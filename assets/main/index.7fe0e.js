window.__require=function e(t,o,n){function i(a,c){if(!o[a]){if(!t[a]){var s=a.split("/");if(s=s[s.length-1],!t[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+a+"'")}a=s}var u=o[a]={exports:{}};t[a][0].call(u.exports,function(e){return i(t[a][1][e]||e)},u,u.exports,e,t,o,n)}return o[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<n.length;a++)i(n[a]);return i}({ABTest_Game:[function(e,t,o){"use strict";cc._RF.push(t,"ed9f48ARaREiI46hOojw0dj","ABTest_Game");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"ed9f48ARaREiI46hOojw0dj","ABTest_Game");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0}),n("CommonData");var u=cc._decorator,p=u.ccclass,d=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.settingBtn=null,t.settingBtnFrames=null,t.candidate=null,t.candidateFrames=null,t.level=null,t.levelFrames=null,t.btns=[],t.btnFrames=[],t.counters=[],t.counterFrames=null,t.counterLabelOutlines=[],t.bgDarks=[],t.bgLights=[],t}return s(t,e),t.prototype.start=function(){},l([d(cc.Sprite)],t.prototype,"settingBtn",void 0),l([d(cc.SpriteFrame)],t.prototype,"settingBtnFrames",void 0),l([d(cc.Sprite)],t.prototype,"candidate",void 0),l([d(cc.SpriteFrame)],t.prototype,"candidateFrames",void 0),l([d(cc.Sprite)],t.prototype,"level",void 0),l([d(cc.SpriteFrame)],t.prototype,"levelFrames",void 0),l([d([cc.Sprite])],t.prototype,"btns",void 0),l([d([cc.SpriteFrame])],t.prototype,"btnFrames",void 0),l([d([cc.Sprite])],t.prototype,"counters",void 0),l([d(cc.SpriteFrame)],t.prototype,"counterFrames",void 0),l([d([cc.LabelOutline])],t.prototype,"counterLabelOutlines",void 0),l([d([cc.Node])],t.prototype,"bgDarks",void 0),l([d([cc.Node])],t.prototype,"bgLights",void 0),l([p],t)}(cc.Component);r.default=f,cc._RF.pop(),cc._RF.pop()},{}],AbsorbCup:[function(e,t,o){"use strict";cc._RF.push(t,"1ea40Ug9LpKTKRQwhowVdwd","AbsorbCup");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"1ea40Ug9LpKTKRQwhowVdwd","AbsorbCup");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("const"),d=n("Cup"),f=n("CupMgr"),h=cc._decorator,y=h.ccclass,m=h.property,g=[3,2,1,1],v=[1,2,3,1],_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.txt_absorbNum=null,t.bottomNodes=[],t.isRestoring=!1,t.absorbArray=[],t.originalParents=new Map,t}return s(t,e),t.prototype.setAbsorbArray=function(e){this.absorbArray=e,this.txt_absorbNum.string=this.absorbArray.length.toString();for(var t=0,o=this.bottomNodes;t<o.length;t++){var n=o[t];n&&n.parent&&this.originalParents.set(n,n.parent)}},t.prototype.updateText=function(){this.txt_absorbNum.string=this.absorbArray.length.toString()},t.prototype.getAbsorbNum=function(){return this.absorbArray.length},t.prototype.fadeOut=function(){var e=this;f.default.getInstance().emptyCupPosArray.push(cc.v2(this.node.position)),f.default.getInstance().cups.indexOf(this)>=0&&f.default.getInstance().cups.splice(f.default.getInstance().cups.indexOf(this),1),cc.tween(this.node).to(.3,{opacity:0}).call(function(){cc.director.emit(p.EventNames.DoPour),e.node.destroy()}).start()},t.prototype.restoreWater=function(){var e=this;if(this.currentState,d.CupState.Restoring,0!=this.absorbArray.length){var t=this.getAbsorbColorId();this.node.parent!=f.default.getInstance().node&&(t=this.absorbArray[0]),this.absorbArray.splice(this.absorbArray.indexOf(t),1),this.updateText();var o=this;this.isRestoring=!0;for(var n=d.SPLIT_COUNT-1;n>=0;n--)this.info.colorIds[n]=t;u.default.instance.playSFX(u.AudioRef.WaterRestore),this.startAddWater(t,4,function(){o.isRestoring=!1,e.info.colorIds=[t,t,t,t],e.stopPourInAnimation(t),e.currentState=d.CupState.Idle,cc.director.emit(p.EventNames.DoPour)})}else this.fadeOut()},t.prototype.getAbsorbColorId=function(){for(var e=f.default.getInstance().cups.filter(function(e){return!e.isFrozen()&&!e.hasMask()&&e.currentState!=d.CupState.Finished&&e.currentState!=d.CupState.ReadyToBeCollected}),t=new Map,o=[],n=[],i=[],r=0,a=999,c=0,s=e;c<s.length;c++){var l=s[c],u=l.getTop();3==u.topColorNum&&1==u.emptyNum&&this.absorbArray.indexOf(u.topColorId)>=0&&i.push(u.topColorId);for(var p=0,h=l.info.colorIds;p<h.length;p++){var y=h[p];if(0!==y&&(y>100?t.set(y-100,(t.get(y-100)||0)+1):t.set(y,(t.get(y)||0)+1),l.cupType===d.CupType.Temp1||l.cupType===d.CupType.Temp1AD||l.cupType===d.CupType.Absorb))break}}for(var m=1;m<=10;m++)void 0===(_=t.get(m))&&(t.set(m,0),_=0),_<a&&_>0&&(a=_),_>r&&(r=_);for(m=1;m<=10;m++){var _;(_=t.get(m))===r&&this.absorbArray.indexOf(m)>=0&&o.push(m),_===a&&this.absorbArray.indexOf(m)>=0&&n.push(m)}var S=JSON.parse(JSON.stringify(g));f.default.getInstance().currentLevelAdWatchedCount>=2&&(S=JSON.parse(JSON.stringify(v))),0===n.length&&(S[0]=0),0===o.length&&(S[1]=0),0===i.length&&(S[2]=0);var b=S,C=b.reduce(function(e,t){return e+t},0);if(0!==C){var P=Math.random()*C;console.error("\u968f\u673a\u5305\u88f9\u2014\u2014\u968f\u673a\u6570 r:",P,"\u603b\u6743\u91cd total:",C,"\u6743\u91cd:",b);var k=0;for(m=0;m<b.length;m++)if((P-=b[m])<0){k=m;break}switch(k){case 0:return n[Math.floor(Math.random()*n.length)];case 1:return o[Math.floor(Math.random()*o.length)];case 2:return i[Math.floor(Math.random()*i.length)];default:return this.absorbArray[Math.floor(Math.random()*this.absorbArray.length)]}}},t.prototype.moveBottomNodesToParent=function(){for(var e=0,t=this.bottomNodes;e<t.length;e++){var o=t[e];if(o&&o.parent){var n=o.parent.convertToWorldSpaceAR(o.position);o.parent=this.node.parent,o.position=o.parent.convertToNodeSpaceAR(n)}}},t.prototype.restoreBottomNodesParent=function(){for(var e=0,t=this.bottomNodes;e<t.length;e++){var o=t[e],n=this.originalParents.get(o);if(o&&n){var i=o.parent.convertToWorldSpaceAR(o.position);o.parent=n,o.position=n.convertToNodeSpaceAR(i)}}1==this.getTop().emptyNum&&this.restoreWater()},t.prototype.moveToPour=function(t,o,n,i,r){this.moveBottomNodesToParent(),e.prototype.moveToPour.call(this,t,o,n,i,r)},l([m(cc.Label)],t.prototype,"txt_absorbNum",void 0),l([m([cc.Node])],t.prototype,"bottomNodes",void 0),l([y],t)}(d.default);r.default=_,cc._RF.pop(),cc._RF.pop()},{}],AddCupPanel:[function(e,t,o){"use strict";cc._RF.push(t,"030e7FLXWpAOrYtv6rkDWsy","AddCupPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"030e7FLXWpAOrYtv6rkDWsy","AddCupPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("Cup"),p=n("CupMgr"),d=n("const"),f=n("GameManager"),h=n("BasePanel"),y=cc._decorator,m=y.ccclass,g=(y.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.onBtn_AddCup=function(){var e=this;f.default.platform.reportVideoEvent("Challenge_UnlockCupAtStart",1),f.default.platform.showRewardAD(function(){f.default.platform.reportVideoEvent("Challenge_UnlockCupAtStart",2);var t=p.default.getInstance().getLockedCups().getComponent(u.default);cc.Canvas.instance.scheduleOnce(function(){t.unlockCupWithTween()},1),cc.director.emit(d.EventNames.DoPour),e.hide()})},t.prototype.onBtn_Close=function(){this.hide()},l([m],t)}(h.default));r.default=g,cc._RF.pop(),cc._RF.pop()},{}],AddDesktopPanel:[function(e,t,o){"use strict";cc._RF.push(t,"198d2047nBPfqLXIIHjLb+5","AddDesktopPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"198d2047nBPfqLXIIHjLb+5","AddDesktopPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("CommonData"),d=n("GameManager"),f=n("BasePanel"),h=n("config"),y=n("const"),m=cc._decorator,g=m.ccclass,v=(m.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.onBtn_Close=function(){u.default.instance.playSFX(u.AudioRef.ClickClose),this.hide()},t.prototype.hide=function(){1===this.node.scale&&e.prototype.hide.call(this)},t.prototype.onBtn_AddToDesktop=function(){var e=this;u.default.instance.playSFX(u.AudioRef.ClickButton),p.default.ifAddDesktop?d.default.platform.showTips("\u5df2\u6210\u529f\u6dfb\u52a0\u81f3\u684c\u9762"):h.currentPlatform===h.platformEnum.toutiao&&d.default.platform.addshortCut(function(){p.default.ifAddDesktopReward?d.default.platform.showTips("\u5df2\u9886\u53d6\u8fc7\u6dfb\u52a0\u684c\u9762\u7684\u5956\u52b1"):(p.default.ifAddDesktopReward=!0,p.default.ifAddDesktop=!0,d.default.showRewardPanel([1,1,1,0]),p.default.PropUndo++,p.default.PropAddCup++,p.default.PropPump++,cc.director.emit(y.EventNames.GetAddDesktopReward),e.hide())})},t.prototype.start=function(){},l([g],t)}(f.default));r.default=v,cc._RF.pop(),cc._RF.pop()},{}],AddPackageNode:[function(e,t,o){"use strict";cc._RF.push(t,"84111fWxXpD+YPzlLj3li5u","AddPackageNode");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"84111fWxXpD+YPzlLj3li5u","AddPackageNode");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("CommonData"),d=n("const"),f=n("GameManager"),h=n("GoldDataManager"),y=n("DataNexusSDK"),m=n("StaminaManager"),g=n("GameScene"),v=n("CupMgr"),_=n("PackageManger"),S=cc._decorator,b=S.ccclass,C=S.property,P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.freeNode=null,t.adNode=null,t.quitNode=null,t.restartBtn=null,t.refreshBtn=null,t}return s(t,e),t.prototype.onEnable=function(){this.freeNode.active=!1,this.adNode.active=!1,this.quitNode.active=!1,this.restartBtn.active=!1,this.refreshBtn.active=!1,_.default.instance.ifThirdUnlock?(this.playBtnPopoutEffect(this.restartBtn),this.playBtnPopoutEffect(this.refreshBtn)):(p.default.ifFirstAddPackage?this.playBtnPopoutEffect(this.freeNode):this.playBtnPopoutEffect(this.adNode),this.playBtnPopoutEffect(this.quitNode))},t.prototype.playBtnPopoutEffect=function(e){e.active=!0,e.scale=0,cc.tween(e).to(.2,{scale:.95}).to(.1,{scale:.8}).start()},t.prototype.onBtn_Restart=function(){if(u.default.instance.playSFX(u.AudioRef.ClickButton),cc.director.getScene().name===d.SceneNames.Game&&p.default.WinStreak>=2&&g.default.instance.uiManager.showPanel("EndStreakPanel").then(function(e){e.getComponent("EndStreakPanel").initPanel(1)}),m.default.instance.energy<=0)cc.director.getScene().name===d.SceneNames.Game&&g.default.instance.uiManager.showPanel("EnergyPanel");else{if(p.default.ifTest||cc.director.getScene().name!==d.SceneNames.Game&&cc.director.getScene().name!==d.SceneNames.GameLong||m.default.instance.consume(1),f.default.platform.reportPageEvent("RestartGame"),cc.director.getScene().name===d.SceneNames.Game&&(f.default.platform.reportAdPointEvent("WinProgress_BreakFirst",p.default.WinStreak),p.default.WinStreak=0),p.default.currentLevelReplayedTime++,cc.director.getScene().name===d.SceneNames.Game){var e={level_id:p.default.CurrentLevel,ad_cnt:v.default.getInstance().currentLevelAdWatchedCount};e.duration=g.default.instance.getLevelTime(),e.game_mode=cc.director.getScene().name,e.stamina_value=m.default.instance.energy,e.coin_amount=h.default.Gold,y.default.instance.trackLevelExit(e)}cc.director.loadScene(cc.director.getScene().name)}},t.prototype.onBtn_Refresh=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),f.default.platform.reportVideoEvent("GamePage_refreshPackage_video",1),f.default.platform.showRewardAD(function(){f.default.platform.reportVideoEvent("GamePage_refreshPackage_video",2),g.default.instance.onBtn_RefreshPackage()})},l([C(cc.Node)],t.prototype,"freeNode",void 0),l([C(cc.Node)],t.prototype,"adNode",void 0),l([C(cc.Node)],t.prototype,"quitNode",void 0),l([C(cc.Node)],t.prototype,"restartBtn",void 0),l([C(cc.Node)],t.prototype,"refreshBtn",void 0),l([b],t)}(cc.Component);r.default=P,cc._RF.pop(),cc._RF.pop()},{}],AddStepPanel:[function(e,t,o){"use strict";cc._RF.push(t,"1c5fbYXfOVNLJHpCKXq+qhf","AddStepPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"1c5fbYXfOVNLJHpCKXq+qhf","AddStepPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("const"),d=n("GameManager"),f=n("GameManager_Long"),h=n("GameManager_Multi"),y=n("DataNexusEnum"),m=n("DataNexusSDK"),g=n("BasePanel"),v=cc._decorator,_=v.ccclass,S=(v.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.onEnable=function(){m.default.instance.trackAdPlacementShow(y.RewardADEvent.OTHER)},t.prototype.onBtn_AddStep=function(){var e=this;u.default.instance.playSFX(u.AudioRef.ClickButton);var t=null;cc.director.getScene().name===p.SceneNames.GameModeMultiple?t=h.default.getInstance():cc.director.getScene().name===p.SceneNames.GameModeFillLong&&(t=f.default.getInstance()),m.default.instance.trackAdClick(y.RewardADEvent.OTHER),d.default.platform.reportVideoEvent("AddStep",1),d.default.platform.showRewardAD(function(){d.default.platform.reportVideoEvent("AddStep",2),m.default.instance.trackAdVideoFinish(y.RewardADEvent.OTHER),t.step+=10,t.updateStepUI(),t.startTimer(),e.hide()})},t.prototype.onBtn_Close=function(){this.hide(),u.default.instance.playSFX(u.AudioRef.ClickClose),cc.director.emit(p.EventNames.GameLose)},l([_],t)}(g.default));r.default=S,cc._RF.pop(),cc._RF.pop()},{}],AddTimePanel:[function(e,t,o){"use strict";cc._RF.push(t,"e8e59eVzp9CtaNS0XCD/LRL","AddTimePanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"e8e59eVzp9CtaNS0XCD/LRL","AddTimePanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("const"),d=n("GameManager"),f=n("GameManager_Long"),h=n("GameManager_Multi"),y=n("DataNexusEnum"),m=n("DataNexusSDK"),g=n("BasePanel"),v=cc._decorator,_=v.ccclass,S=v.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.text_reviveTime=null,t}return s(t,e),t.prototype.onEnable=function(){m.default.instance.trackAdPlacementShow(y.RewardADEvent.ADD_TIME),cc.director.emit(p.EventNames.PauseAllBombs),u.default.instance.playSFX(u.AudioRef.GameOver),cc.director.getScene().name===p.SceneNames.Challenge?(this.text_reviveTime.string="\u672c\u5c40\u590d\u6d3b\u673a\u4f1a\u8fd8\u5269:"+h.default.getInstance().revivedTime+"\u6b21",h.default.getInstance().revivedTime--):this.text_reviveTime.node.active=!1},t.prototype.onBtn_AddTime=function(){var e=this;u.default.instance.playSFX(u.AudioRef.ClickButton);var t=null;if(cc.director.getScene().name===p.SceneNames.GameModeMultiple||cc.director.getScene().name===p.SceneNames.Challenge)t=h.default.getInstance(),d.default.platform.reportVideoEvent("Challenge_revive_video",1),m.default.instance.trackAdClick(y.RewardADEvent.ADD_TIME),d.default.platform.showRewardAD(function(){m.default.instance.trackAdVideoFinish(y.RewardADEvent.ADD_TIME),t.time+=60,t.time_slider+=60,t.updateTimeUI(),t.updateSliderTimeUI(0),t.startTimer(),e.hide(),cc.director.emit(p.EventNames.ResumeAllBombs),d.default.platform.reportVideoEvent("Challenge_revive_video",2)});else if(cc.director.getScene().name===p.SceneNames.GameModeFillLong)return t=f.default.getInstance(),m.default.instance.trackAdClick(y.RewardADEvent.ADD_TIME),void d.default.platform.showRewardAD(function(){m.default.instance.trackAdVideoFinish(y.RewardADEvent.ADD_TIME),t.time+=60,t.updateTimeUI(),t.startTimer(),e.hide()})},t.prototype.onBtn_Close=function(){this.node.active=!1,u.default.instance.playSFX(u.AudioRef.ClickClose),cc.director.emit(p.EventNames.GameLose)},l([S(cc.Label)],t.prototype,"text_reviveTime",void 0),l([_],t)}(g.default);r.default=b,cc._RF.pop(),cc._RF.pop()},{}],AppConfig:[function(e,t,o){"use strict";cc._RF.push(t,"2b843hYR5pAoryvVrC/Jy4k","AppConfig");var n=t,i=o;cc._RF.push(n,"2b843hYR5pAoryvVrC/Jy4k","AppConfig"),Object.defineProperty(i,"__esModule",{value:!0}),i.interAD_ID=i.gameTitle=i.rewardAD_ID=i.appId=i.version=void 0,i.version="1.5.4",i.appId="wxeb3a3f764474c346",i.rewardAD_ID="",i.gameTitle="",i.interAD_ID="","wx62c02bb1d9e7b052"==i.appId?(i.gameTitle="\u5012\u6c34\u5206\u7c7b",i.rewardAD_ID="adunit-041a8a8963163d95",i.interAD_ID=""):"wxeb3a3f764474c346"==i.appId?(i.gameTitle="\u5012\u6c34\u6311\u6218",i.rewardAD_ID="adunit-635f143a0281f206",i.interAD_ID="adunit-e1356d2ea372c531"):"tt4323359edc288b3202"==i.appId?(i.gameTitle="\u5206\u7c7b\u5012\u6c34",i.rewardAD_ID="16m36bnn5p7n3u0mke",i.interAD_ID="k0lgqlf2ic3goknfn6"):"tt1a6c6cd18564383c02"==i.appId?(i.gameTitle="\u5012\u6c34\u6311\u6218",i.rewardAD_ID="1iegc38dmad53h5ltr",i.interAD_ID="11g3h203619d01l7ih"):"tt1aeb6c5685dfeee002"==i.appId?(i.gameTitle="\u6765\u6d88\u554a",i.rewardAD_ID="109i6093cege1bcerf",i.interAD_ID=""):"ttb07ac6c72f4f0d0702"==i.appId&&(i.gameTitle="\u65e0\u654c\u6d88\u9664\u738b",i.rewardAD_ID="57045oe5iptcd47qle",i.interAD_ID="28pfsigp0ap135ja0j"),cc._RF.pop(),cc._RF.pop()},{}],Arrayincludes:[function(e,t){"use strict";cc._RF.push(t,"52d09A8qVxKMJ2j26Bt6wrP","Arrayincludes"),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var o=Object(this),n=o.length>>>0;if(0==n)return!1;for(var i,r,a=0|t,c=Math.max(0<=a?a:n-Math.abs(a),0);c<n;){if((i=o[c])===(r=e)||"number"==typeof i&&"number"==typeof r&&isNaN(i)&&isNaN(r))return!0;c++}return!1}}),cc._RF.pop()},{}],AudioManager_BP:[function(e,t,o){"use strict";cc._RF.push(t,"06005HI1i5GdJvsDArc4Nwz","AudioManager_BP");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"06005HI1i5GdJvsDArc4Nwz","AudioManager_BP");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0}),r.AudioRef=void 0;var u=n("ExternalManager_BP");!function(e){e.ClickButton="clickButton",e.ClickClose="clickClose",e.ChooseBottle="chooseBottle",e.OpenBottle="openBottle",e.WaterFlow="waterFlow",e.WaterDrop="waterDrop",e.BottleFull="bottleFull",e.Victory="victory",e.GameOver="gameOver",e.Boom="boom"}(r.AudioRef||(r.AudioRef={}));var p=cc._decorator,d=p.ccclass,f=p.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.clickBtn=null,t.clickClose=null,t.chooseBottle=null,t.waterFlow=null,t.waterDrop=null,t.victory=null,t}var o;return s(t,e),o=t,t.prototype.onLoad=function(){o.instance=this},t.prototype.playBtn=function(){u.default.CommonData.SoundOn&&this.clickBtn&&cc.audioEngine.playEffect(this.clickBtn,!1)},t.prototype.playClickClose=function(){u.default.CommonData.SoundOn&&this.clickClose&&cc.audioEngine.playEffect(this.clickClose,!1)},t.prototype.playChooseBottle=function(){u.default.CommonData.SoundOn&&this.chooseBottle&&cc.audioEngine.playEffect(this.chooseBottle,!1)},t.prototype.playWaterFlow=function(){u.default.CommonData.SoundOn&&this.waterFlow&&cc.audioEngine.playEffect(this.waterFlow,!1)},t.prototype.playWaterDrop=function(){u.default.CommonData.SoundOn&&this.waterDrop&&cc.audioEngine.playEffect(this.waterDrop,!1)},t.prototype.playVictory=function(){u.default.CommonData.SoundOn&&this.victory&&cc.audioEngine.playEffect(this.victory,!1)},t.instance=null,l([f({type:cc.AudioClip,tooltip:"\u6309\u94ae\u70b9\u51fb\u97f3"})],t.prototype,"clickBtn",void 0),l([f({type:cc.AudioClip,tooltip:"\u5173\u95ed\u97f3"})],t.prototype,"clickClose",void 0),l([f({type:cc.AudioClip,tooltip:"\u9009\u62e9\u74f6\u5b50\u97f3"})],t.prototype,"chooseBottle",void 0),l([f({type:cc.AudioClip,tooltip:"\u5012\u6c34\u97f3"})],t.prototype,"waterFlow",void 0),l([f({type:cc.AudioClip,tooltip:"\u6c34\u6ef4\u97f3"})],t.prototype,"waterDrop",void 0),l([f({type:cc.AudioClip,tooltip:"\u80dc\u5229\u97f3"})],t.prototype,"victory",void 0),o=l([d],t)}(cc.Component);r.default=h,cc._RF.pop(),cc._RF.pop()},{}],AudioManager_ED:[function(e,t,o){"use strict";cc._RF.push(t,"a9853SE9e5Kp6iyrqjHAJDN","AudioManager_ED");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"a9853SE9e5Kp6iyrqjHAJDN","AudioManager_ED");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0}),r.AudioRef=void 0;var u=n("ExternalManager_ED"),p=cc._decorator,d=p.ccclass,f=p.property;!function(e){e.ClickButton="clickButton",e.ClickClose="clickClose",e.ChooseBottle="chooseBottle",e.OpenBottle="openBottle",e.WaterFlow="waterFlow",e.SortItem="sortItem",e.Victory="victory",e.PreHomeBGM="preHomeBgm",e.HomeBGM="homeBgm",e.LevelBGM="levelBgm",e.BottleFull="bottleFull",e.CapFinish="coverLid",e.WaterCurrentOut="waterFlyOut",e.WaterCurrentIn="waterFlyin",e.DrinkFinish="drinkFinish"}(r.AudioRef||(r.AudioRef={}));var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btn=null,t.bottleUnlock=null,t.chooseBottle=null,t.openBottle=null,t.waterFlow=null,t.bottleFullefx=null,t.coverLid=null,t}var o;return s(t,e),o=t,t.prototype.onLoad=function(){o.instance=this},t.prototype.playBtn=function(){u.default.CommonData.SoundOn&&cc.audioEngine.playEffect(this.btn,!1)},t.prototype.playBottleUnlock=function(){u.default.CommonData.SoundOn&&cc.audioEngine.playEffect(this.bottleUnlock,!1)},t.prototype.playChooseBottle=function(){u.default.CommonData.SoundOn&&cc.audioEngine.playEffect(this.chooseBottle,!1)},t.prototype.playOpenBottle=function(){u.default.CommonData.SoundOn&&cc.audioEngine.playEffect(this.openBottle,!1)},t.prototype.playWaterFlow=function(){u.default.CommonData.SoundOn&&cc.audioEngine.playEffect(this.waterFlow,!1)},t.prototype.playBottleFullefx=function(){u.default.CommonData.SoundOn&&cc.audioEngine.playEffect(this.bottleFullefx,!1)},t.prototype.playCoverLid=function(){u.default.CommonData.SoundOn&&cc.audioEngine.playEffect(this.coverLid,!1)},t.prototype.playSFX=function(e,t){void 0===t&&(t=!1)},t.prototype.setSFXVolume=function(){},t.prototype.setBGMVolume=function(){},t.instance=null,l([f({type:cc.AudioClip})],t.prototype,"btn",void 0),l([f({type:cc.AudioClip,tooltip:"\u6c34\u74f6\u788e\u5f00"})],t.prototype,"bottleUnlock",void 0),l([f({type:cc.AudioClip,tooltip:"\u9009\u4e2d/\u653e\u4e0b\u6c34\u74f6"})],t.prototype,"chooseBottle",void 0),l([f({type:cc.AudioClip,tooltip:"\u52a0\u74f6\u5b50"})],t.prototype,"openBottle",void 0),l([f({type:cc.AudioClip,tooltip:"\u5012\u6c34"})],t.prototype,"waterFlow",void 0),l([f({type:cc.AudioClip,tooltip:"\u5b8c\u6210\u74f6\u5b50"})],t.prototype,"bottleFullefx",void 0),l([f({type:cc.AudioClip,tooltip:"\u74f6\u5b50\u76d6\u4e0a"})],t.prototype,"coverLid",void 0),o=l([d],t)}(cc.Component);r.default=h,cc._RF.pop(),cc._RF.pop()},{}],AudioManager:[function(e,t,o){"use strict";cc._RF.push(t,"f71b8dYn/VGEL+TQVd1yJli","AudioManager");var n=e,i=t,r=o;cc._RF.push(i,"f71b8dYn/VGEL+TQVd1yJli","AudioManager"),Object.defineProperty(r,"__esModule",{value:!0}),r.AudioRef=void 0;var a,c=n("CommonData");(function(e){e[e.BGM=0]="BGM",e[e.SFX=1]="SFX",e[e.MUSIC=2]="MUSIC"})(a||(a={})),function(e){e.ClickButton="clickButton",e.ClickClose="clickClose",e.ChooseBottle="chooseBottle",e.OpenBottle="openBottle",e.WaterFlow="waterFlow",e.WaterFlow1="waterFlow1",e.WaterFlow2="waterFlow2",e.WaterFlow3="waterFlow",e.SortItem="sortItem",e.Victory="victory",e.PreHomeBGM="preHomeBgm",e.HomeBGM="homeBgm",e.LevelBGM="levelBgm",e.BottleFull="bottleFull",e.CapFinish="coverLid",e.WaterCurrentOut="waterFlyOut",e.WaterCurrentIn="waterFlyin",e.DrinkFinish="drinkFinish",e.WaterDrop="waterDrop",e.PigOut="pigOut",e.PigOut1="pigOut1",e.PigOut2="pigOut2",e.PigOut3="pigOut3",e.FillWater="FillWater",e.GameOver="gameOver",e.Boom="boom",e.WaterRestore="waterRestore",e.Reward="reward",e.HardLevel="hardLevel",e.HellLevel="hellLevel",e.CountDown="countDown",e.GoldCoin="goldCoin",e.GoldCoinOver="goldCoinOver",e.LevelBgmH="levelBgmH",e.LevelBgmM="levelBgmM",e.ClockRing="clockRing",e.FillWater5="FillWater5",e.FillWater4="FillWater4",e.FillWater3="FillWater3",e.FillWater2="FillWater2",e.FireWork="fireWork"}(r.AudioRef||(r.AudioRef={}));var s=function(){function e(){this._audioBundle=null,this._audioCache=new Map,this._bgmAudioId=-1,this._curBgmName="",this._musicAudioIds=new Map,this._bgmVolume=1,this._sfxVolume=1,this._musicVolume=1,this._bgmMuted=!1,this._sfxMuted=!1,this._musicMuted=!1}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),e.prototype.init=function(e){var t=this,o=cc.assetManager.getBundle("Audio");if(o)return this._audioBundle=o,void(e&&e());this._audioBundle?e&&e():cc.assetManager.loadBundle("Audio",function(o,n){o?cc.error("\u97f3\u9891 bundle \u52a0\u8f7d\u5931\u8d25",o):(t._audioBundle=n,cc.log("\u97f3\u9891 bundle \u52a0\u8f7d\u5b8c\u6210"),e&&e())})},e.prototype.preload=function(e,t,o){var n=this;void 0===t&&(t=a.SFX),this._audioBundle?this._audioCache.has(e)?o&&o():this._audioBundle.load(e,cc.AudioClip,function(i,r){i?cc.error("\u9884\u52a0\u8f7d\u97f3\u9891 "+e+" \u5931\u8d25",i):(n._audioCache.set(e,{clip:r,type:t}),o&&o())}):cc.error("\u97f3\u9891 bundle \u672a\u521d\u59cb\u5316\uff0c\u8bf7\u5148\u8c03\u7528 init()")},e.prototype.playBGM=function(e,t){var o=this;void 0===t&&(t=!0),c.default.MusicOn||this.setBGMVolume(0),this._audioBundle?this._curBgmName===e&&-1!==this._bgmAudioId||(this.stopBGM(),this._getAudioClip(e,a.BGM,function(n){o._bgmAudioId=cc.audioEngine.play(n,t,o._bgmMuted?0:o._bgmVolume),o._curBgmName=e})):cc.error("\u97f3\u9891 bundle \u672a\u521d\u59cb\u5316\uff0c\u8bf7\u5148\u8c03\u7528 init()")},e.prototype.stopBGM=function(){-1!==this._bgmAudioId&&(cc.audioEngine.stop(this._bgmAudioId),this._bgmAudioId=-1,this._curBgmName="")},e.prototype.pauseBGM=function(){-1!==this._bgmAudioId&&cc.audioEngine.pause(this._bgmAudioId)},e.prototype.resumeBGM=function(){-1!==this._bgmAudioId&&cc.audioEngine.resume(this._bgmAudioId)},e.prototype.setBGMVolume=function(e){this._bgmVolume=e,-1===this._bgmAudioId||this._bgmMuted||cc.audioEngine.setVolume(this._bgmAudioId,e)},e.prototype.muteBGM=function(e){this._bgmMuted=e,-1!==this._bgmAudioId&&cc.audioEngine.setVolume(this._bgmAudioId,e?0:this._bgmVolume)},e.prototype.playSFX=function(e,t){var o=this;return void 0===t&&(t=!1),!1===c.default.SoundOn&&this.setSFXVolume(0),this._audioBundle?(this._getAudioClip(e,a.SFX,function(e){cc.audioEngine.play(e,t,o._sfxMuted?0:o._sfxVolume)}),0):(cc.error("\u97f3\u9891 bundle \u672a\u521d\u59cb\u5316\uff0c\u8bf7\u5148\u8c03\u7528 init()"),-1)},e.prototype.setSFXVolume=function(e){this._sfxVolume=e},e.prototype.muteSFX=function(e){this._sfxMuted=e},e.prototype.playMusic=function(e,t){var o=this;if(void 0===t&&(t=!0),c.default.SoundOn||this.setMusicVolume(0),!this._audioBundle)return cc.error("\u97f3\u9891 bundle \u672a\u521d\u59cb\u5316\uff0c\u8bf7\u5148\u8c03\u7528 init()"),-1;var n=this._musicAudioIds.get(e);return null!=n&&cc.audioEngine.getState(n)===cc.audioEngine.AudioState.PLAYING?n:(this._getAudioClip(e,a.MUSIC,function(n){var i=cc.audioEngine.play(n,t,o._musicMuted?0:o._musicVolume);o._musicAudioIds.set(e,i),cc.audioEngine.setFinishCallback(i,function(){o._musicAudioIds.get(e)===i&&o._musicAudioIds.delete(e)})}),0)},e.prototype.stopMusic=function(e){var t=this._musicAudioIds.get(e);null!=t&&(cc.audioEngine.stop(t),this._musicAudioIds.delete(e))},e.prototype.isMusicPlaying=function(e){var t=this._musicAudioIds.get(e);return null!=t&&cc.audioEngine.getState(t)===cc.audioEngine.AudioState.PLAYING},e.prototype.setMusicVolume=function(e){this._musicVolume=e,this._musicMuted||this._musicAudioIds.forEach(function(t){return cc.audioEngine.setVolume(t,e)})},e.prototype.muteMusic=function(e){var t=this;this._musicMuted=e,this._musicAudioIds.forEach(function(o){return cc.audioEngine.setVolume(o,e?0:t._musicVolume)})},e.prototype.stopAll=function(){cc.audioEngine.stopAll(),this._bgmAudioId=-1,this._curBgmName="",this._musicAudioIds.clear()},e.prototype._getAudioClip=function(e,t,o){var n=this;this._audioCache.has(e)?o(this._audioCache.get(e).clip):this._audioBundle.load(e,cc.AudioClip,function(i,r){i?cc.error("\u52a0\u8f7d\u97f3\u9891 "+e+" \u5931\u8d25",i):(n._audioCache.set(e,{clip:r,type:t}),o(r))})},e}();r.default=s,cc._RF.pop(),cc._RF.pop()},{}],AutoPlayUtil_ED:[function(e,t,o){"use strict";cc._RF.push(t,"3bac2F09+5PiaEEU90eXksK","AutoPlayUtil_ED");var n=e,i=t,r=o;cc._RF.push(i,"3bac2F09+5PiaEEU90eXksK","AutoPlayUtil_ED"),Object.defineProperty(r,"__esModule",{value:!0}),r.AutoplayUtil=void 0;var a=n("Cup_ED"),c=n("GameManager_ED");(function(e){e.delay=function(e){return new Promise(function(t){return setTimeout(t,1e3*e)})},e.existPourablePairs=function(e,t){var o=Array.from(c.default.instance.bottlesShowed.values());if(t){for(var n=0;n<o.length;n++){var i=o[n];if(i.cupType!=a.CupType.Locked&&i.isEmpty())return!0}return!1}var r=o.filter(function(e){return e.currentState!=a.CupState.Finished&&!e.isEmpty()&&e.canCheckDeadlock()});for(n=0;n<r.length;n++){var s=r[n];if(s.cupType!=a.CupType.Fixed)for(var l=0;l<r.length;l++)if(n!==l){var u=r[l];if((u.getTop().topColorId==s.getTop().topColorId||100==Math.abs(u.getTop().topColorId-s.getTop().topColorId))&&(u.getTop().emptyNum,s.canPourTo(u)||s.canFinish(u)))return!0}}return!1},e.pickRandomPourPair=function(e,t){var o=Array.from(c.default.instance.bottlesShowed.values());if(t){for(var n=0,i=-1,r=0;r<o.length;r++)if(!o[r].isEmpty()&&o[r].canCheckDeadlock()&&o[r].currentState!=a.CupState.Finished){var s=o[r].getTop().topColorNum,l=o[r].getTop().emptyNum;if(s>n){if(s+l==4)continue;n=s,i=r}}var u=o[i],p=-1;for(r=0;r<o.length;r++)if(o[r].isEmpty()&&o[r].cupType!=a.CupType.Locked){p=r;break}return-1===p?[null,null]:[u,o[p]]}var d=[],f=o.filter(function(e){return e.currentState!=a.CupState.Finished&&!e.isEmpty()&&e.canCheckDeadlock()});for(r=0;r<f.length;r++){var h=f[r];if(!h.isEmpty()&&h.currentState!=a.CupState.Finished&&h.cupType!=a.CupType.Fixed)for(var y=0;y<f.length;y++)if(r!==y){var m=f[y];(h.canPourTo(m)||h.canFinish(m))&&d.push([r,y])}}if(0===d.length)return[null,null];var g=d[Math.floor(Math.random()*d.length)],v=g[0],_=g[1];return[f[v],f[_]]},e.pickPourPair=function(){for(var e=[],t=Array.from(c.default.instance.bottlesShowed.values()).filter(function(e){return e.currentState!=a.CupState.Finished&&!e.isEmpty()&&e.canCheckDeadlock()}),o=0;o<t.length;o++){var n=t[o];if(!n.isEmpty()&&n.currentState!=a.CupState.Finished&&n.cupType!=a.CupType.Fixed)for(var i=0;i<t.length;i++)if(o!==i){var r=t[i];n.getTop().topColorId==r.getTop().topColorId&&r.getTop().emptyNum>0&&e.push([o,i])}}if(0===e.length)return[null,null];var s=e[Math.floor(Math.random()*e.length)],l=s[0],u=s[1];return[t[l],t[u]]},e.existEmptyCup=function(){for(var e=Array.from(c.default.instance.bottlesShowed.values()),t=0;t<e.length;t++)if(e[t].isEmpty()&&e[t].cupType!=a.CupType.Locked)return!0;return!1}})(r.AutoplayUtil||(r.AutoplayUtil={})),cc._RF.pop(),cc._RF.pop()},{}],AutoPlayUtil:[function(e,t,o){"use strict";cc._RF.push(t,"dde78e0TgtKLo6fst/Swzm0","AutoPlayUtil");var n=e,i=t,r=o;cc._RF.push(i,"dde78e0TgtKLo6fst/Swzm0","AutoPlayUtil"),Object.defineProperty(r,"__esModule",{value:!0}),r.AutoplayUtil=void 0;var a=n("Cup"),c=n("CupMgr_Long");(function(e){e.delay=function(e){return new Promise(function(t){return setTimeout(t,1e3*e)})},e.existPourablePairs=function(e,t){if(t){for(var o=0;o<e.cups.length;o++){var n=e.cups[o];if(n.cupType!=a.CupType.Locked){if(n.isEmpty()&&n.cupType!==a.CupType.SingleColor)return!0;if(n.isEmpty()&&n.cupType===a.CupType.SingleColor)for(var i=0,r=e.cups;i<r.length;i++){var c=r[i];if(c!==n&&!c.isEmpty()&&c.getTop().topColorId===n.singleColorId)return!0}}}return!1}var s=e.cups.filter(function(e){return e.currentState!=a.CupState.Finished&&e.currentState!=a.CupState.ReadyToBeCollected&&!e.isEmpty()&&e.canCheckDeadlock()});for(o=0;o<s.length;o++){var l=s[o];if(l.cupType!=a.CupType.Fixed&&l.cupType!=a.CupType.BombFixed)for(var u=0;u<s.length;u++)if(o!==u){var p=s[u];if(p.getTop().topColorId==l.getTop().topColorId||100==Math.abs(p.getTop().topColorId%1e3-l.getTop().topColorId%1e3)){if(p.getTop().emptyNum,l.canPourTo(p)&&l.cupType==a.CupType.Temp1&&!p.isSingleColor())continue;if(l.canPourTo(p)||l.canFinish(p))return!0}}}return!1},e.pickRandomPourPair=function(e,t){if(t){for(var o=0,n=-1,i=0;i<e.cups.length;i++)if(!e.cups[i].isEmpty()&&e.cups[i].canCheckDeadlock()&&e.cups[i].currentState!=a.CupState.Finished&&e.cups[i].currentState!=a.CupState.ReadyToBeCollected){var r=e.cups[i].getTop().topColorNum,c=e.cups[i].getTop().emptyNum;if(r>o){if(r+c==4)continue;o=r,n=i}}var s=-1;for(i=0;i<e.cups.length;i++)if(e.cups[i].isEmpty()&&e.cups[i].cupType!=a.CupType.Temp1&&e.cups[i].cupType!=a.CupType.Locked&&e.cups[i].cupType!=a.CupType.SingleColor&&!e.cups[i].isFrozen()&&!e.cups[i].hasMask()){s=i;break}for(i=0;i<e.cups.length&&-1==s;i++)if(e.cups[i].isEmpty()&&e.cups[i].cupType!=a.CupType.Locked&&e.cups[i].cupType!=a.CupType.SingleColor&&!e.cups[i].isFrozen()&&!e.cups[i].hasMask()){s=i;break}if(-1!=s&&e.cups[s].cupType===a.CupType.Temp1)for(i=0;i<e.cups.length;i++)if(!e.cups[i].isEmpty()&&e.cups[i].cupType!=a.CupType.Temp1&&e.cups[i].canCheckDeadlock()&&e.cups[i].currentState!=a.CupState.Finished&&e.cups[i].currentState!=a.CupState.ReadyToBeCollected&&(r=e.cups[i].getTop().topColorNum,c=e.cups[i].getTop().emptyNum,1==r)){if(r+c==4)continue;n=i;break}if(-1===s)for(i=0;i<e.cups.length;i++){var l=0,u=0;if(n=-1,e.cups[i].isEmpty()&&e.cups[i].cupType==a.CupType.SingleColor){s=i,l=e.cups[i].singleColorId;for(var p=0;p<e.cups.length;p++)if(!e.cups[p].isEmpty()&&e.cups[p].canCheckDeadlock()&&e.cups[p].currentState!=a.CupState.Finished&&e.cups[p].currentState!=a.CupState.ReadyToBeCollected&&e.cups[p].getTop().topColorId==l&&(r=e.cups[p].getTop().topColorNum,c=e.cups[p].getTop().emptyNum,r>u)){if(r+c==4)continue;u=r,n=p}break}}return-1===s||-1===n?[null,null]:[e.cups[n],e.cups[s]]}var d=[],f=e.cups.filter(function(e){return e.currentState!=a.CupState.Finished&&e.currentState!=a.CupState.ReadyToBeCollected&&!e.isEmpty()&&e.canCheckDeadlock()});for(i=0;i<f.length;i++){var h=f[i];if(!h.isEmpty()&&h.currentState!=a.CupState.Finished&&h.cupType!=a.CupType.BombFixed&&h.cupType!=a.CupType.Fixed)for(p=0;p<f.length;p++)if(i!==p){var y=f[p];if(h.canPourTo(y)||h.canFinish(y)){if(h.canPourTo(y)&&h.cupType==a.CupType.Temp1&&!y.isSingleColor())continue;d.push([i,p])}}}if(0===d.length)return[null,null];var m=d[Math.floor(Math.random()*d.length)],g=m[0],v=m[1];return[f[g],f[v]]},e.pickPourPair=function(e){for(var t=[],o=e.cups.filter(function(e){return e.currentState!=a.CupState.Finished&&e.currentState!=a.CupState.ReadyToBeCollected&&!e.isEmpty()&&e.canCheckDeadlock()}),n=0;n<o.length;n++){var i=o[n];if(!i.isEmpty()&&i.currentState!=a.CupState.Finished&&i.cupType!=a.CupType.Fixed&&i.cupType!=a.CupType.BombFixed)for(var r=0;r<o.length;r++)if(n!==r){var c=o[r];i.getTop().topColorId==c.getTop().topColorId&&c.getTop().emptyNum>0&&t.push([n,r])}}if(0===t.length)return[null,null];var s=t[Math.floor(Math.random()*t.length)],l=s[0],u=s[1];return[o[l],o[u]]},e.existPourablePairs_Challenge=function(e,t){if(t){for(var o=0;o<e.cups.length;o++){var n=e.cups[o];if(n.cupType!=a.CupType.Locked&&n.isEmpty())return!0}return!1}var i=e.cups.filter(function(e){return e.currentState!=a.CupState.Finished&&!e.isEmpty()&&e.cupType!=a.CupType.Locked});for(o=0;o<i.length;o++)for(var r=i[o],c=0;c<i.length;c++)if(o!==c){var s=i[c];if((s.getTop().topColorId==r.getTop().topColorId||100==Math.abs(s.getTop().topColorId%1e3-r.getTop().topColorId%1e3))&&(s.getTop().emptyNum,r.canPourTo(s)||r.canFinish(s)))return!0}return!1},e.pickRandomPourPair_Challenge=function(e,t){if(t){for(var o=0,n=-1,i=0;i<e.cups.length;i++)if(!e.cups[i].isEmpty()&&e.cups[i].cupType!=a.CupType.Locked&&e.cups[i].currentState!=a.CupState.Finished){var r=e.cups[i].getTop().topColorNum,c=e.cups[i].getTop().emptyNum;if(r>o){if(r+c==17)continue;o=r,n=i}}var s=e.cups[n],l=-1;for(i=0;i<e.cups.length;i++)if(e.cups[i].isEmpty()&&e.cups[i].cupType!=a.CupType.Locked){l=i;break}return-1===l?[null,null]:[s,e.cups[l]]}var u=[],p=e.cups.filter(function(e){return e.currentState!=a.CupState.Finished&&!e.isEmpty()&&e.cupType!=a.CupType.Locked});for(i=0;i<p.length;i++){var d=p[i];if(!d.isEmpty()&&d.currentState!=a.CupState.Finished)for(var f=0;f<p.length;f++)if(i!==f){var h=p[f];(d.canPourTo(h)||d.canFinish(h))&&u.push([i,f])}}if(0===u.length)return[null,null];var y=u[Math.floor(Math.random()*u.length)],m=y[0],g=y[1];return[p[m],p[g]]},e.existPourablePairsToLong_Long=function(){for(var e=c.default.getInstance().cups.filter(function(e){return e.currentState!=a.CupState.Finished&&e.currentState!=a.CupState.ReadyToBeCollected&&!e.isEmpty()&&e.canCheckDeadlock()}),t=c.default.getInstance().longCups.filter(function(e){return e.currentState!=a.CupState.Finished}),o=0;o<e.length;o++)for(var n=0;n<t.length;n++){var i=e[o],r=t[n];if(i.getTop().topColorId==r.getTop().topColorId)return!0}},e.pickRandomPourPairToLong_Long=function(){for(var e=c.default.getInstance().cups.filter(function(e){return e.currentState!=a.CupState.Finished&&e.currentState!=a.CupState.ReadyToBeCollected&&!e.isEmpty()&&e.canCheckDeadlock()}),t=c.default.getInstance().longCups.filter(function(e){return e.currentState!=a.CupState.Finished}),o=[],n=0;n<e.length;n++)for(var i=0;i<t.length;i++){var r=e[n],s=t[i];r.getTop().topColorId==s.getTop().topColorId&&o.push([n,i])}if(0===o.length)return[null,null];var l=o[Math.floor(Math.random()*o.length)],u=l[0],p=l[1];return[e[u],t[p]]},e.existPourablePairs_Long=function(e,t){if(t){for(var o=0;o<e.cups.length;o++){var n=e.cups[o];if(n.cupType!=a.CupType.Locked&&n.isEmpty())return!0}return!1}var i=e.cups.filter(function(e){return e.currentState!=a.CupState.Finished&&e.currentState!=a.CupState.ReadyToBeCollected&&!e.isEmpty()&&e.cupType!=a.CupType.Locked});for(o=0;o<i.length;o++)for(var r=i[o],c=0;c<i.length;c++)if(o!==c){var s=i[c];if((s.getTop().topColorId==r.getTop().topColorId||100==Math.abs(s.getTop().topColorId%1e3-r.getTop().topColorId%1e3))&&(s.getTop().emptyNum,r.canPourTo(s)||r.canFinish(s)))return!0}return!1},e.pickRandomPourPair_Long=function(e,t){if(t){for(var o=0,n=-1,i=0;i<e.cups.length;i++)if(!e.cups[i].isEmpty()&&e.cups[i].canCheckDeadlock()&&e.cups[i].currentState!=a.CupState.Finished&&e.cups[i].currentState!=a.CupState.ReadyToBeCollected){var r=e.cups[i].getTop().topColorNum,c=e.cups[i].getTop().emptyNum;if(r>o){if(r+c==4)continue;o=r,n=i}}var s=e.cups[n],l=-1;for(i=0;i<e.cups.length;i++)if(e.cups[i].isEmpty()&&e.cups[i].cupType!=a.CupType.Locked){l=i;break}return-1===l?[null,null]:[s,e.cups[l]]}var u=[],p=e.cups.filter(function(e){return e.currentState!=a.CupState.Finished&&e.currentState!=a.CupState.ReadyToBeCollected&&!e.isEmpty()&&e.canCheckDeadlock()});for(i=0;i<p.length;i++){var d=p[i];if(!d.isEmpty()&&d.currentState!=a.CupState.Finished&&d.cupType!=a.CupType.Fixed&&d.cupType!=a.CupType.BombFixed)for(var f=0;f<p.length;f++)if(i!==f){var h=p[f];(d.canPourTo(h)||d.canFinish(h))&&u.push([i,f])}}if(0===u.length)return[null,null];var y=u[Math.floor(Math.random()*u.length)],m=y[0],g=y[1];return[p[m],p[g]]},e.pickPourPair_Long=function(e){for(var t=[],o=e.cups.filter(function(e){return e.currentState!=a.CupState.Finished&&e.currentState!=a.CupState.ReadyToBeCollected&&!e.isEmpty()&&e.canCheckDeadlock()}),n=0;n<o.length;n++){var i=o[n];if(!i.isEmpty()&&i.currentState!=a.CupState.Finished&&i.cupType!=a.CupType.Fixed&&i.cupType!=a.CupType.BombFixed)for(var r=0;r<o.length;r++)if(n!==r){var c=o[r];i.getTop().topColorId==c.getTop().topColorId&&c.getTop().emptyNum>0&&t.push([n,r])}}if(0===t.length)return[null,null];var s=t[Math.floor(Math.random()*t.length)],l=s[0],u=s[1];return[o[l],o[u]]}})(r.AutoplayUtil||(r.AutoplayUtil={})),cc._RF.pop(),cc._RF.pop()},{}],AutoPlay_SS:[function(e,t,o){"use strict";cc._RF.push(t,"5354bcpMDRGFZbesKtk8rzR","AutoPlay_SS");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"5354bcpMDRGFZbesKtk8rzR","AutoPlay_SS");var c=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var s=n("CommonData_SS"),l=n("UIManager_SS"),u=cc._decorator,p=u.ccclass,d=(u.property,function(){function e(){}return e.startAutoPlay=function(){console.warn("\u5f00\u542f\u81ea\u52a8\u64cd\u4f5c"),this.executeAutoPlay()},e.executeAutoPlay=function(){var e=this;if(s.default.ScrewSortCtrl)if(s.default.ifOpenAuto)if(s.default.ScrewSortCtrl.ifGameWin)setTimeout(function(){cc.find("Canvas/panelArea/gameOverPnl").getComponent("gameOverPnl_SS").clickNextLevel()},1e3);else{s.default.ScrewSortCtrl.canOperate=!1;for(var t=[],o=0;o<s.default.ScrewSortCtrl.steelLayer.children.length;o++)t=t.concat(s.default.ScrewSortCtrl.steelLayer.children[o].getComponent("ScrewSortSteel_SS").getCanPlace());t.sort(function(e,t){return t.pushSteel.getComponent("ScrewSortSteel_SS")._tailList.length-e.pushSteel.getComponent("ScrewSortSteel_SS")._tailList.length});var n,i=[];t.forEach(function(e){0===e.pushSteel.getComponent("ScrewSortSteel_SS")._screwList.length&&i.push(e)}),t.length>0?(n=i.length>0?i[Math.floor(Math.random()*i.length)]:t[0],this.executePopScrew(n.popSteel,function(){setTimeout(function(){e.executePushScrew(n.pushSteel,function(){setTimeout(function(){e.executeAutoPlay()},1e3+1e3*Math.random())})},1e3*Math.random())})):this.executeStalemate()}else s.default.ScrewSortCtrl.canOperate=!0},e.executePopScrew=function(e,t){if(s.default.ScrewSortCtrl){var o=e.getComponent("ScrewSortSteel_SS");s.default.ScrewSortCtrl.typeInOperation=o._listTail,s.default.ScrewSortCtrl.lastSteelIndex=o._steelIndex,o.popScrew(o._listTail,function(){t&&t()})}},e.executePushScrew=function(e,t){if(s.default.ScrewSortCtrl){var o=e.getComponent("ScrewSortSteel_SS"),n={state:"push",list:[]},i=o._checkUnlockInfo(s.default.ScrewSortCtrl.typeInOperation);if(-1!==i){var r={list:o._steelIndex,i:i};n.unlockData=r}o.pushScrew(n,function(){console.log("//// \u64cd\u4f5c\u8bb0\u5f55 ////",n),s.default.ScrewSortCtrl.operationRecord.push(n),s.default.ScrewSortCtrl.withdrawBtn.interactable=!0,s.default.ScrewSortCtrl.withdrawTimesBg.node.color=cc.Color.WHITE,n.unlockData&&(o._screwList[n.unlockData.i]-=1e3,o.screwArea.children[n.unlockData.i].getChildByName("lock").active=!1);var e=s.default.ScrewSortCtrl.steelLayer.children[s.default.ScrewSortCtrl.lastSteelIndex],i=s.default.ScrewSortCtrl.steelBackLayer.children[s.default.ScrewSortCtrl.lastSteelIndex],r=e.getComponent("ScrewSortSteel_SS")._screwList;if(r[r.length-1]>=100&&r[r.length-1]<1e3){var a={list:s.default.ScrewSortCtrl.lastSteelIndex,i:r.length-1};n.unhideData=a,r[n.unhideData.i]-=100,e.getChildByName("screwArea").children[n.unhideData.i].getChildByName("hide").active=!1,i.getChildByName("screwArea").children[n.unhideData.i].getChildByName("hide").active=!1}o.checkIfTypeFilled(o._listTail)&&o._onTypeFilled(o._listTail),s.default.ScrewSortCtrl.checkIfStalemate(),t&&t()})}},e.executeStalemate=function(){s.default.ScrewSortCtrl.restLocked>0&&s.default.ScrewSortCtrl.reviveTimes>0?Math.random()<.5?this.executeAddList():this.executeRevive():s.default.ScrewSortCtrl.restLocked>0?this.executeAddList():s.default.ScrewSortCtrl.reviveTimes>0?this.executeRevive():this.executeReplay()},e.executeAddList=function(){var e=this;l.default.instance.showPanel(l.default.instance.pnlEnum.addList),setTimeout(function(){cc.find("Canvas/panelArea/addListPnl").getComponent("addListPnl_SS").clickAddList(),setTimeout(function(){e.executeAutoPlay()},500+1e3*Math.random())},2500)},e.executeRevive=function(){var e=this;l.default.instance.showPanel(l.default.instance.pnlEnum.revive),setTimeout(function(){cc.find("Canvas/panelArea/revivePnl").getComponent("revivePnl_SS").clickRevive(),setTimeout(function(){e.executeAutoPlay()},500+1e3*Math.random())},2500)},e.executeReplay=function(){l.default.instance.showPanel(l.default.instance.pnlEnum.set),setTimeout(function(){cc.find("Canvas/panelArea/setPnl").getComponent("setPnl_SS").clickRestart()},2500)},c([p],e)}());r.default=d,cc._RF.pop(),cc._RF.pop()},{}],AutoPlayerFillLong:[function(e,t,o){"use strict";cc._RF.push(t,"79af2ZUWmpFoItQj9+BU6TH","AutoPlayerFillLong");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"79af2ZUWmpFoItQj9+BU6TH","AutoPlayerFillLong");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},p=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0});var d,f,h=n("CommonData"),y=n("Cup"),m=n("CupMgr_Long"),g=n("AutoPlayUtil"),v=n("InputSimulator"),_=n("config"),S=n("GameManager_Long"),b=n("GameScene_Long"),C=cc._decorator,P=C.ccclass,k=C.property;(function(e){e[e.Playing=0]="Playing",e[e.DeadLock=1]="DeadLock",e[e.Win=2]="Win",e[e.OutOfTime=3]="OutOfTime",e[e.OutOfSteps=4]="OutOfSteps"})(d||(d={})),function(e){e[e.PourAvailable=0]="PourAvailable",e[e.PourNormal=1]="PourNormal",e[e.PourToEmpty=2]="PourToEmpty",e[e.UnlockAdCup=3]="UnlockAdCup",e[e.RestartGame=4]="RestartGame",e[e.NextLevel=5]="NextLevel",e[e.UseDyeProp=6]="UseDyeProp",e[e.AddTime=7]="AddTime",e[e.AddStep=8]="AddStep"}(f||(f={}));var w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.minDelay=1.5,t.randomDelay=.5,t.clickNode=null,t.state=d.Playing,t.isExecuting=!1,t}return s(t,e),t.prototype.onEnable=function(){h.default.autoPlaying&&cc.director.on("load_level_finish",this.StartAutoPlay,this)},t.prototype.onDisable=function(){cc.director.off("load_level_finish",this.StartAutoPlay,this)},t.prototype.StartAutoPlay=function(){h.default.autoPlaying=!0,b.default.instance.updateAutoPlayText(),this.rules=this.buildRules(),this.schedule(this.tick,.5),_.currentPlatform!==_.platformEnum.wechat&&this.clickNode.on(cc.Node.EventType.TOUCH_END,this.StopAutoPlay,this)},t.prototype.StopAutoPlay=function(){h.default.autoPlaying=!1,b.default.instance.updateAutoPlayText(),this.unschedule(this.tick),_.currentPlatform!==_.platformEnum.wechat&&this.clickNode.off(cc.Node.EventType.TOUCH_END,this.StopAutoPlay,this)},t.prototype.tick=function(){return u(this,void 0,void 0,function(){var e,t,o,n;return p(this,function(i){switch(i.label){case 0:if(this.refreshState(),this.isExecuting)return[2];e=0,t=this.rules,i.label=1;case 1:if(!(e<t.length))return[3,10];if(!(o=t[e]).condition())return[3,9];if(this.isExecuting=!0,!(Math.random()<=o.successRate))return[3,8];i.label=2;case 2:return i.trys.push([2,4,5,7]),[4,o.action()];case 3:return i.sent(),[3,7];case 4:return n=i.sent(),console.error("\u6267\u884c\u52a8\u4f5c\u65f6\u51fa\u9519:",n),[3,7];case 5:return[4,g.AutoplayUtil.delay(this.randomWait())];case 6:return i.sent(),this.isExecuting=!1,[7];case 7:return[2];case 8:this.isExecuting=!1,i.label=9;case 9:return e++,[3,1];case 10:return[2]}})})},t.prototype.refreshState=function(){m.default.getInstance().checkIsAllFinished()?this.state=d.Win:S.default.getInstance().time<=0?this.state=d.OutOfTime:S.default.getInstance().step<=0?this.state=d.OutOfSteps:m.default.getInstance().ifDeadLock()?this.state=d.DeadLock:this.state=d.Playing},t.prototype.buildRules=function(){var e=this,t=v.default.instance,o=g.AutoplayUtil;return[{type:f.PourAvailable,successRate:1,condition:function(){return e.state===d.Playing&&o.existPourablePairsToLong_Long(m.default.getInstance())},action:function(){return u(e,void 0,void 0,function(){var e,n,i;return p(this,function(r){switch(r.label){case 0:return e=o.pickRandomPourPairToLong_Long(m.default.getInstance()),n=e[0],i=e[1],t.clickCup(n),[4,o.delay(this.randomWait())];case 1:return r.sent(),t.clickCup(i),[4,o.delay(this.randomWait())];case 2:return r.sent(),[2]}})})}},{type:f.PourNormal,successRate:1,condition:function(){return e.state===d.Playing&&o.existPourablePairs_Long(m.default.getInstance(),!1)},action:function(){return u(e,void 0,void 0,function(){var e,n,i;return p(this,function(r){switch(r.label){case 0:return e=o.pickRandomPourPair_Long(m.default.getInstance(),!1),n=e[0],i=e[1],t.clickCup(n),[4,o.delay(this.randomWait())];case 1:return r.sent(),t.clickCup(i),[4,o.delay(this.randomWait())];case 2:return r.sent(),[2]}})})}},{type:f.PourToEmpty,successRate:1,condition:function(){return e.state===d.Playing&&!o.existPourablePairs_Long(m.default.getInstance(),!1)&&o.existPourablePairs_Long(m.default.getInstance(),!0)},action:function(){return u(e,void 0,void 0,function(){var e,n,i;return p(this,function(r){switch(r.label){case 0:return e=o.pickRandomPourPair_Long(m.default.getInstance(),!0),n=e[0],i=e[1],t.clickCup(n),[4,o.delay(this.randomWait())];case 1:return r.sent(),t.clickCup(i),[4,o.delay(this.randomWait())];case 2:return r.sent(),[2]}})})}},{type:f.PourAvailable,successRate:1,condition:function(){return e.state===d.Playing},action:function(){return u(e,void 0,void 0,function(){var e,n,i;return p(this,function(r){switch(r.label){case 0:return e=o.pickPourPair_Long(m.default.getInstance()),n=e[0],i=e[1],n&&i?(t.clickCup(n),[4,o.delay(this.randomWait())]):[3,3];case 1:return r.sent(),t.clickCup(i),[4,o.delay(this.randomWait())];case 2:r.sent(),r.label=3;case 3:return[2]}})})}},{type:f.AddTime,successRate:1,condition:function(){return e.state===d.OutOfTime},action:function(){return u(e,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return[4,t.ClickAddTime()];case 1:return e.sent(),[2]}})})}},{type:f.AddStep,successRate:1,condition:function(){return e.state===d.OutOfSteps},action:function(){return u(e,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return[4,t.ClickAddStep()];case 1:return e.sent(),[2]}})})}},{type:f.UnlockAdCup,successRate:.8,condition:function(){return e.state===d.DeadLock&&m.default.getInstance().hasLockedCups()},action:function(){return u(e,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return[4,o.delay(.3)];case 1:return e.sent(),[4,t.clickCup(m.default.getInstance().getLockedCups().getComponent(y.default))];case 2:return e.sent(),[2]}})})}},{type:f.UseDyeProp,successRate:1,condition:function(){return e.state===d.DeadLock&&h.default.ifReplayed&&m.default.getInstance().canDyeWater()},action:function(){return u(e,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return[4,t.simulateClickDyeProp()];case 1:return e.sent(),[2]}})})}},{type:f.RestartGame,successRate:1,condition:function(){return e.state===d.DeadLock},action:function(){return u(e,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return h.default.ifReplayed=!0,[4,t.clickNode(b.default.instance.btn_Setting)];case 1:return e.sent(),[4,o.delay(.5)];case 2:return e.sent(),[4,t.clickNode(b.default.instance.uiManager.node.getChildByName("SettingPanel").getChildByName("GameBtns").getChildByName("Btn_Restart"))];case 3:return e.sent(),[2]}})})}},{type:f.NextLevel,successRate:1,condition:function(){return e.state===d.Win},action:function(){return u(e,void 0,void 0,function(){var e,n;return p(this,function(i){switch(i.label){case 0:return h.default.ifReplayed=!1,[4,o.delay(3)];case 1:return i.sent(),cc.find("Canvas").getChildByName("RewardPanel")?(e=cc.find("Canvas").getChildByName("RewardPanel").getChildByName("PanelMask"),[4,t.clickNode(e)]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,o.delay(2)];case 4:return i.sent(),n=b.default.instance.uiManager.node.getChildByName("GameOverPanel").getChildByName("Btns").getChildByName("Btn_Nextlevel"),6===h.default.Level?[3,7]:[4,t.clickNode(n)];case 5:return i.sent(),[4,o.delay(2)];case 6:return i.sent(),[3,10];case 7:return[4,t.simulateDrinkMaking()];case 8:return i.sent(),[4,o.delay(2)];case 9:i.sent(),i.label=10;case 10:return[2]}})})}}]},t.prototype.randomWait=function(){return this.minDelay+Math.random()*this.randomDelay},l([k({type:cc.Float,tooltip:"\u4e24\u6b21\u70b9\u51fb\u95f4\u7684\u6700\u5c0f\u7b49\u5f85\u79d2"})],t.prototype,"minDelay",void 0),l([k({type:cc.Float,tooltip:"\u4e24\u6b21\u70b9\u51fb\u95f4\u7684\u968f\u673a\u9644\u52a0\u6700\u5927\u7b49\u5f85\u79d2"})],t.prototype,"randomDelay",void 0),l([k(cc.Node)],t.prototype,"clickNode",void 0),l([P],t)}(cc.Component);r.default=w,cc._RF.pop(),cc._RF.pop()},{}],AutoPlayerLong:[function(e,t,o){"use strict";cc._RF.push(t,"88564W/OIxLq6wlW8mIHYsa","AutoPlayerLong");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"88564W/OIxLq6wlW8mIHYsa","AutoPlayerLong");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},p=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0});var d,f,h=n("CommonData"),y=n("Cup_17"),m=n("CupMgr_17"),g=n("GameManager_17"),v=n("AutoPlayUtil"),_=n("InputSimulator"),S=n("config"),b=cc._decorator,C=b.ccclass,P=b.property;(function(e){e[e.Playing=0]="Playing",e[e.DeadLock=1]="DeadLock",e[e.Win=2]="Win"})(d||(d={})),function(e){e[e.PourNormal=0]="PourNormal",e[e.PourToEmpty=1]="PourToEmpty",e[e.UnlockAdCup=2]="UnlockAdCup",e[e.RestartGame=3]="RestartGame",e[e.NextLevel=4]="NextLevel",e[e.UseDyeProp=5]="UseDyeProp"}(f||(f={}));var k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.minDelay=.3,t.randomDelay=.1,t.clickNode=null,t.state=d.Playing,t.isExecuting=!1,t}return s(t,e),t.prototype.onEnable=function(){h.default.autoPlaying&&cc.director.on("load_level_finish",this.StartAutoPlay,this)},t.prototype.onDisable=function(){cc.director.off("load_level_finish",this.StartAutoPlay,this)},t.prototype.StartAutoPlay=function(){h.default.autoPlaying=!0,g.default.instance.updateAutoPlayText(),this.rules=this.buildRules(),this.schedule(this.tick,.5),S.currentPlatform!==S.platformEnum.wechat&&this.clickNode.on(cc.Node.EventType.TOUCH_END,this.StopAutoPlay,this)},t.prototype.StopAutoPlay=function(){h.default.autoPlaying=!1,g.default.instance.updateAutoPlayText(),this.unschedule(this.tick),S.currentPlatform!==S.platformEnum.wechat&&this.clickNode.off(cc.Node.EventType.TOUCH_END,this.StopAutoPlay,this)},t.prototype.tick=function(){return u(this,void 0,void 0,function(){var e,t,o,n;return p(this,function(i){switch(i.label){case 0:if(this.refreshState(),this.isExecuting)return[2];e=0,t=this.rules,i.label=1;case 1:if(!(e<t.length))return[3,10];if(!(o=t[e]).condition())return[3,9];if(this.isExecuting=!0,!(Math.random()<=o.successRate))return[3,8];i.label=2;case 2:return i.trys.push([2,4,5,7]),[4,o.action()];case 3:return i.sent(),[3,7];case 4:return n=i.sent(),console.error("\u6267\u884c\u52a8\u4f5c\u65f6\u51fa\u9519:",n),[3,7];case 5:return[4,v.AutoplayUtil.delay(this.randomWait())];case 6:return i.sent(),this.isExecuting=!1,[7];case 7:return[2];case 8:this.isExecuting=!1,i.label=9;case 9:return e++,[3,1];case 10:return[2]}})})},t.prototype.refreshState=function(){m.default.getInstance().checkIsAllFinished()?this.state=d.Win:m.default.getInstance().ifDeadLock()?this.state=d.DeadLock:this.state=d.Playing},t.prototype.buildRules=function(){var e=this,t=_.default.instance,o=v.AutoplayUtil;return[{type:f.PourNormal,successRate:1,condition:function(){return e.state===d.Playing&&o.existPourablePairs_Challenge(m.default.getInstance(),!1)},action:function(){return u(e,void 0,void 0,function(){var e,n,i;return p(this,function(r){switch(r.label){case 0:return e=o.pickRandomPourPair_Challenge(m.default.getInstance(),!1),n=e[0],i=e[1],t.clickCup_Challenge(n),[4,o.delay(.3)];case 1:return r.sent(),t.clickCup_Challenge(i),[4,o.delay(.3)];case 2:return r.sent(),[2]}})})}},{type:f.PourToEmpty,successRate:1,condition:function(){return e.state===d.Playing&&!o.existPourablePairs_Challenge(m.default.getInstance(),!1)&&o.existPourablePairs_Challenge(m.default.getInstance(),!0)},action:function(){return u(e,void 0,void 0,function(){var e,n,i;return p(this,function(r){switch(r.label){case 0:return e=o.pickRandomPourPair_Challenge(m.default.getInstance(),!0),n=e[0],i=e[1],t.clickCup_Challenge(n),[4,o.delay(.3)];case 1:return r.sent(),t.clickCup_Challenge(i),[4,o.delay(.3)];case 2:return r.sent(),[2]}})})}},{type:f.UnlockAdCup,successRate:.8,condition:function(){return e.state===d.DeadLock&&m.default.getInstance().hasLockedCups()},action:function(){return u(e,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return[4,o.delay(.3)];case 1:return e.sent(),[4,t.clickCup_Challenge(m.default.getInstance().getLockedCups().getComponent(y.default))];case 2:return e.sent(),[2]}})})}},{type:f.RestartGame,successRate:1,condition:function(){return e.state===d.DeadLock},action:function(){return u(e,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return h.default.ifReplayed=!0,[4,t.clickNode(g.default.instance.btn_Setting)];case 1:return e.sent(),[4,o.delay(.5)];case 2:return e.sent(),[4,t.clickNode(g.default.instance.uiManager.node.getChildByName("SettingPanel").getChildByName("GameBtns").getChildByName("Btn_Restart"))];case 3:return e.sent(),[2]}})})}},{type:f.NextLevel,successRate:1,condition:function(){return e.state===d.Win},action:function(){return u(e,void 0,void 0,function(){var e,n;return p(this,function(i){switch(i.label){case 0:return h.default.ifReplayed=!1,[4,o.delay(3)];case 1:return i.sent(),cc.find("Canvas").getChildByName("RewardPanel")?(e=cc.find("Canvas").getChildByName("RewardPanel").getChildByName("PanelMask"),[4,t.clickNode(e)]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,o.delay(2)];case 4:return i.sent(),n=g.default.instance.uiManager.node.getChildByName("GameOverPanel").getChildByName("Btns").getChildByName("Btn_Nextlevel"),6===h.default.Level?[3,7]:[4,t.clickNode(n)];case 5:return i.sent(),[4,o.delay(2)];case 6:return i.sent(),[3,10];case 7:return[4,t.simulateDrinkMaking()];case 8:return i.sent(),[4,o.delay(2)];case 9:i.sent(),i.label=10;case 10:return[2]}})})}}]},t.prototype.randomWait=function(){return this.minDelay+Math.random()*this.randomDelay},l([P({type:cc.Float,tooltip:"\u4e24\u6b21\u70b9\u51fb\u95f4\u7684\u6700\u5c0f\u7b49\u5f85\u79d2"})],t.prototype,"minDelay",void 0),l([P({type:cc.Float,tooltip:"\u4e24\u6b21\u70b9\u51fb\u95f4\u7684\u968f\u673a\u9644\u52a0\u6700\u5927\u7b49\u5f85\u79d2"})],t.prototype,"randomDelay",void 0),l([P(cc.Node)],t.prototype,"clickNode",void 0),l([C],t)}(cc.Component);r.default=k,cc._RF.pop(),cc._RF.pop()},{}],AutoPlayerMulti:[function(e,t,o){"use strict";cc._RF.push(t,"b3635pE8StFd5ioYEQzc0ol","AutoPlayerMulti");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"b3635pE8StFd5ioYEQzc0ol","AutoPlayerMulti");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},p=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0});var d,f,h=n("CommonData"),y=n("Cup"),m=n("CupMgr"),g=n("GameScene"),v=n("AutoPlayUtil"),_=n("InputSimulator"),S=n("config"),b=n("GameManager_Multi"),C=cc._decorator,P=C.ccclass,k=C.property;(function(e){e[e.Playing=0]="Playing",e[e.DeadLock=1]="DeadLock",e[e.Win=2]="Win",e[e.OutOfTime=3]="OutOfTime",e[e.OutOfSteps=4]="OutOfSteps"})(d||(d={})),function(e){e[e.PourAvailable=0]="PourAvailable",e[e.PourNormal=1]="PourNormal",e[e.PourToEmpty=2]="PourToEmpty",e[e.UnlockAdCup=3]="UnlockAdCup",e[e.RestartGame=4]="RestartGame",e[e.NextLevel=5]="NextLevel",e[e.UseDyeProp=6]="UseDyeProp",e[e.AddTime=7]="AddTime",e[e.AddStep=8]="AddStep"}(f||(f={}));var w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.minDelay=1.5,t.randomDelay=.5,t.clickNode=null,t.state=d.Playing,t.isExecuting=!1,t}return s(t,e),t.prototype.onEnable=function(){h.default.autoPlaying&&cc.director.on("load_level_finish",this.StartAutoPlay,this)},t.prototype.onDisable=function(){cc.director.off("load_level_finish",this.StartAutoPlay,this)},t.prototype.StartAutoPlay=function(){h.default.autoPlaying=!0,g.default.instance.updateAutoPlayText(),this.rules=this.buildRules(),this.schedule(this.tick,.5),S.currentPlatform!==S.platformEnum.wechat&&this.clickNode.on(cc.Node.EventType.TOUCH_END,this.StopAutoPlay,this)},t.prototype.StopAutoPlay=function(){h.default.autoPlaying=!1,g.default.instance.updateAutoPlayText(),this.unschedule(this.tick),S.currentPlatform!==S.platformEnum.wechat&&this.clickNode.off(cc.Node.EventType.TOUCH_END,this.StopAutoPlay,this)},t.prototype.tick=function(){return u(this,void 0,void 0,function(){var e,t,o,n;return p(this,function(i){switch(i.label){case 0:if(this.refreshState(),this.isExecuting)return[2];e=0,t=this.rules,i.label=1;case 1:if(!(e<t.length))return[3,10];if(!(o=t[e]).condition())return[3,9];if(this.isExecuting=!0,!(Math.random()<=o.successRate))return[3,8];i.label=2;case 2:return i.trys.push([2,4,5,7]),[4,o.action()];case 3:return i.sent(),[3,7];case 4:return n=i.sent(),console.error("\u6267\u884c\u52a8\u4f5c\u65f6\u51fa\u9519:",n),[3,7];case 5:return[4,v.AutoplayUtil.delay(this.randomWait())];case 6:return i.sent(),this.isExecuting=!1,[7];case 7:return[2];case 8:this.isExecuting=!1,i.label=9;case 9:return e++,[3,1];case 10:return[2]}})})},t.prototype.refreshState=function(){m.default.getInstance().checkIsAllFinished()?this.state=d.Win:b.default.getInstance().time<=0?this.state=d.OutOfTime:b.default.getInstance().step<=0?this.state=d.OutOfSteps:m.default.getInstance().ifDeadLock()?this.state=d.DeadLock:this.state=d.Playing},t.prototype.buildRules=function(){var e=this,t=_.default.instance,o=v.AutoplayUtil;return[{type:f.PourNormal,successRate:1,condition:function(){return e.state===d.Playing&&o.existPourablePairs(m.default.getInstance(),!1)},action:function(){return u(e,void 0,void 0,function(){var e,n,i;return p(this,function(r){switch(r.label){case 0:return e=o.pickRandomPourPair(m.default.getInstance(),!1),n=e[0],i=e[1],t.clickCup(n),[4,o.delay(this.randomWait())];case 1:return r.sent(),t.clickCup(i),[4,o.delay(this.randomWait())];case 2:return r.sent(),[2]}})})}},{type:f.PourToEmpty,successRate:1,condition:function(){return e.state===d.Playing&&!o.existPourablePairs(m.default.getInstance(),!1)&&o.existPourablePairs(m.default.getInstance(),!0)},action:function(){return u(e,void 0,void 0,function(){var e,n,i;return p(this,function(r){switch(r.label){case 0:return e=o.pickRandomPourPair(m.default.getInstance(),!0),n=e[0],i=e[1],t.clickCup(n),[4,o.delay(this.randomWait())];case 1:return r.sent(),t.clickCup(i),[4,o.delay(this.randomWait())];case 2:return r.sent(),[2]}})})}},{type:f.PourAvailable,successRate:1,condition:function(){return e.state===d.Playing},action:function(){return u(e,void 0,void 0,function(){var e,n,i;return p(this,function(r){switch(r.label){case 0:return e=o.pickPourPair(m.default.getInstance()),n=e[0],i=e[1],n&&i?(t.clickCup(n),[4,o.delay(this.randomWait())]):[3,3];case 1:return r.sent(),t.clickCup(i),[4,o.delay(this.randomWait())];case 2:r.sent(),r.label=3;case 3:return[2]}})})}},{type:f.AddTime,successRate:1,condition:function(){return e.state===d.OutOfTime},action:function(){return u(e,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return[4,t.ClickAddTime()];case 1:return e.sent(),[2]}})})}},{type:f.AddStep,successRate:1,condition:function(){return e.state===d.OutOfSteps},action:function(){return u(e,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return[4,t.ClickAddStep()];case 1:return e.sent(),[2]}})})}},{type:f.UnlockAdCup,successRate:.8,condition:function(){return e.state===d.DeadLock&&m.default.getInstance().hasLockedCups()},action:function(){return u(e,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return[4,o.delay(.3)];case 1:return e.sent(),[4,t.clickCup(m.default.getInstance().getLockedCups().getComponent(y.default))];case 2:return e.sent(),[2]}})})}},{type:f.UseDyeProp,successRate:1,condition:function(){return e.state===d.DeadLock&&h.default.ifReplayed&&m.default.getInstance().canDyeWater()},action:function(){return u(e,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return[4,t.simulateClickDyeProp()];case 1:return e.sent(),[2]}})})}},{type:f.RestartGame,successRate:1,condition:function(){return e.state===d.DeadLock},action:function(){return u(e,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return h.default.ifReplayed=!0,[4,t.clickNode(g.default.instance.btn_Setting)];case 1:return e.sent(),[4,o.delay(.5)];case 2:return e.sent(),[4,t.clickNode(g.default.instance.uiManager.node.getChildByName("SettingPanel").getChildByName("GameBtns").getChildByName("Btn_Restart"))];case 3:return e.sent(),[2]}})})}},{type:f.NextLevel,successRate:1,condition:function(){return e.state===d.Win},action:function(){return u(e,void 0,void 0,function(){var e,n;return p(this,function(i){switch(i.label){case 0:return h.default.ifReplayed=!1,[4,o.delay(3)];case 1:return i.sent(),cc.find("Canvas").getChildByName("RewardPanel")?(e=cc.find("Canvas").getChildByName("RewardPanel").getChildByName("PanelMask"),[4,t.clickNode(e)]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,o.delay(2)];case 4:return i.sent(),n=g.default.instance.uiManager.node.getChildByName("GameOverPanel").getChildByName("Btns").getChildByName("Btn_Nextlevel"),6===h.default.Level?[3,7]:[4,t.clickNode(n)];case 5:return i.sent(),[4,o.delay(2)];case 6:return i.sent(),[3,10];case 7:return[4,t.simulateDrinkMaking()];case 8:return i.sent(),[4,o.delay(2)];case 9:i.sent(),i.label=10;case 10:return[2]}})})}}]},t.prototype.randomWait=function(){return this.minDelay+Math.random()*this.randomDelay},l([k({type:cc.Float,tooltip:"\u4e24\u6b21\u70b9\u51fb\u95f4\u7684\u6700\u5c0f\u7b49\u5f85\u79d2"})],t.prototype,"minDelay",void 0),l([k({type:cc.Float,tooltip:"\u4e24\u6b21\u70b9\u51fb\u95f4\u7684\u968f\u673a\u9644\u52a0\u6700\u5927\u7b49\u5f85\u79d2"})],t.prototype,"randomDelay",void 0),l([k(cc.Node)],t.prototype,"clickNode",void 0),l([P],t)}(cc.Component);r.default=w,cc._RF.pop(),cc._RF.pop()},{}],AutoPlayer_ED:[function(e,t,o){"use strict";cc._RF.push(t,"8ee72YUhR9JfaEDwwGALGwj","AutoPlayer_ED");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"8ee72YUhR9JfaEDwwGALGwj","AutoPlayer_ED");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},p=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0});var d,f,h=n("ExternalManager_ED"),y=n("AutoPlayUtil_ED"),m=n("InputSimulator_ED"),g=n("config"),v=n("CupMgr_ED"),_=n("GameManager_ED"),S=cc._decorator,b=S.ccclass,C=S.property;(function(e){e[e.Playing=0]="Playing",e[e.DeadLock=1]="DeadLock",e[e.Win=2]="Win"})(d||(d={})),function(e){e[e.PourNormal=0]="PourNormal",e[e.PourToEmpty=1]="PourToEmpty",e[e.UnlockAdCup=2]="UnlockAdCup",e[e.RestartGame=3]="RestartGame",e[e.NextLevel=4]="NextLevel",e[e.UseDyeProp=5]="UseDyeProp",e[e.PourAvailable=6]="PourAvailable"}(f||(f={}));var P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cupMgr=null,t.btn_AddCup=null,t.btn_EliminateCup=null,t.minDelay=1.5,t.randomDelay=.5,t.clickNode=null,t.state=d.Playing,t.isExecuting=!1,t}return s(t,e),t.prototype.onEnable=function(){h.default.CommonData.autoPlaying&&cc.director.on("load_level_finish",this.StartAutoPlay,this),this.cupMgr=this.node.getChildByName("cupMgr").getComponent(v.default)},t.prototype.onDisable=function(){cc.director.off("load_level_finish",this.StartAutoPlay,this)},t.prototype.StartAutoPlay=function(){h.default.CommonData.autoPlaying=!0,_.default.instance.updateAutoPlayText(),this.rules=this.buildRules(),this.schedule(this.tick,.5),g.currentPlatform!==g.platformEnum.wechat&&this.clickNode.on(cc.Node.EventType.TOUCH_END,this.StopAutoPlay,this)},t.prototype.StopAutoPlay=function(){h.default.CommonData.autoPlaying=!1,_.default.instance.updateAutoPlayText(),this.unschedule(this.tick),g.currentPlatform!==g.platformEnum.wechat&&this.clickNode.off(cc.Node.EventType.TOUCH_END,this.StopAutoPlay,this)},t.prototype.tick=function(){return u(this,void 0,void 0,function(){var e,t,o;return p(this,function(n){switch(n.label){case 0:if(this.refreshState(),this.isExecuting)return[2];e=0,t=this.rules,n.label=1;case 1:if(!(e<t.length))return[3,10];if(!(o=t[e]).condition())return[3,9];if(this.isExecuting=!0,!(Math.random()<=o.successRate))return[3,8];n.label=2;case 2:return n.trys.push([2,4,5,7]),[4,o.action()];case 3:case 4:return n.sent(),[3,7];case 5:return[4,y.AutoplayUtil.delay(this.randomWait())];case 6:return n.sent(),this.isExecuting=!1,[7];case 7:return[2];case 8:this.isExecuting=!1,n.label=9;case 9:return e++,[3,1];case 10:return[2]}})})},t.prototype.refreshState=function(){this.cupMgr.ifDeadLock()?this.state=d.DeadLock:this.state=d.Playing},t.prototype.buildRules=function(){var e=this,t=m.default.instance,o=y.AutoplayUtil;return[{type:f.PourNormal,successRate:1,condition:function(){return e.state===d.Playing&&o.existPourablePairs(e.cupMgr,!1)},action:function(){return u(e,void 0,void 0,function(){var e,n,i;return p(this,function(r){switch(r.label){case 0:return e=o.pickRandomPourPair(this.cupMgr,!1),n=e[0],i=e[1],t.clickCup(n),[4,o.delay(this.randomWait())];case 1:return r.sent(),t.clickCup(i),[4,o.delay(this.randomWait())];case 2:return r.sent(),[2]}})})}},{type:f.PourToEmpty,successRate:1,condition:function(){return e.state===d.Playing&&!o.existPourablePairs(e.cupMgr,!1)&&o.existPourablePairs(e.cupMgr,!0)},action:function(){return u(e,void 0,void 0,function(){var e,n,i;return p(this,function(r){switch(r.label){case 0:return e=o.pickRandomPourPair(this.cupMgr,!0),n=e[0],i=e[1],t.clickCup(n),[4,o.delay(this.randomWait())];case 1:return r.sent(),t.clickCup(i),[4,o.delay(this.randomWait())];case 2:return r.sent(),[2]}})})}},{type:f.PourAvailable,successRate:1,condition:function(){return e.state===d.Playing},action:function(){return u(e,void 0,void 0,function(){var e,n,i;return p(this,function(r){switch(r.label){case 0:return e=o.pickPourPair(this.cupMgr),n=e[0],i=e[1],n&&i?(t.clickCup(n),[4,o.delay(this.randomWait())]):[3,3];case 1:return r.sent(),t.clickCup(i),[4,o.delay(this.randomWait())];case 2:r.sent(),r.label=3;case 3:return[2]}})})}},{type:f.UnlockAdCup,successRate:1,condition:function(){return e.state===d.DeadLock&&255===e.btn_AddCup.opacity&&!o.existEmptyCup(e.cupMgr)},action:function(){return u(e,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return[4,o.delay(.3)];case 1:return e.sent(),[4,t.clickNode(this.btn_AddCup)];case 2:return e.sent(),[2]}})})}},{type:f.UseDyeProp,successRate:1,condition:function(){return e.state===d.DeadLock&&255===e.btn_EliminateCup.opacity},action:function(){return u(e,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return[4,o.delay(.3)];case 1:return e.sent(),[4,t.clickNode(this.btn_EliminateCup)];case 2:return e.sent(),[2]}})})}}]},t.prototype.randomWait=function(){return this.minDelay+Math.random()*this.randomDelay},l([C(v.default)],t.prototype,"cupMgr",void 0),l([C(cc.Node)],t.prototype,"btn_AddCup",void 0),l([C(cc.Node)],t.prototype,"btn_EliminateCup",void 0),l([C({type:cc.Float,tooltip:"\u4e24\u6b21\u70b9\u51fb\u95f4\u7684\u6700\u5c0f\u7b49\u5f85\u79d2"})],t.prototype,"minDelay",void 0),l([C({type:cc.Float,tooltip:"\u4e24\u6b21\u70b9\u51fb\u95f4\u7684\u968f\u673a\u9644\u52a0\u6700\u5927\u7b49\u5f85\u79d2"})],t.prototype,"randomDelay",void 0),l([C(cc.Node)],t.prototype,"clickNode",void 0),l([b],t)}(cc.Component);r.default=P,cc._RF.pop(),cc._RF.pop()},{}],AutoPlayer:[function(e,t,o){"use strict";cc._RF.push(t,"19287i5+hdP76lrVobAVWGd","AutoPlayer");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"19287i5+hdP76lrVobAVWGd","AutoPlayer");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},p=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0});var d,f,h=n("CommonData"),y=n("Cup"),m=n("CupMgr"),g=n("GameScene"),v=n("AutoPlayUtil"),_=n("InputSimulator"),S=n("config"),b=cc._decorator,C=b.ccclass,P=b.property;(function(e){e[e.Playing=0]="Playing",e[e.DeadLock=1]="DeadLock",e[e.Win=2]="Win"})(d||(d={})),function(e){e[e.PourNormal=0]="PourNormal",e[e.PourToEmpty=1]="PourToEmpty",e[e.UnlockAdCup=2]="UnlockAdCup",e[e.RestartGame=3]="RestartGame",e[e.NextLevel=4]="NextLevel",e[e.UseDyeProp=5]="UseDyeProp",e[e.PourAvailable=6]="PourAvailable"}(f||(f={}));var k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.minDelay=1.5,t.randomDelay=.5,t.clickNode=null,t.state=d.Playing,t.isExecuting=!1,t}return s(t,e),t.prototype.onEnable=function(){h.default.autoPlaying&&cc.director.on("load_level_finish",this.StartAutoPlay,this)},t.prototype.onDisable=function(){cc.director.off("load_level_finish",this.StartAutoPlay,this)},t.prototype.StartAutoPlay=function(){h.default.autoPlaying=!0,g.default.instance.updateAutoPlayText(),this.rules=this.buildRules(),this.schedule(this.tick,.5),S.currentPlatform!==S.platformEnum.wechat&&this.clickNode.on(cc.Node.EventType.TOUCH_END,this.StopAutoPlay,this)},t.prototype.StopAutoPlay=function(){h.default.autoPlaying=!1,g.default.instance.updateAutoPlayText(),this.unschedule(this.tick),S.currentPlatform!==S.platformEnum.wechat&&this.clickNode.off(cc.Node.EventType.TOUCH_END,this.StopAutoPlay,this)},t.prototype.tick=function(){return u(this,void 0,void 0,function(){var e,t,o,n;return p(this,function(i){switch(i.label){case 0:if(this.refreshState(),this.isExecuting)return[2];e=0,t=this.rules,i.label=1;case 1:if(!(e<t.length))return[3,10];if(!(o=t[e]).condition())return[3,9];if(this.isExecuting=!0,!(Math.random()<=o.successRate))return[3,8];i.label=2;case 2:return i.trys.push([2,4,5,7]),[4,o.action()];case 3:return i.sent(),[3,7];case 4:return n=i.sent(),console.error("\u6267\u884c\u52a8\u4f5c\u65f6\u51fa\u9519:",n),[3,7];case 5:return[4,v.AutoplayUtil.delay(this.randomWait())];case 6:return i.sent(),this.isExecuting=!1,[7];case 7:return[2];case 8:this.isExecuting=!1,i.label=9;case 9:return e++,[3,1];case 10:return[2]}})})},t.prototype.refreshState=function(){m.default.getInstance().checkIsAllFinished()?this.state=d.Win:m.default.getInstance().ifDeadLock()?this.state=d.DeadLock:this.state=d.Playing},t.prototype.buildRules=function(){var e=this,t=_.default.instance,o=v.AutoplayUtil;return[{type:f.PourNormal,successRate:1,condition:function(){return e.state===d.Playing&&o.existPourablePairs(m.default.getInstance(),!1)},action:function(){return u(e,void 0,void 0,function(){var e,n,i;return p(this,function(r){switch(r.label){case 0:return e=o.pickRandomPourPair(m.default.getInstance(),!1),n=e[0],i=e[1],t.clickCup(n),[4,o.delay(this.randomWait())];case 1:return r.sent(),t.clickCup(i),[4,o.delay(this.randomWait())];case 2:return r.sent(),[2]}})})}},{type:f.PourToEmpty,successRate:1,condition:function(){return e.state===d.Playing&&!o.existPourablePairs(m.default.getInstance(),!1)&&o.existPourablePairs(m.default.getInstance(),!0)},action:function(){return u(e,void 0,void 0,function(){var e,n,i;return p(this,function(r){switch(r.label){case 0:return e=o.pickRandomPourPair(m.default.getInstance(),!0),n=e[0],i=e[1],t.clickCup(n),[4,o.delay(this.randomWait())];case 1:return r.sent(),t.clickCup(i),[4,o.delay(this.randomWait())];case 2:return r.sent(),[2]}})})}},{type:f.PourAvailable,successRate:1,condition:function(){return e.state===d.Playing},action:function(){return u(e,void 0,void 0,function(){var e,n,i;return p(this,function(r){switch(r.label){case 0:return e=o.pickPourPair(m.default.getInstance()),n=e[0],i=e[1],n&&i?(t.clickCup(n),[4,o.delay(this.randomWait())]):[3,3];case 1:return r.sent(),t.clickCup(i),[4,o.delay(this.randomWait())];case 2:r.sent(),r.label=3;case 3:return[2]}})})}},{type:f.UnlockAdCup,successRate:.8,condition:function(){return e.state===d.DeadLock&&m.default.getInstance().hasLockedCups()},action:function(){return u(e,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return[4,o.delay(.3)];case 1:return e.sent(),[4,t.clickCup(m.default.getInstance().getLockedCups().getComponent(y.default))];case 2:return e.sent(),[2]}})})}},{type:f.UseDyeProp,successRate:1,condition:function(){return e.state===d.DeadLock&&h.default.ifReplayed&&m.default.getInstance().canAddEmptyCup()},action:function(){return u(e,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return[4,t.simulateClickAddProp()];case 1:return e.sent(),[2]}})})}},{type:f.RestartGame,successRate:1,condition:function(){return e.state===d.DeadLock},action:function(){return u(e,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return h.default.ifReplayed=!0,[4,o.delay(.5)];case 1:return e.sent(),[4,t.clickNode(g.default.instance.btn_Setting)];case 2:return e.sent(),[4,o.delay(.5)];case 3:return e.sent(),[4,t.clickNode(g.default.instance.uiManager.node.getChildByName("SettingPanel").getChildByName("GameBtns").getChildByName("Btn_Restart"))];case 4:return e.sent(),[2]}})})}},{type:f.NextLevel,successRate:1,condition:function(){return e.state===d.Win},action:function(){return u(e,void 0,void 0,function(){var e,n,i,r,a;return p(this,function(c){switch(c.label){case 0:return[4,o.delay(1)];case 1:return c.sent(),h.default.ifReplayed=!1,(e=g.default.instance.uiManager.node.getChildByName("DrinkPanel"))&&e.active?(n=g.default.instance.uiManager.node.getChildByName("DrinkPanel").getChildByName("PanelMask"),[4,t.clickNode(n)]):[3,3];case 2:c.sent(),c.label=3;case 3:return[4,o.delay(3)];case 4:return c.sent(),cc.find("Canvas").getChildByName("RewardPanel")?(i=cc.find("Canvas").getChildByName("RewardPanel").getChildByName("PanelMask"),[4,t.clickNode(i)]):[3,6];case 5:c.sent(),c.label=6;case 6:return[4,o.delay(2)];case 7:return c.sent(),(r=g.default.instance.uiManager.node.getChildByName("GameOverMainPanel"))&&r.active?(a=g.default.instance.uiManager.node.getChildByName("GameOverMainPanel").getChildByName("Btns").getChildByName("Btn_Nextlevel"),[4,t.clickNode(a)]):[3,10];case 8:return c.sent(),[4,o.delay(2)];case 9:c.sent(),c.label=10;case 10:return[2]}})})}}]},t.prototype.randomWait=function(){return this.minDelay+Math.random()*this.randomDelay},l([P({type:cc.Float,tooltip:"\u4e24\u6b21\u70b9\u51fb\u95f4\u7684\u6700\u5c0f\u7b49\u5f85\u79d2"})],t.prototype,"minDelay",void 0),l([P({type:cc.Float,tooltip:"\u4e24\u6b21\u70b9\u51fb\u95f4\u7684\u968f\u673a\u9644\u52a0\u6700\u5927\u7b49\u5f85\u79d2"})],t.prototype,"randomDelay",void 0),l([P(cc.Node)],t.prototype,"clickNode",void 0),l([C],t)}(cc.Component);r.default=k,cc._RF.pop(),cc._RF.pop()},{}],BasePanel_ED:[function(e,t,o){"use strict";cc._RF.push(t,"5f8f6c9PVVA4oYIewOkcnMl","BasePanel_ED");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"5f8f6c9PVVA4oYIewOkcnMl","BasePanel_ED");var a,c=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(i,"__esModule",{value:!0});var l=cc._decorator,u=l.ccclass,p=l.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bg=null,t}return c(t,e),t.prototype.init=function(){},t.prototype.show=function(e){this.init(),this.node.active=!0,this.bg.scale=0,this.bg.opacity=0,cc.tween(this.bg).to(.2,{scale:1,opacity:255}).call(function(){e&&e()}).start()},t.prototype.hide=function(e){var t=this;this.bg.scale=1,this.bg.opacity=255,cc.tween(this.bg).to(.2,{scale:0,opacity:0}).call(function(){t.node.active=!1,e&&e()}).start()},s([p(cc.Node)],t.prototype,"bg",void 0),s([u],t)}(cc.Component);i.default=d,cc._RF.pop(),cc._RF.pop()},{}],BasePanel:[function(e,t,o){"use strict";cc._RF.push(t,"d6c0aTwu4VMfpyIiqv2/zJ0","BasePanel");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"d6c0aTwu4VMfpyIiqv2/zJ0","BasePanel");var a,c=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(i,"__esModule",{value:!0});var l=cc._decorator,u=l.ccclass,p=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.init=function(){},t.prototype.show=function(e){this.init();var t=this.node;cc.director.emit("UpdateOpenPanelCount"),t&&(cc.Tween.stopAllByTarget(t),t.scale=.5,t.opacity=220,cc.tween(t).to(.3,{scale:1,opacity:255},{easing:"backOut"}).call(function(){e&&e()}).start())},t.prototype.hide=function(e){var t=this,o=this.node;o&&(cc.Tween.stopAllByTarget(o),o.scale=1,o.opacity=255,cc.tween(o).to(.4,{scale:0,opacity:0},{easing:"backIn"}).call(function(){t.node.active=!1,e&&"function"==typeof e&&e(),cc.director.emit("UpdateOpenPanelCount")}).start())},s([u],t)}(cc.Component));i.default=p,cc._RF.pop(),cc._RF.pop()},{}],BeginnerTaskGift:[function(e,t,o){"use strict";cc._RF.push(t,"02868kaSa9Lkbwb/ceBBkPx","BeginnerTaskGift");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"02868kaSa9Lkbwb/ceBBkPx","BeginnerTaskGift");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("ThemeDataManager"),d=n("CommonData"),f=n("const"),h=n("UIManager"),y=cc._decorator,m=y.ccclass,g=y.property,v=[{level:6,reward:"11_1"},{level:9,reward:"11_2"},{level:12,reward:"11_3"},{level:17,reward:"11_4"}],_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.slider=null,t.task_progress=null,t.target=0,t.current=0,t}var o;return s(t,e),o=t,t.prototype.onEnable=function(){cc.director.on(f.EventNames.LevelFinish,this.updateGiftProgress,this),this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.setPosition(o.originalPos)},t.prototype.onDisable=function(){cc.director.off(f.EventNames.LevelFinish,this.updateGiftProgress,this),this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this)},t.prototype.onLoad=function(){var e=d.default.Level-1;if(d.default.Level>=7&&0==p.default.ThemeUnlockMap["11_1"])this.node.active=!1;else{this.node.active=!(e>=17||e<3);for(var t=0,o=0,n=0;n<v.length;n++)if((t=v[n].level-e)>0){var i=v[n-1]?v[n-1].level:3;o=v[n].level-i;break}this.slider.fillRange=(o-t)/o,this.task_progress.string=o-t+"/ "+o,this.current=o-t,this.target=o}},t.prototype.updateGiftProgress=function(){this.current+=1,cc.tween(this.slider).to(.5,{fillRange:this.current/this.target}).start(),this.task_progress.string=this.current+"/ "+this.target,this.current>=this.target&&this.scheduleOnce(this.hideGift,.5)},t.prototype.hideGift=function(){var e=this;cc.tween(this.node).to(.5,{opacity:0}).call(function(){e.node.active=!1}).start()},t.prototype.onBtn_click=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),h.default.getInstance().showPanel("BeginnerTaskPanel")},t.prototype.onTouchMove=function(){o.originalPos=cc.v2(this.node.position)},t.prototype.onTouchEnd=function(){o.endPos=cc.v2(this.node.position);var e=o.endPos.sub(o.originalPos);o.originalPos=cc.v2(this.node.position),e.mag()<10&&this.onBtn_click()},t.originalPos=cc.v2(-300,440),t.endPos=cc.v2(0,0),l([g(cc.Sprite)],t.prototype,"slider",void 0),l([g(cc.Label)],t.prototype,"task_progress",void 0),o=l([m],t)}(cc.Component);r.default=_,cc._RF.pop(),cc._RF.pop()},{}],BeginnerTaskPanel:[function(e,t,o){"use strict";cc._RF.push(t,"c4ce6T42gZD/oasm5xdmQqL","BeginnerTaskPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"c4ce6T42gZD/oasm5xdmQqL","BeginnerTaskPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0}),r.taskInfo=void 0;var u=n("AudioManager"),p=n("Puzzle"),d=n("ThemeDataManager"),f=n("CommonData"),h=n("const"),y=n("UnlockData"),m=n("UIManager"),g=n("BasePanel"),v=cc._decorator,_=v.ccclass,S=v.property;r.taskInfo=[{level:6,reward:"11_1"},{level:9,reward:"11_2"},{level:12,reward:"11_3"},{level:17,reward:"11_4"}];var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lockBoxNode=null,t.puzzleNode=null,t.label_taskDesc=null,t.puzzle=null,t.layout_task=null,t.layout_reward=null,t.btnFrames=[],t.btn_sprite=null,t}return s(t,e),t.prototype.onEnable=function(){this.init()},t.prototype.init=function(){var e=f.default.Level-1;e<=3?(this.lockBoxNode.active=!0,this.puzzleNode.active=!1):(this.lockBoxNode.active=!1,this.puzzleNode.active=!0,this.puzzle.setUp(11)),f.default.CurrentLevel>=17?(this.layout_task.active=!1,this.layout_reward.active=!0,this.btn_sprite.spriteFrame=this.btnFrames[1]):(this.btn_sprite.spriteFrame=this.btnFrames[0],this.layout_task.active=!0,this.layout_reward.active=!1);for(var t=0,o=0;o<r.taskInfo.length&&!((t=r.taskInfo[o].level-e)>0);o++);this.label_taskDesc.string=""+t},t.prototype.onBtn_Close=function(){if(this.hide(),u.default.instance.playSFX(u.AudioRef.ClickButton),cc.director.getScene().name==h.SceneNames.Game){if(f.default.CurrentLevel===f.default.Level)return;f.default.CurrentUnlockIndex<=f.default.collectionList.length&&f.default.CurrentLevel%5!=0?m.default.getInstance().showPanel("DrinkPanel"):f.default.CurrentLevel%5==0&&null!=y.default.CurrentUnlockItem?m.default.getInstance().showPanel("JourneyPanel"):m.default.getInstance().showPanel("GameOverMainPanel")}},t.prototype.onBtn_ChangeTheme=function(){f.default.CurrentLevel<17||(d.default.CurrentSelectedThemeIndex=11,cc.director.emit(h.EventNames.ChangeBg))},l([S(cc.Node)],t.prototype,"lockBoxNode",void 0),l([S(cc.Node)],t.prototype,"puzzleNode",void 0),l([S(cc.Label)],t.prototype,"label_taskDesc",void 0),l([S(p.default)],t.prototype,"puzzle",void 0),l([S(cc.Node)],t.prototype,"layout_task",void 0),l([S(cc.Node)],t.prototype,"layout_reward",void 0),l([S([cc.SpriteFrame])],t.prototype,"btnFrames",void 0),l([S(cc.Sprite)],t.prototype,"btn_sprite",void 0),l([_],t)}(g.default);r.default=b,cc._RF.pop(),cc._RF.pop()},{}],BombCup:[function(e,t,o){"use strict";cc._RF.push(t,"ffc66q9nRNO24LtVIhzUAPU","BombCup");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"ffc66q9nRNO24LtVIhzUAPU","BombCup");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("const"),d=n("GameManager"),f=n("Cup"),h=cc._decorator,y=h.ccclass,m=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.skeleton=null,t.bombNode=null,t.timeLabel=null,t.bombTime=10,t.ifDefused=!1,t.originalParents=new Map,t}return s(t,e),t.prototype.onEnable=function(){cc.director.on(p.EventNames.FirstClickCup,this.tryStartTimer,this),cc.director.on(p.EventNames.OnVideoAdStart,this.pauseTimer,this),cc.director.on(p.EventNames.OnVideoAdEnd,this.resumeTimer,this),cc.director.on(p.EventNames.PauseAllBombs,this.pauseTimer,this),cc.director.on(p.EventNames.ResumeAllBombs,this.resumeTimer,this),cc.director.on(p.EventNames.AllCupFinished,this.bombDefuse,this)},t.prototype.setBombTime=function(e){this.originalParents.set(this.bombNode,this.bombNode.parent),this.bombTime=e,this.bombNode.active=e>0,this.skeleton.node.active=!1,this.skeleton.node.parent.active=!0,this.stopScaleAnimation(),this.updateTimeUI()},t.prototype.onDisable=function(){cc.director.off(p.EventNames.FirstClickCup,this.tryStartTimer,this),cc.director.off(p.EventNames.OnVideoAdStart,this.pauseTimer,this),cc.director.off(p.EventNames.OnVideoAdEnd,this.resumeTimer,this),cc.director.off(p.EventNames.PauseAllBombs,this.pauseTimer,this),cc.director.off(p.EventNames.ResumeAllBombs,this.resumeTimer,this),cc.director.off(p.EventNames.AllCupFinished,this.bombDefuse,this),this.stopTimer()},t.prototype.playFinishAnimation=function(){e.prototype.playFinishAnimation.call(this),this.bombDefuse()},t.prototype.unmaskCup=function(){var t=this;if(this.cupType===f.CupType.BombMasked)return this.ifDefused?this.cupType=f.CupType.Normal:this.cupType=f.CupType.Bomb,void e.prototype.unmaskCup.call(this);e.prototype.unmaskCup.call(this),this.ifDefused||this.scheduleOnce(function(){t.startTimer()},.6)},t.prototype.startTimer=function(){this.maskColorCount>0&&this.cupType!==f.CupType.BombMasked||(cc.director.getScheduler().schedule(this.tick,this,1,cc.macro.REPEAT_FOREVER,0,!1),null!=this.skeleton&&(this.skeleton.node.active=!0))},t.prototype.stopTimer=function(){cc.director.getScheduler().unschedule(this.tick,this)},t.prototype.pauseTimer=function(){0!=this.bombTime&&cc.director.getScheduler().pauseTarget(this)},t.prototype.resumeTimer=function(){cc.director.getScheduler().resumeTarget(this)},t.prototype.tick=function(){this.bombTime--,this.bombTime<=5&&d.default.platform.vibrateShort(),this.bombTime<=0&&(this.bombTime=0,this.stopTimer(),this.scheduleOnce(this.bombExplode.bind(this),0)),5==this.bombTime&&(cc.director.emit(p.EventNames.BombTimeWarning),this.playScaleAnimation()),this.updateTimeUI()},t.prototype.updateTimeUI=function(){Math.floor(this.bombTime/60),this.bombTime,0!=this.bombTime?this.timeLabel.string=this.bombTime.toString():this.timeLabel.node.active=!1},t.prototype.tryStartTimer=function(e){void 0===e&&(e=null),null==e&&this.startTimer(),null!==e&&this.node.parent===e&&this.startTimer()},t.prototype.bombDefuse=function(){var e=this;this.ifDefused||!1===this.bombNode.active||(this.stopTimer(),this.ifDefused=!0,this.bombTime<=5&&cc.director.emit(p.EventNames.BombDefuse),null!=this.skeleton&&null!=this.skeleton.node&&this.skeleton.node.isValid&&(this.skeleton.node.active=!1,this.stopScaleAnimation(),cc.tween(this.bombNode).delay(.5).to(.5,{scale:0},{easing:"backIn"}).call(function(){e.bombNode.active=!1}).start()))},t.prototype.bombExplode=function(){var e=this;this.stopTimer(),this.stopScaleAnimation(),this.scheduleOnce(function(){cc.director.emit(p.EventNames.PauseAllBombs)},0),this.ifDefused=!0;var t=this.skeleton.node.parent.convertToWorldSpaceAR(this.skeleton.node.position);this.skeleton.node.parent=this.bombNode.parent,this.skeleton.node.position=this.skeleton.node.parent.convertToNodeSpaceAR(t),this.skeleton.node.zIndex=99,this.skeleton.node.scale=.8,this.resetType(),this.skeleton.setAnimation(0,"baozha",!1),u.default.instance.playSFX(u.AudioRef.Boom),cc.tween(this.bombNode).to(.2,{scale:0},{easing:"sineIn"}).call(function(){e.bombNode.active=!1}).start(),this.skeleton.setCompleteListener(function(){cc.director.emit(p.EventNames.Explode);var t=e.bombNode,o=e.skeleton.node.parent.convertToWorldSpaceAR(e.skeleton.node.position);e.skeleton.node.parent=t,e.skeleton.node.position=t.convertToNodeSpaceAR(o),e.skeleton.node.zIndex=99,e.skeleton.node.parent.active=!1,e.skeleton=null,e.bombNode=null,e.timeLabel=null})},t.prototype.playScaleAnimation=function(){this.node.zIndex=100,cc.tween(this.bombNode).parallel(cc.tween().to(.25,{scale:.9}).to(.25,{scale:1}).to(.25,{scale:1.1}).to(.25,{scale:1}),cc.tween().to(.25,{rotation:-10}).to(.25,{rotation:0}).to(.25,{rotation:10}).to(.25,{rotation:0})).repeatForever().start()},t.prototype.stopScaleAnimation=function(){this.node.zIndex=0,cc.tween(this.bombNode).stop(),this.bombNode.rotation=0,this.bombNode.scale=.8},t.prototype.moveBottomNodesToParent=function(){if((this.cupType===f.CupType.Bomb||this.cupType===f.CupType.BombFixed||this.cupType===f.CupType.BombFrozen||this.cupType===f.CupType.BombMasked)&&this.bombNode&&this.bombNode.isValid&&!1!==this.bombNode.active){var e=this.bombNode.parent.convertToWorldSpaceAR(this.bombNode.position);this.bombNode.parent=this.node.parent,this.bombNode.position=this.bombNode.parent.convertToNodeSpaceAR(e),this.bombNode.zIndex=99}},t.prototype.restoreBottomNodesParent=function(){if((this.cupType===f.CupType.Bomb||this.cupType===f.CupType.BombFixed||this.cupType===f.CupType.BombFrozen||this.cupType===f.CupType.BombMasked)&&this.bombNode&&this.bombNode.isValid&&!1!==this.bombNode.active){var e=this.originalParents.get(this.bombNode),t=this.bombNode.parent.convertToWorldSpaceAR(this.bombNode.position);this.bombNode.parent=e,this.bombNode.position=e.convertToNodeSpaceAR(t),this.bombNode.zIndex=99}},t.prototype.resetType=function(){switch(this.cupType){case f.CupType.Bomb:this.cupType=f.CupType.Normal;break;case f.CupType.BombFixed:this.cupType=f.CupType.Fixed;break;case f.CupType.BombFrozen:this.cupType=f.CupType.Frozen;break;case f.CupType.BombMasked:this.cupType=f.CupType.Masked}},t.prototype.moveToPour=function(t,o,n,i,r){this.moveBottomNodesToParent(),e.prototype.moveToPour.call(this,t,o,n,i,r)},l([m(sp.Skeleton)],t.prototype,"skeleton",void 0),l([m(cc.Node)],t.prototype,"bombNode",void 0),l([m(cc.Label)],t.prototype,"timeLabel",void 0),l([y],t)}(f.default);r.default=g,cc._RF.pop(),cc._RF.pop()},{}],BombWarning:[function(e,t,o){"use strict";cc._RF.push(t,"5e53bkl3HpMc5Yv02uhTQUj","BombWarning");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"5e53bkl3HpMc5Yv02uhTQUj","BombWarning");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("const"),d=cc._decorator,f=d.ccclass,h=(d.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tween=null,t.referenceCount=0,t}return s(t,e),t.prototype.onEnable=function(){cc.director.on(p.EventNames.BombTimeWarning,this.addRef,this),cc.director.on(p.EventNames.BombDefuse,this.decRef,this),cc.director.on(p.EventNames.Explode,this.decRef,this)},t.prototype.onDisable=function(){cc.director.off(p.EventNames.BombTimeWarning,this.addRef,this),cc.director.off(p.EventNames.BombDefuse,this.decRef,this),cc.director.off(p.EventNames.Explode,this.decRef,this)},t.prototype.addRef=function(){this.referenceCount++,1===this.referenceCount&&this.startBlink()},t.prototype.decRef=function(){this.referenceCount--,0===this.referenceCount&&this.stopBlink()},t.prototype.startBlink=function(){u.default.instance.playMusic(u.AudioRef.CountDown),this.node.opacity=0,this.tween=cc.tween(this.node).repeatForever(cc.tween().to(.5,{opacity:255}).to(.5,{opacity:100})).start()},t.prototype.stopBlink=function(){u.default.instance.stopMusic(u.AudioRef.CountDown),this.tween.stop(),cc.tween(this.node).to(.2,{opacity:0}).start()},l([f],t)}(cc.Component));r.default=h,cc._RF.pop(),cc._RF.pop()},{}],BottleMgr_BP:[function(e,t,o){"use strict";cc._RF.push(t,"d6d00MHtP5AMr8ecSVtsyDM","BottleMgr_BP");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"d6d00MHtP5AMr8ecSVtsyDM","BottleMgr_BP");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},p=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0});var d=n("Bottle_BP"),f=n("LevelConfig_BP"),h=n("LevelDataMgr_BP"),y=n("AudioManager_BP"),m=cc._decorator,g=m.ccclass,v=m.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bottleContainer=null,t.idLabelContainer=null,t.bottlePrefab=null,t.bottleSpriteAtlas=null,t.idLabelOffsetY=-60,t.waterFlowNode=null,t.waterFlow=null,t.bottles=[],t.selectedBottle=null,t.operationRecords=[],t.maxRecords=50,t.isPouringNow=!1,t.isLevelCompleted=!1,t.levelConfig=null,t.waterFlowGraphics=null,t._waterFlowColor=cc.Color.GREEN.clone(),t._currentPouringFrom=null,t._currentPouringTo=null,t}return s(t,e),Object.defineProperty(t.prototype,"IsPouringNow",{get:function(){return this.isPouringNow},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){return u(this,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return f.LevelConfig_BP.init(),[4,h.LevelDataMgr_BP.initAsync()];case 1:return e.sent(),this.initWaterFlow(),[2]}})})},t.prototype.initWaterFlow=function(){this.waterFlowNode||(this.waterFlowNode=new cc.Node("WaterFlow"),(this.bottleContainer?this.bottleContainer.parent:this.node).addChild(this.waterFlowNode),this.waterFlowNode.zIndex=cc.macro.MIN_ZINDEX),this.waterFlowNode.setContentSize(cc.winSize.width,cc.winSize.height),this.waterFlowNode.setPosition(0,0),this.waterFlowGraphics=this.waterFlowNode.getComponent(cc.Graphics),this.waterFlowGraphics||(this.waterFlowGraphics=this.waterFlowNode.addComponent(cc.Graphics)),this.waterFlowGraphics.lineWidth=10,this.waterFlowGraphics.lineCap=cc.Graphics.LineCap.ROUND,this.waterFlowGraphics.lineJoin=cc.Graphics.LineJoin.ROUND,cc.log("[BottleMgr_BP] \u6c34\u67f1\u7ec4\u4ef6\u521d\u59cb\u5316\u5b8c\u6210",this.waterFlowNode.parent.name,this.waterFlowNode.zIndex)},t.prototype.initLevel=function(e){return u(this,void 0,void 0,function(){var t,o=this;return p(this,function(){return this.bottles=[],this.selectedBottle=null,this.operationRecords=[],this.isPouringNow=!1,this.isLevelCompleted=!1,this.bottleContainer&&this.bottleContainer.childrenCount>0&&this.bottleContainer.removeAllChildren(),this.idLabelContainer&&cc.isValid(this.idLabelContainer)?(this.idLabelContainer.parent!==this.node&&this.node.addChild(this.idLabelContainer),this.idLabelContainer.childrenCount>0&&this.idLabelContainer.removeAllChildren()):(t=new cc.Node("IdLabelContainer"),this.node.addChild(t),this.idLabelContainer=t),f.LevelConfig_BP.getLevelConfigAsync(e,function(e){o.levelConfig=e,o.createBottles(),o.initializeWater(),o.node.emit("levelReady")}),[2]})})},t.prototype.createBottles=function(){var e=this;if(!this.idLabelContainer){var t=new cc.Node("IdLabelContainer");this.node.addChild(t),this.idLabelContainer=t}var o=this.levelConfig.bottleConfigs.length,n=this.bottleContainer.width,i=n/(o+1);this.levelConfig.bottleConfigs.forEach(function(t,o){var r=-n/2+(o+1)*i,a=cc.instantiate(e.bottlePrefab);a.name="Bottle_"+o,a.setPosition(r,0),e.bottleContainer.addChild(a);var c=a.getComponent(d.default);c.init(o,t.capacity,t.target),a.on(cc.Node.EventType.TOUCH_END,function(){e.onBottleClick(c)}),e.bottles.push(c),e.createIdLabel(o,r,0)})},t.prototype.createIdLabel=function(e,t,o){var n=new cc.Node("IdLabel_"+e),i=n.addComponent(cc.Label);i.string=this.getLetterId(e),i.fontSize=40,i.lineHeight=40,i.fontFamily="Arial",i.useSystemFont=!0,i.enableBold=!0,i.horizontalAlign=cc.Label.HorizontalAlign.CENTER,i.verticalAlign=cc.Label.VerticalAlign.CENTER,i.overflow=cc.Label.Overflow.NONE,i.cacheMode=cc.Label.CacheMode.NONE;var r=n.addComponent(cc.LabelOutline);r.color=cc.color(0,0,0),r.width=2,n.setPosition(t,o+this.idLabelOffsetY),this.idLabelContainer.addChild(n)},t.prototype.getLetterId=function(e){var t=e,o="";do{var n=t%26;o=String.fromCharCode(65+n)+o,t=Math.floor(t/26)-1}while(t>=0);return o},t.prototype.initializeWater=function(){if(0!==this.bottles.length){var e=h.LevelDataMgr_BP.getLevelData(this.levelConfig.levelId);if(e&&e.bottleConfigs)for(var t=0;t<this.bottles.length&&t<e.bottleConfigs.length;t++){var o=e.bottleConfigs[t].initial||0;o>0&&this.bottles[t].addWater(o)}else if(e&&e.initialBottles)for(t=0;t<this.bottles.length;t++){var n=e.initialBottles[t]||0;n>0&&this.bottles[t].addWater(n)}else{var i=this.levelConfig.bottleConfigs.reduce(function(e,t){return e+t.target},0);i>0&&this.bottles[0].addWater(i)}}},t.prototype.onBottleClick=function(e){this.isPouringNow||this.isLevelCompleted||(null===this.selectedBottle?e.getAvailablePour()>0&&(y.default.instance.playChooseBottle(),this.selectedBottle=e,e.setState(d.BottleState_BP.Selected)):this.selectedBottle===e?(e.setState(d.BottleState_BP.Idle),this.selectedBottle=null):this.pourWater(this.selectedBottle,e))},t.prototype.pourWater=function(e,t){var o=this;this.isPouringNow=!0;var n=e.getAvailablePour(),i=t.capacity-t.currentAmount,r=Math.min(n,i);if(r>0){this.operationRecords.push({fromId:e.id,toId:t.id,amount:r}),this.operationRecords.length>this.maxRecords&&this.operationRecords.shift(),this.isPouringNow=!0;var a=e.node.parent,c=a?e.node.getSiblingIndex():-1;a&&e.node.setSiblingIndex(a.childrenCount-1);var s=t.node.x>e.node.x;console.log(s,t.node.x,e.node.x);var l=null;if(t.mouthSprite&&a){var u=t.mouthSprite.node.convertToWorldSpaceAR(cc.Vec2.ZERO),p=a.convertToNodeSpaceAR(u),f=15;l=cc.v2(p.x,p.y+f)}else f=.15*e.node.height,l=cc.v2(t.node.x,t.node.y+f);var h=!1,m=!1,g=!1,v=function(){h&&m&&g&&(t.setState(d.BottleState_BP.Idle),o.isPouringNow=!1,o.checkLevelCompletion())};e.moveToPour(l,s,r,function(){o.startWaterFlow(e,t,s),y.default.instance.playWaterFlow(),e.startRemoveWater(r,function(){h=!0,v()}),t.startAddWater(r,function(){m=!0,v()})},function(){o.stopWaterFlow(e,t),e.resetPosition(void 0,void 0,function(){a&&c>=0&&cc.isValid(e.node)&&e.node.setSiblingIndex(c),g=!0,v()})})}else this.isPouringNow=!1;e.setState(d.BottleState_BP.Idle),this.selectedBottle=null},t.prototype.undo=function(){if(0!==this.operationRecords.length&&!this.isPouringNow){var e=this.operationRecords.pop(),t=this.bottles[e.fromId];this.bottles[e.toId].removeWater(e.amount),t.addWater(e.amount)}},t.prototype.checkLevelCompletion=function(){this.bottles.every(function(e){return Math.abs(e.currentAmount-e.targetAmount)<1e-4})&&(this.isLevelCompleted=!0,cc.log("\u5173\u5361\u5b8c\u6210\uff01"),this.node.emit("levelComplete"))},t.prototype.resetLevel=function(){this.bottles.forEach(function(e){return e.clear()}),this.selectedBottle=null,this.operationRecords=[],this.isLevelCompleted=!1,this.initializeWater()},t.prototype.getOperationCount=function(){return this.operationRecords.length},t.prototype.checkIfHasValidMoves=function(){for(var e=0,t=this.bottles;e<t.length;e++){var o=t[e];if(!o.isCompleted()&&0!==o.getAvailablePour())for(var n=0,i=this.bottles;n<i.length;n++){var r=i[n];if(o!==r&&!r.isCompleted()&&r.capacity-r.currentAmount>0)return!0}}return!1},t.prototype.startWaterFlow=function(e,t,o){var n=this;if(this.waterFlowGraphics&&this.waterFlowNode){this._waterFlowColor=e.getSurfaceColor();var i=e.mouthSprite?e.mouthSprite.node.convertToWorldSpaceAR(cc.Vec2.ZERO):e.node.convertToWorldSpaceAR(cc.v2(0,.5*e.node.height));e.enableTiltFill(i,o),e.suppressSurfaceAnimation(),this._currentPouringFrom=e,this._currentPouringTo=t,this.drawWaterFlow(o),this.schedule(function(){return n.updateWaterFlowPosition(o)},0),cc.log("[BottleMgr_BP] \u6c34\u67f1\u5f00\u59cb")}else cc.warn("[BottleMgr_BP] \u6c34\u67f1\u7ec4\u4ef6\u672a\u521d\u59cb\u5316")},t.prototype.drawWaterFlow=function(e){if(this.waterFlowGraphics&&this._currentPouringFrom&&this._currentPouringTo){var t,o;if(this._currentPouringFrom.mouthSprite)t=this._currentPouringFrom.mouthSprite.node.convertToWorldSpaceAR(cc.v2(e?10:-10,0));else{var n=cc.v2(0,.5*this._currentPouringFrom.node.height);t=this._currentPouringFrom.node.convertToWorldSpaceAR(n)}this._currentPouringTo.mouthSprite?o=this._currentPouringTo.mouthSprite.node.convertToWorldSpaceAR(cc.Vec2.ZERO):(n=cc.v2(0,.5*this._currentPouringTo.node.height),o=this._currentPouringTo.node.convertToWorldSpaceAR(n));var i=this._currentPouringTo.getWaterSurfaceWorldPos(),r=this.waterFlowNode.convertToNodeSpaceAR(t),a=this.waterFlowNode.convertToNodeSpaceAR(o),c=this.waterFlowNode.convertToNodeSpaceAR(i);this.waterFlowGraphics.clear();var s=a.x-r.x,l=r.x+.5*s,u=r.y,p=a.x,d=a.y+20;this.waterFlowGraphics.strokeColor=this._waterFlowColor,this.waterFlowGraphics.lineWidth=10,this.waterFlowGraphics.moveTo(r.x,r.y),this.waterFlowGraphics.bezierCurveTo(l,u,p,d,a.x,a.y),this.waterFlowGraphics.stroke(),this.waterFlowGraphics.moveTo(a.x,a.y),this.waterFlowGraphics.lineTo(c.x,c.y+10),this.waterFlowGraphics.stroke();var f=cc.color(Math.min(255,this._waterFlowColor.r+80),Math.min(255,this._waterFlowColor.g+80),Math.min(255,this._waterFlowColor.b+80),180);this.waterFlowGraphics.strokeColor=f,this.waterFlowGraphics.lineWidth=1.5,this.waterFlowGraphics.moveTo(r.x-1,r.y),this.waterFlowGraphics.bezierCurveTo(l-1,u,p-1,d,a.x-1,a.y),this.waterFlowGraphics.stroke(),this.waterFlowGraphics.moveTo(a.x-1,a.y),this.waterFlowGraphics.lineTo(c.x-1,c.y),this.waterFlowGraphics.stroke()}},t.prototype.updateWaterFlowPosition=function(e){this.drawWaterFlow(e)},t.prototype.stopWaterFlow=function(e){this.unscheduleAllCallbacks(),this.unscheduleAllCallbacks(),e&&(e.disableTiltFill(),e.restoreSurfaceAnimation()),this._currentPouringFrom=null,this._currentPouringTo=null,this.waterFlowGraphics&&(this.waterFlowGraphics.clear(),cc.log("[BottleMgr_BP] \u6c34\u67f1\u505c\u6b62"))},t.prototype.getBottlesState=function(){return this.bottles.map(function(e){return{id:e.id,current:e.currentAmount,target:e.targetAmount,completed:e.isCompleted()}})},l([v(cc.Node)],t.prototype,"bottleContainer",void 0),l([v(cc.Node)],t.prototype,"idLabelContainer",void 0),l([v(cc.Prefab)],t.prototype,"bottlePrefab",void 0),l([v(cc.SpriteAtlas)],t.prototype,"bottleSpriteAtlas",void 0),l([v(cc.Integer)],t.prototype,"idLabelOffsetY",void 0),l([v(cc.Node)],t.prototype,"waterFlowNode",void 0),l([g],t)}(cc.Component);r.default=_,cc._RF.pop(),cc._RF.pop()},{}],Bottle_BP:[function(e,t,o){"use strict";cc._RF.push(t,"56fd1g02+JCtqZ62Tz/u1I0","Bottle_BP");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"56fd1g02+JCtqZ62Tz/u1I0","Bottle_BP");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0}),r.BottleState_BP=void 0;var u,p=n("SpriteConfig_BP");!function(e){e[e.Idle=0]="Idle",e[e.Selected=1]="Selected",e[e.Pouring=2]="Pouring",e[e.Completed=3]="Completed"}(u=r.BottleState_BP||(r.BottleState_BP={}));var d=cc._decorator,f=d.ccclass,h=d.property,y=function(e){return 1*e},m=cc.color(247,194,18),g=cc.color(255,226,75),v=cc.color(255,239,147),_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.capacityLabel=null,t.targetLabel=null,t.bottleSprite=null,t.waterSprite=null,t.mouthSprite=null,t.dashedLineSprite=null,t.surface=null,t.surfaceHighlight=null,t.pourInSurface=null,t.pourInSurfaceHighlight=null,t.pourInSplash=null,t.pourInSplashHighlight=null,t.pourInRipple=null,t.shadow=null,t.spriteAtlas=null,t.bottleSprites=[],t.waterSprites=[],t.bottleId=0,t._currentAmount=0,t._capacity=0,t._targetAmount=0,t._state=u.Idle,t._waterColor="string"==typeof m?(new cc.Color).fromHEX(m):m.clone(),t._surfaceColor="string"==typeof g?(new cc.Color).fromHEX(g):g.clone(),t._splashColor="string"==typeof v?(new cc.Color).fromHEX(v):v.clone(),t.currentFillRange=0,t.waterSkewAngle=0,t.tiltFillActive=!1,t.tiltFillIsRight=!1,t.savedFillType=cc.Sprite.FillType.VERTICAL,t.savedFillRange=0,t.savedFillCenter=cc.v2(.5,.5),t.savedFillStart=0,t.suppressSurfaceWhilePouring=!1,t.onStateChange=null,t.onPourStart=null,t.onPourEnd=null,t.onPourInComplete=null,t.pourTween=null,t.surfaceAnimationPlaying=!1,t.originalPosition=cc.v2(0,0),t.originalShadowY=0,t.originalShadowScale=1,t.originalShadowOpacity=255,t.selectSurfacePlaying=!1,t.pourStartPosition=cc.v2(0,0),t.pourStartAnchor=cc.v2(.5,0),t.pourInEffectActivated=!1,t}return s(t,e),t.prototype.onLoad=function(){"string"==typeof m&&(this._waterColor=(new cc.Color).fromHEX(m)),"string"==typeof g&&(this._surfaceColor=(new cc.Color).fromHEX(g)),"string"==typeof v&&(this._splashColor=(new cc.Color).fromHEX(v)),this.waterSprite&&(this.waterSprite.node.color=this._waterColor instanceof cc.Color?this._waterColor:(new cc.Color).fromHEX(String(this._waterColor)),this.waterSprite.node.active=!0,this.waterSprite.node.opacity=255),this.surface&&(this.surface.node.color=this._surfaceColor,this.surface.node.active=!0,this.surface.node.opacity=255),this.surfaceHighlight&&(this.surfaceHighlight.node.color=this._surfaceColor,this.surfaceHighlight.node.active=!0,this.surfaceHighlight.node.opacity=180),this.pourInSurface&&(this.pourInSurface.node.color=this._surfaceColor,this.pourInSurface.node.active=!1,this.pourInSurface.node.opacity=255),this.pourInSplash&&(this.pourInSplash.node.color=this._splashColor,this.pourInSplash.node.active=!1,this.pourInSplash.node.opacity=255),this.bottleSprite&&(this.bottleSprite.node.active=!0,this.bottleSprite.node.opacity=255)},t.prototype.update=function(){this.waterSprite&&(this.waterSkewAngle=this.node.angle),this.updateSurface()},t.prototype.init=function(e,t,o){this.bottleId=e,this._capacity=t,this._targetAmount=o,this._currentAmount=0,this._state=u.Idle,this.originalPosition=cc.v2(this.node.x,this.node.y),this.shadow&&(this.originalShadowY=this.shadow.y,this.originalShadowScale=this.shadow.scale,this.originalShadowOpacity=this.shadow.opacity),this.loadSprites(),this.updateUI(),this.checkCompletion()},t.prototype.loadSprites=function(){var e=this.bottleSprites[this._capacity-1],t=this.waterSprites[this._capacity-1];if(this.bottleSprite&&e?(this.bottleSprite.spriteFrame=e,this.updatePositions()):e||cc.warn("\u672a\u627e\u5230\u5bb9\u91cf "+this._capacity+" \u7684\u74f6\u5b50\u7cbe\u7075"),this.waterSprite&&t){this.waterSprite.spriteFrame=t,this.waterSprite.sizeMode=cc.Sprite.SizeMode.RAW;var o=t.getOriginalSize();this.waterSprite.node.setContentSize(o),this.waterSprite.node.scaleY=1,this.adjustWaterHeightForCapacity(),this.waterSprite.node.color=this._waterColor,this.updatePositions()}else t||cc.warn("\u672a\u627e\u5230\u5bb9\u91cf "+this._capacity+" \u7684\u6c34\u7cbe\u7075")},t.prototype.updatePositions=function(){if(this.mouthSprite&&this.bottleSprite){var e=this.bottleSprite.node,t=this.mouthSprite.node,o=this.bottleSprite.spriteFrame,n=o?o.getOriginalSize().height:e.height;t.x=e.x,t.y=n}if(this.bottleSprite&&this.bottleSprite.spriteFrame){var i=this.bottleSprite.spriteFrame.getOriginalSize();this.node.setContentSize(i.width,i.height+20),this.setAnchor(cc.v2(.5,0))}this.updateDashedLinePosition()},t.prototype.getWaterDisplayHeight=function(){return this.waterSprite?this.waterSprite.node.height:0},t.prototype.adjustWaterHeightForCapacity=function(){4===this._capacity&&this.waterSprite&&(this.waterSprite.node.height=393)},t.prototype.updateDashedLinePosition=function(){if(this.dashedLineSprite&&this.waterSprite){this.targetAmount<=0&&(this.dashedLineSprite.node.active=!1);var e=this._targetAmount/this._capacity,t=this.getWaterDisplayHeight(),o=p.SpriteConfig_BP.getWaterMaxHeightRatio(this._capacity);this.dashedLineSprite.node.y=e*t*o}},t.prototype.updateUI=function(){this.capacityLabel&&(this.capacityLabel.string=this._capacity+"L"),this.targetLabel&&(this.targetLabel.node.active=!1),this.updateWaterDisplay()},t.prototype.updateSurface=function(){if(this.surface&&this.waterSprite&&(!this.isPouring()||0!=this.surface.node.active)){if(this._currentAmount<=0)return this.surface.node.active=!1,this.surfaceHighlight&&(this.surfaceHighlight.node.active=!1),void(this.surfaceAnimationPlaying=!1);var e=this._capacity<=1?.2:.05;if((this._capacity>0?this._currentAmount/this._capacity:0)<e)return this.surface.node.active=!1,this.surfaceHighlight&&(this.surfaceHighlight.node.active=!1),void(this.surfaceAnimationPlaying=!1);this.surface.node.active=!0,this.surface.node.opacity=255,this.surfaceHighlight&&(this.surfaceHighlight.node.active=!0,this.surfaceHighlight.node.opacity=180);var t=this.waterSprite.node,o=this.currentFillRange>0?this.currentFillRange:this.waterSprite.fillRange||0,n=-t.height*t.anchorY+t.height*o,i=t.convertToWorldSpaceAR(cc.v2(0,n)),r=(this.surface.node.parent||this.node).convertToNodeSpaceAR(i);this.surface.node.setPosition(r.x,r.y),this.surfaceHighlight&&(this.surfaceHighlight.node.parent===this.surface.node?this.surfaceHighlight.node.setPosition(0,0):this.surfaceHighlight.node.setPosition(r.x,r.y)),this.surface.node.color=this._surfaceColor,this.surfaceAnimationPlaying||(this.surface.setAnimation(0,"smd_start",!0),this.surfaceHighlight&&this.surfaceHighlight.setAnimation(0,"sms_start",!0),this.surfaceAnimationPlaying=!0);var a=this.isPouring()&&!this.suppressSurfaceWhilePouring,c=this.selectSurfacePlaying,s=c||a,l=c?1.5:1;this.surface.timeScale=s?l:0,this.surfaceHighlight&&(this.surfaceHighlight.timeScale=s?l:0)}},t.prototype.playPourInAnimation=function(e){var t,o,n,i,r=this;void 0===e&&(e=0),this.pourInSurface&&(this.pourInSurface.animation=null,this.pourInSurfaceHighlight&&(this.pourInSurfaceHighlight.animation=null),this.pourInSplash&&(this.pourInSplash.animation=null),this.pourInSplashHighlight&&(this.pourInSplashHighlight.animation=null),this.pourInRipple&&(this.pourInRipple.animation=null),this.pourInSurface.node.color=this._surfaceColor,this.pourInSplash&&(this.pourInSplash.node.color=this._splashColor),this.pourInSurface.node.active=!0,this.pourInSurface.node.opacity=255,this.pourInSurfaceHighlight&&(this.pourInSurfaceHighlight.node.opacity=180),"smd_start"!==(null===(t=this.pourInSurface.getCurrent(0))||void 0===t?void 0:t.animation.name)&&(this.pourInSurface.setAnimation(0,"smd_start",!1).listener={complete:function(e){"smd_start"===e.animation.name&&r.pourInSurface.setAnimation(0,"smd_channel",!0)}}),this.pourInSurfaceHighlight&&"sms_start"!==(null===(o=this.pourInSurfaceHighlight.getCurrent(0))||void 0===o?void 0:o.animation.name)&&(this.pourInSurfaceHighlight.setAnimation(0,"sms_start",!1).listener={complete:function(e){"sms_start"===e.animation.name&&r.pourInSurfaceHighlight.setAnimation(0,"sms_channel",!0)}}),this.pourInSplash&&"sdd_start"!==(null===(n=this.pourInSplash.getCurrent(0))||void 0===n?void 0:n.animation.name)&&(this.pourInSplash.setAnimation(0,"sdd_start",!1).listener={complete:function(e){"sdd_start"===e.animation.name&&r.pourInSplash.setAnimation(0,"sdd_channel",!0)}}),this.pourInSplashHighlight&&"sds_start"!==(null===(i=this.pourInSplashHighlight.getCurrent(0))||void 0===i?void 0:i.animation.name)&&(this.pourInSplashHighlight.setAnimation(0,"sds_start",!1).listener={complete:function(e){"sds_start"===e.animation.name&&r.pourInSplashHighlight.setAnimation(0,"sds_channel",!0)}}),this.pourInRipple&&(this.pourInRipple.animation=null,this.pourInRipple.setAnimation(0,"bw_channel",!0)))},t.prototype.updatePourInEffectPosition=function(){var e=this;if(this.waterSprite){var t=this.waterSprite.node,o=this.currentFillRange>0?this.currentFillRange:this.waterSprite.fillRange||0,n=-t.height*t.anchorY+t.height*o,i=t.convertToWorldSpaceAR(cc.v2(0,n)),r=function(t){if(t){var o=(t.node.parent||e.node).convertToNodeSpaceAR(i);t.node.setPosition(o.x,o.y)}};r(this.pourInSurface),r(this.pourInSurfaceHighlight),r(this.pourInSplash),r(this.pourInSplashHighlight),r(this.pourInRipple)}},t.prototype.stopPourInAnimation=function(){var e=this;this.pourInSurface&&(this.updatePourInEffectPosition(),this.pourInSurface.animation=null,this.pourInSurfaceHighlight&&(this.pourInSurfaceHighlight.animation=null),this.pourInSplash&&(this.pourInSplash.animation=null),this.pourInSplashHighlight&&(this.pourInSplashHighlight.animation=null),this.pourInRipple&&(this.pourInRipple.animation=null),this.pourInSurface.setAnimation(0,"smd_end",!1).listener={complete:function(t){"smd_end"===t.animation.name&&(e.pourInSurface.node.active=!1)}},this.pourInSurfaceHighlight&&this.pourInSurfaceHighlight.setAnimation(0,"sms_end",!1),this.pourInSplash&&this.pourInSplash.setAnimation(0,"sdd_end",!1),this.pourInSplashHighlight&&this.pourInSplashHighlight.setAnimation(0,"sds_end",!1),this.pourInRipple&&this.pourInRipple.setAnimation(0,"bw_end",!1))},t.prototype.updateWaterDisplay=function(){if(this.waterSprite){var e=this._capacity>0?this._currentAmount/this._capacity:0;if(this.waterSprite.node.active=e>0,e>0){if(this.tiltFillActive)this.updateTiltFillRange();else{var t=p.SpriteConfig_BP.getWaterMaxHeightRatio(this._capacity);this.waterSprite.fillType=cc.Sprite.FillType.VERTICAL,this.waterSprite.fillStart=0,this.waterSprite.fillRange=Math.min(e,1)*t,this.currentFillRange=this.waterSprite.fillRange}this.waterSprite.node.color=this._waterColor}else this.currentFillRange=0}},t.prototype.setState=function(e){if(this._state!==e){var t=this._state;this._state=e,e===u.Selected&&t!==u.Selected?(this.pourInSurface.node.active=!1,this.playSelectAnimation(),this.playSelectSurfaceAnimation()):e!==u.Selected&&t===u.Selected&&(this.playDeselectAnimation(),this.playDeselectSurfaceAnimation()),this.updateStateUI(),this.onStateChange&&this.onStateChange(e)}},t.prototype.playSelectAnimation=function(){var e=.05*this.node.height,t=this.originalPosition.y+e;if(this.node.stopAllActions(),cc.tween(this.node).to(y(.2),{y:t}).start(),this.shadow){this.shadow.stopAllActions();var o=this.shadow.parent===this.node;cc.tween(this.shadow).to(y(.2),{y:o?this.originalShadowY-2*e:this.originalShadowY,scale:.75,opacity:125}).start()}},t.prototype.playDeselectAnimation=function(){this.node.stopAllActions(),cc.tween(this.node).to(y(.2),{y:this.originalPosition.y}).start(),this.shadow&&(this.shadow.stopAllActions(),cc.tween(this.shadow).to(y(.2),{y:this.originalShadowY,scale:this.originalShadowScale,opacity:this.originalShadowOpacity}).start())},t.prototype.playSelectSurfaceAnimation=function(){var e=this;if(this.surface){var t=!1;try{this.surface.setAnimation(0,"sm",!1),t=!0}catch(e){this.surface.setAnimation(0,"smd_start",!0)}var o=!1;if(this.surfaceHighlight)try{this.surfaceHighlight.setAnimation(0,"ggsm",!1),this.surfaceHighlight.timeScale=1.5,o=!0}catch(e){this.surfaceHighlight.setAnimation(0,"sms_start",!0),this.surfaceHighlight.timeScale=1}this.selectSurfacePlaying=t||o,this.surface.timeScale=1.5,this.surfaceHighlight&&(this.surfaceHighlight.timeScale=1.5),t&&this.surface.setCompleteListener(function(t){"sm"===(t&&t.animation?t.animation.name:"")&&(e.selectSurfacePlaying=!1,e.resetSurfaceIdle())}),o&&this.surfaceHighlight&&this.surfaceHighlight.setCompleteListener(function(e){e&&e.animation&&e.animation.name})}},t.prototype.playDeselectSurfaceAnimation=function(){var e=this;if(this.surface){var t=!1;try{this.surface.setAnimation(0,"sm",!1),t=!0}catch(e){this.surface.setAnimation(0,"smd_start",!0)}var o=!1;if(this.surfaceHighlight)try{this.surfaceHighlight.setAnimation(0,"ggsm",!1),this.surfaceHighlight.timeScale=1.2,o=!0}catch(e){this.surfaceHighlight.setAnimation(0,"sms_start",!0),this.surfaceHighlight.timeScale=1}this.selectSurfacePlaying=t||o,this.surface.timeScale=1.5,this.surfaceHighlight&&(this.surfaceHighlight.timeScale=1.5),t&&this.surface.setCompleteListener(function(t){"sm"===(t&&t.animation?t.animation.name:"")&&(e.selectSurfacePlaying=!1,e.resetSurfaceIdle())})}},t.prototype.resetSurfaceIdle=function(){if(this.surface){this.surfaceAnimationPlaying=!1;try{this.surface.setAnimation(0,"smd_start",!0),this.surface.timeScale=0}catch(e){}if(this.surfaceHighlight)try{this.surfaceHighlight.setAnimation(0,"sms_start",!0),this.surfaceHighlight.timeScale=0}catch(e){}}},t.prototype.updateStateUI=function(){},t.prototype.setWaterColor=function(e){this._waterColor="string"==typeof e?(new cc.Color).fromHEX(e):e.clone(),this.updateWaterDisplay()},t.prototype.getWaterColor=function(){return this._waterColor.clone()},t.prototype.getSurfaceColor=function(){return this._surfaceColor.clone()},t.prototype.setSurfaceColor=function(e){this._surfaceColor="string"==typeof e?(new cc.Color).fromHEX(e):e.clone(),this.surface&&(this.surface.node.color=this._surfaceColor),this.surfaceHighlight&&(this.surfaceHighlight.node.color=this._surfaceColor)},t.prototype.setSplashColor=function(e){this._splashColor="string"==typeof e?(new cc.Color).fromHEX(e):e.clone(),this.pourInSplash&&(this.pourInSplash.node.color=this._splashColor),this.pourInSplashHighlight&&(this.pourInSplashHighlight.node.color=this._splashColor)},t.prototype.addWater=function(e){var t=this._capacity-this._currentAmount,o=Math.min(e,t);return this._currentAmount+=o,this.updateWaterDisplay(),this.checkCompletion(),o},t.prototype.removeWater=function(e){var t=this._currentAmount,o=Math.min(e,t);return this._currentAmount-=o,this.updateWaterDisplay(),o},t.prototype.checkCompletion=function(){this._currentAmount===this._targetAmount?this.setState(u.Completed):this._state===u.Completed&&this.setState(u.Idle)},t.prototype.clear=function(){this.pourInSurface.node.active=!1,this._currentAmount=0,this.setState(u.Idle),this.updateWaterDisplay()},t.prototype.isCompleted=function(){return Math.abs(this._currentAmount-this._targetAmount)<1e-4},Object.defineProperty(t.prototype,"capacity",{get:function(){return this._capacity},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentAmount",{get:function(){return this._currentAmount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"targetAmount",{get:function(){return this._targetAmount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.bottleId},enumerable:!1,configurable:!0}),t.prototype.getAvailablePour=function(){return this._currentAmount},t.prototype.setOnStateChange=function(e){this.onStateChange=e},t.prototype.isPouring=function(){return Math.abs(this.node.angle)>1},t.prototype.moveToPour=function(e,t,o,n,i){var r=this;this.onPourStart=n,this.onPourEnd=i;var a=60,c=110;if(t&&(a=-a,c=-c),this.pourStartPosition=this.originalPosition.clone(),this.pourStartAnchor=this.node.getAnchorPoint().clone(),this.mouthSprite)this.mouthSprite.node.convertToWorldSpaceAR(cc.Vec2.ZERO);else{var s=cc.v2(0,this.node.height);this.node.convertToWorldSpaceAR(s)}this.setPourAnchor(t);var l=cc.v2(e.x,e.y);if(this.pourTween&&this.pourTween.stop(),this.setState(u.Pouring),this.pourTween=cc.tween(this.node).set({angle:0}).to(y(.2),{x:l.x,y:l.y,angle:a},{easing:"sineIn"}).call(function(){r.onPourStart&&r.onPourStart(r)}).to(y(.6),{angle:c}).call(function(){r.onPourEnd&&r.onPourEnd(r)}).start(),this.shadow){var p=this.node.height+50;cc.tween(this.shadow).to(y(.2),{opacity:0,scale:0,y:this.originalShadowY-p}).to(y(.8-.2),{opacity:0,scale:0,y:this.originalShadowY-this.node.height}).to(y(.2),{opacity:this.originalShadowOpacity,scale:this.originalShadowScale}).start()}},t.prototype.startAddWater=function(e,t){var o=this;this.onPourInComplete=t,this.setState(u.Pouring),this.pourInEffectActivated=!1;var n=this._currentAmount,i=Math.min(n+e,this._capacity),r=y(.6);cc.tween({value:n}).to(r,{value:i},{progress:function(e,t,n,i){o._currentAmount=cc.misc.lerp(e,t,i),o.updateWaterDisplay();var r=o._capacity>0?o._currentAmount/o._capacity:0;return!o.pourInEffectActivated&&r>=.05&&(o.pourInEffectActivated=!0,o.updatePourInEffectPosition(),o.playPourInAnimation(0)),o.pourInEffectActivated&&o.updatePourInEffectPosition(),i}}).call(function(){o._currentAmount=i,o.updateWaterDisplay(),o.updatePourInEffectPosition(),o.checkCompletion(),o.stopPourInAnimation();var e=o.isCompleted();o.onPourInComplete&&o.onPourInComplete(o,e)}).start()},t.prototype.startRemoveWater=function(e,t){var o=this,n=this._currentAmount,i=Math.max(n-e,0),r=y(.6);cc.tween({value:n}).to(r,{value:i},{progress:function(e,t,n,i){return o._currentAmount=cc.misc.lerp(e,t,i),o.updateWaterDisplay(),i}}).call(function(){o._currentAmount=i,o.updateWaterDisplay(),t&&t(o)}).start()},t.prototype.resetPosition=function(e,t,o){var n=this;void 0===t&&(t=.2);var i=e||this.pourStartPosition;this.pourTween&&this.pourTween.stop();var r=this.node.getAnchorPoint(),a=this.pourStartAnchor,c=cc.v2(a.x-r.x,a.y-r.y),s=i.x-c.x*this.node.width*this.node.scaleX,l=i.y-c.y*this.node.height*this.node.scaleY;this.pourTween=cc.tween(this.node).to(y(t),{x:s,y:l,angle:0},{easing:"sineOut"}).call(function(){n.setAnchor(a),n.selectSurfacePlaying=!1,n.resetSurfaceIdle(),n.setState(u.Idle),o&&o()}).start()},t.prototype.setPourAnchor=function(e){var t=e?.7:.3;this.setAnchor(cc.v2(t,1))},t.prototype.setNormalAnchor=function(){this.setAnchor(cc.v2(.5,0))},t.prototype.enableTiltFill=function(e,t){if(this.waterSprite){this.savedFillType=this.waterSprite.fillType,this.savedFillRange=this.waterSprite.fillRange||0,this.savedFillCenter=this.waterSprite.fillCenter?this.waterSprite.fillCenter.clone():cc.v2(.5,.5),this.savedFillStart=this.waterSprite.fillStart||0;var o=this.waterSprite.node.convertToNodeSpaceAR(e),n=this.waterSprite.node.getContentSize(),i=this.waterSprite.node.getAnchorPoint(),r=(o.x+n.width*i.x)/n.width,a=(o.y+n.height*i.y)/n.height;this.waterSprite.fillType=cc.Sprite.FillType.RADIAL,this.waterSprite.fillCenter=cc.v2(r,a),this.tiltFillActive=!0,this.tiltFillIsRight=t,this.updateTiltFillRange()}},t.prototype.updateTiltFillRange=function(){if(this.waterSprite&&this.tiltFillActive){var e=this._capacity>0?this._currentAmount/this._capacity:0;this.tiltFillIsRight?this.waterSprite.fillRange=-.231-.08*e:this.waterSprite.fillRange=.731+.08*e,this.currentFillRange=this.waterSprite.fillRange}},t.prototype.disableTiltFill=function(){this.waterSprite&&this.tiltFillActive&&(this.tiltFillActive=!1,this.waterSprite.fillType=this.savedFillType,this.waterSprite.fillRange=this.savedFillRange,this.waterSprite.fillCenter=this.savedFillCenter,this.waterSprite.fillStart=this.savedFillStart,this.currentFillRange=this.waterSprite.fillRange||0,this.updateWaterDisplay())},t.prototype.suppressSurfaceAnimation=function(){this.suppressSurfaceWhilePouring=!0,this.surface&&(this.surface.node.active=!1,this.surface.timeScale=0),this.surfaceHighlight&&(this.surfaceHighlight.node.active=!1,this.surfaceHighlight.timeScale=0)},t.prototype.restoreSurfaceAnimation=function(){this.suppressSurfaceWhilePouring=!1,this.surfaceAnimationPlaying=!1,this.surface&&(this.surface.node.active=!0),this.surfaceHighlight&&(this.surfaceHighlight.node.active=!0),this.updateSurface()},t.prototype.setAnchor=function(e){if(this.node){var t=this.node.getAnchorPoint();if(t.x!==e.x||t.y!==e.y){for(var o=this.node.getPosition(),n=[],i=0,r=this.node.children;i<r.length;i++){var a=r[i];n.push(a.getPosition().clone())}this.node.setAnchorPoint(e);var c=cc.v2(e.x-t.x,e.y-t.y),s=cc.v2(c.x*this.node.width*this.node.scaleX,c.y*this.node.height*this.node.scaleY);if(0!==this.node.angle){var l=this.node.angle*Math.PI/180,u=Math.cos(l),p=Math.sin(l),d=s.x*u-s.y*p,f=s.x*p+s.y*u;s.x=d,s.y=f}o.x+=s.x,o.y+=s.y,this.node.setPosition(o);for(var h=0;h<this.node.children.length;h++){a=this.node.children[h];var y=n[h];a.setPosition(y.x-c.x*this.node.width,y.y-c.y*this.node.height)}}}},t.prototype.canPourTo=function(e){return!(this._currentAmount<=0||e._currentAmount>=e._capacity||(e._currentAmount,0))},t.prototype.getWaterSurfaceWorldPos=function(){if(!this.waterSprite)return this.node.convertToWorldSpaceAR(cc.v2(0,.5*-this.node.height));var e=this.waterSprite.node,t=this.currentFillRange>0?this.currentFillRange:this.waterSprite.fillRange||0,o=-e.height*e.anchorY+e.height*t;return e.convertToWorldSpaceAR(cc.v2(0,o))},l([h(cc.Label)],t.prototype,"capacityLabel",void 0),l([h(cc.Label)],t.prototype,"targetLabel",void 0),l([h(cc.Sprite)],t.prototype,"bottleSprite",void 0),l([h(cc.Sprite)],t.prototype,"waterSprite",void 0),l([h(cc.Sprite)],t.prototype,"mouthSprite",void 0),l([h(cc.Sprite)],t.prototype,"dashedLineSprite",void 0),l([h(sp.Skeleton)],t.prototype,"surface",void 0),l([h(sp.Skeleton)],t.prototype,"surfaceHighlight",void 0),l([h(sp.Skeleton)],t.prototype,"pourInSurface",void 0),l([h(sp.Skeleton)],t.prototype,"pourInSurfaceHighlight",void 0),l([h(sp.Skeleton)],t.prototype,"pourInSplash",void 0),l([h(sp.Skeleton)],t.prototype,"pourInSplashHighlight",void 0),l([h(sp.Skeleton)],t.prototype,"pourInRipple",void 0),l([h(cc.Node)],t.prototype,"shadow",void 0),l([h(cc.SpriteAtlas)],t.prototype,"spriteAtlas",void 0),l([h([cc.SpriteFrame])],t.prototype,"bottleSprites",void 0),l([h([cc.SpriteFrame])],t.prototype,"waterSprites",void 0),l([f],t)}(cc.Component);r.default=_,cc._RF.pop(),cc._RF.pop()},{}],BreathAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"15059ZkNuRHQKAqk6OalAzW","BreathAnimation");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"15059ZkNuRHQKAqk6OalAzW","BreathAnimation");var a,c=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(i,"__esModule",{value:!0});var l=cc._decorator,u=l.ccclass,p=l.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scaleRatio=1.1,t.duration=.8,t._initialScaleX=.8,t._initialScaleY=.8,t}return c(t,e),t.prototype.onLoad=function(){this._initialScaleX=this.node.scaleX,this._initialScaleY=this.node.scaleY},t.prototype.onEnable=function(){this.startBreath()},t.prototype.onDisable=function(){this.stopBreath()},t.prototype.startBreath=function(){this.node.stopAllActions(),this.node.scaleX=this._initialScaleX,this.node.scaleY=this._initialScaleY;var e=this._initialScaleX*this.scaleRatio,t=this._initialScaleY*this.scaleRatio;cc.tween(this.node).repeatForever(cc.tween().to(.5*this.duration,{scaleX:e,scaleY:t},{easing:"sineInOut"}).to(.5*this.duration,{scaleX:this._initialScaleX,scaleY:this._initialScaleY},{easing:"sineInOut"})).start()},t.prototype.stopBreath=function(){this.node.stopAllActions(),this.node.scaleX=this._initialScaleX,this.node.scaleY=this._initialScaleY},s([p({tooltip:"\u547c\u5438\u65f6\u653e\u5927\u7684\u500d\u6570"})],t.prototype,"scaleRatio",void 0),s([p({tooltip:"\u547c\u5438\u4e00\u6b21\u7684\u65f6\u95f4\uff08\u79d2\uff09"})],t.prototype,"duration",void 0),s([u],t)}(cc.Component);i.default=d,cc._RF.pop(),cc._RF.pop()},{}],BundleData:[function(e,t,o){"use strict";cc._RF.push(t,"54c5bFCHCJJ06CRa6MBvypf","BundleData");var n=t,i=o;cc._RF.push(n,"54c5bFCHCJJ06CRa6MBvypf","BundleData"),Object.defineProperty(i,"__esModule",{value:!0}),i.BundleNames=void 0,i.BundleNames||(i.BundleNames={}),cc._RF.pop(),cc._RF.pop()},{}],BundleManager:[function(e,t,o){"use strict";cc._RF.push(t,"11126Yt3oVBcKdR1d6wkFAU","BundleManager");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"11126Yt3oVBcKdR1d6wkFAU","BundleManager");var a=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c},c=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},s=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var l=cc._decorator,u=l.ccclass,p=(l.property,function(){function e(){this._bundles=new Map,this._loadingBundles=new Map}var t;return t=e,e.getInstance=function(){return this._instance||(this._instance=new t),this._instance},e.prototype.loadBundle=function(e,t){this.loadBundleAsync(e).then(function(e){t&&t(null,e)}).catch(function(e){t&&t(e,null)})},e.prototype.loadBundleAsync=function(e){var t=this;return new Promise(function(o,n){if(t._bundles.has(e))o(t._bundles.get(e));else if(t._loadingBundles.has(e))t._loadingBundles.get(e).then(o).catch(n);else{var i=new Promise(function(o,n){cc.assetManager.loadBundle(e,function(i,r){t._loadingBundles.delete(e),i?n(i):(t._bundles.set(e,r),o(r))})});t._loadingBundles.set(e,i),i.then(o).catch(n)}})},e.prototype.loadRes=function(e,t,o){var n=this;return new Promise(function(i,r){return c(n,void 0,void 0,function(){var n,a;return s(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,this.loadBundleAsync(e)];case 1:return(n=c.sent())?(n.load(t,o,function(e,t){e?r(e):i(t)}),[3,3]):(r(new Error("Bundle "+e+" not found")),[2]);case 2:return a=c.sent(),r(a),[3,3];case 3:return[2]}})})})},e.prototype.getRes=function(e,t,o){var n=this._bundles.get(e);return n?n.get(t,o):null},e.prototype.loadScene=function(e,t){var o=this;return new Promise(function(n,i){return c(o,void 0,void 0,function(){var o;return s(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.loadBundleAsync(e)];case 1:return r.sent().loadScene(t,function(e,t){e?i(e):n(t)}),[3,3];case 2:return o=r.sent(),i(o),[3,3];case 3:return[2]}})})})},e.prototype.releaseBundle=function(e){var t=this._bundles.get(e);t&&(t.releaseAll(),cc.assetManager.removeBundle(t),this._bundles.delete(e))},e.prototype.getBundle=function(e){return this._bundles.get(e)},e.prototype.releaseAllBundles=function(){this._bundles.forEach(function(e){e.releaseAll(),cc.assetManager.removeBundle(e)}),this._bundles.clear(),this._loadingBundles.clear()},e.prototype.getLoadedBundles=function(){return Array.from(this._bundles.keys())},e._instance=null,t=a([u],e)}());i.default=p,cc._RF.pop(),cc._RF.pop()},{}],CandidateText:[function(e,t,o){"use strict";cc._RF.push(t,"321a70nxg1Jg6cksLdP87iR","CandidateText");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"321a70nxg1Jg6cksLdP87iR","CandidateText");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CupMgr"),p=n("const"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t}return s(t,e),t.prototype.onLoad=function(){cc.director.on(p.EventNames.UpdateCandidateText,this.updateText,this),cc.director.on(p.EventNames.LoadLevel,this.opening,this)},t.prototype.onDestroy=function(){cc.director.off(p.EventNames.UpdateCandidateText,this.updateText,this),cc.director.off(p.EventNames.LoadLevel,this.opening,this)},t.prototype.opening=function(){if(0!=u.default.getInstance().candidateCupCfgs.length){var e=this.node.x;this.node.getComponent(cc.Widget).isAlignRight=!1,this.node.x=e+500,this.node.opacity=255,cc.tween(this.node).to(.5,{x:e},{easing:"sineIn"}).start()}else this.node.active=!1},t.prototype.updateText=function(e){!this.node.active&&e>0&&(this.node.active=!0),this.label.string=e.toString()},l([h(cc.Label)],t.prototype,"label",void 0),l([f],t)}(cc.Component);r.default=y,cc._RF.pop(),cc._RF.pop()},{}],CapSkin:[function(e,t,o){"use strict";cc._RF.push(t,"a18f2ed+oJL/6hsZGJOyxeF","CapSkin");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"a18f2ed+oJL/6hsZGJOyxeF","CapSkin");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=n("const"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sf=null,t}return s(t,e),t.prototype.onEnable=function(){cc.director.getScene().name===p.SceneNames.Game&&this.setUpSkin()},t.prototype.setUpSkin=function(){var e=this;if(0!=u.default.SelectedCapIndex){var t=cc.assetManager.getBundle("Caps");if(!t)return cc.error("Caps\u8d44\u6e90\u5305\u672a\u52a0\u8f7d\uff0c\u8bf7\u5148\u52a0\u8f7d\u8d44\u6e90\u5305"),void cc.assetManager.loadBundle("Caps",function(t,o){t?cc.error("\u52a0\u8f7dCaps\u8d44\u6e90\u5305\u5931\u8d25:",t):o.load(""+u.default.SelectedCapIndex,cc.Texture2D,function(t,o){t?console.error("\u52a0\u8f7d\u56fe\u7247"+u.default.SelectedCapIndex+"\u5931\u8d25:",t):e.sf.spriteFrame=new cc.SpriteFrame(o)})});for(var o=0;o<3;++o)t.load(""+u.default.SelectedCapIndex,cc.Texture2D,function(t,o){t?console.error("\u52a0\u8f7d\u56fe\u7247"+u.default.SelectedCapIndex+"\u5931\u8d25:",t):e.sf.spriteFrame=new cc.SpriteFrame(o)})}else this.sf.spriteFrame=null},l([h(cc.Sprite)],t.prototype,"sf",void 0),l([f],t)}(cc.Component);r.default=y,cc._RF.pop(),cc._RF.pop()},{}],ChallengeBtn:[function(e,t,o){"use strict";cc._RF.push(t,"22c66SO/pFAiKGmV0XWAA8L","ChallengeBtn");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"22c66SO/pFAiKGmV0XWAA8L","ChallengeBtn");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=n("const"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bg=null,t.withAd=null,t.withoutAd=null,t.withShare=null,t}return s(t,e),t.prototype.onEnable=function(){cc.director.getScene().name===p.SceneNames.Challenge&&(u.default.FreeChallengeTimes>0?this.bg.spriteFrame=this.withoutAd:0===u.default.FreeChallengeTimes?this.bg.spriteFrame=this.withShare:this.bg.spriteFrame=this.withAd)},l([h(cc.Sprite)],t.prototype,"bg",void 0),l([h(cc.SpriteFrame)],t.prototype,"withAd",void 0),l([h(cc.SpriteFrame)],t.prototype,"withoutAd",void 0),l([h(cc.SpriteFrame)],t.prototype,"withShare",void 0),l([f],t)}(cc.Component);r.default=y,cc._RF.pop(),cc._RF.pop()},{}],ChallengeModeScene:[function(e,t,o){"use strict";cc._RF.push(t,"d94d5sQADJGaKBDhIMIAwBO","ChallengeModeScene");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"d94d5sQADJGaKBDhIMIAwBO","ChallengeModeScene");var a,c=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(i,"__esModule",{value:!0});var l=cc._decorator,u=l.ccclass,p=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),s([u],t)}(cc.Component));i.default=p,cc._RF.pop(),cc._RF.pop()},{}],ChangeColorCup:[function(e,t,o){"use strict";cc._RF.push(t,"2e412vdYORFCIbr4XtIY3Zq","ChangeColorCup");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"2e412vdYORFCIbr4XtIY3Zq","ChangeColorCup");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("Cup"),p=n("Water"),d=cc._decorator,f=d.ccclass,h=(d.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.targetColorIds=[0,0,0,0],t.buffer=0,t.isChangingColor=!1,t}return s(t,e),t.prototype.changeColor=function(){var e=this;this.isChangingColor=!0,this.unscheduleAllCallbacks(),this.moveKeyUp(),this.scheduleOnce(function(){if(e.water._action==p.WaterAction.none){for(var t=[0,0,0,0],o=e.info.colorIds.slice(),n=0,i=0;i<e.buffer;i++){t=[0,0,0,0];for(var r=0;r<u.SPLIT_COUNT;r++)0!=o[r]&&(0==n&&(n=o[r]),r<u.SPLIT_COUNT-1?0!=n&&(t[r]=o[r+1]):0!=n&&(t[r]=n));o=t.slice()}if(0!=n){e.buffer=0;var a=!0;for(r=0;r<u.SPLIT_COUNT;r++)if(t[r]!=e.info.colorIds[r]){a=!1;break}a||e.dyeWater(t),e.isChangingColor=!1}}},.5)},t.prototype.changeColorUndo=function(){var e=this;console.error("changeColorUndo"),this.isChangingColor=!0,this.unscheduleAllCallbacks(),this.moveKeyUp(),this.scheduleOnce(function(){if(e.water._action==p.WaterAction.none){for(var t=[0,0,0,0],o=e.info.colorIds.slice(),n=0,i=0;i<e.buffer;i++){t=[],console.error("currentColorIds",o);for(var r=0;r<u.SPLIT_COUNT;r++)console.error(""+r,t),0!=o[r]?0!=n?r<u.SPLIT_COUNT-1&&t.push(o[r]):(n=o[r],t.push(n),r!=u.SPLIT_COUNT-1&&t.push(o[u.SPLIT_COUNT-1])):t.push(0);o=t.slice()}if(0!=n){e.buffer=0;var a=!0;for(r=0;r<u.SPLIT_COUNT;r++)if(t[r]!=e.info.colorIds[r]){a=!1;break}a||e.dyeWater(t),e.isChangingColor=!1}}},.5)},t.prototype.updateSurface=function(){var e=this.water.getWaterCenter();if(e.y+=13,this.cupType!=u.CupType.Temp1&&this.cupType!=u.CupType.Absorb||(e.y-=5),this.surface.node.setPosition(e.x,e.y),this.water._action==p.WaterAction.in&&(this.pourInSurface.node.setPosition(e.x,e.y),console.warn(this.water.infos[this.water.infos.length-1].height)),this.water.ifShowPourInSurface||this.currentState!=u.CupState.PouringIn){if(this.water.infos.length<=0)return this.surface.node.opacity=0,this.surfaceHighlight.node.opacity=0,this.pourInSurface.node.opacity=0,this.pourInSurfaceHightlight.node.opacity=0,this.pourInSplash.node.opacity=0,this.pourInSplashHighlight.node.opacity=0,void(this.pourInRipple.node.opacity=0);if(this.water._action==p.WaterAction.in&&(this.surface.node.opacity=255,this.surfaceHighlight.node.opacity=180,this.pourInSurface.node.active=!0,this.pourInSurface.node.opacity=255,this.pourInSurfaceHightlight.node.opacity=180,this.pourInSurface.node.setPosition(e.x,e.y)),this.water._action==p.WaterAction.colorChange)return this.surface.node.opacity=0,this.surfaceHighlight.node.opacity=0,this.pourInSurface.node.opacity=0,this.pourInSurfaceHightlight.node.opacity=0,this.pourInSplash.node.opacity=0,this.pourInSplashHighlight.node.opacity=0,void(this.pourInRipple.node.opacity=0);var t=this.getTop().topColorId;if(0!=(t%=1e3)&&this.currentState!=u.CupState.Pouring){this.surface.node.opacity=255,this.surfaceHighlight.node.opacity=180;var o=this.getTop().emptyNum;void 0===this.water.infos[3-o]||void 0===this.water.infos[3-o].surfaceColor?this.surface.node.color=(new cc.Color).fromHEX(u.SurfaceColors[t]||"#538849"):this.surface.node.color=this.water.infos[3-o].surfaceColor}else if(this.surface.node.opacity=this.currentState==u.CupState.Finished?255:0,this.currentState==u.CupState.Pouring&&(this.surface.node.opacity=0),this.currentState==u.CupState.Finished)this.surface.node.opacity=255,this.surfaceHighlight.node.opacity=180,this.surface.node.color=this.water.infos[0].surfaceColor;else if(this.water._action==p.WaterAction.in){this.surface.node.opacity=255,this.surfaceHighlight.node.opacity=180,u.WaterColors[t];var n=u.SurfaceColors[t]||"#538849";t%1e3>100&&(u.color_locked,n=u.color_locked_surface),this.surface.node.color=(new cc.Color).fromHEX(n)}}},l([f],t)}(u.default));r.default=h,cc._RF.pop(),cc._RF.pop()},{}],CircleProgreeDisplay:[function(e,t,o){"use strict";cc._RF.push(t,"d8382NeqBxE8pLEUaExZrei","CircleProgreeDisplay");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"d8382NeqBxE8pLEUaExZrei","CircleProgreeDisplay");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("SignInManager"),p=cc._decorator,d=p.ccclass,f=p.property,h=p.menu,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.progressSprite=null,t.progressLabel=null,t}return s(t,e),t.prototype.onEnable=function(){this.progressSprite.fillRange=0;var e=u.default.instance.getDailyTaskTarget(),t=u.default.instance.dailyWinCount,o=t/e;o>1&&(o=1),this.progressLabel.string=(t>e?e:t)+"/"+e,o<=0||cc.tween(this.progressSprite).delay(1.2).to(.4,{fillRange:o},{easing:"sineOut"}).start()},l([f(cc.Sprite)],t.prototype,"progressSprite",void 0),l([f(cc.Label)],t.prototype,"progressLabel",void 0),l([d,h("Event/CircleProgressDisplay")],t)}(cc.Component);r.default=y,cc._RF.pop(),cc._RF.pop()},{}],ClockAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"e054c48SYJBS4OcSxkRlw1K","ClockAnimation");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"e054c48SYJBS4OcSxkRlw1K","ClockAnimation");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("const"),d=cc._decorator,f=d.ccclass,h=(d.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.onEnable=function(){this.node.scale=0,cc.director.on(p.EventNames.LoadLevelFinish,this.playClockAnimation,this)},t.prototype.onDestroy=function(){cc.director.off(p.EventNames.LoadLevelFinish,this.playClockAnimation,this)},t.prototype.playClockAnimation=function(){var e=this;cc.tween(this.node).to(.3,{scale:1}).call(function(){u.default.instance.playSFX(u.AudioRef.ClockRing)}).to(.1,{rotation:-10}).to(.1,{rotation:10}).to(.1,{rotation:-10}).to(.1,{rotation:10}).to(.1,{rotation:-10}).to(.1,{rotation:10}).to(.1,{rotation:-10}).to(.1,{rotation:10}).to(.1,{rotation:-10}).to(.1,{rotation:10}).to(.1,{rotation:-10}).to(.05,{rotation:0}).delay(.1).parallel(cc.tween().to(.8,{scale:0}),cc.tween().to(.6,{position:cc.v3(0,680)},{easing:"sineOut"})).call(function(){e.node.destroy()}).start()},l([f],t)}(cc.Component));r.default=h,cc._RF.pop(),cc._RF.pop()},{}],CollectionData:[function(e,t,o){"use strict";cc._RF.push(t,"44bd9XwOOBJdqDAOXhoM45f","CollectionData");var n=e,i=t,r=o;cc._RF.push(i,"44bd9XwOOBJdqDAOXhoM45f","CollectionData");var a=function(){return(a=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},c=function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<o;t++)for(var r=arguments[t],a=0,c=r.length;a<c;a++,i++)n[i]=r[a];return n};Object.defineProperty(r,"__esModule",{value:!0}),r._finishEffectUnlockMap=r.FinishEffectNameMap=r.finishEffectUnlockPriceMap=r.effectShowOrder=r._themeUnlockMap=r._themePriceMap=r.ThemeUnlockNeedMap=r.ThemeNameMap=r.themeShowOrder=r._characterPriceMap=r._characterUnlockMap=r.characterNameMap=r.characterCollectionList=r.unlockCharacterByWinStreakArrayIndex=r.unlockCharacterByWinStreakArray=r.characterUnlockConditionMap=r.characterShowOrder=r.animationName=r.animalSpine=r.animalSpineRoot=r.noSkinCharacters=r.capUnlockConditionMap=r._capPriceMap=r._capUnlockMap=r.unlockCapByWinStreakArrayIndex=r.unlockCapByWinStreakArray=r.capNameMap=r.capCollectionList=r.capShowOrder=void 0;var s=n("AppConfig"),l=(new Date).getMonth()+1===2,u="wxeb3a3f764474c346"==s.appId;r.capShowOrder=c([15],u?[43]:[],[11,12,13,14],l?[40,41,42]:[],[38,39,1,2,16,17,18,19,3,20,21,22,23,24,25,26,4,27,6,7,5,8,9,10,28,29,30,31,32,33,34,35,36,37]),r.capCollectionList=c(["\u732a\u5934","\u6843\u5b50","\u98de\u884c\u9e1f","\u732b\u722a","\u5c0f\u72d7","\u9ea6\u514b\u98ce","\u732b\u54aa","\u8272\u5b50","\u94bb\u6212","\u5c0f\u9e2d\u5b50","\u9ebb\u5c06","\u5361\u76ae\u5df4\u62c9","\u9ed1\u516b\u7403","\u53e3\u7ea2","\u5c0f\u718a\u732b","\u673a\u667a\u725b","\u673a\u667a\u9a6c","\u673a\u667a\u9e45","\u5927\u773c\u86d9","\u5446\u5446\u72d7","\u77f3\u4e2d\u5251","\u7f8a\u9a7c\u9a7c","\u751f\u6c14\u718a","\u5446\u6728\u5934","\u83ca\u82b1","\u5446\u5446\u85af","\u732b\u732b\u638c","\u6708\u4eae","\u661f\u661f","\u8783\u87f9","\u571f\u62e8\u9f20","\u7ae0\u9c7c","\u5341\u5b57\u661f","\u8774\u8776\u7ed3","\u7231\u5fc3","\u7687\u51a0","\u5c0f\u9a6c","\u96ea\u82b1","\u96ea\u4eba"],l?["\u5143\u5b9d","\u997a\u5b50","\u7206\u7af9"]:[],u?["\u798f\u5982\u4e1c\u6d77"]:[]),r.capNameMap=a(a({1:"\u732a\u5934",2:"\u6843\u5b50",3:"\u98de\u884c\u9e1f",4:"\u732b\u722a",5:"\u5c0f\u72d7",6:"\u9ea6\u514b\u98ce",7:"\u732b\u54aa",8:"\u8272\u5b50",9:"\u94bb\u6212",10:"\u5c0f\u9e2d\u5b50",11:"\u9ebb\u5c06",12:"\u5361\u76ae\u5df4\u62c9",13:"\u9ed1\u516b\u7403",14:"\u53e3\u7ea2",15:"\u5c0f\u718a\u732b",16:"\u673a\u667a\u725b",17:"\u673a\u667a\u9a6c",18:"\u673a\u667a\u9e45",19:"\u5927\u773c\u86d9",20:"\u5446\u5446\u72d7",21:"\u77f3\u4e2d\u5251",22:"\u7f8a\u9a7c\u9a7c",23:"\u751f\u6c14\u718a",24:"\u5446\u6728\u5934",25:"\u83ca\u82b1",26:"\u5446\u5446\u85af",27:"\u732b\u732b\u638c",28:"\u6708\u4eae",29:"\u661f\u661f",30:"\u8783\u87f9",31:"\u571f\u62e8\u9f20",32:"\u7ae0\u9c7c",33:"\u5341\u5b57\u661f",34:"\u8774\u8776\u7ed3",35:"\u7231\u5fc3",36:"\u7687\u51a0",37:"\u5c0f\u9a6c",38:"\u96ea\u82b1",39:"\u96ea\u4eba"},l?{40:"\u5143\u5b9d",41:"\u997a\u5b50",42:"\u7206\u7af9"}:{}),u?{43:"\u798f\u5982\u4e1c\u6d77"}:{}),r.unlockCapByWinStreakArray=[7,14,35,56],r.unlockCapByWinStreakArrayIndex=[11,12,13,14],r._capUnlockMap=a(a({1:!1,2:!1,3:!1,4:!1,5:!1,6:!1,7:!1,8:!1,9:!1,10:!1,11:!1,12:!1,13:!1,14:!1,15:!1,16:!1,17:!1,18:!1,19:!1,20:!1,21:!1,22:!1,23:!1,24:!1,25:!1,26:!1,27:!1,28:!1,29:!1,30:!1,31:!1,32:!1,33:!1,34:!1,35:!1,36:!1,37:!1,38:!1,39:!1},l?{40:!1,41:!1,42:!1}:{}),u?{43:!1}:{}),r._capPriceMap={38:2026,39:2026},r.capUnlockConditionMap=a(a({1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:"\u8fde\u80dc7\u6b21\u83b7\u5f97",12:"\u8fde\u80dc14\u6b21\u83b7\u5f97",13:"\u8fde\u80dc35\u6b21\u83b7\u5f97",14:"\u8fde\u80dc56\u6b21\u83b7\u5f97",15:"\u8ba2\u9605\u6e38\u620f\u5708\u83b7\u5f97",16:0,17:0,18:0,19:0,20:0,21:0,22:0,23:0,24:0,25:0,26:0,27:0,28:0,29:0,30:0,31:0,32:0,33:0,34:0,35:0,36:0,37:0,38:"\u51ac\u65e5\u5947\u9047\u6d3b\u52a8\u89e3\u9501",39:"\u51ac\u65e5\u5947\u9047\u6d3b\u52a8\u89e3\u9501"},l?{40:"\u65b0\u6625\u6d3b\u52a8\u89e3\u9501",41:"\u65b0\u6625\u6d3b\u52a8\u89e3\u9501",42:"\u65b0\u6625\u6d3b\u52a8\u89e3\u9501"}:{}),u?{43:"\u6e38\u620f\u5708\u6625\u8282\u6d3b\u52a8\u83b7\u5f97"}:{}),r.noSkinCharacters=[5,6,7,8],r.animalSpineRoot="Animals/",r.animalSpine=["Pig/zhuye","Kapi/kap","Cow/niu","Bear/xiong","Goose/yz","Hamster/cs","Penguin/qe","Horse/zhuye6"],r.animationName=["animation","kpbl","niu","xiong","animation2","animation2","animation2","animation2"],r.characterShowOrder=c([1,4],l?[8]:[],[7,3,2,5,6]),r.characterUnlockConditionMap=a({1:0,2:0,3:0,4:"\u8fde\u80dc140\u6b21\u83b7\u5f97",5:0,6:0,7:"\u51ac\u65e5\u5947\u9047\u6d3b\u52a8\u83b7\u5f97"},l?{8:"\u65b0\u6625\u6d3b\u52a8\u83b7\u5f97"}:{}),r.unlockCharacterByWinStreakArray=[140],r.unlockCharacterByWinStreakArrayIndex=[4],r.characterCollectionList=c(["\u5657\u5657\u732a","\u5361\u76ae\u5df4\u62c9","\u54de\u4ed4","\u8d1d\u5c14\u718a","\u5feb\u9001\u9e45","\u4ed3\u9f20\u9f20","\u9177\u4f01\u9e45"],l?["\u9a6c\u6210\u529f"]:[]),r.characterNameMap=a({1:"\u5657\u5657\u732a",2:"\u5361\u76ae\u5df4\u62c9",3:"\u54de\u4ed4",4:"\u8d1d\u5c14\u718a",5:"\u5feb\u9001\u9e45",6:"\u4ed3\u9f20\u9f20",7:"\u9177\u4f01\u9e45"},l?{8:"\u9a6c\u6210\u529f"}:{}),r._characterUnlockMap=a({1:!0,2:!1,3:!1,4:!1,5:!1,6:!1,7:!1},l?{8:!1}:{}),r._characterPriceMap={7:12e3},r.themeShowOrder=c([1,2,3,4,5,6,7,8,9],l?[10]:[],[11]),r.ThemeNameMap=a(a({1:"\u6e29\u99a8\u5c0f\u5e97",2:"\u9b54\u6cd5\u5c0f\u5c4b",3:"\u6d77\u98ce\u6696\u9633",4:"\u79cb\u65e5\u9ec4\u660f",5:"\u5357\u74dc\u4e07\u5723",6:"\u5c0f\u5356\u90e8",7:"\u5927\u6f20\u708e\u708e",8:"\u7ae5\u8da3\u4e50\u6e38",9:"\u94f6\u88c5\u7d20\u88f9"},l?{10:"\u65b0\u5c81\u5e8f\u66f2"}:{}),{11:"\u7a97\u5916\u8857\u666f"}),r.ThemeUnlockNeedMap=a(a({1:1,2:4,3:9,4:9,5:4,6:9,7:9,8:9,9:9},l?{10:9}:{}),{11:4}),r._themePriceMap=a(a({1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:1e3},l?{10:1e3}:{}),{11:0}),r._themeUnlockMap=a(a({1:!0,2:!1,"2_1":!1,"2_2":!1,"2_3":!1,"2_4":!1,3:!1,"3_1":!1,"3_2":!1,"3_3":!1,"3_4":!1,"3_5":!1,"3_6":!1,"3_7":!1,"3_8":!1,"3_9":!1,4:!1,"4_1":!1,"4_2":!1,"4_3":!1,"4_4":!1,"4_5":!1,"4_6":!1,"4_7":!1,"4_8":!1,"4_9":!1,5:!1,"5_1":!1,"5_2":!1,"5_3":!1,"5_4":!1,6:!1,"6_1":!1,"6_2":!1,"6_3":!1,"6_4":!1,"6_5":!1,"6_6":!1,"6_7":!1,"6_8":!1,"6_9":!1,7:!1,"7_1":!1,"7_2":!1,"7_3":!1,"7_4":!1,"7_5":!1,"7_6":!1,"7_7":!1,"7_8":!1,"7_9":!1,8:!1,"8_1":!1,"8_2":!1,"8_3":!1,"8_4":!1,"8_5":!1,"8_6":!1,"8_7":!1,"8_8":!1,"8_9":!1,9:!1,"9_1":!1,"9_2":!1,"9_3":!1,"9_4":!1,"9_5":!1,"9_6":!1,"9_7":!1,"9_8":!1,"9_9":!1},l?{10:!1,"10_1":!1,"10_2":!1,"10_3":!1,"10_4":!1,"10_5":!1,"10_6":!1,"10_7":!1,"10_8":!1,"10_9":!1}:{}),{11:!1,"11_1":!1,"11_2":!1,"11_3":!1,"11_4":!1}),r.effectShowOrder=c([1,9],l?[10]:[],[2,3,4,5,6,7,8]),r.finishEffectUnlockPriceMap=a({1:0,2:2500,3:2500,4:3e3,5:3e3,6:3e3,7:5e3,8:5e3,9:2888},l?{10:2888}:{}),r.FinishEffectNameMap=a({1:"\u9ed8\u8ba4",2:"\u6811\u53f6",3:"\u661f\u661f",4:"\u8774\u8776",5:"\u6c34\u6d41",6:"\u65b9\u5757",7:"\u5c4f\u969c",8:"\u5149\u5e55",9:"\u96ea\u82b1"},l?{10:"\u70df\u82b1"}:{}),r._finishEffectUnlockMap=a({1:!0,2:!1,3:!1,4:!1,5:!1,6:!1,7:!1,8:!1,9:!1},l?{10:!1}:{}),cc._RF.pop(),cc._RF.pop()},{}],CollectionItem_Animal:[function(e,t,o){"use strict";cc._RF.push(t,"2cf7a10d6NNQrULZR/WeLDS","CollectionItem_Animal");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"2cf7a10d6NNQrULZR/WeLDS","CollectionItem_Animal");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=n("const"),d=n("CollectionManager"),f=n("SubItem_Animal"),h=n("CollectionData"),y=cc._decorator,m=y.ccclass,g=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.animalImages=[],t.animalName=[],t.subItems=[],t.index=0,t}return s(t,e),t.prototype.updateItem=function(e){for(var t=this,o=[],n=[],i=0,r=Object.entries(d.default.CharacterUnlockMap);i<r.length;i++){var a=r[i],c=a[0],s=a[1];!1!==h.characterShowOrder.includes(Number(c))&&(s?o.push(Number(c)):n.push(Number(c)))}o.sort(function(e,t){return h.characterShowOrder.indexOf(e)-h.characterShowOrder.indexOf(t)}),n.sort(function(e,t){return h.characterShowOrder.indexOf(e)-h.characterShowOrder.indexOf(t)});for(var l=o.concat(n),f=0;f<2&&this.index!==e;++f)l[2*(this.index-1)+f]===u.default.SelectedCharacterIndex&&cc.director.emit(p.EventNames.UpdateAnimalSelection);this.index=e;var y=cc.assetManager.getBundle("Animals");if(y){var m=function(o){var i=l[2*(e-1)+o];return 2*(e-1)+o>=l.length?(g.animalImages[o].node.parent.active=!1,"continue"):(g.animalImages[o].node.parent.active=!0,n.includes(i)?(y.load(i+"d",cc.Texture2D,function(e,n){e?console.error("\u52a0\u8f7d\u56fe\u7247"+i+"\u5931\u8d25:",e):(t.animalImages[o].node.width=n.width,t.animalImages[o].node.height=n.height,t.animalImages[o].spriteFrame=new cc.SpriteFrame(n))}),"continue"):(g.animalImages[o].node.active=!1,"continue"))},g=this;for(f=0;f<2;++f)m(f);for(f=0;f<2;++f)v=l[2*(e-1)+f],2*(e-1)+f>=l.length?this.animalImages[f].node.parent.active=!1:(this.animalName[f].string=d.default.characterNameMap[v],o.includes(v)?this.subItems[f].updateIndex(v,!0):this.subItems[f].updateIndex(v,!1))}else for(cc.error("Animals\u8d44\u6e90\u5305\u672a\u52a0\u8f7d\uff0c\u8bf7\u5148\u52a0\u8f7d\u8d44\u6e90\u5305"),cc.assetManager.loadBundle("Animals",function(o,i){if(o)cc.error("\u52a0\u8f7dAnimals\u8d44\u6e90\u5305\u5931\u8d25:",o);else for(var r=function(o){t.animalImages[o].node.parent.active=!0;var r=l[2*(e-1)+o];return 2*(e-1)+o>=l.length?(t.animalImages[o].node.parent.active=!1,"continue"):n.includes(r)?(i.load(r+"d",cc.Texture2D,function(e,n){e?console.error("\u52a0\u8f7d\u56fe\u7247"+r+"\u5931\u8d25:",e):(t.animalImages[o].node.width=n.width,t.animalImages[o].node.height=n.height,t.animalImages[o].spriteFrame=new cc.SpriteFrame(n))}),"continue"):(t.animalImages[o].node.active=!1,"continue")},a=0;a<2;++a)r(a)}),f=0;f<2;++f){var v=l[2*(e-1)+f];2*(e-1)+f>=l.length?this.animalImages[f].node.parent.active=!1:(this.animalName[f].string=d.default.characterNameMap[v],o.includes(v)?this.subItems[f].updateIndex(v,!0):this.subItems[f].updateIndex(v,!1))}},t.prototype.refreshItem=function(){this.updateItem(this.index)},l([g([cc.Sprite])],t.prototype,"animalImages",void 0),l([g([cc.Label])],t.prototype,"animalName",void 0),l([g([f.default])],t.prototype,"subItems",void 0),l([m],t)}(cc.Component);r.default=v,cc._RF.pop(),cc._RF.pop()},{}],CollectionItem_Cap:[function(e,t,o){"use strict";cc._RF.push(t,"6af0aWXdNxHDoSxNbZByIHi","CollectionItem_Cap");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"6af0aWXdNxHDoSxNbZByIHi","CollectionItem_Cap");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("config"),p=n("CollectionManager"),d=n("SubItem_Cap"),f=n("CollectionData"),h=cc._decorator,y=h.ccclass,m=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.capImages=[],t.capName=[],t.subItems=[],t.index=0,t}return s(t,e),t.prototype.updateItem=function(e){for(var t=this,o=[],n=[],i=0,r=Object.entries(p.default.CapUnlockMap);i<r.length;i++){var a=r[i],c=a[0],s=a[1];u.currentPlatform==u.platformEnum.toutiao&&15===Number(c)||!1!==f.capShowOrder.includes(Number(c))&&(s?o.push(Number(c)):n.push(Number(c)))}o.sort(function(e,t){return f.capShowOrder.indexOf(e)-f.capShowOrder.indexOf(t)}),n.sort(function(e,t){return f.capShowOrder.indexOf(e)-f.capShowOrder.indexOf(t)});for(var l=o.concat(n),d=0;d<3&&this.index!==e;++d)l[3*(this.index-1)+d];this.index=e;var h=cc.assetManager.getBundle("Caps");if(h){var y=function(o){if(3*(e-1)+o>=l.length)return m.capImages[o].node.parent.active=!1,"continue";var i=l[3*(e-1)+o];if(m.capImages[o].node.parent.active=!0,n.includes(i))return h.load(i+"d",cc.Texture2D,function(e,n){e?console.error("\u52a0\u8f7d\u56fe\u7247"+i+"\u5931\u8d25:",e):t.capImages[o].spriteFrame=new cc.SpriteFrame(n)}),"continue";h.load(""+i,cc.Texture2D,function(e,n){e?console.error("\u52a0\u8f7d\u56fe\u7247"+i+"\u5931\u8d25:",e):t.capImages[o].spriteFrame=new cc.SpriteFrame(n)})},m=this;for(d=0;d<3;++d)y(d);for(d=0;d<3;++d)3*(e-1)+d>=l.length?this.capImages[d].node.parent.active=!1:(g=l[3*(e-1)+d],this.capName[d].string=p.default.capNameMap[g],o.includes(g)?this.subItems[d].updateIndex(g,!0):this.subItems[d].updateIndex(g,!1))}else for(cc.error("Caps\u8d44\u6e90\u5305\u672a\u52a0\u8f7d\uff0c\u8bf7\u5148\u52a0\u8f7d\u8d44\u6e90\u5305"),cc.assetManager.loadBundle("Caps",function(o,i){if(o)cc.error("\u52a0\u8f7dCaps\u8d44\u6e90\u5305\u5931\u8d25:",o);else for(var r=function(o){if(3*(e-1)+o>=l.length)return t.capImages[o].node.parent.active=!1,"continue";var r=l[3*(e-1)+o];if(t.capImages[o].node.parent.active=!0,n.includes(r))return i.load(r+"d",cc.Texture2D,function(e,n){e?console.error("\u52a0\u8f7d\u56fe\u7247"+r+"\u5931\u8d25:",e):t.capImages[o].spriteFrame=new cc.SpriteFrame(n)}),"continue";i.load(""+r,cc.Texture2D,function(e,n){e?console.error("\u52a0\u8f7d\u56fe\u7247"+r+"\u5931\u8d25:",e):t.capImages[o].spriteFrame=new cc.SpriteFrame(n)})},a=0;a<3;++a)r(a)}),d=0;d<3;++d)if(3*(e-1)+d>=l.length)this.capImages[d].node.parent.active=!1;else{var g=l[3*(e-1)+d];this.capName[d].string=p.default.capNameMap[g],o.includes(g)?this.subItems[d].updateIndex(g,!0):this.subItems[d].updateIndex(g,!1)}},l([m([cc.Sprite])],t.prototype,"capImages",void 0),l([m([cc.Label])],t.prototype,"capName",void 0),l([m([d.default])],t.prototype,"subItems",void 0),l([y],t)}(cc.Component);r.default=g,cc._RF.pop(),cc._RF.pop()},{}],CollectionItem_Drink:[function(e,t,o){"use strict";cc._RF.push(t,"2360eXOenJAJJpW91OCWjUm","CollectionItem_Drink");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"2360eXOenJAJJpW91OCWjUm","CollectionItem_Drink");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.drinkImages=[],t.drinkName=[],t.index=0,t}return s(t,e),t.prototype.updateItem=function(e){var t,o=this;t=e<=10?"Drink1":e<=20?"Drink2":"Drink3",this.index=e;var n=cc.assetManager.getBundle(t);if(n){var i=function(t){var i=3*(e-1)+t+1;if(i>=u.default.CurrentUnlockIndex)return r.drinkImages[t].node.parent.opacity=0,r.drinkName[t].string="","continue";n.load(""+i,cc.Texture2D,function(e,n){e?console.error("\u52a0\u8f7d\u56fe\u7247"+i+"\u5931\u8d25:",e):o.drinkImages[t].spriteFrame=new cc.SpriteFrame(n)})},r=this;for(a=0;a<3;++a)i(a);for(a=0;a<3&&!(3*(e-1)+a+1>=u.default.CurrentUnlockIndex);++a)this.drinkImages[a].node.parent.opacity=255,this.drinkName[a].string=u.default.collectionList[3*(e-1)+a]}else{cc.error("DrinkTextureBig\u8d44\u6e90\u5305\u672a\u52a0\u8f7d\uff0c\u8bf7\u5148\u52a0\u8f7d\u8d44\u6e90\u5305"),cc.assetManager.loadBundle(t,function(t,n){if(t)cc.error("\u52a0\u8f7dDrinkTexture\u8d44\u6e90\u5305\u5931\u8d25:",t);else for(var i=function(t){var i=3*(e-1)+t+1;if(i>=u.default.CurrentUnlockIndex)return o.drinkImages[t].node.parent.opacity=0,o.drinkName[t].string="","continue";n.load(""+i,cc.Texture2D,function(e,n){e?console.error("\u52a0\u8f7d\u56fe\u7247"+i+"\u5931\u8d25:",e):o.drinkImages[t].spriteFrame=new cc.SpriteFrame(n)})},r=0;r<3;++r)i(r)});for(var a=0;a<3&&!(3*(e-1)+a+1>=u.default.CurrentUnlockIndex);++a)this.drinkImages[a].node.parent.opacity=255,this.drinkName[a].string=u.default.collectionList[3*(e-1)+a]}},l([f([cc.Sprite])],t.prototype,"drinkImages",void 0),l([f([cc.Label])],t.prototype,"drinkName",void 0),l([d],t)}(cc.Component);r.default=h,cc._RF.pop(),cc._RF.pop()},{}],CollectionItem_Effect:[function(e,t,o){"use strict";cc._RF.push(t,"658c0cyH8BPyahXJHb1yozY","CollectionItem_Effect");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"658c0cyH8BPyahXJHb1yozY","CollectionItem_Effect");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("const"),p=n("FinishEffectDataManager"),d=n("SubItem_Effect"),f=n("CollectionData"),h=cc._decorator,y=h.ccclass,m=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.subItems=[],t.index=0,t}return s(t,e),t.prototype.updateItem=function(e){for(var t=[],o=[],n=0,i=f.effectShowOrder;n<i.length;n++){var r=i[n];1==p.default.FinishEffectUnlockMap[r]?t.push(Number(r)):o.push(Number(r))}t.sort(function(e,t){return f.effectShowOrder.indexOf(e)-f.effectShowOrder.indexOf(t)}),o.sort(function(e,t){return f.effectShowOrder.indexOf(e)-f.effectShowOrder.indexOf(t)});for(var a=t.concat(o),c=0;c<2&&this.index!==e;++c)a[2*(this.index-1)+c]===p.default.CurrentFinishEffectIndex&&cc.director.emit(u.EventNames.UpdateAnimalSelection);for(this.index=e,c=0;c<2;++c){var s=a[2*(e-1)+c];t.includes(s)?(this.subItems[c].node.opacity=255,this.subItems[c].updateIndex(s,!0)):o.includes(s)?(this.subItems[c].node.opacity=255,this.subItems[c].updateIndex(s,!1)):this.subItems[c].node.opacity=0}},l([m([d.default])],t.prototype,"subItems",void 0),l([y],t)}(cc.Component);r.default=g,cc._RF.pop(),cc._RF.pop()},{}],CollectionItem_Rank:[function(e,t,o){"use strict";cc._RF.push(t,"5500eeW1ydM9KWr8ody3jXY","CollectionItem_Rank");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"5500eeW1ydM9KWr8ody3jXY","CollectionItem_Rank");var a,c=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(i,"__esModule",{value:!0});var l=cc._decorator,u=l.ccclass,p=l.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.avatar=null,t.nameLabel=null,t.rankLabel=null,t.medalSprite=null,t.scoreLabel=null,t.medalFrames=[],t}return c(t,e),t.prototype.updateItem=function(e){var t=this;this.rankLabel.string=e.rank.toString(),this.nameLabel.string=e.nick_name,this.scoreLabel.string=e.score.toString(),e.rank>0&&e.rank<=3?(this.medalSprite.spriteFrame=this.medalFrames[e.rank-1],this.medalSprite.node.active=!0):this.medalSprite.node.active=!1,this.getAvatar(e.head_url).then(function(e){t.avatar.spriteFrame=e}).catch(function(e){cc.error("\u52a0\u8f7d\u5934\u50cf\u5931\u8d25:",e)})},t.prototype.getAvatar=function(e){return new Promise(function(t){if(e){var o=wx.createImage();o.src=e,o.onload=function(){var e=new cc.Texture2D;e.initWithElement(o),e.handleLoadedTexture(),t(new cc.SpriteFrame(e))}}else t(null)})},s([p(cc.Sprite)],t.prototype,"avatar",void 0),s([p(cc.Label)],t.prototype,"nameLabel",void 0),s([p(cc.Label)],t.prototype,"rankLabel",void 0),s([p(cc.Sprite)],t.prototype,"medalSprite",void 0),s([p(cc.Label)],t.prototype,"scoreLabel",void 0),s([p([cc.SpriteFrame])],t.prototype,"medalFrames",void 0),s([u],t)}(cc.Component);i.default=d,cc._RF.pop(),cc._RF.pop()},{}],CollectionItem_Theme:[function(e,t,o){"use strict";cc._RF.push(t,"932afsRentBUKDOskzaEp9U","CollectionItem_Theme");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"932afsRentBUKDOskzaEp9U","CollectionItem_Theme");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("const"),p=n("ThemeDataManager"),d=n("SubItem_Theme"),f=n("CollectionData"),h=cc._decorator,y=h.ccclass,m=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.subItems=[],t.index=0,t}return s(t,e),t.prototype.updateItem=function(e){for(var t=[],o=[],n=0,i=f.themeShowOrder;n<i.length;n++){var r=i[n];1==p.default.ThemeUnlockMap[r]?t.push(Number(r)):o.push(Number(r))}t.sort(function(e,t){return f.themeShowOrder.indexOf(e)-f.themeShowOrder.indexOf(t)}),o.sort(function(e,t){return f.themeShowOrder.indexOf(e)-f.themeShowOrder.indexOf(t)});for(var a=t.concat(o),c=0;c<2&&this.index!==e;++c)a[2*(this.index-1)+c]===p.default.CurrentSelectedThemeIndex&&cc.director.emit(u.EventNames.UpdateAnimalSelection);for(this.index=e,c=0;c<2;++c){var s=a[2*(e-1)+c];t.includes(s)?(this.subItems[c].node.opacity=255,this.subItems[c].updateIndex(s,!0)):o.includes(s)?(this.subItems[c].node.opacity=255,this.subItems[c].updateIndex(s,!1)):this.subItems[c].node.opacity=0}},l([m([d.default])],t.prototype,"subItems",void 0),l([y],t)}(cc.Component);r.default=g,cc._RF.pop(),cc._RF.pop()},{}],CollectionManager:[function(t,o,n){"use strict";cc._RF.push(o,"b1175OVw3JCz4u6eRNALKW2","CollectionManager");var i=t,r=o,a=n;cc._RF.push(r,"b1175OVw3JCz4u6eRNALKW2","CollectionManager"),Object.defineProperty(a,"__esModule",{value:!0});var c=i("CommonData"),s=i("FinishEffectDataManager"),l=i("GameManager"),u=i("ThemeDataManager"),p=i("SignInManager"),d=i("CollectionData"),f=function(){function t(){}return Object.defineProperty(t,"characterPriceMap",{get:function(){return 1==p.default.instance.getMonth()&&(this._characterPriceMap[7]=0),t._characterPriceMap},enumerable:!1,configurable:!0}),Object.defineProperty(t,"capPriceMap",{get:function(){return 1==p.default.instance.getMonth()&&(this._capPriceMap[38]=0,this._capPriceMap[39]=0),t._capPriceMap},enumerable:!1,configurable:!0}),t.reportUnlockProgress=function(){var e=0,o=t.capCollectionList.length;for(var n in t.CapUnlockMap)t.CapUnlockMap[n]&&e++;var i=e+"/"+o,r=0,a=t.characterCollectionList.length;for(var n in t.CharacterUnlockMap)t.CharacterUnlockMap[n]&&r++;var d=r+"/"+a,f=c.default.CurrentUnlockIndex-1+"/"+c.default.collectionList.length,h=0,y=0;for(var n in u.default.ThemeUnlockMap)"string"==typeof n&&(h++,1==u.default.ThemeUnlockMap[n]&&y++);var m=y+"/"+h;for(var n in y=0,h=0,s.default.FinishEffectUnlockMap)h++,1==s.default.FinishEffectUnlockMap[n]&&y++;var g=y+"/"+h;l.default.platform.reportCollectionEvent("Drink",f,"",""),l.default.platform.reportCollectionEvent("Character",d,"",""),l.default.platform.reportCollectionEvent("Cap",i,"",""),l.default.platform.reportCollectionEvent("Background",m,"",""),l.default.platform.reportCollectionEvent("Effect",g,"",""),p.default.instance.reportEventData()},Object.defineProperty(t,"CapUnlockMap",{get:function(){var e=t.getStorage("capUnlockMap");if(e){var o=JSON.parse(e);for(var n in t._capUnlockMap)null==o[n]&&(o[n]=t._capUnlockMap[n]);t._capUnlockMap=o}return t._capUnlockMap},enumerable:!1,configurable:!0}),t.setCapUnlockMap=function(e,o){var n=t.getStorage("capUnlockMap");n&&(t._capUnlockMap=JSON.parse(n)),t._capUnlockMap[e]=o,t.saveCapUnlockMap()},t.saveCapUnlockMap=function(){var e=JSON.stringify(t._capUnlockMap);t.setStorage("capUnlockMap",e)},Object.defineProperty(t,"CharacterUnlockMap",{get:function(){var e=t.getStorage("characterUnlockMap");if(e){var o=JSON.parse(e);for(var n in t._characterUnlockMap)null==o[n]&&(o[n]=t._characterUnlockMap[n]);t._characterUnlockMap=o}return t._characterUnlockMap},enumerable:!1,configurable:!0}),t.setCharacterUnlockMap=function(e,o){var n=t.getStorage("characterUnlockMap");n&&(t._characterUnlockMap=JSON.parse(n)),t._characterUnlockMap[e]=o,t.saveCharacterUnlockMap()},t.saveCharacterUnlockMap=function(){var e=JSON.stringify(t._characterUnlockMap);t.setStorage("characterUnlockMap",e)},Object.defineProperty(t,"UnlockWinCount",{get:function(){return null!==t.getStorage("UnlockWinCount")&&void 0!==t.getStorage("UnlockWinCount")&&""!==t.getStorage("UnlockWinCount")?(t._UnlockWinCount=parseInt(t.getStorage("UnlockWinCount")),t._UnlockWinCount):1},set:function(e){t.setStorage("UnlockWinCount",e)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CurrentCapByLevelIndex",{get:function(){return null!==t.getStorage("CurrentCapByLevelIndex")&&void 0!==t.getStorage("CurrentCapByLevelIndex")&&""!==t.getStorage("CurrentCapByLevelIndex")?(t._CurrentCapByLevelIndex=parseInt(t.getStorage("CurrentCapByLevelIndex")),t._CurrentCapByLevelIndex):1},set:function(e){t.setStorage("CurrentCapByLevelIndex",e),t._CurrentCapByLevelIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CurrentCapByWinStreakIndex",{get:function(){return null!==t.getStorage("CurrentCapByWinStreakIndex")&&void 0!==t.getStorage("CurrentCapByWinStreakIndex")&&""!==t.getStorage("CurrentCapByWinStreakIndex")?(t._CurrentCapByWinStreakIndex=parseInt(t.getStorage("CurrentCapByWinStreakIndex")),t._CurrentCapByWinStreakIndex):1},set:function(e){t.setStorage("CurrentCapByWinStreakIndex",e),t._CurrentCapByWinStreakIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SelectedCapIndex",{get:function(){return null!==t.getStorage("SelectedCapIndex")&&void 0!==t.getStorage("SelectedCapIndex")&&""!==t.getStorage("SelectedCapIndex")?(t._SelectedCapIndex=parseInt(t.getStorage("SelectedCapIndex")),t._SelectedCapIndex):0},set:function(e){t.setStorage("SelectedCapIndex",e),t._SelectedCapIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CurrentCharacterByLevelIndex",{get:function(){return null!==t.getStorage("CurrentCharacterByLevelIndex")&&void 0!==t.getStorage("CurrentCharacterByLevelIndex")&&""!==t.getStorage("CurrentCharacterByLevelIndex")?(t._CurrentCharacterByLevelIndex=parseInt(t.getStorage("CurrentCharacterByLevelIndex")),t._CurrentCharacterByLevelIndex):2},set:function(e){t.setStorage("CurrentCharacterByLevelIndex",e),t._CurrentCharacterByLevelIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CurrentCharacterByWinStreakIndex",{get:function(){return null!==t.getStorage("CurrentCharacterByWinStreakIndex")&&void 0!==t.getStorage("CurrentCharacterByWinStreakIndex")&&""!==t.getStorage("CurrentCharacterByWinStreakIndex")?(t._CurrentCharacterByWinStreakIndex=parseInt(t.getStorage("CurrentCharacterByWinStreakIndex")),t._CurrentCharacterByWinStreakIndex):1},set:function(e){t.setStorage("CurrentCharacterByWinStreakIndex",e),t._CurrentCharacterByWinStreakIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SelectedCharacterIndex",{get:function(){return null!==t.getStorage("SelectedCharacterIndex")&&void 0!==t.getStorage("SelectedCharacterIndex")&&""!==t.getStorage("SelectedCharacterIndex")?(t._SelectedCharacterIndex=parseInt(t.getStorage("SelectedCharacterIndex")),t._SelectedCharacterIndex):1},set:function(e){t.setStorage("SelectedCharacterIndex",e),t._SelectedCharacterIndex=e},enumerable:!1,configurable:!0}),t.syncProgress=function(){c.default.UnlockWinCount<0&&(c.default.UnlockWinCount=0);for(var e=0;e<t.unlockCapByWinStreakArray.length&&(t.CurrentCapByWinStreakIndex=e+1,!1!==t.CapUnlockMap[t.unlockCapByWinStreakArrayIndex[e]]);e++)e==t.unlockCapByWinStreakArray.length-1&&t.CurrentCapByWinStreakIndex++;for(e=0;e<t.unlockCharacterByWinStreakArray.length&&(t.CurrentCharacterByWinStreakIndex=e+1,!1!==t.CharacterUnlockMap[t.unlockCharacterByWinStreakArrayIndex[e]]);e++)e==t.unlockCharacterByWinStreakArray.length-1&&t.CurrentCharacterByWinStreakIndex++},t.setStorage=function(t,o){switch(e(o)){case"boolean":o=o?"true":"false"}cc.sys.localStorage.setItem(t,o)},t.getStorage=function(e){var t=cc.sys.localStorage.getItem(e);switch(t){case"true":t=!0;break;case"false":t=!1}return t},t.unlockCapByLevelArray=new Map,t.unlockCapByWinStreakArray=d.unlockCapByWinStreakArray,t.unlockCapByWinStreakArrayIndex=d.unlockCapByWinStreakArrayIndex,t.capCollectionList=d.capCollectionList,t.capNameMap=d.capNameMap,t._capUnlockMap=d._capUnlockMap,t.unlockCharacterByLevelArray=new Map,t.unlockCharacterByWinStreakArray=d.unlockCharacterByWinStreakArray,t.unlockCharacterByWinStreakArrayIndex=d.unlockCharacterByWinStreakArrayIndex,t.characterCollectionList=d.characterCollectionList,t.characterNameMap=d.characterNameMap,t._characterUnlockMap=d._characterUnlockMap,t._characterPriceMap=d._characterPriceMap,t._capPriceMap=d._capPriceMap,t._UnlockWinCount=1,t._CurrentCapByLevelIndex=1,t._CurrentCapByWinStreakIndex=1,t._SelectedCapIndex=0,t._CurrentCharacterByLevelIndex=2,t._CurrentCharacterByWinStreakIndex=1,t._SelectedCharacterIndex=1,t}();a.default=f,cc._RF.pop(),cc._RF.pop()},{}],CollectionPanel:[function(e,t,o){"use strict";cc._RF.push(t,"aff5aohlf9L8pta3PgE3ov9","CollectionPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"aff5aohlf9L8pta3PgE3ov9","CollectionPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("BasePanel"),p=n("AudioManager"),d=n("GameManager"),f=cc._decorator,h=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btn_home=null,t.titles=[],t.views=[],t}return s(t,e),t.prototype.show=function(e){this.init();var t=this.node;cc.director.emit("UpdateOpenPanelCount"),t&&(cc.Tween.stopAllByTarget(t),t.setPosition(0,-2170),t.scale=1,t.opacity=255,cc.tween(t).to(.4,{y:0},{easing:"sineOut"}).call(function(){e&&e()}).start())},t.prototype.onEnable=function(){d.default.platform.reportPageEvent("CollectionPage")},t.prototype.onBtn_home=function(){p.default.instance.playSFX(p.AudioRef.ClickButton),this.hide()},t.prototype.onBtn_Continue=function(){p.default.instance.playSFX(p.AudioRef.ClickButton),"Main"===cc.director.getScene().name?cc.director.loadScene("Game"):this.hide()},t.prototype.hide=function(e){var t=this,o=this.node;o&&(cc.Tween.stopAllByTarget(o),o.scale=1,o.opacity=255,cc.tween(o).to(.4,{y:-2170},{easing:"sineIn"}).call(function(){t.node.active=!1,e&&e(),cc.director.emit("UpdateOpenPanelCount")}).start())},t.prototype.onBtn_close=function(){this.hide()},t.prototype.onBtn_Cap=function(){if(!this.views[0].active){p.default.instance.playSFX(p.AudioRef.ClickButton);for(var e=0;e<this.titles.length;e++)this.titles[e].opacity=0;for(e=0;e<this.views.length;e++)this.views[e].active=!1;this.views[0].active=!0,this.titles[0].opacity=255}},t.prototype.onBtn_Animal=function(){if(!this.views[1].active){p.default.instance.playSFX(p.AudioRef.ClickButton);for(var e=0;e<this.titles.length;e++)this.titles[e].opacity=0;for(e=0;e<this.views.length;e++)this.views[e].active=!1;this.views[1].active=!0,this.titles[1].opacity=255}},t.prototype.onBtn_Theme=function(){if(!this.views[2].active){p.default.instance.playSFX(p.AudioRef.ClickButton);for(var e=0;e<this.titles.length;e++)this.titles[e].opacity=0;for(e=0;e<this.views.length;e++)this.views[e].active=!1;this.views[2].active=!0,this.titles[2].opacity=255}},t.prototype.onBtn_Effect=function(){if(!this.views[3].active){p.default.instance.playSFX(p.AudioRef.ClickButton);for(var e=0;e<this.titles.length;e++)this.titles[e].opacity=0;for(e=0;e<this.views.length;e++)this.views[e].active=!1;this.views[3].active=!0,this.titles[3].opacity=255}},l([y(cc.Node)],t.prototype,"btn_home",void 0),l([y([cc.Node])],t.prototype,"titles",void 0),l([y([cc.Node])],t.prototype,"views",void 0),l([h],t)}(u.default);r.default=m,cc._RF.pop(),cc._RF.pop()},{}],CollectionScroll_Animal:[function(e,t,o){"use strict";cc._RF.push(t,"03e99bLH2dAa6C79WNgxwRQ","CollectionScroll_Animal");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"03e99bLH2dAa6C79WNgxwRQ","CollectionScroll_Animal");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},p=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0});var d=n("CollectionItem_Animal"),f=n("const"),h=n("CollectionManager"),y=cc._decorator,m=y.ccclass,g=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.viewContent=null,t.maskNode=null,t.scroll=null,t.itemPrefab=null,t.startPos=null,t.cachePool=[],t.dataList=[],t.maxNum=4,t.itemHeight=470,t.initY=0,t.maxY=0,t.minY=0,t.needSize=0,t.visibleHeight=0,t.curOffset=0,t.miniIdx=0,t.showItemList=[],t.headList=[],t.selectionNode=null,t.text_progress=null,t}return s(t,e),t.prototype.updateSelectionNode=function(e){e&&(this.selectionNode.active=!0,this.selectionNode.parent=e,this.selectionNode.setPosition(0,200))},t.prototype.onLoad=function(){return u(this,void 0,void 0,function(){return p(this,function(){return this.startPos=cc.v2(this.viewContent.position.x,this.viewContent.position.y),this.visibleHeight=this.maskNode.getContentSize().height,this.scroll.node.on("scrolling",this.onScrolling.bind(this),this),[2]})})},t.prototype.onEnable=function(){cc.director.on(f.EventNames.UpdateAnimalSelection,this.updateSelectionNode,this),this.cachePool=[],this.dataList=[],this.viewContent.height=0,this.initY=-this.itemHeight/2,this.curOffset=0,this.miniIdx=0,this.showItemList=[];for(var e=0;e<h.default.characterCollectionList.length/2;e++)this.dataList.push(e+1);this.loadList(),this.startPos&&(this.viewContent.position=this.startPos),this.setProgressText()},t.prototype.setProgressText=function(){for(var e=0,t=1;t<=h.default.characterCollectionList.length;t++)h.default.CharacterUnlockMap[t]&&e++;this.text_progress.string="\u6536\u96c6\u8fdb\u5ea6:"+e.toString()+"/"+h.default.characterCollectionList.length.toString()},t.prototype.onDisable=function(){cc.director.off(f.EventNames.UpdateAnimalSelection,this.updateSelectionNode,this)},t.prototype.start=function(){},t.prototype.loadList=function(){this.viewContent.destroyAllChildren(),this.InitObjs(),this.needSize=this.dataList.length*this.itemHeight,this.viewContent.setContentSize(new cc.Size(this.viewContent.getContentSize().width,this.needSize))},t.prototype.InitObjs=function(){for(var e=0,t=0;t<this.maxNum&&this.dataList[t];t++){var o=cc.instantiate(this.itemPrefab);o.parent=this.viewContent,o.active=!0,e=this.initY-this.itemHeight*t,o.position=cc.v3(0,e),this.onRefresh(o,t+"",t),this.showItemList.push(o)}},t.prototype.countBorder=function(e){var t=this.visibleHeight;this.minY=e,this.maxY=e+t},t.prototype.refresh=function(){var e=this.curOffset,t=this.needSize;if(!(e<0||e+this.visibleHeight>=t)){var o=0;this.countBorder(e);var n=this.miniIdx,i=Math.floor(e/this.itemHeight);if(this.miniIdx!=i){var r=this.initY-this.itemHeight*i,a=this.initY-this.itemHeight*(i+this.maxNum),c=[],s=[];this.showItemList.forEach(function(e,t){e.position.y>r||e.position.y<=a?c.push(e.uuid):s.push(n+t)});for(var l=this.showItemList.length-1;l>=0;l--){var u=this.showItemList[l];c.indexOf(u.uuid)>=0&&(this.cachePool.push(u),this.showItemList.splice(l,1))}this.miniIdx=i;for(var p=0;p<this.maxNum;p++)o=this.miniIdx+p,s.indexOf(o)<0&&this.refreshItem(o,p)}}},t.prototype.refreshItem=function(e,t){if(!(e<0||e>=this.dataList.length)){var o,n=this.cachePool.pop();null!=n&&(o=this.initY-this.itemHeight*e,n.position=cc.v3(0,o),n.active=!0,this.onRefresh(n,t,e),this.showItemList.push(n),this.showItemList.sort(function(e,t){return-e.position.y+t.position.y}))}},t.prototype.onRefresh=function(e,t,o){console.log("onRefresh objIdx:",o,"dataList:",this.dataList),e.getComponent(d.default).updateItem(this.dataList[o])},t.prototype.onScrolling=function(){var e=this.scroll.getScrollOffset();this.curOffset=e.y,this.refresh()},l([g(cc.Node)],t.prototype,"viewContent",void 0),l([g(cc.Node)],t.prototype,"maskNode",void 0),l([g(cc.ScrollView)],t.prototype,"scroll",void 0),l([g(cc.Prefab)],t.prototype,"itemPrefab",void 0),l([g(cc.Node)],t.prototype,"selectionNode",void 0),l([g(cc.Label)],t.prototype,"text_progress",void 0),l([m],t)}(cc.Component);r.default=v,cc._RF.pop(),cc._RF.pop()},{}],CollectionScroll_Cap:[function(e,t,o){"use strict";cc._RF.push(t,"aa6e9gW6l1DJJn0/0uO0q/B","CollectionScroll_Cap");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"aa6e9gW6l1DJJn0/0uO0q/B","CollectionScroll_Cap");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},p=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0});var d=n("CollectionItem_Cap"),f=n("CollectionManager"),h=n("config"),y=cc._decorator,m=y.ccclass,g=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.viewContent=null,t.maskNode=null,t.scroll=null,t.itemPrefab=null,t.startPos=null,t.cachePool=[],t.dataList=[],t.maxNum=6,t.itemHeight=300,t.initY=0,t.maxY=0,t.minY=0,t.needSize=0,t.visibleHeight=0,t.curOffset=0,t.miniIdx=0,t.showItemList=[],t.headList=[],t.selectionNode=null,t.text_progress=null,t}return s(t,e),t.prototype.onLoad=function(){return u(this,void 0,void 0,function(){return p(this,function(){return this.startPos=cc.v2(this.viewContent.position.x,this.viewContent.position.y),this.visibleHeight=this.maskNode.getContentSize().height,this.scroll.node.on("scrolling",this.onScrolling.bind(this),this),[2]})})},t.prototype.updateSelectionNode=function(e){e?(this.selectionNode.active=!0,this.selectionNode.setParent(e),this.selectionNode.setPosition(0,130)):this.selectionNode.active=!1},t.prototype.onEnable=function(){this.cachePool=[],this.dataList=[],this.viewContent.height=0,this.initY=-this.itemHeight/2,this.curOffset=0,this.miniIdx=0,this.showItemList=[];var e=f.default.capCollectionList.length;h.currentPlatform===h.platformEnum.toutiao&&(e-=1);for(var t=0;t<e/3;t++)this.dataList.push(t+1);this.loadList(),this.startPos&&(this.viewContent.position=this.startPos),this.setProgressText()},t.prototype.setProgressText=function(){for(var e=0,t=1;t<=f.default.capCollectionList.length;t++)f.default.CapUnlockMap[t]&&e++;this.text_progress.string="\u6536\u96c6\u8fdb\u5ea6:"+e.toString()+"/"+f.default.capCollectionList.length.toString(),h.currentPlatform===h.platformEnum.toutiao&&(this.text_progress.string="\u6536\u96c6\u8fdb\u5ea6:"+e.toString()+"/"+(f.default.capCollectionList.length-1).toString())},t.prototype.start=function(){},t.prototype.loadList=function(){this.viewContent.destroyAllChildren(),this.InitObjs(),this.needSize=this.dataList.length*this.itemHeight,this.viewContent.setContentSize(new cc.Size(this.viewContent.getContentSize().width,this.needSize))},t.prototype.InitObjs=function(){for(var e=0,t=0;t<this.maxNum&&this.dataList[t];t++){var o=cc.instantiate(this.itemPrefab);o.parent=this.viewContent,o.active=!0,e=this.initY-this.itemHeight*t,o.position=cc.v3(0,e),this.onRefresh(o,t+"",t),this.showItemList.push(o)}},t.prototype.countBorder=function(e){var t=this.visibleHeight;this.minY=e,this.maxY=e+t},t.prototype.refresh=function(){var e=this.curOffset,t=this.needSize;if(!(e<0||e+this.visibleHeight>=t)){var o=0;this.countBorder(e);var n=this.miniIdx,i=Math.floor(e/this.itemHeight);if(this.miniIdx!=i){var r=this.initY-this.itemHeight*i,a=this.initY-this.itemHeight*(i+this.maxNum),c=[],s=[];this.showItemList.forEach(function(e,t){e.position.y>r||e.position.y<=a?c.push(e.uuid):s.push(n+t)});for(var l=this.showItemList.length-1;l>=0;l--){var u=this.showItemList[l];c.indexOf(u.uuid)>=0&&(this.cachePool.push(u),this.showItemList.splice(l,1))}this.miniIdx=i;for(var p=0;p<this.maxNum;p++)o=this.miniIdx+p,s.indexOf(o)<0&&this.refreshItem(o,p)}}},t.prototype.refreshItem=function(e,t){if(!(e<0||e>=this.dataList.length)){var o,n=this.cachePool.pop();null!=n&&(o=this.initY-this.itemHeight*e,n.position=cc.v3(0,o),n.active=!0,this.onRefresh(n,t,e),this.showItemList.push(n),this.showItemList.sort(function(e,t){return-e.position.y+t.position.y}))}},t.prototype.onRefresh=function(e,t,o){console.log("onRefresh objIdx:",o,"dataList:",this.dataList),e.getComponent(d.default).updateItem(this.dataList[o])},t.prototype.onScrolling=function(){var e=this.scroll.getScrollOffset();this.curOffset=e.y,this.refresh()},l([g(cc.Node)],t.prototype,"viewContent",void 0),l([g(cc.Node)],t.prototype,"maskNode",void 0),l([g(cc.ScrollView)],t.prototype,"scroll",void 0),l([g(cc.Prefab)],t.prototype,"itemPrefab",void 0),l([g(cc.Node)],t.prototype,"selectionNode",void 0),l([g(cc.Label)],t.prototype,"text_progress",void 0),l([m],t)}(cc.Component);r.default=v,cc._RF.pop(),cc._RF.pop()},{}],CollectionScroll_ChallengeRank:[function(e,t,o){"use strict";cc._RF.push(t,"81816cZZhBBpoOxqpXet5Ar","CollectionScroll_ChallengeRank");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"81816cZZhBBpoOxqpXet5Ar","CollectionScroll_ChallengeRank");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},p=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0});var d=n("CollectionItem_Rank"),f=n("Rankdata"),h=cc._decorator,y=h.ccclass,m=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.viewContent=null,t.maskNode=null,t.scroll=null,t.itemPrefab=null,t.startPos=null,t.cachePool=[],t.dataList=[],t.maxNum=9,t.itemHeight=105,t.initY=0,t.maxY=0,t.minY=0,t.needSize=0,t.visibleHeight=0,t.curOffset=0,t.miniIdx=0,t.showItemList=[],t.headList=[],t}return s(t,e),t.prototype.onLoad=function(){return u(this,void 0,void 0,function(){return p(this,function(){return this.startPos=cc.v2(this.viewContent.position.x,this.viewContent.position.y),this.visibleHeight=this.maskNode.getContentSize().height,this.scroll.node.on("scrolling",this.onScrolling.bind(this),this),[2]})})},t.prototype.onEnable=function(){this.cachePool=[],this.dataList=[],this.viewContent.height=0,this.initY=-this.itemHeight/2,this.curOffset=0,this.miniIdx=0,this.showItemList=[];for(var e=0;e<f.default.challengeRankDataList.length;e++)this.dataList.push(f.default.challengeRankDataList[e]);this.loadList(),this.startPos&&(this.viewContent.position=this.startPos)},t.prototype.start=function(){},t.prototype.loadList=function(){this.viewContent.destroyAllChildren(),this.InitObjs(),this.needSize=this.dataList.length*this.itemHeight,this.viewContent.setContentSize(new cc.Size(this.viewContent.getContentSize().width,this.needSize))},t.prototype.InitObjs=function(){for(var e=0,t=0;t<this.maxNum&&this.dataList[t];t++){var o=cc.instantiate(this.itemPrefab);o.parent=this.viewContent,o.active=!0,e=this.initY-this.itemHeight*t,o.position=cc.v3(0,e),this.onRefresh(o,t+"",t),this.showItemList.push(o)}},t.prototype.countBorder=function(e){var t=this.visibleHeight;this.minY=e,this.maxY=e+t},t.prototype.refresh=function(){var e=this.curOffset,t=this.needSize;if(!(e<0||e+this.visibleHeight>=t)){var o=0;this.countBorder(e);var n=this.miniIdx,i=Math.floor(e/this.itemHeight);if(this.miniIdx!=i){var r=this.initY-this.itemHeight*i,a=this.initY-this.itemHeight*(i+this.maxNum),c=[],s=[];this.showItemList.forEach(function(e,t){e.position.y>r||e.position.y<=a?c.push(e.uuid):s.push(n+t)});for(var l=this.showItemList.length-1;l>=0;l--){var u=this.showItemList[l];c.indexOf(u.uuid)>=0&&(this.cachePool.push(u),this.showItemList.splice(l,1))}this.miniIdx=i;for(var p=0;p<this.maxNum;p++)o=this.miniIdx+p,s.indexOf(o)<0&&this.refreshItem(o,p)}}},t.prototype.refreshItem=function(e,t){if(!(e<0||e>=this.dataList.length)){var o,n=this.cachePool.pop();null!=n&&(o=this.initY-this.itemHeight*e,n.position=cc.v3(0,o),n.active=!0,this.onRefresh(n,t,e),this.showItemList.push(n),this.showItemList.sort(function(e,t){return-e.position.y+t.position.y}))}},t.prototype.onRefresh=function(e,t,o){e.getComponent(d.default).updateItem(this.dataList[o])},t.prototype.onScrolling=function(){var e=this.scroll.getScrollOffset();this.curOffset=e.y,this.refresh()},l([m(cc.Node)],t.prototype,"viewContent",void 0),l([m(cc.Node)],t.prototype,"maskNode",void 0),l([m(cc.ScrollView)],t.prototype,"scroll",void 0),l([m(cc.Prefab)],t.prototype,"itemPrefab",void 0),l([y],t)}(cc.Component);r.default=g,cc._RF.pop(),cc._RF.pop()},{}],CollectionScroll_Drink:[function(e,t,o){"use strict";cc._RF.push(t,"da433Uz86tOkYt6TA+LSQo9","CollectionScroll_Drink");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"da433Uz86tOkYt6TA+LSQo9","CollectionScroll_Drink");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},p=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0});var d=n("CollectionItem_Drink"),f=n("CommonData"),h=cc._decorator,y=h.ccclass,m=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.viewContent=null,t.maskNode=null,t.scroll=null,t.itemPrefab=null,t.startPos=null,t.cachePool=[],t.dataList=[],t.maxNum=6,t.itemHeight=300,t.initY=0,t.maxY=0,t.minY=0,t.needSize=0,t.visibleHeight=0,t.curOffset=0,t.miniIdx=0,t.showItemList=[],t.headList=[],t.text_progress=null,t}return s(t,e),t.prototype.onLoad=function(){return u(this,void 0,void 0,function(){return p(this,function(){return this.startPos=cc.v2(this.viewContent.position.x,this.viewContent.position.y),this.visibleHeight=this.maskNode.getContentSize().height,this.scroll.node.on("scrolling",this.onScrolling.bind(this),this),[2]})})},t.prototype.onEnable=function(){this.cachePool=[],this.dataList=[],this.viewContent.height=0,this.initY=-this.itemHeight/2,this.curOffset=0,this.miniIdx=0,this.showItemList=[];var e=f.default.CurrentUnlockIndex;e>=f.default.collectionList.length+1&&(e=f.default.collectionList.length+1);for(var t=0;t<(e-1)/3;t++)this.dataList.push(t+1);this.loadList(),this.startPos&&(this.viewContent.position=this.startPos),this.setProgressText()},t.prototype.setProgressText=function(){var e=0;(e=f.default.CurrentUnlockIndex-1)>f.default.collectionList.length&&(e=f.default.collectionList.length),this.text_progress.string="\u6536\u96c6\u8fdb\u5ea6:"+e.toString()+"/"+f.default.collectionList.length.toString()},t.prototype.loadList=function(){this.viewContent.destroyAllChildren(),this.InitObjs(),this.needSize=this.dataList.length*this.itemHeight,this.viewContent.setContentSize(new cc.Size(this.viewContent.getContentSize().width,this.needSize))},t.prototype.InitObjs=function(){for(var e=0,t=0;t<this.maxNum&&this.dataList[t];t++){var o=cc.instantiate(this.itemPrefab);o.parent=this.viewContent,o.active=!0,e=this.initY-this.itemHeight*t,o.position=cc.v3(0,e),this.onRefresh(o,t+"",t),this.showItemList.push(o)}},t.prototype.countBorder=function(e){var t=this.visibleHeight;this.minY=e,this.maxY=e+t},t.prototype.refresh=function(){var e=this.curOffset,t=this.needSize;if(!(e<0||e+this.visibleHeight>=t)){var o=0;this.countBorder(e);var n=this.miniIdx,i=Math.floor(e/this.itemHeight);if(this.miniIdx!=i){var r=this.initY-this.itemHeight*i,a=this.initY-this.itemHeight*(i+this.maxNum),c=[],s=[];this.showItemList.forEach(function(e,t){e.position.y>r||e.position.y<=a?c.push(e.uuid):s.push(n+t)});for(var l=this.showItemList.length-1;l>=0;l--){var u=this.showItemList[l];c.indexOf(u.uuid)>=0&&(this.cachePool.push(u),this.showItemList.splice(l,1))}this.miniIdx=i;for(var p=0;p<this.maxNum;p++)o=this.miniIdx+p,s.indexOf(o)<0&&this.refreshItem(o,p)}}},t.prototype.refreshItem=function(e,t){if(!(e<0||e>=this.dataList.length)){var o,n=this.cachePool.pop();null!=n&&(o=this.initY-this.itemHeight*e,n.position=cc.v3(0,o),n.active=!0,this.onRefresh(n,t,e),this.showItemList.push(n),this.showItemList.sort(function(e,t){return-e.position.y+t.position.y}))}},t.prototype.onRefresh=function(e,t,o){e.getComponent(d.default).updateItem(this.dataList[o])},t.prototype.onScrolling=function(){var e=this.scroll.getScrollOffset();this.curOffset=e.y,this.refresh()},l([m(cc.Node)],t.prototype,"viewContent",void 0),l([m(cc.Node)],t.prototype,"maskNode",void 0),l([m(cc.ScrollView)],t.prototype,"scroll",void 0),l([m(cc.Prefab)],t.prototype,"itemPrefab",void 0),l([m(cc.Label)],t.prototype,"text_progress",void 0),l([y],t)}(cc.Component);r.default=g,cc._RF.pop(),cc._RF.pop()},{}],CollectionScroll_Effect:[function(e,t,o){"use strict";cc._RF.push(t,"48759N73S5N1IzMcE68FnQn","CollectionScroll_Effect");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"48759N73S5N1IzMcE68FnQn","CollectionScroll_Effect");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},p=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0});var d=n("CollectionItem_Effect"),f=n("const"),h=n("FinishEffectDataManager"),y=cc._decorator,m=y.ccclass,g=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.viewContent=null,t.maskNode=null,t.scroll=null,t.itemPrefab=null,t.startPos=null,t.cachePool=[],t.dataList=[],t.maxNum=6,t.itemHeight=470,t.initY=0,t.maxY=0,t.minY=0,t.needSize=0,t.visibleHeight=0,t.curOffset=0,t.miniIdx=0,t.showItemList=[],t.headList=[],t.selectionNode=null,t.text_progress=null,t}return s(t,e),t.prototype.updateSelectionNode=function(e){e&&(this.selectionNode.active=!0,this.selectionNode.parent=e,this.selectionNode.setPosition(0,200))},t.prototype.onLoad=function(){return u(this,void 0,void 0,function(){return p(this,function(){return this.startPos=cc.v2(this.viewContent.position.x,this.viewContent.position.y),this.visibleHeight=this.maskNode.getContentSize().height,this.scroll.node.on("scrolling",this.onScrolling.bind(this),this),[2]})})},t.prototype.onEnable=function(){cc.director.on(f.EventNames.UpdateAnimalSelection,this.updateSelectionNode,this),this.cachePool=[],this.dataList=[],this.viewContent.height=0,this.initY=-this.itemHeight/2,this.curOffset=0,this.miniIdx=0,this.showItemList=[];for(var e=0;e<Object.keys(h.default.FinishEffectNameMap).length/2;e++)this.dataList.push(e+1);this.loadList(),this.startPos&&(this.viewContent.position=this.startPos),this.setProgressText()},t.prototype.setProgressText=function(){var e=0,t=0;Object.entries(h.default.FinishEffectNameMap).forEach(function(o){var n=o[0];o[1],t++,h.default.FinishEffectUnlockMap[Number(n)]&&e++}),this.text_progress.string="\u6536\u96c6\u8fdb\u5ea6:"+e.toString()+"/"+t.toString()},t.prototype.onDisable=function(){cc.director.off(f.EventNames.UpdateAnimalSelection,this.updateSelectionNode,this)},t.prototype.start=function(){},t.prototype.loadList=function(){this.viewContent.destroyAllChildren(),this.InitObjs(),this.needSize=this.dataList.length*this.itemHeight,this.viewContent.setContentSize(new cc.Size(this.viewContent.getContentSize().width,this.needSize))},t.prototype.InitObjs=function(){for(var e=0,t=0;t<this.maxNum&&this.dataList[t];t++){var o=cc.instantiate(this.itemPrefab);o.parent=this.viewContent,o.active=!0,e=this.initY-this.itemHeight*t,o.position=cc.v3(0,e),this.onRefresh(o,t+"",t),this.showItemList.push(o)}},t.prototype.countBorder=function(e){var t=this.visibleHeight;this.minY=e,this.maxY=e+t},t.prototype.refresh=function(){var e=this.curOffset,t=this.needSize;if(!(e<0||e+this.visibleHeight>=t)){var o=0;this.countBorder(e);var n=this.miniIdx,i=Math.floor(e/this.itemHeight);if(this.miniIdx!=i){var r=this.initY-this.itemHeight*i,a=this.initY-this.itemHeight*(i+this.maxNum),c=[],s=[];this.showItemList.forEach(function(e,t){e.position.y>r||e.position.y<=a?c.push(e.uuid):s.push(n+t)});for(var l=this.showItemList.length-1;l>=0;l--){var u=this.showItemList[l];c.indexOf(u.uuid)>=0&&(this.cachePool.push(u),this.showItemList.splice(l,1))}this.miniIdx=i;for(var p=0;p<this.maxNum;p++)o=this.miniIdx+p,s.indexOf(o)<0&&this.refreshItem(o,p)}}},t.prototype.refreshItem=function(e,t){if(!(e<0||e>=this.dataList.length)){var o,n=this.cachePool.pop();null!=n&&(o=this.initY-this.itemHeight*e,n.position=cc.v3(0,o),n.active=!0,this.onRefresh(n,t,e),this.showItemList.push(n),this.showItemList.sort(function(e,t){return-e.position.y+t.position.y}))}},t.prototype.onRefresh=function(e,t,o){console.log("onRefresh objIdx:",o,"dataList:",this.dataList),e.getComponent(d.default).updateItem(this.dataList[o])},t.prototype.onScrolling=function(){var e=this.scroll.getScrollOffset();this.curOffset=e.y,this.refresh()},l([g(cc.Node)],t.prototype,"viewContent",void 0),l([g(cc.Node)],t.prototype,"maskNode",void 0),l([g(cc.ScrollView)],t.prototype,"scroll",void 0),l([g(cc.Prefab)],t.prototype,"itemPrefab",void 0),l([g(cc.Node)],t.prototype,"selectionNode",void 0),l([g(cc.Label)],t.prototype,"text_progress",void 0),l([m],t)}(cc.Component);r.default=v,cc._RF.pop(),cc._RF.pop()},{}],CollectionScroll_Rank:[function(e,t,o){"use strict";cc._RF.push(t,"6744aaEK8hCLpH7VjTJvO62","CollectionScroll_Rank");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"6744aaEK8hCLpH7VjTJvO62","CollectionScroll_Rank");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},p=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0});var d=n("CollectionItem_Rank"),f=n("Rankdata"),h=cc._decorator,y=h.ccclass,m=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.viewContent=null,t.maskNode=null,t.scroll=null,t.itemPrefab=null,t.startPos=null,t.cachePool=[],t.dataList=[],t.maxNum=9,t.itemHeight=105,t.initY=0,t.maxY=0,t.minY=0,t.needSize=0,t.visibleHeight=0,t.curOffset=0,t.miniIdx=0,t.showItemList=[],t.headList=[],t}return s(t,e),t.prototype.onLoad=function(){return u(this,void 0,void 0,function(){return p(this,function(){return this.startPos=cc.v2(this.viewContent.position.x,this.viewContent.position.y),this.visibleHeight=this.maskNode.getContentSize().height,this.scroll.node.on("scrolling",this.onScrolling.bind(this),this),[2]})})},t.prototype.onEnable=function(){this.cachePool=[],this.dataList=[],this.viewContent.height=0,this.initY=-this.itemHeight/2,this.curOffset=0,this.miniIdx=0,this.showItemList=[];for(var e=0;e<f.default.rankDataList.length;e++)this.dataList.push(f.default.rankDataList[e]);this.loadList(),this.startPos&&(this.viewContent.position=this.startPos)},t.prototype.start=function(){},t.prototype.loadList=function(){this.viewContent.destroyAllChildren(),this.InitObjs(),this.needSize=this.dataList.length*this.itemHeight,this.viewContent.setContentSize(new cc.Size(this.viewContent.getContentSize().width,this.needSize))},t.prototype.InitObjs=function(){for(var e=0,t=0;t<this.maxNum&&this.dataList[t];t++){var o=cc.instantiate(this.itemPrefab);o.parent=this.viewContent,o.active=!0,e=this.initY-this.itemHeight*t,o.position=cc.v3(0,e),this.onRefresh(o,t+"",t),this.showItemList.push(o)}},t.prototype.countBorder=function(e){var t=this.visibleHeight;this.minY=e,this.maxY=e+t},t.prototype.refresh=function(){var e=this.curOffset,t=this.needSize;if(!(e<0||e+this.visibleHeight>=t)){var o=0;this.countBorder(e);var n=this.miniIdx,i=Math.floor(e/this.itemHeight);if(this.miniIdx!=i){var r=this.initY-this.itemHeight*i,a=this.initY-this.itemHeight*(i+this.maxNum),c=[],s=[];this.showItemList.forEach(function(e,t){e.position.y>r||e.position.y<=a?c.push(e.uuid):s.push(n+t)});for(var l=this.showItemList.length-1;l>=0;l--){var u=this.showItemList[l];c.indexOf(u.uuid)>=0&&(this.cachePool.push(u),this.showItemList.splice(l,1))}this.miniIdx=i;for(var p=0;p<this.maxNum;p++)o=this.miniIdx+p,s.indexOf(o)<0&&this.refreshItem(o,p)}}},t.prototype.refreshItem=function(e,t){if(!(e<0||e>=this.dataList.length)){var o,n=this.cachePool.pop();null!=n&&(o=this.initY-this.itemHeight*e,n.position=cc.v3(0,o),n.active=!0,this.onRefresh(n,t,e),this.showItemList.push(n),this.showItemList.sort(function(e,t){return-e.position.y+t.position.y}))}},t.prototype.onRefresh=function(e,t,o){e.getComponent(d.default).updateItem(this.dataList[o])},t.prototype.onScrolling=function(){var e=this.scroll.getScrollOffset();this.curOffset=e.y,this.refresh()},l([m(cc.Node)],t.prototype,"viewContent",void 0),l([m(cc.Node)],t.prototype,"maskNode",void 0),l([m(cc.ScrollView)],t.prototype,"scroll",void 0),l([m(cc.Prefab)],t.prototype,"itemPrefab",void 0),l([y],t)}(cc.Component);r.default=g,cc._RF.pop(),cc._RF.pop()},{}],CollectionScroll_Theme:[function(e,t,o){"use strict";cc._RF.push(t,"f27feFoiNdM/4mDrF8cbWDf","CollectionScroll_Theme");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"f27feFoiNdM/4mDrF8cbWDf","CollectionScroll_Theme");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},p=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0});var d=n("CollectionItem_Theme"),f=n("const"),h=n("ThemeDataManager"),y=cc._decorator,m=y.ccclass,g=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.viewContent=null,t.maskNode=null,t.scroll=null,t.itemPrefab=null,t.startPos=null,t.cachePool=[],t.dataList=[],t.maxNum=6,t.itemHeight=470,t.initY=0,t.maxY=0,t.minY=0,t.needSize=0,t.visibleHeight=0,t.curOffset=0,t.miniIdx=0,t.showItemList=[],t.headList=[],t.selectionNode=null,t.text_progress=null,t}return s(t,e),t.prototype.updateSelectionNode=function(e){e&&(this.selectionNode.active=!0,this.selectionNode.parent=e,this.selectionNode.setPosition(0,200))},t.prototype.onLoad=function(){return u(this,void 0,void 0,function(){return p(this,function(){return this.startPos=cc.v2(this.viewContent.position.x,this.viewContent.position.y),this.visibleHeight=this.maskNode.getContentSize().height,this.scroll.node.on("scrolling",this.onScrolling.bind(this),this),[2]})})},t.prototype.onEnable=function(){cc.director.on(f.EventNames.UpdateAnimalSelection,this.updateSelectionNode,this),this.cachePool=[],this.dataList=[],this.viewContent.height=0,this.initY=-this.itemHeight/2,this.curOffset=0,this.miniIdx=0,this.showItemList=[];for(var e=0;e<Object.keys(h.default.ThemeNameMap).length/2;e++)this.dataList.push(e+1);this.loadList(),this.startPos&&(this.viewContent.position=this.startPos),this.setProgressText()},t.prototype.setProgressText=function(){var e=0,t=0;Object.entries(h.default.ThemeUnlockMap).forEach(function(o){var n=o[0];o[1],n.length>1&&(t++,h.default.ThemeUnlockMap[n]&&e++)}),this.text_progress.string="\u6536\u96c6\u8fdb\u5ea6:"+e.toString()+"/"+t.toString()},t.prototype.onDisable=function(){cc.director.off(f.EventNames.UpdateAnimalSelection,this.updateSelectionNode,this)},t.prototype.start=function(){},t.prototype.loadList=function(){this.viewContent.destroyAllChildren(),this.InitObjs(),this.needSize=this.dataList.length*this.itemHeight,this.viewContent.setContentSize(new cc.Size(this.viewContent.getContentSize().width,this.needSize))},t.prototype.InitObjs=function(){for(var e=0,t=0;t<this.maxNum&&this.dataList[t];t++){var o=cc.instantiate(this.itemPrefab);o.parent=this.viewContent,o.active=!0,e=this.initY-this.itemHeight*t,o.position=cc.v3(0,e),this.onRefresh(o,t+"",t),this.showItemList.push(o)}},t.prototype.countBorder=function(e){var t=this.visibleHeight;this.minY=e,this.maxY=e+t},t.prototype.refresh=function(){var e=this.curOffset,t=this.needSize;if(!(e<0||e+this.visibleHeight>=t)){var o=0;this.countBorder(e);var n=this.miniIdx,i=Math.floor(e/this.itemHeight);if(this.miniIdx!=i){var r=this.initY-this.itemHeight*i,a=this.initY-this.itemHeight*(i+this.maxNum),c=[],s=[];this.showItemList.forEach(function(e,t){e.position.y>r||e.position.y<=a?c.push(e.uuid):s.push(n+t)});for(var l=this.showItemList.length-1;l>=0;l--){var u=this.showItemList[l];c.indexOf(u.uuid)>=0&&(this.cachePool.push(u),this.showItemList.splice(l,1))}this.miniIdx=i;for(var p=0;p<this.maxNum;p++)o=this.miniIdx+p,s.indexOf(o)<0&&this.refreshItem(o,p)}}},t.prototype.refreshItem=function(e,t){if(!(e<0||e>=this.dataList.length)){var o,n=this.cachePool.pop();null!=n&&(o=this.initY-this.itemHeight*e,n.position=cc.v3(0,o),n.active=!0,this.onRefresh(n,t,e),this.showItemList.push(n),this.showItemList.sort(function(e,t){return-e.position.y+t.position.y}))}},t.prototype.onRefresh=function(e,t,o){console.log("onRefresh objIdx:",o,"dataList:",this.dataList),e.getComponent(d.default).updateItem(this.dataList[o])},t.prototype.onScrolling=function(){var e=this.scroll.getScrollOffset();this.curOffset=e.y,this.refresh()},l([g(cc.Node)],t.prototype,"viewContent",void 0),l([g(cc.Node)],t.prototype,"maskNode",void 0),l([g(cc.ScrollView)],t.prototype,"scroll",void 0),l([g(cc.Prefab)],t.prototype,"itemPrefab",void 0),l([g(cc.Node)],t.prototype,"selectionNode",void 0),l([g(cc.Label)],t.prototype,"text_progress",void 0),l([m],t)}(cc.Component);r.default=v,cc._RF.pop(),cc._RF.pop()},{}],CollectionUnlockItem:[function(e,t){"use strict";cc._RF.push(t,"dc951OM1ChEJIcWwDpvwx5d","CollectionUnlockItem");var o=t;cc._RF.push(o,"dc951OM1ChEJIcWwDpvwx5d","CollectionUnlockItem"),cc._RF.pop(),cc._RF.pop()},{}],CommonData_SS:[function(e,t,o){"use strict";cc._RF.push(t,"9f33fbFhIRDm5cgSMwFDGLR","CommonData_SS");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"9f33fbFhIRDm5cgSMwFDGLR","CommonData_SS");var a=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(i,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,l=(c.property,function(){function e(){}return Object.defineProperty(e,"ifOver3MinWatchingAd",{get:function(){return(new Date).getTime()-this.lastTimeWatchingAd>18e4},enumerable:!1,configurable:!0}),e.ifPadFit=!1,e.openId="",e.appId="",e.ScrewSortGame=null,e.ScrewSortCtrl=null,e.ifOpenBySidebar=!1,e.sceneId="undefined",e.userData=null,e.gameMode=cc.Enum({normal:"normal",configured:"configured"}),e.mode="null",e.difficultyData="null",e.curScene="start",e.curPanelCount=0,e.ifOpenAuto=!1,e.ifSkipAd=!1,e.ifTestLevel=!1,e.ifOpenBlock=!1,e.collectShopList=["\u767e\u8d27\u5e97","\u529e\u516c\u697c","\u4fbf\u5229\u5e97","\u51b0\u6dc7\u6dcb\u5e97","\u73bb\u7483\u9910\u5385","\u8336\u9910\u5385","\u5382\u623f","\u7535\u8bdd\u4ead","\u7535\u5f71\u9662","\u52a8\u7269\u533b\u9662","\u72ec\u680b\u5c0f\u9662","\u670d\u88c5\u5e97","\u6c49\u5821\u5e97","\u8d27\u4ed3","\u5bb6\u5177\u5382","\u6559\u5802","\u8b66\u5bdf\u5c40","\u9152\u5427","\u5496\u5561\u8336\u9910\u9986","\u5496\u5561\u5e97","\u5feb\u9910\u5e97","\u5feb\u95ea\u5e97","\u9732\u5929\u9910\u9986","\u732b\u5496","\u7f8e\u5f0f\u522b\u5885","\u9762\u5305\u5e97","\u5976\u8336\u5e97","\u62ab\u8428\u5e97","\u70ed\u72d7\u5e97","\u65e5\u7528\u54c1\u5e97","\u5546\u573a","\u5546\u54c1\u623f","\u5546\u52a1\u5927\u53a6","\u5546\u52a1\u697c","\u793e\u533a\u4e2d\u5fc3","\u6c34\u5382","\u4f53\u80b2\u5546\u5e97","\u751c\u54c1\u5c4b","\u505c\u8f66\u573a","\u73a9\u5177\u5e97","\u897f\u9910\u5385","\u6d88\u9632\u5385","\u5c0f\u5382\u623f","\u5c0f\u5546\u94fa","\u5c0f\u6d0b\u623f","\u5c0f\u4f4f\u5b85","\u978b\u5e97","\u7259\u79d1\u533b\u9662","\u533b\u9662","\u94f6\u884c","\u6742\u8d27\u94fa","\u70b8\u9e21\u5e97","\u5c55\u89c8\u9986","\u81ea\u52a9\u5e97","\u4f11\u95f2\u9910\u5385","\u5c0f\u533a\u9910\u5385","\u5c0f\u533a\u5496\u5561","\u8857\u5934\u5496\u5561","\u8001\u793e\u533a\u9910\u9986","\u65e7\u5c0f\u533a\u697c","\u98df\u54c1\u767e\u8d27\u5e97","\u65b0\u6f6e\u5496\u5561\u5e97","\u84dd\u8272\u767e\u8d27\u5e97","\u81ea\u7136\u98ce\u4f4f\u5b85","\u8001\u793e\u533a\u767e\u8d27","\u84dd\u8272\u5c0f\u5e97\u94fa","\u81ea\u7136\u98ce\u9910\u5385","\u767e\u5e74\u8001\u94fa","\u6e05\u65b0\u9910\u5385","\u5feb\u9910\u5496\u5561\u5e97","\u793e\u533a\u533b\u9662","\u4e09\u7532\u533b\u9662","\u5ea6\u5047\u6751\u767e\u8d27","\u73bb\u7483\u5546\u573a","\u6a58\u5b50\u4e3b\u9898\u5e97","\u5ea6\u5047\u6751\u5c0f\u94fa","\u57ce\u4e2d\u5c0f\u5e97\u94fa","\u9ad8\u7aef\u5496\u5561\u5385","\u5361\u5e03\u5947\u8bfa\u5e97","\u7eff\u8272\u9910\u5385","\u6797\u4e2d\u5c0f\u5e97","\u65e0\u4eba\u767e\u8d27\u5e97","\u9732\u53f0\u5496\u5561\u5385","\u95f9\u533a\u767e\u8d27\u5e97","\u5927\u9662\u522b\u5885","\u73bb\u7483\u9876\u505c\u8f66\u573a","\u73bb\u7483\u9876\u6d17\u8f66\u5e97","\u53cc\u5c42\u6d17\u8f66\u5e97","\u6d17\u8f66\u5e97","\u7f8e\u5f0f\u6c49\u5821\u5e97","\u6d88\u9632\u8f66\u7ad9","\u5feb\u9910\u5496\u5561","\u751c\u7b52\u5e97","\u8857\u8fb9\u5c45\u6c11\u697c","L\u5f62\u5c45\u6c11\u697c","\u8def\u8fb9\u70e7\u70e4\u5e97","\u81ea\u884c\u8f66\u5e97","\u7cbe\u88c5\u65e9\u9910\u5e97","\u9999\u6c34\u4f53\u9a8c\u5e97","\u65e7\u8f66\u5e93"],a([s],e)}());i.default=l,cc._RF.pop(),cc._RF.pop()},{}],CommonData:[function(e,t,o){"use strict";cc._RF.push(t,"fd53f560o1BAY8KT55kfwOP","CommonData");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"fd53f560o1BAY8KT55kfwOP","CommonData"),Object.defineProperty(r,"__esModule",{value:!0});var c=n("CollectionManager"),s=function(){function e(){}return Object.defineProperty(e,"isNewPlayer",{get:function(){return null===e.getStorage("isNewPlayer")||void 0===e.getStorage("isNewPlayer")||""===e.getStorage("isNewPlayer")||(e._isNewPlayer=e.getStorage("isNewPlayer"),e._isNewPlayer)},set:function(t){e.setStorage("isNewPlayer",t),e._isNewPlayer=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"TestCounter",{get:function(){return e.ifTestCounter},set:function(t){e.setStorage("TestCounter",t),e.ifTestCounter=t,e.ifTestCounter>20&&1==e.playerType&&(e.ifTest=!e.ifTest,e.ifSkipAd=!e.ifSkipAd)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"inGameShowSubUpdateNoticeTimes",{get:function(){return null!==e.getStorage("inGameShowSubUpdateNoticeTimes")&&void 0!==e.getStorage("inGameShowSubUpdateNoticeTimes")&&""!==e.getStorage("inGameShowSubUpdateNoticeTimes")?(e._inGameShowSubUpdateNoticeTimes=parseInt(e.getStorage("inGameShowSubUpdateNoticeTimes")),e._inGameShowSubUpdateNoticeTimes):2},set:function(t){e.setStorage("inGameShowSubUpdateNoticeTimes",t),e._inGameShowSubUpdateNoticeTimes=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LastShowSubUpdateDate",{get:function(){return null!==e.getStorage("LastShowSubUpdateDate")&&void 0!==e.getStorage("LastShowSubUpdateDate")&&""!==e.getStorage("LastShowSubUpdateDate")?(e._lastShowSubUpdateDate=e.getStorage("LastShowSubUpdateDate"),e._lastShowSubUpdateDate):""},set:function(t){e.setStorage("LastShowSubUpdateDate",t),e._lastShowSubUpdateDate=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"MusicOn",{get:function(){return null===e.getStorage("MusicOn")||void 0===e.getStorage("MusicOn")||""===e.getStorage("MusicOn")||(e._MusicOn=e.getStorage("MusicOn"),e._MusicOn)},set:function(t){e.setStorage("MusicOn",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SoundOn",{get:function(){return null===e.getStorage("SoundOn")||void 0===e.getStorage("SoundOn")||""===e.getStorage("SoundOn")||(e._SoundOn=e.getStorage("SoundOn"),e._SoundOn)},set:function(t){e.setStorage("SoundOn",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"VibrationOn",{get:function(){return null===e.getStorage("VibrationOn")||void 0===e.getStorage("VibrationOn")||""===e.getStorage("VibrationOn")||(e._VibrationOn=e.getStorage("VibrationOn"),e._VibrationOn)},set:function(t){e.setStorage("VibrationOn",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"OrderNum",{get:function(){return null!==e.getStorage("OrderNum")&&void 0!==e.getStorage("OrderNum")&&""!==e.getStorage("OrderNum")?(e._OrderNum=parseInt(e.getStorage("OrderNum")),e._OrderNum):0},set:function(t){e.setStorage("OrderNum",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ifPlayedMasked",{get:function(){return null!==e.getStorage("ifPlayedMasked")&&void 0!==e.getStorage("ifPlayedMasked")&&""!==e.getStorage("ifPlayedMasked")&&(e._ifPlayedMasked=e.getStorage("ifPlayedMasked"),e._ifPlayedMasked)},set:function(t){e.setStorage("ifPlayedMasked",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ifPlayedBombCup",{get:function(){return null!==e.getStorage("ifPlayedBombCup")&&void 0!==e.getStorage("ifPlayedBombCup")&&""!==e.getStorage("ifPlayedBombCup")&&(e._ifPlayedBombCup=e.getStorage("ifPlayedBombCup"),e._ifPlayedBombCup)},set:function(t){e.setStorage("ifPlayedBombCup",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ifPlayedAbsorbCup",{get:function(){return null!==e.getStorage("ifPlayedAbsorbCup")&&void 0!==e.getStorage("ifPlayedAbsorbCup")&&""!==e.getStorage("ifPlayedAbsorbCup")&&(e._ifPlayedAbsorbCup=e.getStorage("ifPlayedAbsorbCup"),e._ifPlayedAbsorbCup)},set:function(t){e.setStorage("ifPlayedAbsorbCup",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ifPlayedChangeColorCup",{get:function(){return null!==e.getStorage("ifPlayedChangeColorCup")&&void 0!==e.getStorage("ifPlayedChangeColorCup")&&""!==e.getStorage("ifPlayedChangeColorCup")&&(e._ifPlayedChangeColorCup=e.getStorage("ifPlayedChangeColorCup"),e._ifPlayedChangeColorCup)},set:function(t){e.setStorage("ifPlayedChangeColorCup",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ifPlayedLockCup",{get:function(){return null!==e.getStorage("ifPlayedLockCup")&&void 0!==e.getStorage("ifPlayedLockCup")&&""!==e.getStorage("ifPlayedLockCup")&&(e._ifPlayedLockCup=e.getStorage("ifPlayedLockCup"),e._ifPlayedLockCup)},set:function(t){e.setStorage("ifPlayedLockCup",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"IfReadOldUserLevel",{get:function(){return e._IfReadOldUserLevel},set:function(t){e._IfReadOldUserLevel=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"oldUserLevel",{get:function(){return null!==e.getStorage("oldUserLevel")&&void 0!==e.getStorage("oldUserLevel")&&""!==e.getStorage("oldUserLevel")?(e._oldUserLevel=parseInt(e.getStorage("oldUserLevel")),e._oldUserLevel):1},set:function(t){e.setStorage("oldUserLevel",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Level",{get:function(){return null!==e.getStorage("Level")&&void 0!==e.getStorage("Level")&&""!==e.getStorage("Level")?(e._Level=parseInt(e.getStorage("Level")),e._Level):1},set:function(t){console.error("set level:",t),e.setStorage("Level",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"CurrentLevel",{get:function(){return null!==e.getStorage("CurrentLevel")&&void 0!==e.getStorage("CurrentLevel")&&""!==e.getStorage("CurrentLevel")?(e._CurrentLevel=parseInt(e.getStorage("CurrentLevel")),e._CurrentLevel):1},set:function(t){e.setStorage("CurrentLevel",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"challengeList",{get:function(){return this._challengeList},set:function(e){this._challengeList=e,cc.sys.localStorage.setItem("challengeList",JSON.stringify(e))},enumerable:!1,configurable:!0}),e.loadChallengeLevel=function(){var e=cc.sys.localStorage.getItem("challengeList");e&&(this._challengeList=JSON.parse(e))},e.removeChallengeLevel=function(){this._challengeList.splice(0,1),this.challengeList=this._challengeList},Object.defineProperty(e,"challengeList0",{get:function(){return this._challengeList0},set:function(e){this._challengeList0=e,cc.sys.localStorage.setItem("challengeList0",JSON.stringify(e))},enumerable:!1,configurable:!0}),e.loadChallengeLevel0=function(){var e=cc.sys.localStorage.getItem("challengeList0");e&&(this._challengeList0=JSON.parse(e))},e.removeChallengeLevel0=function(){this._challengeList0.splice(0,1),this.challengeList0=this._challengeList0},Object.defineProperty(e,"challengeList1",{get:function(){return this._challengeList1},set:function(e){this._challengeList1=e,cc.sys.localStorage.setItem("challengeList1",JSON.stringify(e))},enumerable:!1,configurable:!0}),e.loadChallengeLevel1=function(){var e=cc.sys.localStorage.getItem("challengeList1");e&&(this._challengeList1=JSON.parse(e))},e.removeChallengeLevel1=function(){this._challengeList1.splice(0,1),this.challengeList1=this._challengeList1},Object.defineProperty(e,"challengeList2",{get:function(){return this._challengeList2},set:function(e){this._challengeList2=e,cc.sys.localStorage.setItem("challengeList2",JSON.stringify(e))},enumerable:!1,configurable:!0}),e.loadChallengeLevel2=function(){var e=cc.sys.localStorage.getItem("challengeList2");e&&(this._challengeList2=JSON.parse(e))},e.removeChallengeLevel2=function(){this._challengeList2.splice(0,1),this.challengeList2=this._challengeList2},Object.defineProperty(e,"challengeList3",{get:function(){return this._challengeList3},set:function(e){this._challengeList3=e,cc.sys.localStorage.setItem("challengeList3",JSON.stringify(e))},enumerable:!1,configurable:!0}),e.loadChallengeLevel3=function(){var e=cc.sys.localStorage.getItem("challengeList3");e&&(this._challengeList3=JSON.parse(e))},e.removeChallengeLevel3=function(){this._challengeList3.splice(0,1),this.challengeList3=this._challengeList3},Object.defineProperty(e,"LevelChallenge",{get:function(){return null!==e.getStorage("LevelChallenge")&&void 0!==e.getStorage("LevelChallenge")&&""!==e.getStorage("LevelChallenge")?(e._LevelChallenge=parseInt(e.getStorage("LevelChallenge")),e._LevelChallenge):1},set:function(t){e.setStorage("LevelChallenge",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ChallengeModeDifficulty",{get:function(){return null!==e.getStorage("ChallengeModeDifficulty")&&void 0!==e.getStorage("ChallengeModeDifficulty")&&""!==e.getStorage("ChallengeModeDifficulty")?(e._ChallengeModeDifficulty=e.getStorage("ChallengeModeDifficulty"),e._ChallengeModeDifficulty):""},set:function(t){e.setStorage("ChallengeModeDifficulty",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LevelModeMultiple",{get:function(){return null!==e.getStorage("LevelModeMultiple")&&void 0!==e.getStorage("LevelModeMultiple")&&""!==e.getStorage("LevelModeMultiple")?(e._LevelModeMultiple=parseInt(e.getStorage("LevelModeMultiple")),e._LevelModeMultiple):1},set:function(t){e.setStorage("LevelModeMultiple",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LevelModeFillLong",{get:function(){return null!==e.getStorage("LevelModeFillLong")&&void 0!==e.getStorage("LevelModeFillLong")&&""!==e.getStorage("LevelModeFillLong")?(e._LevelModeFillLong=parseInt(e.getStorage("LevelModeFillLong")),e._LevelModeFillLong):1},set:function(t){e.setStorage("LevelModeFillLong",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"UnlockWinCount",{get:function(){return null!==e.getStorage("UnlockWinCount")&&void 0!==e.getStorage("UnlockWinCount")&&""!==e.getStorage("UnlockWinCount")?(e._UnlockWinCount=parseInt(e.getStorage("UnlockWinCount")),e._UnlockWinCount):1},set:function(t){e.setStorage("UnlockWinCount",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"UnlockDrops",{get:function(){return null!==e.getStorage("UnlockDrops")&&void 0!==e.getStorage("UnlockDrops")&&""!==e.getStorage("UnlockDrops")?(e._UnlockDrops=parseInt(e.getStorage("UnlockDrops")),e._UnlockDrops):0},set:function(t){e.setStorage("UnlockDrops",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"CurrentUsedDropsAmount",{get:function(){return null!==e.getStorage("CurrentUnlockProgress")&&void 0!==e.getStorage("CurrentUnlockProgress")&&""!==e.getStorage("CurrentUnlockProgress")?(e._CurrentUsedDropsAmount=parseInt(e.getStorage("CurrentUnlockProgress")),e._CurrentUsedDropsAmount):0},set:function(t){e.setStorage("CurrentUnlockProgress",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"CurrentUnlockIndex",{get:function(){return null!==e.getStorage("CurrentUnlockIndex")&&void 0!==e.getStorage("CurrentUnlockIndex")&&""!==e.getStorage("CurrentUnlockIndex")?(e._CurrentUnlockIndex=parseInt(e.getStorage("CurrentUnlockIndex")),e._CurrentUnlockIndex>e.collectionList.length+1&&(e._CurrentUnlockIndex=e.collectionList.length+1),e._CurrentUnlockIndex):1},set:function(t){t>e.collectionList.length+1&&(t=e.collectionList.length+1),e.setStorage("CurrentUnlockIndex",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SelectedCapIndex",{get:function(){return null!==e.getStorage("SelectedCapIndex")&&void 0!==e.getStorage("SelectedCapIndex")&&""!==e.getStorage("SelectedCapIndex")?(e._SelectedCapIndex=parseInt(e.getStorage("SelectedCapIndex")),e._SelectedCapIndex):0},set:function(t){e.setStorage("SelectedCapIndex",t),e._SelectedCapIndex=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SelectedCharacterIndex",{get:function(){return null!==e.getStorage("SelectedCharacterIndex")&&void 0!==e.getStorage("SelectedCharacterIndex")&&""!==e.getStorage("SelectedCharacterIndex")?(e._SelectedCharacterIndex=parseInt(e.getStorage("SelectedCharacterIndex")),e._SelectedCharacterIndex):1},set:function(t){e.setStorage("SelectedCharacterIndex",t),e._SelectedCharacterIndex=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ifFirstAddPackage",{get:function(){return null===e.getStorage("ifFirstAddPackage")||void 0===e.getStorage("ifFirstAddPackage")||""===e.getStorage("ifFirstAddPackage")||(e._ifFirstAddPackage=e.getStorage("ifFirstAddPackage"),e._ifFirstAddPackage)},set:function(t){e.setStorage("ifFirstAddPackage",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ifFirstRevive",{get:function(){return null===e.getStorage("ifFirstRevive")||void 0===e.getStorage("ifFirstRevive")||""===e.getStorage("ifFirstRevive")||(e._ifFirstRevive=e.getStorage("ifFirstRevive"),e._ifFirstRevive)},set:function(t){e.setStorage("ifFirstRevive",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"PropUndo",{get:function(){return null!==e.getStorage("PropUndo")&&void 0!==e.getStorage("PropUndo")&&""!==e.getStorage("PropUndo")?(e._PropUndo=parseInt(e.getStorage("PropUndo")),e._PropUndo):0},set:function(t){e.setStorage("PropUndo",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"PropOrganize",{get:function(){return null!==e.getStorage("PropOrganize")&&void 0!==e.getStorage("PropOrganize")&&""!==e.getStorage("PropOrganize")?(e._PropOrganize=parseInt(e.getStorage("PropOrganize")),e._PropOrganize):0},set:function(t){e.setStorage("PropOrganize",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"PropPump",{get:function(){return null!==e.getStorage("PropPump")&&void 0!==e.getStorage("PropPump")&&""!==e.getStorage("PropPump")?(e._PropPump=parseInt(e.getStorage("PropPump")),e._PropPump):0},set:function(t){e.setStorage("PropPump",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"PropDye",{get:function(){return null!==e.getStorage("PropDye")&&void 0!==e.getStorage("PropDye")&&""!==e.getStorage("PropDye")?(e._PropDye=parseInt(e.getStorage("PropDye")),e._PropDye):0},set:function(t){e.setStorage("PropDye",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"PropAddCup",{get:function(){return null!==e.getStorage("PropAddCup")&&void 0!==e.getStorage("PropAddCup")&&""!==e.getStorage("PropAddCup")?(e._PropAddCup=parseInt(e.getStorage("PropAddCup")),e._PropAddCup):0},set:function(t){e.setStorage("PropAddCup",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ifAddDesktop",{get:function(){return null!==e.getStorage("ifAddDesktop")&&void 0!==e.getStorage("ifAddDesktop")&&""!==e.getStorage("ifAddDesktop")&&(e._ifAddDesktop=e.getStorage("ifAddDesktop"),e._ifAddDesktop)},set:function(t){e.setStorage("ifAddDesktop",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ifAddDesktopReward",{get:function(){return null!==e.getStorage("ifAddDesktopReward")&&void 0!==e.getStorage("ifAddDesktopReward")&&""!==e.getStorage("ifAddDesktopReward")&&(e._ifAddDesktopReward=e.getStorage("ifAddDesktopReward"),e._ifAddDesktopReward)},set:function(t){e.setStorage("ifAddDesktopReward",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LastGetFeedRewardDate",{get:function(){return null!==e.getStorage("LastGetFeedRewardDate")&&void 0!==e.getStorage("LastGetFeedRewardDate")&&""!==e.getStorage("LastGetFeedRewardDate")?(e.lastGetFeedRewardDate=e.getStorage("LastGetFeedRewardDate"),e.lastGetFeedRewardDate):""},set:function(t){e.setStorage("LastGetFeedRewardDate",t),e.lastGetFeedRewardDate=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LastGetRewardDate",{get:function(){return null!==e.getStorage("LastGetRewardDate")&&void 0!==e.getStorage("LastGetRewardDate")&&""!==e.getStorage("LastGetRewardDate")?(e.lastGetRewardDate=e.getStorage("LastGetRewardDate"),e.lastGetRewardDate):""},set:function(t){e.setStorage("LastGetRewardDate",t),e.lastGetRewardDate=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SideBarRewardCount",{get:function(){return null!==e.getStorage("RewardCount")&&void 0!==e.getStorage("RewardCount")&&""!==e.getStorage("RewardCount")?(e._rewardCount=parseInt(e.getStorage("RewardCount")),e._rewardCount):0},set:function(t){e.setStorage("RewardCount",t),e._rewardCount=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LastUnlockDate_EndlessBottle",{get:function(){return null!==e.getStorage("LastUnlockDate_EndlessBottle")&&void 0!==e.getStorage("LastUnlockDate_EndlessBottle")&&""!==e.getStorage("LastUnlockDate_EndlessBottle")?(e._lastUnlockDate_EndlessBottle=e.getStorage("LastUnlockDate_EndlessBottle"),e._lastUnlockDate_EndlessBottle):""},set:function(t){e.setStorage("LastUnlockDate_EndlessBottle",t),e._lastUnlockDate_EndlessBottle=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LastUnlockDate_MultiBottle",{get:function(){return null!==e.getStorage("LastUnlockDate_MultiBottle")&&void 0!==e.getStorage("LastUnlockDate_MultiBottle")&&""!==e.getStorage("LastUnlockDate_MultiBottle")?(e._lastUnlockDate_MultiBottle=e.getStorage("LastUnlockDate_MultiBottle"),e._lastUnlockDate_MultiBottle):""},set:function(t){e.setStorage("LastUnlockDate_MultiBottle",t),e._lastUnlockDate_MultiBottle=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LastUnlockDate_BottlePuzzle",{get:function(){return null!==e.getStorage("LastUnlockDate_BottlePuzzle")&&void 0!==e.getStorage("LastUnlockDate_BottlePuzzle")&&""!==e.getStorage("LastUnlockDate_BottlePuzzle")?(e._lastUnlockDate_BottlePuzzle=e.getStorage("LastUnlockDate_BottlePuzzle"),e._lastUnlockDate_BottlePuzzle):""},set:function(t){e.setStorage("LastUnlockDate_BottlePuzzle",t),e._lastUnlockDate_BottlePuzzle=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LastUnlockDate_FillLong",{get:function(){return null!==e.getStorage("LastUnlockDate_FillLong")&&void 0!==e.getStorage("LastUnlockDate_FillLong")&&""!==e.getStorage("LastUnlockDate_FillLong")?(e._lastUnlockDate_FillLong=e.getStorage("LastUnlockDate_FillLong"),e._lastUnlockDate_FillLong):""},set:function(t){e.setStorage("LastUnlockDate_FillLong",t),e._lastUnlockDate_FillLong=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LastUnlockDate_ScrewSort",{get:function(){return null!==e.getStorage("LastUnlockDate_ScrewSort")&&void 0!==e.getStorage("LastUnlockDate_ScrewSort")&&""!==e.getStorage("LastUnlockDate_ScrewSort")?(e._lastUnlockDate_ScrewSort=e.getStorage("LastUnlockDate_ScrewSort"),e._lastUnlockDate_ScrewSort):""},set:function(t){e.setStorage("LastUnlockDate_ScrewSort",t),e._lastUnlockDate_ScrewSort=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"WinStreak",{get:function(){return null!==e.getStorage("WinStreak")&&void 0!==e.getStorage("WinStreak")&&""!==e.getStorage("WinStreak")?(e._winStreak=parseInt(e.getStorage("WinStreak")),e._winStreak):0},set:function(t){e.setStorage("WinStreak",t),e._winStreak=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LastWinStreakDate",{get:function(){return null!==e.getStorage("LastWinStreakDate")&&void 0!==e.getStorage("LastWinStreakDate")&&""!==e.getStorage("LastWinStreakDate")?(e._lastWinStreakDate=e.getStorage("LastWinStreakDate"),e._lastWinStreakDate):""},set:function(t){e.setStorage("LastWinStreakDate",t),e._lastWinStreakDate=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LastWinStreakEndDate",{get:function(){return null!==e.getStorage("LastWinStreakEndDate")&&void 0!==e.getStorage("LastWinStreakEndDate")&&""!==e.getStorage("LastWinStreakEndDate")?(e._lastWinStreakEndDate=e.getStorage("LastWinStreakEndDate"),e._lastWinStreakEndDate):""},set:function(t){e.setStorage("LastWinStreakEndDate",t),e._lastWinStreakEndDate=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ShowFeedTime",{get:function(){return null!==e.getStorage("ShowFeedTime")&&void 0!==e.getStorage("ShowFeedTime")&&""!==e.getStorage("ShowFeedTime")?(e._showFeedTime=parseInt(e.getStorage("ShowFeedTime")),e._showFeedTime):0},set:function(t){e.setStorage("ShowFeedTime",t),e._showFeedTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LastFirstWinDate",{get:function(){return null!==e.getStorage("LastFirstWinDate")&&void 0!==e.getStorage("LastFirstWinDate")&&""!==e.getStorage("LastFirstWinDate")?(e.lastFirstWinDate=e.getStorage("LastFirstWinDate"),e.lastFirstWinDate):""},set:function(t){e.setStorage("LastFirstWinDate",t),e.lastFirstWinDate=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"IsRecommended",{get:function(){return null!==e.getStorage("isRecommended")&&void 0!==e.getStorage("isRecommended")&&""!==e.getStorage("isRecommended")&&(e._isRecommended=e.getStorage("isRecommended"),e._isRecommended)},set:function(t){e.setStorage("isRecommended",t),e._isRecommended=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LastGetDailyEnergyDate",{get:function(){return null!==e.getStorage("LastGetDailyEnergyDate")&&void 0!==e.getStorage("LastGetDailyEnergyDate")&&""!==e.getStorage("LastGetDailyEnergyDate")?(e._lastGetDailyEnergyDate=e.getStorage("LastGetDailyEnergyDate"),e._lastGetDailyEnergyDate):""},set:function(t){e.setStorage("LastGetDailyEnergyDate",t),e._lastGetDailyEnergyDate=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LastLogInDate",{get:function(){return null!==e.getStorage("LastLogInDate")&&void 0!==e.getStorage("LastLogInDate")&&""!==e.getStorage("LastLogInDate")?(e._lastLogInDate=e.getStorage("LastLogInDate"),e._lastLogInDate):""},set:function(t){e.setStorage("LastLogInDate",t),e._lastLogInDate=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LastLoadSceneDate",{get:function(){var t=e.getStorage("LastLoadSceneDate");return null!=t&&""!==t?(e._lastLoadSceneDate=t,e._lastLoadSceneDate):""},set:function(t){e.setStorage("LastLoadSceneDate",t),e._lastLoadSceneDate=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"FirstLogInDate",{get:function(){return null!==e.getStorage("FirstLogInDate")&&void 0!==e.getStorage("FirstLogInDate")&&""!==e.getStorage("FirstLogInDate")?(e._firstLogInDate=e.getStorage("FirstLogInDate"),e._firstLogInDate):""},set:function(t){e.setStorage("FirstLogInDate",t),e._firstLogInDate=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"PropCounter",{get:function(){return null!==e.getStorage("PropCounter")&&void 0!==e.getStorage("PropCounter")&&""!==e.getStorage("PropCounter")?(e._propCounter=parseInt(e.getStorage("PropCounter")),e._propCounter):0},set:function(t){e.setStorage("PropCounter",t),e._propCounter=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"IsFirstInvited",{get:function(){return null!==e.getStorage("isFirstInvited")&&void 0!==e.getStorage("isFirstInvited")&&""!==e.getStorage("isFirstInvited")&&(e._isFirstInvited=e.getStorage("isFirstInvited"),e._isFirstInvited)},set:function(t){e.setStorage("isFirstInvited",t),e._isFirstInvited=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"InviteCount",{get:function(){return null!==e.getStorage("InviteCount")&&void 0!==e.getStorage("InviteCount")&&""!==e.getStorage("InviteCount")?(e._inviteCount=parseInt(e.getStorage("InviteCount")),e._inviteCount):0},set:function(t){e.setStorage("InviteCount",t),e._inviteCount=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"InviteRewardCount",{get:function(){return null!==e.getStorage("InviteRewardCount")&&void 0!==e.getStorage("InviteRewardCount")&&""!==e.getStorage("InviteRewardCount")?(e._inviteRewardCount=parseInt(e.getStorage("InviteRewardCount")),e._inviteRewardCount):0},set:function(t){e.setStorage("InviteRewardCount",t),e._inviteRewardCount=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"IfShowPropPanelPump",{get:function(){return null!==e.getStorage("IfShowPropPanelPump")&&void 0!==e.getStorage("IfShowPropPanelPump")&&""!==e.getStorage("IfShowPropPanelPump")&&(e._ifShowPropPanelPump=e.getStorage("IfShowPropPanelPump"),e._ifShowPropPanelPump)},set:function(t){e.setStorage("IfShowPropPanelPump",t),e._ifShowPropPanelPump=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"IfShowPropPanelAddCup",{get:function(){return null!==e.getStorage("IfShowPropPanelAddCup")&&void 0!==e.getStorage("IfShowPropPanelAddCup")&&""!==e.getStorage("IfShowPropPanelAddCup")&&(e._ifShowPropPanelAddCup=e.getStorage("IfShowPropPanelAddCup"),e._ifShowPropPanelAddCup)},set:function(t){e.setStorage("IfShowPropPanelAddCup",t),e._ifShowPropPanelAddCup=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"IfShowPropPanelUndo",{get:function(){return null!==e.getStorage("IfShowPropPanelUndo")&&void 0!==e.getStorage("IfShowPropPanelUndo")&&""!==e.getStorage("IfShowPropPanelUndo")&&(e._ifShowPropPanelUndo=e.getStorage("IfShowPropPanelUndo"),e._ifShowPropPanelUndo)},set:function(t){e.setStorage("IfShowPropPanelUndo",t),e._ifShowPropPanelUndo=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"IfShowPropPanelAddTime",{get:function(){return null!==e.getStorage("IfShowPropPanelAddTime")&&void 0!==e.getStorage("IfShowPropPanelAddTime")&&""!==e.getStorage("IfShowPropPanelAddTime")&&(e._ifShowPropPanelAddTime=e.getStorage("IfShowPropPanelAddTime"),e._ifShowPropPanelAddTime)},set:function(t){e.setStorage("IfShowPropPanelAddTime",t),e._ifShowPropPanelAddTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"IfJoinGameClub",{get:function(){return null!==e.getStorage("IfJoinGameClub")&&void 0!==e.getStorage("IfJoinGameClub")&&""!==e.getStorage("IfJoinGameClub")&&(e._ifJoinGameClub=e.getStorage("IfJoinGameClub"),e._ifJoinGameClub)},set:function(t){e.setStorage("IfJoinGameClub",t),e._ifJoinGameClub=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"IfGetGameClubReward",{get:function(){return 1==c.default.CapUnlockMap[15]||null!==e.getStorage("IfGetGameClubReward")&&void 0!==e.getStorage("IfGetGameClubReward")&&""!==e.getStorage("IfGetGameClubReward")&&(e._ifGetGameClubReward=e.getStorage("IfGetGameClubReward"),e._ifGetGameClubReward)},set:function(t){e.setStorage("IfGetGameClubReward",t),e._ifGetGameClubReward=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"GameClubRewardIndex",{get:function(){return null!==e.getStorage("GameClubRewardIndex")&&void 0!==e.getStorage("GameClubRewardIndex")&&""!==e.getStorage("GameClubRewardIndex")?(e._gameClubRewardIndex=parseInt(e.getStorage("GameClubRewardIndex")),e._gameClubRewardIndex):0},set:function(t){e.setStorage("GameClubRewardIndex",t),e._gameClubRewardIndex=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ChallengeRecord",{get:function(){return null!==e.getStorage("ChallengeRecord")&&void 0!==e.getStorage("ChallengeRecord")&&""!==e.getStorage("ChallengeRecord")?(e._challengeRecord=parseInt(e.getStorage("ChallengeRecord")),e._challengeRecord):0},set:function(t){e.setStorage("ChallengeRecord",t),e._challengeRecord=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LastChallengeDate",{get:function(){return null!==e.getStorage("LastChallengeDate")&&void 0!==e.getStorage("LastChallengeDate")&&""!==e.getStorage("LastChallengeDate")?(e._lastChallengeDate=e.getStorage("LastChallengeDate"),e._lastChallengeDate):""},set:function(t){e.setStorage("LastChallengeDate",t),e._lastChallengeDate=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"FreeChallengeTimes",{get:function(){return null!==e.getStorage("FreeChallengeTimes")&&void 0!==e.getStorage("FreeChallengeTimes")&&""!==e.getStorage("FreeChallengeTimes")?(e._freeChallengeTimes=parseInt(e.getStorage("FreeChallengeTimes")),e._freeChallengeTimes):0},set:function(t){e.setStorage("FreeChallengeTimes",t),e._freeChallengeTimes=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LastShareChallengeDate",{get:function(){return null!==e.getStorage("LastShareChallengeDate")&&void 0!==e.getStorage("LastShareChallengeDate")&&""!==e.getStorage("LastShareChallengeDate")?(e._lastShareChallengeDate=e.getStorage("LastShareChallengeDate"),e._lastShareChallengeDate):""},set:function(t){e.setStorage("LastShareChallengeDate",t),e._lastShareChallengeDate=t},enumerable:!1,configurable:!0}),e.setStorage=function(e,t){switch(a(t)){case"boolean":t=t?"true":"false"}cc.sys.localStorage.setItem(e,t)},e.getStorage=function(e){var t=cc.sys.localStorage.getItem(e);switch(t){case"true":t=!0;break;case"false":t=!1}return t},e.isToday=function(e){var t;t="string"==typeof e?new Date(e):e;var o=new Date;return t.getFullYear()===o.getFullYear()&&t.getMonth()===o.getMonth()&&t.getDate()===o.getDate()},e.getTodayDate=function(){var e=new Date;return e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0")+"-"+String(e.getDate()).padStart(2,"0")},e.clearMemory=function(){cc.sys.localStorage.clear()},e.userInfoAuthorized=!1,e.nickName="",e.avatarUrl="",e.version="",e.start_time=0,e.finish_time=0,e.openId="",e.platform="",e.appId="",e.currentLevelDifficulty=0,e.mode="",e.ifRestart=!1,e.ifSkipAd=!1,e.ratio=1,e.ifTest=!1,e.ifFed=!1,e.playerType=0,e.ifTestCounter=0,e.ifWhiteList=!1,e.NumberOn=!1,e.TimeOn=!1,e.ifTestNode=!1,e.ifAutoPlay=!1,e.autoPlaying=!1,e.ifReplayed=!1,e._isNewPlayer=!0,e.lastRewardAdFailShareTime=0,e.lastRewardAdFailCallShareTimes=0,e.winCountThisLife=0,e.currentLevelReplayedTime=0,e.ifTestingB=!1,e.ifTestingC=!1,e.ifTestingD=!1,e.TUTORIAL_INDEX=[3,5,7,30,55,25],e.isFirstTimeReturnToMain=!0,e.isReturnToMain=!1,e.ifShowMode=!0,e.pathX=0,e.pathY=720,e.ifOpenBySidebar=!1,e.sceneId="",e.userData=null,e.feedType=0,e.Reward3=0,e.Reward7=[0,0,0,0],e.collectionList=["\u6a59\u610f\u6ee1\u6ee1","\u7f24\u7eb7\u679c\u6c47","\u7f24\u7eb7\u679c\u6c47","\u6930\u5b50\u676f","\u51b0\u70b9\u65f6\u523b","\u5065\u8eab\u51a0\u519b","\u897f\u74dc\u6c81\u723d","\u67ff\u67ff\u5982\u610f","\u6a58\u4e50\u65f6\u5149","\u6e05\u723d\u82e6\u74dc","\u6843\u91cc\u6843\u6c14","\u73cd\u73e0\u5976\u8336","\u51b0\u51bb\u8292\u679c\u6c41","\u6e05\u723d\u67e0\u6aac","\u51b0\u6dc7\u51cc\u676f","\u8349\u8393\u829d\u58eb","\u571f\u65b0\u5409","\u5947\u5f02\u661f\u7403","\u723d\u559d\u676f","\u6768\u679d\u7518\u9732","\u67e0\u6aac\u7ea2\u8336","\u9b54\u6cd5\u679c\u6c41","\u72d7\u72d7\u676f","\u8292\u679c\u6d41\u5149","\u9ec4\u91d1\u6ce2\u4e50","\u7ef5\u7ef5\u51b0\u8403","\u6a59\u4e4b\u5473","\u5947\u601d\u5999\u60f3","\u8349\u8393\u5976\u6614","\u53e4\u8272\u53e4\u9999","\u679c\u56ed\u6a59\u9732","\u897f\u74dc\u66b4\u98ce","\u841d\u535c\u6c41","\u8292\u679c\u6c7d\u6c34","\u7eaf\u6a59\u6c41","\u5947\u5947\u602a\u602a","\u7ea2\u7cd6\u96ea\u68a8","\u67e0\u6aac\u9ad8\u6c64","\u5c0f\u718a\u676f","\u6843\u5b50\u6c7d\u6c34","\u723d\u4e50\u897f\u74dc","\u590d\u53e4\u9676\u74f7\u676f","\u756a\u8304\u5438\u5438\u676f","\u767d\u96ea\u7ef5\u7ef5","\u67e0\u6aac\u8336","\u5f69\u8679\u676f","\u90e8\u961f\u676f","\u897f\u6e56\u6c34","\u5947\u5f02\u53ef\u4e50","\u53cc\u62fc\u676f","\u5927\u7897\u68a8","\u7a88\u7a95\u676f","\u83e0\u841d\u738b","\u7a9d\u74dc\u738b","\u559c\u8336","\u591c\u6765\u9999","\u725b\u89d2\u676f","\u5e1d\u738b\u9ad8\u811a\u676f","\u51a0\u519b\u9ad8\u811a\u676f","\u6cd5\u8001\u9ad8\u811a\u676f","\u6f6e\u6d41\u676f","\u6817\u5b50\u676f","\u5c0f\u4e11\u676f","\u732b\u732b\u676f","\u897f\u74dc\u676f","\u5730\u7403\u676f","\u83b2\u82b1\u676f","\u9e2d\u9e2d\u676f","\u9ca8\u9c7c\u676f","\u6c34\u8c5a\u676f","\u51b0\u6dc7\u51cc\u7897","\u58a8\u897f\u54e5\u98ce\u60c5","\u7ea2\u8336","\u8e72\u8e72\u676f","\u5927\u773c\u676f","\u6ee1\u5929\u661f\u676f","\u9ad8\u5c4b\u5efa\u74f4","\u8611\u83c7\u58a9\u58a9\u676f","\u8981\u6709\u7231\u5fc3\u676f","\u5154\u5154\u676f","\u4eff\u53e4\u58f6","\u6768\u6885\u5410\u6c14","\u5976\u8336\u676f","\u60ac\u7a7a\u676f","\u6c49\u5821\u676f","\u978b\u578b\u676f","\u7a33\u5b9a\u676f","\u7ea2\u9676\u8336\u7897","\u5f69\u82b1\u9676\u74f7","\u9ad8\u4e50\u9ad8\u676f","\u5f53\u5f53\u676f","\u9cc4\u9c7c\u676f","\u4e09\u89d2\u7eb9\u676f","\u7eff\u8336\u738b","\u51ac\u74dc\u6c34","\u6c99\u68d8\u6c41","\u9178\u6885\u6c64","\u8461\u8404\u6c41","\u7c89\u725b\u5976","\u516b\u5b9d\u7ca5","\u9752\u6885\u7eff\u8336"],e.subFriendRank=!1,e.subUpdateNotice=!1,e._inGameShowSubUpdateNoticeTimes=2,e._lastShowSubUpdateDate="",e._MusicOn=!0,e._SoundOn=!0,e._VibrationOn=!0,e._OrderNum=0,e._ifPlayedMasked=!1,e._ifPlayedBombCup=!1,e._ifPlayedAbsorbCup=!1,e._ifPlayedChangeColorCup=!1,e._ifPlayedLockCup=!1,e._IfReadOldUserLevel=!1,e._oldUserLevel=1,e._Level=1,e._CurrentLevel=1,e._challengeList=[],e._challengeList0=[],e._challengeList1=[],e._challengeList2=[],e._challengeList3=[],e._LevelChallenge=1,e._ChallengeModeDifficulty="",e._LevelModeMultiple=1,e._LevelModeFillLong=1,e._UnlockWinCount=1,e._UnlockDrops=0,e._CurrentUsedDropsAmount=0,e._CurrentUnlockIndex=1,e._SelectedCapIndex=0,e._SelectedCharacterIndex=1,e._ifFirstAddPackage=!0,e._ifFirstRevive=!0,e._PropUndo=0,e._PropOrganize=0,e._PropPump=0,e._PropDye=0,e._PropAddCup=0,e._ifAddDesktop=!1,e._ifAddDesktopReward=!1,e.lastGetFeedRewardDate="",e.lastGetRewardDate="",e._rewardCount=1,e._lastUnlockDate_EndlessBottle="",e._lastUnlockDate_MultiBottle="",e._lastUnlockDate_FillLong="",e._lastUnlockDate_BottlePuzzle="",e._lastUnlockDate_ScrewSort="",e._winStreak=0,e._lastWinStreakDate="",e._lastWinStreakEndDate="",e._showFeedTime=0,e.lastFirstWinDate="",e._isRecommended=!1,e._lastGetDailyEnergyDate="",e.firstProp=!1,e.firstAdd=!1,e.firstUndo=!1,e.firstPump=!1,e._lastLogInDate="",e._lastLoadSceneDate="",e._firstLogInDate="",e._propCounter=0,e._isFirstInvited=!1,e._inviteCount=0,e._inviteRewardCount=0,e._ifShowPropPanelPump=!1,e._ifShowPropPanelAddCup=!1,e._ifShowPropPanelUndo=!1,e._ifShowPropPanelAddTime=!1,e._ifJoinGameClub=!1,e._ifGetGameClubReward=!1,e._gameClubRewardIndex=0,e._challengeRecord=0,e._lastChallengeDate="",e._freeChallengeTimes=0,e._lastShareChallengeDate="",e}();r.default=s,cc._RF.pop(),cc._RF.pop()},{}],CupDraggable_ED:[function(e,t,o){"use strict";cc._RF.push(t,"f6b5dfpRyFGFo7aZOACLctI","CupDraggable_ED");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"f6b5dfpRyFGFo7aZOACLctI","CupDraggable_ED");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CupInfoUI_ED"),p=n("Cup_ED"),d=cc._decorator,f=d.ccclass,h=(d.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.offset=cc.v2(0,0),t.dragging=!1,t}return s(t,e),t.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},t.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},t.prototype.onTouchStart=function(e){var t=e.getLocation(),o=this.node.parent.convertToNodeSpaceAR(t);this.offset=cc.v2(this.node.position.sub(cc.v3(o))),this.dragging=!0,this.node.getComponent(p.default)&&(u.default.getInstance().isMovingCup=this.dragging)},t.prototype.onTouchMove=function(e){if(this.dragging){var t=e.getLocation(),o=this.node.parent.convertToNodeSpaceAR(t).add(this.offset);this.node.setPosition(o)}},t.prototype.onTouchEnd=function(){this.dragging=!1,this.node.getComponent(p.default)&&(u.default.getInstance().isMovingCup=this.dragging)},l([f],t)}(cc.Component));r.default=h,cc._RF.pop(),cc._RF.pop()},{}],CupDraggable:[function(e,t,o){"use strict";cc._RF.push(t,"ab2f5u34AtLWojGOl0xkK/9","CupDraggable");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"ab2f5u34AtLWojGOl0xkK/9","CupDraggable");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CupInfoUI"),p=n("Cup"),d=cc._decorator,f=d.ccclass,h=(d.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.offset=cc.v2(0,0),t.dragging=!1,t}return s(t,e),t.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},t.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},t.prototype.onTouchStart=function(e){var t=e.getLocation(),o=this.node.parent.convertToNodeSpaceAR(t);this.offset=cc.v2(this.node.position.sub(cc.v3(o))),this.dragging=!0,this.node.getComponent(p.default)&&(u.default.getInstance().isMovingCup=this.dragging)},t.prototype.onTouchMove=function(e){if(this.dragging){var t=e.getLocation(),o=this.node.parent.convertToNodeSpaceAR(t).add(this.offset);this.node.setPosition(o)}},t.prototype.onTouchEnd=function(){this.dragging=!1,this.node.getComponent(p.default)&&(u.default.getInstance().isMovingCup=this.dragging)},l([f],t)}(cc.Component));r.default=h,cc._RF.pop(),cc._RF.pop()},{}],CupInfoUI_ED:[function(e,t,o){"use strict";cc._RF.push(t,"c329bnwIW9BVqknrY7n+9FK","CupInfoUI_ED");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"c329bnwIW9BVqknrY7n+9FK","CupInfoUI_ED");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("Cup_ED"),p=n("LevelEditor_ED"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Color1=null,t.Color2=null,t.Color3=null,t.Color4=null,t.PosX=null,t.PosY=null,t.frozenUnlockCountInput=null,t.maskUnlockColorIdInput=null,t.maskUnlockCountInput=null,t.fileNameInput=null,t.isMovingCup=!1,t.currentCup=null,t}var o;return s(t,e),o=t,t.getInstance=function(){return o.instance?o.instance:null},t.prototype.onLoad=function(){o.instance=this},t.prototype.bindToCup=function(e){this.currentCup=e,e.highlight(),this.updatePos(),this.refreshUI()},t.prototype.update=function(){this.currentCup&&this.isMovingCup&&this.updatePos()},t.prototype.getFileName=function(){return""==this.fileNameInput.string?"test":this.fileNameInput.string},t.prototype.updatePos=function(){var e=this.currentCup.node.position;this.PosX.string=e.x.toString(),this.PosY.string=e.y.toString()},t.prototype.refreshUI=function(){if(this.currentCup){this.updateColorInputs();var e=this.currentCup.getCupType();this.updatePanelByType(e)}},t.prototype.updateColorInputs=function(){var e=this.currentCup.getColorIds();this.Color1.string=e[0].toString(),this.Color2.string=e[1].toString(),this.Color3.string=e[2].toString(),this.Color4.string=e[3].toString()},t.prototype.updatePanelByType=function(e){this.frozenUnlockCountInput.string=this.currentCup.getFrozenUnlockCount().toString(),this.maskUnlockColorIdInput.string=this.currentCup.getMaskUnlockColorId().toString(),this.maskUnlockCountInput.string=this.currentCup.getMaskUnlockCount().toString(),this.frozenUnlockCountInput.node.parent.active=e===u.CupType.Frozen,console.log(this.frozenUnlockCountInput.node.active),this.maskUnlockColorIdInput.node.parent.active=e===u.CupType.Masked,console.log(this.maskUnlockColorIdInput.node.active),this.maskUnlockCountInput.node.parent.active=e===u.CupType.Masked,console.log(this.maskUnlockCountInput.node.active)},t.prototype.destroyCurrentCup=function(){this.currentCup&&(this.currentCup.node.destroy(),p.default.getInstance().updateCups(),this.currentCup=null,this.Color1.string="",this.Color2.string="",this.Color3.string="",this.Color4.string="",this.PosX.string="",this.PosY.string="",this.frozenUnlockCountInput.string="",this.maskUnlockColorIdInput.string="",this.maskUnlockCountInput.string="")},t.prototype.applyChanges=function(){if(this.currentCup){var e=this.currentCup.getCupType(),t=[parseInt(this.Color1.string),parseInt(this.Color2.string),parseInt(this.Color3.string),parseInt(this.Color4.string)];this.currentCup.setColorIds(t),e===u.CupType.Frozen&&this.currentCup.setFrozenUnlockCount(parseInt(this.frozenUnlockCountInput.string)),e===u.CupType.Masked&&(this.currentCup.setMaskUnlockColor(parseInt(this.maskUnlockColorIdInput.string)),this.currentCup.setMaskUnlockCount(parseInt(this.maskUnlockCountInput.string)))}},t.prototype.clearBinding=function(){this.currentCup=null},t.instance=null,l([h(cc.EditBox)],t.prototype,"Color1",void 0),l([h(cc.EditBox)],t.prototype,"Color2",void 0),l([h(cc.EditBox)],t.prototype,"Color3",void 0),l([h(cc.EditBox)],t.prototype,"Color4",void 0),l([h(cc.EditBox)],t.prototype,"PosX",void 0),l([h(cc.EditBox)],t.prototype,"PosY",void 0),l([h(cc.EditBox)],t.prototype,"frozenUnlockCountInput",void 0),l([h(cc.EditBox)],t.prototype,"maskUnlockColorIdInput",void 0),l([h(cc.EditBox)],t.prototype,"maskUnlockCountInput",void 0),l([h(cc.EditBox)],t.prototype,"fileNameInput",void 0),o=l([f],t)}(cc.Component);r.default=y,cc._RF.pop(),cc._RF.pop()},{}],CupInfoUI:[function(e,t,o){"use strict";cc._RF.push(t,"f7570beQ9pEAqMq0EzVqcnk","CupInfoUI");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"f7570beQ9pEAqMq0EzVqcnk","CupInfoUI");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("Cup"),p=n("LevelEditor"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Color1=null,t.Color2=null,t.Color3=null,t.Color4=null,t.PosX=null,t.PosY=null,t.frozenUnlockCountInput=null,t.maskUnlockColorIdInput=null,t.maskUnlockCountInput=null,t.fileNameInput=null,t.isMovingCup=!1,t.currentCup=null,t}var o;return s(t,e),o=t,t.getInstance=function(){return o.instance?o.instance:null},t.prototype.onLoad=function(){o.instance=this},t.prototype.bindToCup=function(e){this.currentCup=e,e.highlight(),this.updatePos(),this.refreshUI()},t.prototype.update=function(){this.currentCup&&this.isMovingCup&&this.updatePos()},t.prototype.getFileName=function(){return""==this.fileNameInput.string?"test":this.fileNameInput.string},t.prototype.updatePos=function(){var e=this.currentCup.node.position;this.PosX.string=e.x.toString(),this.PosY.string=e.y.toString()},t.prototype.refreshUI=function(){if(this.currentCup){this.updateColorInputs();var e=this.currentCup.getCupType();this.updatePanelByType(e)}},t.prototype.updateColorInputs=function(){var e=this.currentCup.getColorIds();this.Color1.string=e[0].toString(),this.Color2.string=e[1].toString(),this.Color3.string=e[2].toString(),this.Color4.string=e[3].toString()},t.prototype.updatePanelByType=function(e){this.frozenUnlockCountInput.string=this.currentCup.getFrozenUnlockCount().toString(),this.maskUnlockColorIdInput.string=this.currentCup.getMaskUnlockColorId().toString(),this.maskUnlockCountInput.string=this.currentCup.getMaskUnlockCount().toString(),this.frozenUnlockCountInput.node.parent.active=e===u.CupType.Frozen,this.maskUnlockColorIdInput.node.parent.active=e===u.CupType.Masked,this.maskUnlockCountInput.node.parent.active=e===u.CupType.Masked},t.prototype.destroyCurrentCup=function(){this.currentCup&&(this.currentCup.node.destroy(),p.default.getInstance().updateCups(),this.currentCup=null,this.Color1.string="",this.Color2.string="",this.Color3.string="",this.Color4.string="",this.PosX.string="",this.PosY.string="",this.frozenUnlockCountInput.string="",this.maskUnlockColorIdInput.string="",this.maskUnlockCountInput.string="")},t.prototype.applyChanges=function(){if(this.currentCup){var e=this.currentCup.getCupType(),t=[parseInt(this.Color1.string),parseInt(this.Color2.string),parseInt(this.Color3.string),parseInt(this.Color4.string)];this.currentCup.setColorIds(t),e===u.CupType.Frozen&&this.currentCup.setFrozenUnlockCount(parseInt(this.frozenUnlockCountInput.string)),e===u.CupType.Masked&&(this.currentCup.setMaskUnlockColor(parseInt(this.maskUnlockColorIdInput.string)),this.currentCup.setMaskUnlockCount(parseInt(this.maskUnlockCountInput.string)))}},t.prototype.clearBinding=function(){this.currentCup=null},t.instance=null,l([h(cc.EditBox)],t.prototype,"Color1",void 0),l([h(cc.EditBox)],t.prototype,"Color2",void 0),l([h(cc.EditBox)],t.prototype,"Color3",void 0),l([h(cc.EditBox)],t.prototype,"Color4",void 0),l([h(cc.EditBox)],t.prototype,"PosX",void 0),l([h(cc.EditBox)],t.prototype,"PosY",void 0),l([h(cc.EditBox)],t.prototype,"frozenUnlockCountInput",void 0),l([h(cc.EditBox)],t.prototype,"maskUnlockColorIdInput",void 0),l([h(cc.EditBox)],t.prototype,"maskUnlockCountInput",void 0),l([h(cc.EditBox)],t.prototype,"fileNameInput",void 0),o=l([f],t)}(cc.Component);r.default=y,cc._RF.pop(),cc._RF.pop()},{}],CupMgr_17:[function(e,t,o){"use strict";cc._RF.push(t,"dd399NqH1xOca724QMRESUz","CupMgr_17");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"dd399NqH1xOca724QMRESUz","CupMgr_17");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},p=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},d=function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<o;t++)for(var r=arguments[t],a=0,c=r.length;a<c;a++,i++)n[i]=r[a];return n};Object.defineProperty(r,"__esModule",{value:!0});var f=n("CommonData"),h=n("Cup_17"),y=n("GameManager_17"),m=n("config"),g=n("toutiao"),v=n("AudioManager"),_=n("GameManager"),S=n("const"),b=n("DataNexusEnum"),C=n("DataNexusSDK"),P=cc._decorator,k=P.ccclass,w=P.property,I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.waterBallPrefab=null,t.prefab=null,t.propMask=null,t.cups=[],t.typeAmount=5,t.blankAmount=2,t.finishedAmount=0,t.waterAmount=17,t.selecetedWaterBall=null,t.selected=null,t.selectedColorId=0,t.selectedNum=0,t.actions=[],t.isUndoing=!1,t.pumpClickNode=null,t.isPumping=!1,t.finishPrefab=null,t.finishEffectPool=null,t}var o;return s(t,e),o=t,t.getInstance=function(){return o.instance?o.instance:null},t.prototype.onEnable=function(){o.instance=this},t.prototype.onLoad=function(){},t.prototype.start=function(){var e=Array.from({length:h.WaterColors.length},function(e,t){return t}),t=e.slice(0,4),o=e.slice(4);o.sort(function(){return Math.random()-.5});var n=(e=d(t,o)).map(function(e){return h.WaterColors[e]}),i=e.map(function(e){return h.SurfaceColors[e]}),r=e.map(function(e){return h.SurfaceColors[e]});h.setColors(n,i,r),this.selected=null,this.finishEffectPool=new cc.NodePool,this.actions=[];for(var a=0;a<3;a++){var c=cc.instantiate(this.finishPrefab);this.finishEffectPool.put(c)}this.loadLevel()},t.prototype.loadLevel=function(){for(var e=this,t=[],o=[],n=0;n<this.typeAmount;n++){var i=new Array(this.waterAmount).fill(n+1);o.push(i),t=t.concat(i)}this.applyDifficultyConfig(o,function(o){t=o,e.distributeAllType(t)})},t.prototype.createCups=function(e){void 0===e&&(e=null);for(var t=0;t<e.length;t++)this.createCup(e[t],cc.v2(90*t-315,0));this.createCup([],cc.v2(90*e.length-315,0),!0),cc.director.emit("load_level")},t.prototype.createCup=function(e,t,o){void 0===o&&(o=!1),0==e.length&&(e=new Array(this.waterAmount).fill(0));var n=cc.instantiate(this.prefab);n.parent=this.node,n.setPosition(t);var i=n.getComponent(h.default);this.setUpCup(e,i),this.cups.push(i),o&&i.lockCup()},t.prototype.setUpCup=function(e,t){return u(this,void 0,void 0,function(){return p(this,function(){return t.setCupInfo(e,this.onClickCup.bind(this)),t.orignPt=t.node.position,[2]})})},t.prototype.distributeAllType=function(e){for(var t=[],o=0;o<this.typeAmount;o++)t.push(e.splice(0,this.waterAmount));t=this.makeLastElementsUnique(t),t=this.randomlyIncrementElements(t);for(var n=0;n<this.blankAmount;n++)t.splice(Math.floor(Math.random()*t.length),0,new Array(0));this.createCups(t)},t.prototype.randomlyIncrementElements=function(e){if(f.default.ifTest)return e;for(var t=0,o=0;o<e.length;o++)t+=e[o].length;var n=Math.floor(.2*t),i=[];for(o=0;o<e.length;o++)for(var r=1;r<e[o].length;r++)i.push({row:o,col:r});for(var a=new Set;a.size<n&&a.size<i.length;){var c=Math.floor(Math.random()*i.length);a.add(c)}return a.forEach(function(t){var o=i[t];e[o.row][o.col]+=100}),e},t.prototype.makeLastElementsUnique=function(e){for(var t,o=e.length,n=e[0].length,i=new Set,r=0;r<o;r++){var a=e[r][n-1];if(i.has(a))for(var c=0;c<n-1;c++)if(!i.has(e[r][c])){t=[e[r][n-1],e[r][c]],e[r][c]=t[0],e[r][n-1]=t[1],a=e[r][n-1];break}i.add(a)}for(r=0;r<o;r++)e[r].reverse();return e},t.prototype.applyDifficultyConfig=function(e,t){var o=this._getWeightList();this.reconcatTypeList([],o,e,0,function(e){t&&t(e)})},t.prototype._getWeightList=function(){var e=[20,0,80],t=[30,30,30,10],o=[40,25,25,10];if(1===f.default.LevelChallenge)return o;if(2===f.default.LevelChallenge)return t;if(3===f.default.LevelChallenge)return o;var n=this.getInterval(e,this.sum(e));return 0===n?t:1===n?[34,11,33,22]:o},t.prototype.reconcatTypeList=function(e,t,o,n,i){if(0!==o.length){var r=this._confirmBlocks(t),a=Math.floor(Math.random()*o.length);a===n&&(a=a===o.length-1?0:a+1),n=a,e=e.concat(o[a].splice(0,r)),0===o[a].length&&o.splice(a,1),this.reconcatTypeList(e,t,o,n,i)}else i&&i(e)},t.prototype._confirmBlocks=function(e){return this.getInterval(e,this.sum(e))+1},t.prototype.getInterval=function(e,t){for(var o=Math.random()*t,n=0,i=0;i<e.length;i++)if(o<(n+=e[i]))return i},t.prototype.sum=function(e){var t=0;return e.forEach(function(e){t+=e}),t},t.prototype.onClickCup=function(e){if(e.currentState!=h.CupState.Finished&&!this.isPumping){if(e.cupType==h.CupType.Locked)return _.default.platform.reportVideoEvent("GamePage_addBottle_video",1),C.default.instance.trackAdClick(b.RewardADEvent.UNLOCK_BOX),void _.default.platform.showRewardAD(function(){C.default.instance.trackAdVideoFinish(b.RewardADEvent.UNLOCK_BOX),_.default.platform.reportVideoEvent("GamePage_addBottle_video",2),e.unlockCup()});if(this.selected)if(this.selected==e)this.doSelect(e,!1);else if(this.checkPour(this.selected,e)){var t=this.getPourNum(this.selected,e);this.moveToPour(this.selected,e,t),this.selected=null,this.selecetedWaterBall=null}else{if(e.currentState==h.CupState.PouringIn||e.currentState==h.CupState.Selected)return;this.doSelect(this.selected,!1),this.doSelect(e,!0),this.selected=e}else{if(e.currentState==h.CupState.Selected||e.isEmpty()||e.currentState==h.CupState.PouringIn)return;this.selected=e,this.doSelect(e,!0)}}},t.prototype.doSelect=function(e,t){if(this.selected===e||!e.isEmpty())if(t){e.dropAnimation.node.active=!1;var o=e.getTop();e.currentState=h.CupState.Selected,this.selected=e,this.selectedColorId=o.topColorId,this.selectedNum=o.topColorNum,(u=cc.instantiate(this.waterBallPrefab)).parent=e.node;var n=e.getWaterSurfacePosY(),i=e.node.convertToWorldSpaceAR(new cc.Vec2(e.node.x,0));i.y=n;var r=e.node.convertToNodeSpaceAR(i);u.setPosition(0,r.y);var a=e.node.y+.65*e.node.height;a=e.node.convertToWorldSpaceAR(new cc.Vec2(e.node.x,a)).y;var c=cc.tween;c(u).parallel(c().to(.25,{y:e.node.convertToNodeSpaceAR(new cc.Vec2(0,a)).y},{easing:"sineOut"}),c().to(.2,{scale:.3},{easing:"sineOut"}).to(.05,{scale:.3+.02*this.selectedNum},{easing:"smooth"})).start(),this.selecetedWaterBall=u,u.color=(new cc.Color).fromHEX(h.WaterColors[o.topColorId]);for(var s=0,l=u.children;s<l.length;s++)l[s].color=(new cc.Color).fromHEX(h.SurfaceColors[o.topColorId]);e.removeTop(this.selectedColorId,this.selectedNum)}else{e.currentState=h.CupState.PouringIn,this.selected=null;var u=this.selecetedWaterBall;this.selecetedWaterBall=null,this.waterDrop(u,e,this.selectedColorId,this.selectedNum)}},t.prototype.waterDrop=function(e,t,o,n,i){var r=this;e&&(t.node.convertToWorldSpaceAR(new cc.Vec2(0,0)).x==e.convertToWorldSpaceAR(new cc.Vec2(0,0)).x?cc.tween(e).parallel(cc.tween().to(.1,{scale:.3},{easing:"sineIn"}),cc.tween().to(.35,{y:t.node.convertToNodeSpaceAR(new cc.Vec2(0,t.getWaterSurfacePosY())).y},{easing:"sineIn"})).call(function(){e.destroy(),v.default.instance.playSFX(v.AudioRef.WaterDrop),t.addTop(o,n,function(){t.playDropAnimation(),t.currentState=h.CupState.Idle,i&&i()})}).start():cc.tween(e).to(.1,{scale:.3,x:e.parent.convertToNodeSpaceAR(t.node.convertToWorldSpaceAR(new cc.Vec2(0,0))).x},{easing:"smooth"}).to(.25,{y:t.node.convertToNodeSpaceAR(new cc.Vec2(0,t.getWaterSurfacePosY())).y},{easing:"sineIn"}).call(function(){e.destroy(),v.default.instance.playSFX(v.AudioRef.WaterDrop),t.addTop(o,n,function(){t.playDropAnimation(),t.currentState=h.CupState.Idle,i&&i(),t.checkIsFinshed()&&(r.actions=[],t.currentState=h.CupState.Finished,t.playFinishAnimation(),r.playFinishAnimation(t.node.position),r.finishedAmount++,r.finishedAmount>=3&&m.currentPlatform===m.platformEnum.toutiao&&g.preloadInterstitialAd(),r.finishedAmount>=r.typeAmount&&cc.director.emit("level_finished_long")),cc.director.emit("water_drop")})}).start())},t.prototype.checkPour=function(e,t){var o=t.getTop();return 0!=this.selectedColorId&&t.currentState!=h.CupState.PouringIn&&t.currentState!=h.CupState.Selected&&(0==o.topColorId||o.emptyNum>0&&o.topColorId==this.selectedColorId)},t.prototype.moveToPour=function(e,t,o,n,i){var r=this;if(void 0===n&&(n=this.selectedColorId),void 0===i&&(i=!1),o==this.selectedNum)e.currentState=h.CupState.Idle,e.checkTop(),t.currentState=h.CupState.PouringIn,this.waterDrop(this.selecetedWaterBall,t,n,o,function(){i||r.addAction(e,t,o,n)});else if(o<this.selectedNum){var a=this.selecetedWaterBall,c=cc.instantiate(this.waterBallPrefab);c.parent=e.node,c.setPosition(this.selecetedWaterBall.position),c.color=(new cc.Color).fromHEX(h.WaterColors[n]);for(var s=0,l=c.children;s<l.length;s++)l[s].color=(new cc.Color).fromHEX(h.SurfaceColors[n]);cc.tween(c).to(.1,{scale:.006*o},{easing:"sineIn"}).start(),cc.tween(a).to(.1,{scale:.006*(this.selectedNum-o)},{easing:"sineIn"}).start(),t.currentState=h.CupState.PouringIn,e.currentState=h.CupState.PouringIn,this.scheduleOnce(function(){r.waterDrop(c,t,n,o,function(){i||r.addAction(e,t,o,n)}),r.waterDrop(a,e,n,r.selectedNum-o)},.1)}},t.prototype.hasLockedCups=function(){for(var e=0,t=this.cups;e<t.length;e++)if(t[e].cupType==h.CupType.Locked)return!0;return!1},t.prototype.ifDeadLock=function(){if(this.selected)return!1;for(var e=this.cups.filter(function(e){return e.currentState!=h.CupState.Finished&&e.cupType!==h.CupType.Locked}),t=0;t<e.length;t++){var o=e[t];if(o.isEmpty())return!1;for(var n=0,i=0;i<e.length;i++)if(t!==i){var r=e[i];if(r.isEmpty())return!1;if(r.getTop().topColorId==o.getTop().topColorId&&(n+=r.getTop().emptyNum,o.canPourTo(r)))return!1}if(n>=o.getTop().topColorNum)return!1}return!0},t.prototype.getLockedCups=function(){for(var e=0;e<this.cups.length;e++)if(this.cups[e].cupType===h.CupType.Locked)return this.cups[e].node;return null},t.prototype.getActionNum=function(){return this.actions.length},t.prototype.addAction=function(e,t,o,n){var i=this.cups.indexOf(e),r=this.cups.indexOf(t);this.actions.push({from:i,to:r,num:o,colorId:n}),this.actions.length>5&&this.actions.shift()},t.prototype.undoLastAction=function(){var e=this;if(0!=this.actions.length&&!this.isUndoing){if(this.selected){var t=this.selected;if(this.doSelect(this.selected,!1),this.isUndoing=!0,this.cups.indexOf(t)==this.actions[this.actions.length-1].to)return void this.scheduleOnce(function(){e.undo()},.5)}this.isUndoing=!0,this.undo()}},t.prototype.undo=function(){var e=this,t=this.actions.pop(),o=this.cups[t.from],n=this.cups[t.to];if(o&&n){n.currentState=h.CupState.Selected;var i=cc.instantiate(this.waterBallPrefab);i.parent=n.node;var r=n.getWaterSurfacePosY(),a=n.node.convertToWorldSpaceAR(new cc.Vec2(n.node.x,0));a.y=r;var c=n.node.convertToNodeSpaceAR(a);i.setPosition(0,c.y);var s=n.node.y+.65*n.node.height;s=n.node.convertToWorldSpaceAR(new cc.Vec2(n.node.x,s)).y;var l=cc.tween;this.selecetedWaterBall=i,i.color=(new cc.Color).fromHEX(h.WaterColors[t.colorId]);for(var u=0,p=i.children;u<p.length;u++)p[u].color=(new cc.Color).fromHEX(h.SurfaceColors[t.colorId]);n.removeTop(t.colorId,t.num),l(i).parallel(l().to(.25,{y:n.node.convertToNodeSpaceAR(new cc.Vec2(0,s)).y},{easing:"sineOut"}),l().to(.2,{scale:.3},{easing:"sineOut"}).to(.05,{scale:.3+.02*this.selectedNum},{easing:"smooth"})).call(function(){e.isUndoing=!1,e.selectedNum=t.num,e.moveToPour(n,o,t.num,t.colorId,!0)}).start()}},t.prototype.canPumpWater=function(){var e=this.cups.filter(function(e){return!e.checkIsFinshed()&&!e.isEmpty()});if(0===e.length)return!1;for(var t=function(e){var t=e.getTop().topColorId;return 0===t?"continue":e.info.colorIds.some(function(e){return 0!==e&&e!==t})?{value:!0}:void 0},o=0,n=e;o<n.length;o++){var i=t(n[o]);if("object"==a(i))return i.value}return!1},t.prototype.pumpWater=function(){var e=this;y.default.instance.PopupTipsStay("\u8bf7\u70b9\u51fb\u4efb\u610f\u989c\u8272\u5c06\u5176\u7f6e\u9876"),this.cups.some(function(e){return e.isPouring()})||(this.isPumping=!0,this.propMask.active=!0,this.isPumping=!0,this.pumpClickNode.on(cc.Node.EventType.TOUCH_START,function(t){var o=t.getLocation(),n=[],i=null,r=null;console.error("location",o.x,o.y);for(var a=0,c=0,s=e.cups;c<s.length;c++){var l=s[c],u=l.node.getBoundingBoxToWorld();if(console.error("layerNode:",u),a++,u.contains(o)){console.error("hit cup index:",a),i=l;break}}if(i.currentState!==h.CupState.Finished){for(var p=0,d=i.node.getChildByName("cupMask").children;p<d.length;p++){var f=d[p];n.push(f)}for(var m=0,g=n;m<g.length;m++)if((u=(f=g[m]).getBoundingBoxToWorld()).contains(o)){r=f.name;break}i&&r&&i.pumpWater(r,function(){i.initWater(),e.isPumping=!1,e.propMask.active=!1,y.default.instance.root_Tips.y+=100})&&(v.default.instance.playSFX(v.AudioRef.SortItem),y.default.instance.PopoutTips(),e.pumpClickNode.off(cc.Node.EventType.TOUCH_START))}else y.default.instance.ChangeTipsStay("\u8bf7\u9009\u62e9\u6ca1\u6709\u88c5\u6ee1\u7684\u74f6\u5b50",2)},this))},t.prototype.cancelPumpWater=function(){f.default.PropPump++,this.isPumping=!1,this.propMask.active=!1,this.scheduleOnce(function(){y.default.instance.root_Tips.y+=100},.3),y.default.instance.PopoutTips(),this.pumpClickNode.off(cc.Node.EventType.TOUCH_START),cc.director.emit(S.EventNames.DoPour)},t.prototype.getFinishEffect=function(){return this.finishEffectPool.size()>0?this.finishEffectPool.get():cc.instantiate(this.finishPrefab)},t.prototype.releaseFinishEffect=function(e){e&&e.isValid&&(e.getComponent(sp.Skeleton).animation=null,e.removeFromParent(),this.finishEffectPool.put(e))},t.prototype.onDestroy=function(){this.finishEffectPool&&this.finishEffectPool.clear()},t.prototype.playFinishAnimation=function(e){var t=this,o=this.getFinishEffect();o.parent=this.node,o.setPosition(e),o.getComponent(sp.Skeleton).setAnimation(0,"wcpd",!1),o.getComponent(sp.Skeleton).setCompleteListener(function(){t.releaseFinishEffect(o)})},t.prototype.getPourNum=function(e,t){var o=t.getTop();return 0==o.topColorId?this.selectedNum:Math.min(this.selectedNum,o.emptyNum)},t.prototype.checkIsAllFinished=function(){return this.finishedAmount>=this.typeAmount},t.instance=null,l([w(cc.Prefab)],t.prototype,"waterBallPrefab",void 0),l([w(cc.Prefab)],t.prototype,"prefab",void 0),l([w(cc.Node)],t.prototype,"propMask",void 0),l([w(cc.Node)],t.prototype,"pumpClickNode",void 0),l([w(cc.Prefab)],t.prototype,"finishPrefab",void 0),o=l([k],t)}(cc.Component);r.default=I,cc._RF.pop(),cc._RF.pop()},{}],CupMgr_ED:[function(e,t,o){"use strict";cc._RF.push(t,"68d79t2QyBJzLDb256ZvYqd","CupMgr_ED");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"68d79t2QyBJzLDb256ZvYqd","CupMgr_ED");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},p=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},d=function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<o;t++)for(var r=arguments[t],a=0,c=r.length;a<c;a++,i++)n[i]=r[a];return n};Object.defineProperty(r,"__esModule",{value:!0});var f=n("Cup_ED"),h=n("LevelManager_ED"),y=n("AudioManager_ED"),m=n("GameManager_ED"),g=n("ExternalManager_ED"),v=cc._decorator,_=v.ccclass,S=v.property,b=v.executeInEditMode,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.waterCurrent=null,t._level=1,t.cups=[],t.cupMgr_extra=null,t.foremostRowUid=0,t.currentPool=[],t.selected=null,t.finishAnimation=null,t.finishiAniPool=[],t.bubble=null,t.bubblePool=[],t.activeBubbles=0,t.bubbleTimer=null,t.finishedCups=[],t.propMask=null,t.isOrganizing=!1,t.isPumping=!1,t.pumpClickNode=null,t.guidePrefab=null,t.guideNode=null,t}var o;return s(t,e),o=t,t.getInstance=function(){return o.instance?o.instance:null},t.prototype.onEnable=function(){o.instance=this},t.prototype.onLoad=function(){},t.prototype.start=function(){var e=Array.from({length:f.WaterColors.length},function(e,t){return t}),t=e.slice(0,4),o=e.slice(4);o.sort(function(){return Math.random()-.5}),e=d(t,o),console.log("indices",e);var n=e.map(function(e){return f.WaterColors[e]});e.map(function(e){return f.SurfaceColors[e]}),console.log("newWaterColors",n),this.selected=null,this.startBubbleAnimation()},t.prototype.update=function(){},t.prototype.pushForwardByGiven=function(e,t,o){var n=this;e>=t?o&&o():this.pushForward(function(){e++,n.pushForwardByGiven(e,t,o)})},t.prototype.getMoveRows=function(){for(var e=1,t=1;m.default.instance.rowLists.length&&0===m.default.instance.rowLists[t].cupAmounts;t++)e++;return e},t.prototype.pushForward=function(e){for(var t=function(t){m.default.instance.rowLists[0].node.active=!1,cc.tween(m.default.instance.rowLists[t].node).to(.5,{scale:Math.pow(.96,t-1),y:m.default.instance.PosYList[t-1],opacity:255}).call(function(){t===m.default.instance.rowLists.length-1&&(m.default.instance.rowLists.splice(0,1),h.default.getInstance().createNewRow(),e&&e())}).start()},o=1;o<m.default.instance.rowLists.length;o++)t(o)},t.prototype.checkIfInvalid=function(){var e=new Map;m.default.instance.bottlesShowed.forEach(function(t){t.info.colorIds.forEach(function(t){0!==t&&e.set(t,(e.get(t)||0)+1)})});for(var t=Array.from(e.values()),o=0;o<t.length;o++)if(t[o]>=f.SPLIT_COUNT)return!1;return!0},t.prototype.PropRemove=function(){var e=this.getBottleToRemove();e&&(m.default.instance.operationRecords=[],m.default.instance.onOperationRecording(),e.currentState=f.CupState.Finished,e.removeBottle())},t.prototype.getBottleToRemove=function(){for(var e=0;e<m.default.instance.rowLists.length;e++)for(var t=m.default.instance.rowLists[e],o=0;o<t.cupsArea.children.length;o++){var n=t.cupsArea.children[o].getComponent(f.default);if(n.currentState===f.CupState.Idle&&n.getTop().topColorNum>0)return n}return null},t.prototype.PropAdd=function(e){m.default.instance.operationRecords=[],m.default.instance.onOperationRecording(),e.resetBottle()},t.prototype.getBottleToReset=function(){for(var e=0;e<m.default.instance.rowLists.length;e++){var t=m.default.instance.rowLists[e];if(t.cupAmounts===(t.row_uid%2==1?4:3)){if(0===e)return null;for(var o=m.default.instance.rowLists[e-1],n=0;n<o.cupsArea.children.length;n++){var i=o.cupsArea.children[n].getComponent(f.default);if(i.currentState===f.CupState.Remove)return i}}}return null},t.prototype.setUpCup=function(e,t){return u(this,void 0,void 0,function(){return p(this,function(){return t.setCupInfo(e),t.setCupClickEvent(this.onClickCup.bind(this)),[2]})})},t.prototype.getCurrentFromPool=function(){if(this.currentPool.length>0){var e=this.currentPool.pop();return e.active=!0,e}return cc.instantiate(this.waterCurrent)},t.prototype.putCurrentToPool=function(e){e&&cc.isValid(e)&&(e.active=!1,e.parent=null,this.currentPool.push(e))},t.prototype.onClickCup=function(e){if(e.currentState!==f.CupState.Cover){if(!e.isInteractable())return e.cupType,void f.CupType.Locked;if(!this.isPumping)if(this.selected)if(this.selected==e)this.doSelect(e,!1),this.selected=null;else if(this.checkPour(this.selected,e)){var t=this.getPourNum(this.selected,e);this.selected.currentState=f.CupState.Pouring,this.startPour(this.selected,e,t),e.currentState=f.CupState.PouringIn}else{if(this.doSelect(this.selected,!1),e.currentState==f.CupState.Finished)return;if(e.cupType==f.CupType.Fixed)return;this.doSelect(e,!0),this.selected=e}else{if(e.currentState==f.CupState.Finished)return;if(e.cupType==f.CupType.Fixed)return;this.selected=e,this.doSelect(e,!0)}}},t.prototype.doSelect=function(e,t){var o=e.orignPt,n=.2*e.node.height,i=o.y+(t?n:0);y.default.instance.playChooseBottle(),e.node.stopAllActions(),e.onSelectSurfaceAnimation(),cc.tween(e.node).to(.2,{y:i}).start(),e.shadow.stopAllActions(),cc.tween(e.shadow).to(.2,{y:t?-215-n:-215,scale:t?.5:1,opacity:t?100:255}).start()},t.prototype.checkPour=function(e,t){var o=e.getTop(),n=t.getTop();return 0!=o.topColorId&&(0==n.topColorId||n.emptyNum>0&&n.topColorId==o.topColorId)},t.prototype.getfinishiAniFromPool=function(){if(this.finishiAniPool.length>0){var e=this.finishiAniPool.pop();return e.active=!0,e}return cc.instantiate(this.finishAnimation)},t.prototype.putFinishiToPool=function(e){e&&cc.isValid(e)&&(e.active=!1,e.parent=null,this.finishiAniPool.push(e))},t.prototype.playCompleteEffect=function(e){var t=this;g.default.vibrateShort();var o=this.getfinishiAniFromPool();o.parent=e.row.node,y.default.instance.playBottleFullefx(),o.setPosition(e.node.position),o.getComponent(sp.Skeleton).setAnimation(0,"wcpd",!1),o.getComponent(sp.Skeleton).setCompleteListener(function(){t.putFinishiToPool(o),e.removeBottle()})},t.prototype.getBubbleFromPool=function(){if(this.bubblePool.length>0){var e=this.bubblePool.pop();return e.active=!0,e}return cc.instantiate(this.bubble)},t.prototype.putBubbleToPool=function(e){e&&cc.isValid(e)&&(e.active=!1,e.parent=null,this.bubblePool.push(e))},t.prototype.startBubbleAnimation=function(){var e=this;this.bubbleTimer&&(clearInterval(this.bubbleTimer),this.bubbleTimer=null),this.bubbleTimer=setInterval(function(){if(e.cups&&(e.finishedCups=e.cups.filter(function(e){return e.checkIsFinshed()&&!e.isEmpty()}),0!==e.finishedCups.length&&e.activeBubbles<2&&e.finishedCups.length>0)){var t=Math.floor(Math.random()*e.finishedCups.length),o=e.finishedCups[t];e.playBubbleAnimation(o)}},5e3+5e3*Math.random())},t.prototype.stopBubbleAnimation=function(){this.bubbleTimer&&(clearInterval(this.bubbleTimer),this.bubbleTimer=null)},t.prototype.playBubbleAnimation=function(e){var t=this,o=this.getBubbleFromPool();o.parent=this.node,o.setPosition(e.node.position),o.getComponent(sp.Skeleton).setAnimation(0,"paopao",!1),o.getComponent(sp.Skeleton).setCompleteListener(function(){t.putBubbleToPool(o)})},t.prototype.startPour=function(e,t,o){var n=this;m.default.instance.unscheduleAllCallbacks(),t.cupImg_bottom.active=!1,t.cupImgBottomProjection||(t.cupImgBottomProjection=cc.instantiate(t.cupImg_bottom),t.cupImgBottomProjection.setParent(t.row.cupImgBottomArea),t.cupImgBottomProjection.active=!0,t.cupImgBottomProjection.scale=t.node.scale,t.cupImgBottomProjection.setPosition(t.row.cupImgBottomArea.convertToNodeSpaceAR(t.cupImg_bottom.convertToWorldSpaceAR(cc.Vec2.ZERO)))),e.shadow.active=!1;var i=e.node.convertToWorldSpaceAR(cc.Vec2.ZERO),r=e.row.node.scale,a=t.row.node.scale;e.node.setParent(this.cupMgr_extra),e.node.setPosition(e.node.parent.convertToNodeSpaceAR(i)),e.node.scale=r,t.node.zIndex=0,e.node.zIndex=10;var c=e.getTop(),s=cc.v2(t.node.position),l=(t.node.parent.convertToWorldSpaceAR(s),cc.view.getVisibleSize(),t.node.x>=e.node.x);s.y+=60+.5*t.node.height,s.x=s.x+(l?-0:0),s=t.node.parent.convertToWorldSpaceAR(s),e.setPourAnchor(l),s=e.node.parent.convertToNodeSpaceAR(s);var u=this.getCurrentFromPool();u.active=!1;var p=this;u.scaleX=l?-1:1,this.selected=null,e.moveToPour(s,a,l,o,function(){y.default.instance.playWaterFlow();var i=e.node.convertToWorldSpaceAR(cc.v2());i=n.node.convertToNodeSpaceAR(i),console.log(i+"---startPt");var r=cc.v2(i.x,t.getWaterSurfacePosY());r=n.node.convertToNodeSpaceAR(r),console.log(r+"---endPt"),r.x=i.x;var a=c.topColorId,s=f.SurfaceColors[a]||"#538849";t.pourInRipple.node.color=(new cc.Color).fromHEX(s),u.parent=t.row.node,u.setSiblingIndex(1),u.active=!0,u.setPosition(t.node.position);var l=f.WaterColors[a],p=f.SurfaceColors[a];u.getChildByName("current_dark").color=(new cc.Color).fromHEX(l),u.getChildByName("current_light").color=(new cc.Color).fromHEX(p),t.startAddWater(c.topColorId,o,function(){n.onPourOneFinished(e,t,c.topColorId,o)})}.bind(this),function(){t.cupImg_bottom.active=!0,t.cupImgBottomProjection&&(t.cupImgBottomProjection.destroy(),t.cupImgBottomProjection=null);var o=e.node.convertToWorldSpaceAR(cc.v2());o=this.node.convertToNodeSpaceAR(o),p.putCurrentToPool(u);var n=cc.v2(o.x,t.getWaterSurfacePosY(!0));(n=this.node.convertToNodeSpaceAR(n)).x=o.x,e.setNormalAnchor();var i=e.node.parent.convertToNodeSpaceAR(e.row.cupsArea.convertToWorldSpaceAR(e.orignPt)),r=e.row.node.scale;cc.tween(e.node).delay(.3).to(.3,{x:i.x,y:i.y,angle:0,scale:r},{easing:"sineOut"}).call(function(){e.checkIsStrictFinshed()||(e.currentState=f.CupState.Idle),t.checkIsStrictFinshed()||(t.currentState=f.CupState.Idle),t.node.zIndex=t.colIndex,e.node.zIndex=e.colIndex,e.shadow.y=-215,e.shadow.scale=1,e.shadow.opacity=255,e.shadow.active=!0,e.node.setParent(e.row.cupsArea),e.node.setPosition(e.orignPt),e.node.scale=1}).start()}.bind(this))},t.prototype.onPourOneFinished=function(e,t,o,n,i){void 0===i&&(i=!1),m.default.instance.operationRecords.length>=5&&(m.default.instance.operationRecords.shift(),m.default.instance.onOperationRecording()),i||(m.default.instance.operationRecords.push({from:e.bottle_uid,to:t.bottle_uid,colorId:o,num:n}),m.default.instance.onOperationRecording()),t.currentState=f.CupState.Idle;var r=e.getTop();if(r.topColorId>99){for(var a=0;a<f.SPLIT_COUNT;a++)if(0!=e.info.colorIds[a]){if(e.info.colorIds[a]!=r.topColorId)break;e.info.colorIds[a]-=100,e.onShowHidden(a)}e.initWater()}t.checkIsFinshed()?(t.currentState=f.CupState.Finished,t.playFinishAnimation(),this.playCompleteEffect(t),this.onWaterCleared(o,1),m.default.instance.operationRecords=[],m.default.instance.onOperationRecording()):m.default.instance.checkIfDeadGame(),this.checkIsAllFinished()&&console.log("---------\u5b8c\u6210\u4e86")},t.prototype.onWaterCleared=function(e,t){void 0===t&&(t=1);for(var o=0,n=this.cups;o<n.length;o++)(a=n[o]).tryReduceMaskCondition(e,t);for(var i=0,r=this.cups;i<r.length;i++){var a;if((a=r[i]).cupType===f.CupType.Frozen){a.tryReduceFrozenCount();break}}},t.prototype.undoAction=function(){var e=m.default.instance.operationRecords.pop();if(m.default.instance.onOperationRecording(),e){var t=e.from,o=e.to,n=e.num,i=(e.colorId,m.default.instance.bottlesShowed.get(o)),r=m.default.instance.bottlesShowed.get(t);return i.isPouring()||r.isPouring()?(m.default.instance.operationRecords.push(e),m.default.instance.onOperationRecording(),!1):(i.getTop().topColorId,this.startUndoPour(i,r,n),!0)}return!1},t.prototype.startUndoPour=function(e,t,o){var n=this;t.cupImg_bottom.active=!1,t.cupImgBottomProjection||(t.cupImgBottomProjection=cc.instantiate(t.cupImg_bottom),t.cupImgBottomProjection.setParent(t.row.cupImgBottomArea),t.cupImgBottomProjection.active=!0,t.cupImgBottomProjection.scale=t.node.scale,t.cupImgBottomProjection.setPosition(t.row.cupImgBottomArea.convertToNodeSpaceAR(t.cupImg_bottom.convertToWorldSpaceAR(cc.Vec2.ZERO)))),e.shadow.active=!1;var i=e.node.convertToWorldSpaceAR(cc.Vec2.ZERO),r=e.row.node.scale,a=t.row.node.scale;e.node.setParent(this.cupMgr_extra),e.node.setPosition(e.node.parent.convertToNodeSpaceAR(i)),e.node.scale=r;var c=e.getTop(),s=cc.v2(t.node.position),l=t.node.parent.convertToWorldSpaceAR(s),u=cc.view.getVisibleSize(),p=l.x>.5*u.width;Math.abs(l.x-.5*u.width)<2&&(p=e.node.parent.convertToWorldSpaceAR(cc.v2(e.node.position)).x<.5*u.width),s.y+=60+.5*t.node.height,s.x=s.x+(p?-0:0),s=t.node.parent.convertToWorldSpaceAR(s),e.setPourAnchor(p),s=e.node.parent.convertToNodeSpaceAR(s);var d=this.getCurrentFromPool();d.active=!1;var h=this;d.scaleX=p?-1:1,this.selected=null,e.moveToPour(s,a,p,o,function(){y.default.instance.playWaterFlow();var i=e.node.convertToWorldSpaceAR(cc.v2());cc.v2(i.x,t.getWaterSurfacePosY()).x=i.x,d.parent=t.row.node,d.setSiblingIndex(1),d.active=!0,d.setPosition(t.node.position);var r=c.topColorId,a=f.WaterColors[r],s=f.SurfaceColors[r];d.getChildByName("current_dark").color=(new cc.Color).fromHEX(a),d.getChildByName("current_light").color=(new cc.Color).fromHEX(s);var l=f.SurfaceColors[r]||"#538849";t.pourInRipple.node.color=(new cc.Color).fromHEX(l),t.startAddWater(c.topColorId,o,function(){n.onPourOneFinished(e,t,c.topColorId,o,!0)})}.bind(this),function(){t.cupImg_bottom.active=!0,t.cupImgBottomProjection&&(t.cupImgBottomProjection.destroy(),t.cupImgBottomProjection=null);var o=e.node.convertToWorldSpaceAR(cc.v2()),n=cc.v2(o.x,t.getWaterSurfacePosY(!0));h.putCurrentToPool(d),n.x=o.x,e.setNormalAnchor();var i=e.node.parent.convertToNodeSpaceAR(e.row.cupsArea.convertToWorldSpaceAR(e.orignPt)),r=e.row.node.scale;cc.tween(e.node).delay(.3).to(.3,{x:i.x,y:i.y,angle:0,scale:r},{easing:"sineOut"}).call(function(){e.shadow.y=-215,e.shadow.scale=1,e.shadow.opacity=255,e.shadow.active=!0,e.node.setParent(e.row.cupsArea),e.node.setPosition(e.orignPt),e.node.scale=1}).start()}.bind(this))},t.prototype.isOrgianizeAvailable=function(){for(var e=this.cups.filter(function(e){return e.currentState!=f.CupState.Finished&&e.isInteractable()}),t=0;t<e.length;t++)if(e[t].canOrganizeTopColor())return!0;return!1},t.prototype.organizeWater=function(){if(!this.cups.some(function(e){return e.isPouring()})){var e=this.cups.filter(function(e){return e.currentState!=f.CupState.Finished&&!e.isEmpty()});if(0!=e.length)for(var t=function(t){var o=e[t];if(console.log(o),!o.canOrganizeTopColor())return"continue";o.organizeTopColor(.5,function(){o.currentState=f.CupState.Idle})},o=0;o<e.length;o++)t(o)}},t.prototype.pumpWater=function(){var e=this;this.cups.some(function(e){return e.isPouring()})||(this.propMask.active=!0,console.log("propMask",this.propMask.active),this.isPumping=!0,this.pumpClickNode.on(cc.Node.EventType.TOUCH_START,function(t){var o=t.getLocation();console.log("\u70b9\u51fb\u4f4d\u7f6e:",o);for(var n=[],i=0,r=e.node.children;i<r.length;i++)for(var a=0,c=r[i].children;a<c.length;a++)for(var s=0,l=c[a].children;s<l.length;s++){var u=l[s];"cupImg"!==u.name&&n.push(u)}for(var p=null,d=null,f=0,h=e.cups;f<h.length;f++){var y=h[f];if(y.node.getBoundingBoxToWorld().contains(o)){console.log("\u70b9\u51fb\u5230\u4e86\u676f\u5b50:",y.node.name),p=y,console.log(y);break}}for(var m=0,g=n;m<g.length;m++){var v=g[m];if(v.getBoundingBoxToWorld().contains(o)){console.log("\u70b9\u51fb\u5230\u4e86\u8282\u70b9:",v.name),d=v.name;break}}p&&d&&p.pumpWater(d,function(){e.isPumping=!1,e.propMask.active=!1})&&e.pumpClickNode.off(cc.Node.EventType.TOUCH_START)},this))},t.prototype.ifDeadLock=function(){for(var e=Array.from(m.default.instance.bottlesShowed.values()),t=!0,o=0;o<e.length;o++){var n=e[o];if(n.currentState!=f.CupState.Finished&&!n.isEmpty()&&!n.ifSingleColor()){t=!1;break}}if(t){for(o=0;o<e.length;o++)if(!(r=e[o]).isEmpty()&&r.cupType!=f.CupType.Fixed)for(var i=0;i<e.length;i++)if(o!==i&&((c=e[i]).isEmpty()||c.getTop().topColorId==r.getTop().topColorId)&&r.getTop().topColorNum+c.getTop().topColorNum==f.SPLIT_COUNT)return!1;return!0}for(o=0;o<e.length;o++){var r;if((r=e[o]).isEmpty())return!1;if(r.cupType!=f.CupType.Fixed){var a=0;for(i=0;i<e.length;i++)if(o!==i){var c;if((c=e[i]).isEmpty())return!1;if((c.getTop().topColorId==r.getTop().topColorId||100==Math.abs(c.getTop().topColorId-r.getTop().topColorId))&&(a+=c.getTop().emptyNum,r.canPourTo(c)))return!1}if(a>=r.getTop().topColorNum)return!1}}return!0},t.prototype.hasLockedCups=function(){return this.cups.some(function(e){return e.cupType===f.CupType.Locked})},t.prototype.getLockedCups=function(){for(var e=0;e<this.cups.length;e++)if(this.cups[e].cupType===f.CupType.Locked)return this.cups[e].node;return null},t.prototype.dyeWater=function(){var e=this;if(this.cups.some(function(e){return e.isPouring()}))return!1;var t=this.cups.filter(function(e){return!e.checkIsFinshed()});if(0===t.length)return!1;var o={};console.log(o),t.forEach(function(e){e.info.colorIds.forEach(function(e){if(0!==e){var t=e>100?e-100:e;o[t]||(o[t]=0),o[t]++}})});var n=Object.keys(o);if(console.log("colortypes"+n),n.length<2)return!1;var i=parseInt(n[0]),r=parseInt(n[0]),a=o[i],c=o[r];for(var s in o){var l=o[s],u=parseInt(s);l>a&&(a=l,i=u),l<=c&&(c=l,r=u)}if(c<4)return!1;var p=[];t.forEach(function(e){e.info.colorIds.forEach(function(t,o){0!==t&&(t>100?t-100:t)===r&&p.push({cup:e,index:o})})});for(var d=[];d.length<4&&p.length>0;){var h=Math.floor(Math.random()*p.length);d.push(p[h]),p.splice(h,1)}return d.forEach(function(t){t.cup.info.colorIds[t.index];var o=[];(o=t.cup.info.colorIds)[t.index]=i;var n=e;t.cup.dyeWater(o,function(){1==t.cup.checkIsFinshed()&&(n.playCompleteEffect(t.cup),t.cup.playFinishAnimation(),t.cup.currentState=f.CupState.Finished,n.onWaterCleared(i,1))})}),this.checkIsAllFinished()&&console.log("---------\u5b8c\u6210\u4e86"),!0},t.prototype.getLevel=function(){return this._level},t.prototype.getPourNum=function(e,t){var o=e.getTop(),n=t.getTop();return 0==o.topColorId?0:0==n.topColorId?o.topColorNum:Math.min(o.topColorNum,n.emptyNum)},t.prototype.checkIsAllFinished=function(){for(var e=0,t=this.cups;e<t.length;e++)if(!t[e].checkIsFinshed())return!1;return!0},t.prototype.getDropNum=function(){for(var e=0,t=0,o=this.cups;t<o.length;t++)o[t].checkIsFinshed()&&e++;return 4*e},t.prototype.guide=function(){},t.prototype.updateGuide=function(){if(this.cups[0].currentState!==f.CupState.Pouring&&this.cups[1].currentState!==f.CupState.Pouring&&this.cups[2].currentState!==f.CupState.Pouring){if(this.guideNode.active=!0,null==this.selected&&this.cups[0].currentState!==f.CupState.Finished)(e=this.cups[1].node.position).y-=100,this.guideNode.setPosition(e);else if(null==this.selected&&this.cups[0].currentState===f.CupState.Finished&&this.cups[1].currentState!==f.CupState.Finished&&this.cups[2].currentState!==f.CupState.Finished)(e=this.cups[1].node.position).y-=100,this.guideNode.setPosition(e);else if(this.selected==this.cups[1]&&this.cups[0].currentState!==f.CupState.Finished)(e=this.cups[0].node.position).y-=100,this.guideNode.setPosition(e);else if(this.selected==this.cups[1]&&this.cups[2].currentState!==f.CupState.Finished)(e=this.cups[2].node.position).y-=100,this.guideNode.setPosition(e);else if(this.selected==this.cups[2]&&this.cups[1].currentState!==f.CupState.Finished){var e;(e=this.cups[1].node.position).y-=100,this.guideNode.setPosition(e)}}else this.guideNode.active=!1},t.instance=null,l([S(cc.Prefab)],t.prototype,"waterCurrent",void 0),l([S(cc.Node)],t.prototype,"cupMgr_extra",void 0),l([S(cc.Prefab)],t.prototype,"finishAnimation",void 0),l([S(cc.Prefab)],t.prototype,"bubble",void 0),l([S(cc.Node)],t.prototype,"propMask",void 0),l([S(cc.Node)],t.prototype,"pumpClickNode",void 0),l([S(cc.Prefab)],t.prototype,"guidePrefab",void 0),o=l([_,b],t)}(cc.Component);r.default=C,cc._RF.pop(),cc._RF.pop()},{}],CupMgr_Long:[function(e,t,o){"use strict";cc._RF.push(t,"2f3b2+jzrFGi4hpS69FX7n7","CupMgr_Long");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"2f3b2+jzrFGi4hpS69FX7n7","CupMgr_Long");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},p=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},d=function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<o;t++)for(var r=arguments[t],a=0,c=r.length;a<c;a++,i++)n[i]=r[a];return n};Object.defineProperty(r,"__esModule",{value:!0});var f=n("Cup"),h=n("LevelManager_Long"),y=n("GameScene_Long"),m=n("AudioManager"),g=n("GameManager"),v=n("const"),_=n("Cup_Long"),S=n("DataNexusEnum"),b=n("DataNexusSDK"),C=cc._decorator,P=C.ccclass,k=C.property,w=(C.executeInEditMode,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.waterCurrent=null,t.totalWater=0,t.finishedWater=0,t.cups=[],t.longCups=[],t.targetColorsIds=[],t.finishedLongCups=0,t.currentPool=[],t.waterCurrentLong=null,t.waterCurrentLongPrefab=null,t.selected=null,t.finishAnimation=null,t.finishiAniPool=[],t.bubble=null,t.bubblePool=[],t.activeBubbles=0,t.bubbleTimer=null,t.finishedCups=[],t._actions=[],t.propMask=null,t.isOrganizing=!1,t.isPumping=!1,t.pumpClickNode=null,t}var o;return s(t,e),o=t,t.getInstance=function(){return o.instance?o.instance:null},t.prototype.onEnable=function(){o.instance=this},t.prototype.onLoad=function(){cc.director.on("load_level_finish",this.getTargetInfo,this)},t.prototype.onDestroy=function(){cc.director.off("load_level_finish",this.getTargetInfo,this),o.instance=null},t.prototype.start=function(){var e,t=Array.from({length:f.WaterColors.length},function(e,t){return t}),o=t.slice(0,4),n=t.slice(4);n.sort(function(){return Math.random()-.5});var i=(t=d(o,n)).map(function(e){return f.WaterColors[e]}),r=t.map(function(e){return f.SurfaceColors[e]}),a=t.map(function(e){return f.finishStart[e]}),c=t.map(function(e){return f.finishEnd[e]}),s=t.map(function(e){return f.SplashColors[e]}),l=t.map(function(e){return f.ColorIDRef[e]});f.setColors(i,r,a,c,s,l),null===(e=h.default.getInstance())||void 0===e||e.loadLevel(),this.selected=null,this._actions=[],this.startBubbleAnimation()},t.prototype.getTargetInfo=function(){for(var e=0,t=this.longCups;e<t.length;e++){var o=t[e];this.targetColorsIds.push(o.getTop().topColorId)}},t.prototype.update=function(){},t.prototype.setUpCup=function(e,t){return u(this,void 0,void 0,function(){return p(this,function(){return t.setCupInfo(e,this.onClickCup.bind(this)),t.orignPt=t.node.position,[2]})})},t.prototype.setUpLongCup=function(e,t){return u(this,void 0,void 0,function(){return p(this,function(){return t.setCupInfo(e,this.onClickLongCup.bind(this)),t.orignPt=t.node.position,[2]})})},t.prototype.getWaterCurrentLong=function(){return null==this.waterCurrentLong&&(this.waterCurrentLong=cc.instantiate(this.waterCurrentLongPrefab)),this.waterCurrentLong.active=!0,this.waterCurrentLong},t.prototype.hideWaterCurrentLong=function(){this.waterCurrentLong.active=!1},t.prototype.getCurrentFromPool=function(){if(this.currentPool.length>0){var e=this.currentPool.pop();return e.active=!0,e}return cc.instantiate(this.waterCurrent)},t.prototype.putCurrentToPool=function(e){e&&cc.isValid(e)&&(e.active=!1,e.parent=null,this.currentPool.push(e))},t.prototype.onClickCup=function(e){var t=this;if(cc.director.emit(v.EventNames.OnClickCup),e.isInteractable()){if(!this.isPumping)if(this.selected)if(this.selected==e)this.doSelect(e,!1),this.selected=null;else if(this.checkPour(this.selected,e)){var o=this.getPourNum(this.selected,e);cc.director.emit(v.EventNames.OnClickPour),this.selected.currentState=f.CupState.Pouring,this.startPour(this.selected,e,o),e.currentState=f.CupState.PouringIn}else{if(this.doSelect(this.selected,!1),e.currentState==f.CupState.Finished)return;if(e.cupType==f.CupType.Fixed)return;this.doSelect(e,!0),this.selected=e}else{if(e.currentState==f.CupState.Finished)return;if(e.cupType==f.CupType.Fixed)return void y.default.instance.PopupTips("\u74f6\u5b50\u88ab\u56fa\u5b9a\u4f4f\u5566",2);this.selected=e,this.doSelect(e,!0)}}else e.cupType==f.CupType.Locked&&(g.default.platform.reportVideoEvent("GamePage_addBottle_video",1),b.default.instance.trackAdClick(S.RewardADEvent.UNLOCK_BOX),g.default.platform.showRewardAD(function(){b.default.instance.trackAdVideoFinish(S.RewardADEvent.UNLOCK_BOX),g.default.platform.reportVideoEvent("GamePage_addBottle_video",2),g.default.platform.reportAdPointEvent("AdPoint",t.getProgress()),e.unlockCup()}))},t.prototype.onClickLongCup=function(e){if(cc.director.emit(v.EventNames.OnClickCup),!this.isPumping&&this.selected)if(this.checkPour(this.selected,e)){var t=this.getPourNum(this.selected,e);cc.director.emit(v.EventNames.OnClickPour),this.selected.currentState=f.CupState.Pouring,this.startPourLong(this.selected,e,t)}else this.doSelect(this.selected,!1)},t.prototype.doSelect=function(e,t){t&&e.clearPourInAnimation();var o=e.orignPt.y+(t?.2*e.node.height:0);t&&m.default.instance.playSFX(m.AudioRef.ChooseBottle),cc.tween(e.node).stop(),e.onSelectSurfaceAnimation(),cc.tween(e.node).to(.2,{y:o}).start()},t.prototype.checkPour=function(e,t){var o=e.getTop(),n=t.getTop();return 0!=o.topColorId&&(0==n.topColorId||n.emptyNum>0&&n.topColorId==o.topColorId)},t.prototype.getfinishiAniFromPool=function(){if(this.finishiAniPool.length>0){var e=this.finishiAniPool.pop();return e.active=!0,e.getComponent(cc.ParticleSystem).emissionRate=300,e}return cc.instantiate(this.finishAnimation)},t.prototype.putFinishiToPool=function(e){e&&cc.isValid(e)&&(e.active=!1,e.parent=null,this.finishiAniPool.push(e))},t.prototype.playFinishAnimation=function(e){var t=this;g.default.playVibrateSquence();var o=this.getfinishiAniFromPool(),n=this.getfinishiAniFromPool(),i=this.getfinishiAniFromPool(),r=this.getfinishiAniFromPool();o.scale=e.node.scale,n.scale=e.node.scale,i.scale=e.node.scale,r.scale=e.node.scale;var a=f.finishStart[e.info.colorIds[0]],c=f.finishEnd[e.info.colorIds[0]];o.getComponent(cc.ParticleSystem).startColor=(new cc.Color).fromHEX(a),n.getComponent(cc.ParticleSystem).startColor=(new cc.Color).fromHEX(a),i.getComponent(cc.ParticleSystem).startColor=(new cc.Color).fromHEX(a),r.getComponent(cc.ParticleSystem).startColor=(new cc.Color).fromHEX(a),o.getComponent(cc.ParticleSystem).endColor=(new cc.Color).fromHEX(c),n.getComponent(cc.ParticleSystem).endColor=(new cc.Color).fromHEX(c),i.getComponent(cc.ParticleSystem).endColor=(new cc.Color).fromHEX(c),r.getComponent(cc.ParticleSystem).endColor=(new cc.Color).fromHEX(c),o.parent=e.node.parent,o.zIndex=1e3,n.parent=e.node.parent,n.zIndex=-1,i.parent=e.node.parent,i.zIndex=1e3,r.parent=e.node.parent,r.zIndex=-1,o.opacity=0,n.opacity=0,i.opacity=0,r.opacity=0,o.setPosition(e.node.position.x-.6*e.node.width,e.node.position.y-.45*e.node.height),n.setPosition(e.node.position.x-.6*e.node.width,e.node.position.y-.45*e.node.height),i.setPosition(e.node.position.x+.6*e.node.width,e.node.position.y-.45*e.node.height),r.setPosition(e.node.position.x+.6*e.node.width,e.node.position.y-.45*e.node.height);var s=cc.tween;s(o).to(.1,{opacity:255}).bezierTo(.4,cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y-.2*e.node.height)).call(function(){o.getComponent(cc.ParticleSystem).emissionRate=0}).to(.2,{x:e.node.position.x-.6*e.node.width,y:e.node.position.y+.1*e.node.height}).call(function(){o.getComponent(cc.ParticleSystem).emissionRate=100}).bezierTo(.4,cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y+.45*e.node.height)).call(function(){o.getComponent(cc.ParticleSystem).emissionRate=0}).delay(1).call(function(){t.putFinishiToPool(o)}).start(),s(n).to(.1,{opacity:255}).bezierTo(.4,cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y-.2*e.node.height)).to(.2,{x:e.node.position.x-.6*e.node.width,y:e.node.position.y+.1*e.node.height}).bezierTo(.4,cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y+.45*e.node.height)).call(function(){n.getComponent(cc.ParticleSystem).emissionRate=0}).delay(1).call(function(){t.putFinishiToPool(n)}).start(),s(i).to(.1,{opacity:255}).bezierTo(.4,cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y-.2*e.node.height)).call(function(){o.getComponent(cc.ParticleSystem).emissionRate=0}).to(.2,{x:e.node.position.x+.6*e.node.width,y:e.node.position.y+.1*e.node.height}).call(function(){o.getComponent(cc.ParticleSystem).emissionRate=100}).bezierTo(.4,cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y+.45*e.node.height)).call(function(){i.getComponent(cc.ParticleSystem).emissionRate=0}).delay(1).call(function(){t.putFinishiToPool(i)}).start(),s(r).to(.1,{opacity:255}).bezierTo(.4,cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y-.2*e.node.height)).to(.2,{x:e.node.position.x+.6*e.node.width,y:e.node.position.y+.1*e.node.height}).bezierTo(.4,cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y+.45*e.node.height)).call(function(){r.getComponent(cc.ParticleSystem).emissionRate=0}).delay(1).call(function(){t.putFinishiToPool(r)}).start()},t.prototype.playFinishAnimationLong=function(e){var t=this;g.default.playVibrateSquence();var o=this.getfinishiAniFromPool(),n=this.getfinishiAniFromPool(),i=this.getfinishiAniFromPool(),r=this.getfinishiAniFromPool(),a=o.getComponent(cc.ParticleSystem),c=n.getComponent(cc.ParticleSystem),s=i.getComponent(cc.ParticleSystem),l=r.getComponent(cc.ParticleSystem);o.scale=3*e.node.scale,n.scale=3*e.node.scale,i.scale=3*e.node.scale,r.scale=3*e.node.scale;var u=f.finishStart[e.info.colorIds[0]],p=f.finishEnd[e.info.colorIds[0]];a.startColor=(new cc.Color).fromHEX(u),c.startColor=(new cc.Color).fromHEX(u),s.startColor=(new cc.Color).fromHEX(u),l.startColor=(new cc.Color).fromHEX(u),a.endColor=(new cc.Color).fromHEX(p),c.endColor=(new cc.Color).fromHEX(p),s.endColor=(new cc.Color).fromHEX(p),l.endColor=(new cc.Color).fromHEX(p),a.emissionRate=500,c.emissionRate=500,s.emissionRate=500,l.emissionRate=500,a.life=1,c.life=1,s.life=1,l.life=1,a.lifeVar=.2,c.lifeVar=.2,s.lifeVar=.2,l.lifeVar=.2,o.parent=e.node.parent,o.zIndex=1e3,n.parent=e.node.parent,n.zIndex=-1,i.parent=e.node.parent,i.zIndex=1e3,r.parent=e.node.parent,r.zIndex=-1,o.opacity=0,n.opacity=0,i.opacity=0,r.opacity=0,o.setPosition(e.node.position.x-.6*e.node.width,e.node.position.y-.45*e.node.height),n.setPosition(e.node.position.x-.6*e.node.width,e.node.position.y-.45*e.node.height),i.setPosition(e.node.position.x+.6*e.node.width,e.node.position.y-.45*e.node.height),r.setPosition(e.node.position.x+.6*e.node.width,e.node.position.y-.45*e.node.height);var d=cc.tween;d(o).to(.1,{opacity:255}).bezierTo(.4,cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y-.2*e.node.height)).call(function(){a.emissionRate=0}).to(.2,{x:e.node.position.x-.6*e.node.width,y:e.node.position.y+.1*e.node.height}).call(function(){a.emissionRate=500}).bezierTo(.4,cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y+.5*e.node.height)).call(function(){a.emissionRate=0}).delay(1).call(function(){t.putFinishiToPool(o)}).start(),d(n).to(.1,{opacity:255}).bezierTo(.4,cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y-.2*e.node.height)).to(.2,{x:e.node.position.x-.6*e.node.width,y:e.node.position.y+.1*e.node.height}).bezierTo(.4,cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y+.5*e.node.height)).call(function(){c.emissionRate=0}).delay(1).call(function(){t.putFinishiToPool(n)}).start(),d(i).to(.1,{opacity:255}).bezierTo(.4,cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y-.2*e.node.height)).call(function(){s.emissionRate=0}).to(.2,{x:e.node.position.x+.6*e.node.width,y:e.node.position.y+.1*e.node.height}).call(function(){s.emissionRate=500}).bezierTo(.4,cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y+.5*e.node.height)).call(function(){s.emissionRate=0}).delay(1).call(function(){t.putFinishiToPool(i)}).start(),d(r).to(.1,{opacity:255}).bezierTo(.4,cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y-.2*e.node.height)).to(.2,{x:e.node.position.x+.6*e.node.width,y:e.node.position.y+.1*e.node.height}).bezierTo(.4,cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y+.5*e.node.height)).call(function(){l.emissionRate=0}).delay(1).call(function(){t.putFinishiToPool(r)}).start()},t.prototype.getBubbleFromPool=function(){if(this.bubblePool.length>0){var e=this.bubblePool.pop();return e.active=!0,e}return cc.instantiate(this.bubble)},t.prototype.putBubbleToPool=function(e){e&&cc.isValid(e)&&(e.active=!1,e.parent=null,this.bubblePool.push(e))},t.prototype.startBubbleAnimation=function(){var e=this;cc.director.getScene().name!==v.SceneNames.GameModeMultiple&&(this.bubbleTimer&&(clearInterval(this.bubbleTimer),this.bubbleTimer=null),this.bubbleTimer=setInterval(function(){if(e.cups&&(e.finishedCups=e.cups.filter(function(e){return e.currentState==f.CupState.Finished}),0!==e.finishedCups.length&&e.activeBubbles<2&&e.finishedCups.length>0)){var t=Math.floor(Math.random()*e.finishedCups.length),o=e.finishedCups[t];e.playBubbleAnimation(o)}},5e3+5e3*Math.random()))},t.prototype.stopBubbleAnimation=function(){this.bubbleTimer&&(clearInterval(this.bubbleTimer),this.bubbleTimer=null)},t.prototype.playBubbleAnimation=function(e){var t=this,o=this.getBubbleFromPool();o.parent=e.node.parent,o.setPosition(e.node.position),o.getComponent(sp.Skeleton).setAnimation(0,"paopao",!1),o.getComponent(sp.Skeleton).setCompleteListener(function(){t.putBubbleToPool(o)})},t.prototype.startPour=function(e,t,o){var n=this;t.node.zIndex=0,e.node.zIndex=10;var i=e.getTop(),r=cc.v2(t.node.position),a=(t.node.parent.convertToWorldSpaceAR(r),cc.view.getVisibleSize(),t.node.x>=e.node.x);r.y+=60+.5*t.node.height,r.x=r.x+(a?-0:0),r=t.node.parent.convertToWorldSpaceAR(r),e.setPourAnchor(a),r=e.node.parent.convertToNodeSpaceAR(r);var c=this.getCurrentFromPool();c.active=!1;var s=this;c.scaleX=a?-1:1,this.selected=null,e.hiddenMark.active=!1;for(var l=0,u=f.SPLIT_COUNT-1;u>=0&&(0!=t.info.colorIds[u]||(t.info.colorIds[u]=i.topColorId,++l!=o));u--);e.moveToPour(r,a,o,function(){m.default.instance.playSFX(m.AudioRef.WaterFlow);var r=e.node.convertToWorldSpaceAR(cc.v2());r=n.node.convertToNodeSpaceAR(r);var a=cc.v2(r.x,t.getWaterSurfacePosY());(a=n.node.convertToNodeSpaceAR(a)).x=r.x;var s=i.topColorId,l=f.WaterColors[s],u=f.SurfaceColors[s];f.SurfaceColors[s],c.parent=t.node.parent,c.active=!0,c.setPosition(t.node.position),c.setSiblingIndex(0),c.getChildByName("current_dark").color=(new cc.Color).fromHEX(l),c.getChildByName("current_light").color=(new cc.Color).fromHEX(u),t.startAddWater(i.topColorId,o,function(){n.onPourOneFinished(e,t,i.topColorId,o)})}.bind(this),function(){var o=e.node.convertToWorldSpaceAR(cc.v2());o=this.node.convertToNodeSpaceAR(o),s.putCurrentToPool(c);var n=cc.v2(o.x,t.getWaterSurfacePosY(!0));(n=this.node.convertToNodeSpaceAR(n)).x=o.x,e.setNormalAnchor();var i=e.orignPt;cc.tween(e.node).call(function(){t.checkIsStrictFinshed()||(t.currentState=f.CupState.Idle)}).delay(.3).to(.3,{x:i.x,y:i.y,angle:0},{easing:"sineOut"}).call(function(){e.checkIsStrictFinshed()||(e.currentState=f.CupState.Idle),cc.director.emit("do_pour"),e.node.zIndex=0,e.hiddenMark.active=!0;var t=e.getTop();if(t.topColorId>99){for(var o=[],n=0;n<f.SPLIT_COUNT;n++)o.push(e.info.colorIds[n]);for(n=0;n<t.topColorNum+t.emptyNum;n++)if(0!=o[n]){if(o[n]!=t.topColorId)break;o[n]-=100,e.onShowHidden(n)}e.showHiddenWater(o)}}).start()}.bind(this))},t.prototype.startPourLong=function(e,t,o){var n=this;t.node.zIndex=0,e.node.zIndex=10;var i=e.getTop(),r=cc.v2(t.node.position),a=(t.node.parent.convertToWorldSpaceAR(r),cc.view.getVisibleSize(),t.node.x>=e.node.x);r.y+=60+.5*t.node.height,r.x=r.x+(a?-0:0),r=t.node.parent.convertToWorldSpaceAR(r),e.setPourAnchor(a),r=e.node.parent.convertToNodeSpaceAR(r);var c=this.getWaterCurrentLong();c.active=!1;var s=this;c.scaleX=a?1:-1,this.selected=null,e.hiddenMark.active=!1;for(var l=0,u=_.SPLIT_COUNT_LONG-1;u>=0&&(0!=t.info.colorIds[u]||(t.info.colorIds[u]=i.topColorId,++l!=o));u--);e.moveToPour(r,a,o,function(){m.default.instance.playSFX(m.AudioRef.WaterFlow);var r=e.node.convertToWorldSpaceAR(cc.v2());r=n.node.convertToNodeSpaceAR(r);var a=cc.v2(r.x,t.getWaterSurfacePosY());(a=n.node.convertToNodeSpaceAR(a)).x=r.x;var s=i.topColorId,l=f.WaterColors[s],u=f.SurfaceColors[s];f.SurfaceColors[s],c.parent=t.node.parent,c.active=!0,c.setPosition(t.node.position),c.setSiblingIndex(0),c.getChildByName("current_dark").color=(new cc.Color).fromHEX(l),c.getChildByName("current_light").color=(new cc.Color).fromHEX(u),t.startAddWater(i.topColorId,o,function(){n.onPourOneFinishedLong(e,t,i.topColorId,o)})}.bind(this),function(){var o=e.node.convertToWorldSpaceAR(cc.v2());o=this.node.convertToNodeSpaceAR(o),s.hideWaterCurrentLong();var n=cc.v2(o.x,t.getWaterSurfacePosY(!0));(n=this.node.convertToNodeSpaceAR(n)).x=o.x,e.setNormalAnchor();var i=e.orignPt;cc.tween(e.node).call(function(){}).delay(.3).to(.3,{x:i.x,y:i.y,angle:0},{easing:"sineOut"}).call(function(){e.checkIsStrictFinshed()||(e.currentState=f.CupState.Idle),cc.director.emit("do_pour"),e.node.zIndex=0,e.hiddenMark.active=!0;var t=e.getTop();if(t.topColorId>99){for(var o=[],n=0;n<f.SPLIT_COUNT;n++)o.push(e.info.colorIds[n]);for(n=0;n<t.topColorNum+t.emptyNum;n++)if(0!=o[n]){if(o[n]!=t.topColorId)break;o[n]-=100,e.onShowHidden(n)}e.showHiddenWater(o)}}).start()}.bind(this))},t.prototype.onPourOneFinished=function(e,t,o,n,i){void 0===i&&(i=!1);var r,a=this.cups.indexOf(e);r=this.cups.indexOf(t),5==this._actions.length&&this._actions.shift(),t.stopPourInAnimation(o),i||this._actions.push({from:a,to:r,colorId:o,num:n}),t.checkIsFinshed()&&(console.error("targetColorsIds",this.targetColorsIds,"colorId",o),this.finishCup(t))},t.prototype.onPourOneFinishedLong=function(e,t,o,n,i){void 0===i&&(i=!1);var r=this.cups.indexOf(e),a=this.longCups.indexOf(t);a=-++a,5==this._actions.length&&this._actions.shift(),t.stopPourInAnimation(o),i||this._actions.push({from:r,to:a,colorId:o,num:n}),t.checkIsFinshed()&&this.finishCupLong(t)},t.prototype.onWaterCleared=function(e,t){void 0===t&&(t=1);for(var o=0,n=this.cups;o<n.length;o++)(a=n[o]).tryReduceMaskCondition(e,t);for(var i=0,r=this.cups;i<r.length;i++){var a;if((a=r[i]).cupType===f.CupType.Frozen){a.tryReduceFrozenCount();break}}},t.prototype.undoAction=function(){var e=this._actions.pop();if(null==e)return!1;var t=e.from,o=e.to,n=e.num,i=e.colorId,r=this.cups[t];i=o>0?this.cups[o]:this.longCups[-o-1];for(var a=0,c=this.cups;a<c.length;a++)if(c[a].isPouring())return this._actions.push(e),!1;return null!=this.selected&&this.selected!=i&&this.doSelect(this.selected,!1),o<0?(this.startUndoPourLong(i,r,n),!0):(this.startUndoPour(i,r,n),!0)},t.prototype.startUndoPour=function(e,t,o){var n=this;e.currentState==f.CupState.Finished&&(e.currentState=f.CupState.Idle,this.finishedWater-=4,e.reverseFinishAnimation()),e.clearPourInAnimation(),e.currentState=f.CupState.Pouring,t.currentState=f.CupState.PouringIn,t.node.zIndex=0,e.node.zIndex=10;var i=e.getTop(),r=cc.v2(t.node.position),a=t.node.parent.convertToWorldSpaceAR(r),c=cc.view.getVisibleSize(),s=a.x>.5*c.width;Math.abs(a.x-.5*c.width)<2&&(s=e.node.parent.convertToWorldSpaceAR(cc.v2(e.node.position)).x<.5*c.width),r.y+=60+.5*t.node.height,r.x=r.x+(s?-0:0),r=t.node.parent.convertToWorldSpaceAR(r),e.setPourAnchor(s),r=e.node.parent.convertToNodeSpaceAR(r);var l=this.getCurrentFromPool();l.active=!1;var u=this;l.scaleX=s?-1:1,this.selected=null,e.setPourAnchor(s);for(var p=0,d=f.SPLIT_COUNT-1;d>=0&&(0!=t.info.colorIds[d]||(t.info.colorIds[d]=i.topColorId,++p!=o));d--);e.moveToPour(r,s,o,function(){m.default.instance.playSFX(m.AudioRef.WaterFlow);var r=e.node.convertToWorldSpaceAR(cc.v2());cc.v2(r.x,t.getWaterSurfacePosY()).x=r.x,l.active=!0,l.parent=t.node.parent,l.setPosition(t.node.position),l.setSiblingIndex(0);var a=i.topColorId,c=f.WaterColors[a],s=f.SurfaceColors[a];l.getChildByName("current_dark").color=(new cc.Color).fromHEX(c),l.getChildByName("current_light").color=(new cc.Color).fromHEX(s),t.startAddWater(i.topColorId,o,function(){n.onPourOneFinished(e,t,i.topColorId,o,!0)})}.bind(this),function(){var o=e.node.convertToWorldSpaceAR(cc.v2()),n=cc.v2(o.x,t.getWaterSurfacePosY(!0));u.putCurrentToPool(l),n.x=o.x,e.setNormalAnchor();var i=e.orignPt;cc.tween(e.node).call(function(){t.checkIsStrictFinshed()||(t.currentState=f.CupState.Idle)}).delay(.3).to(.3,{x:i.x,y:i.y,angle:0},{easing:"sineOut"}).call(function(){t.checkIsStrictFinshed()||(e.currentState=f.CupState.Idle),cc.director.emit("do_pour"),e.node.zIndex=0}).start()}.bind(this))},t.prototype.startUndoPourLong=function(e,t,o){var n=e.getTop();e.clearPourInAnimation(),e.removeTopWaterImmediately(o),t.addWaterImmediately(n.topColorId,o),cc.director.emit("do_pour")},t.prototype.isOrgianizeAvailable=function(){for(var e=this.cups.filter(function(e){return e.currentState!=f.CupState.Finished&&e.isInteractable()}),t=0;t<e.length;t++)if(e[t].canOrganizeTopColor())return!0;return!1},t.prototype.organizeWater=function(){if(!this.cups.some(function(e){return e.isPouring()})){var e=this.cups.filter(function(e){return e.currentState!=f.CupState.Finished&&!e.isEmpty()});if(0!=e.length)for(var t=function(t){var o=e[t];if(!o.canOrganizeTopColor())return"continue";o.organizeTopColor(.5,function(){o.currentState=f.CupState.Idle,o.initWater(),cc.director.emit("do_pour")})},o=0;o<e.length;o++)t(o)}},t.prototype.canPumpWater=function(){var e=this.cups.filter(function(e){return!e.checkIsFinshed()&&!e.isEmpty()});if(0===e.length)return!1;for(var t=function(e){var t=e.getTop().topColorId;return 0===t?"continue":e.info.colorIds.some(function(e){return 0!==e&&e!==t})?{value:!0}:void 0},o=0,n=e;o<n.length;o++){var i=t(n[o]);if("object"==a(i))return i.value}return!1},t.prototype.pumpWater=function(){var e=this;y.default.instance.PopupTipsStay("\u8bf7\u70b9\u51fb\u4efb\u610f\u989c\u8272\u5c06\u5176\u7f6e\u9876"),this.cups.some(function(e){return e.isPouring()})||(this._actions=[],this.propMask.active=!0,y.default.instance.root_Tips.y-=100,this.isPumping=!0,this.pumpClickNode.on(cc.Node.EventType.TOUCH_START,function(t){for(var o=t.getLocation(),n=[],i=null,r=null,a=0,c=e.cups;a<c.length;a++){var s=c[a];if(s.node.getBoundingBoxToWorld().contains(o)){i=s;break}}if(i.cupType!==f.CupType.Locked&&i.cupType!==f.CupType.Frozen&&i.cupType!==f.CupType.Masked)if(i.currentState!==f.CupState.Finished&&i.currentState!==f.CupState.ReadyToBeCollected){var l=i.node.getChildByName("cupMask");n.push(l.children[0]),n.push(l.children[1]),n.push(l.children[2]),n.push(l.children[3]);for(var u=0,p=n;u<p.length;u++){var d=p[u];if(d.getBoundingBoxToWorld().contains(o)){r=d.name;break}}i&&r&&i.pumpWater(r,function(){i.initWater(),e.isPumping=!1,e.propMask.active=!1,y.default.instance.root_Tips.y+=100})&&(m.default.instance.playSFX(m.AudioRef.SortItem),y.default.instance.PopoutTips(),e.pumpClickNode.off(cc.Node.EventType.TOUCH_START))}else y.default.instance.ChangeTipsStay("\u8bf7\u9009\u62e9\u6ca1\u6709\u88c5\u6ee1\u7684\u74f6\u5b50",2);else y.default.instance.ChangeTipsStay("\u9009\u62e9\u7684\u74f6\u5b50\u8fd8\u6ca1\u6709\u89e3\u9501\u54e6",2)},this))},t.prototype.ifDeadLock=function(){for(var e=this.cups.filter(function(e){return e.currentState!=f.CupState.Finished&&e.canCheckDeadlock()}),t=0;t<e.length;t++){if((l=e[t]).isEmpty())return!1;if(l.cupType!=f.CupType.Fixed){for(var o=0,n=0;n<e.length;n++)if(t!==n){var i=e[n];if(i.isEmpty())return!1;if((i.getTop().topColorId==l.getTop().topColorId||100==Math.abs(i.getTop().topColorId-l.getTop().topColorId))&&(o+=i.getTop().emptyNum,l.canPourTo(i)))return!1}if(o>=l.getTop().topColorNum)return!1}}var r=this.longCups.filter(function(e){return e.currentState!=f.CupState.Finished});for(t=0;t<r.length;t++)for(var a=r[t].getTop().topColorId,c=0,s=e;c<s.length;c++){var l;if((l=s[c]).getTop().topColorId==a)return!1}return!0},t.prototype.hasLockedCups=function(){return this.cups.some(function(e){return e.cupType===f.CupType.Locked})},t.prototype.getLockedCups=function(){for(var e=0;e<this.cups.length;e++)if(this.cups[e].cupType===f.CupType.Locked)return this.cups[e].node;return null},t.prototype.canDyeWater=function(){var e=this.cups.filter(function(e){return!e.checkIsFinshed()});if(0===e.length)return!1;for(var t=new Set,o=0,n=this.cups;o<n.length;o++){var i=n[o];i.cupType===f.CupType.Masked&&i.getMaskUnlockColorId()>0&&t.add(i.getMaskUnlockColorId())}for(var r=0,a=this.targetColorsIds;r<a.length;r++){var c=a[r];t.add(c)}var s={};e.forEach(function(e){e.info.colorIds.forEach(function(e){if(0!==e){var t=e>100?e-100:e;s[t]||(s[t]=0),s[t]++}})});var l=Object.keys(s).map(function(e){return parseInt(e)});if(l.length<2)return!1;for(var u=0,p=0,d=l;p<d.length;p++){var h=d[p];(g=s[h])>u&&(u=g)}for(var y=0,m=l;y<m.length;y++){var g;if(h=m[y],!t.has(h)&&(g=s[h])<u&&g>=4)return!0}return!1},t.prototype.dyeWater=function(){var e=this;if(this.cups.some(function(e){return e.isPouring()}))return!1;this._actions=[];var t=this.cups.filter(function(e){return!e.checkIsFinshed()});if(0===t.length)return!1;for(var o=new Set,n=0,i=this.cups;n<i.length;n++){var r=i[n];r.cupType===f.CupType.Masked&&r.getMaskUnlockColorId()>0&&o.add(r.getMaskUnlockColorId())}for(var a=0,c=this.targetColorsIds;a<c.length;a++){var s=c[a];o.add(s)}var l={},u={};t.forEach(function(e){e.info.colorIds.forEach(function(t,o){if(0!==t){var n=t>100?t-100:t;l[n]||(l[n]=0,u[n]=[]),l[n]++,u[n].push({cup:e,index:o})}})});var p=Object.keys(l).map(function(e){return parseInt(e)});if(p.length<2)return!1;for(var h=-1,y=0,m=0,g=p;m<g.length;m++){var v=g[m];this.targetColorsIds.includes(v)&&(C=l[v])>y&&(y=C,h=v)}for(var _=[],S=0,b=p;S<b.length;S++){var C;v=b[S],o.has(v)||(C=l[v])<y&&C>=4&&_.push(v)}if(0===_.length)return!1;for(var P=_[Math.floor(Math.random()*_.length)],k=u[P],w=[],I=d(k);w.length<4&&I.length>0;){var T=Math.floor(Math.random()*I.length);w.push(I[T]),I.splice(T,1)}return w.forEach(function(t){t.cup.info.colorIds[t.index]>100&&t.cup.onShowHidden(t.index);var o=[];(o=t.cup.info.colorIds)[t.index]=h,t.cup.dyeWater(o,function(){t.cup.initWater(),1==t.cup.checkIsFinshed()&&e.finishCup(t.cup)})}),!0},t.prototype.finishCup=function(e){if(e.currentState!==f.CupState.Finished&&e.cupType!==f.CupType.Frozen&&e.cupType!==f.CupType.Masked){e.currentState=f.CupState.Finished;var t=e.getTop().topColorId;this._actions=[],this.targetColorsIds.includes(t)?e.currentState=f.CupState.Idle:(e.node.parent==this.node&&(this.finishedWater+=4),this.playFinishAnimation(e),cc.director.getScene().name!==v.SceneNames.GameModeMultiple&&this.playBubbleAnimation(e),e.playFinishAnimation(),e.node.parent==this.node&&this.onWaterCleared(e.getTop().topColorId,1),this.checkIsAllFinished()&&(cc.log("---------\u5b8c\u6210\u4e86"),cc.director.emit("level_finish")))}},t.prototype.finishCupLong=function(e){e.currentState!==f.CupState.Finished&&e.cupType!==f.CupType.Frozen&&e.cupType!==f.CupType.Masked&&(e.node.parent==this.node&&this.finishedLongCups++,this.playFinishAnimationLong(e),e.playFinishAnimation(),e.node.parent==this.node&&this.onWaterCleared(e.getTop().topColorId,1),this.checkIsAllFinished()&&(cc.log("---------\u5b8c\u6210\u4e86"),cc.director.emit("level_finish")))},t.prototype.getProgress=function(){var e=this.finishedWater/this.totalWater;return Math.round(100*e)/100},t.prototype.getPourNum=function(e,t){var o=e.getTop(),n=t.getTop();return 0==o.topColorId?0:0==n.topColorId?o.topColorNum:Math.min(o.topColorNum,n.emptyNum)},t.prototype.getActionNum=function(){return this._actions.length},t.prototype.checkIsAllFinished=function(){return this.finishedLongCups==this.longCups.length},t.prototype.getDropNum=function(){for(var e=0,t=0,o=this.cups;t<o.length;t++)e+=4-o[t].getTop().emptyNum;return e},t.instance=null,l([k(cc.Prefab)],t.prototype,"waterCurrent",void 0),l([k(cc.Prefab)],t.prototype,"waterCurrentLongPrefab",void 0),l([k(cc.Prefab)],t.prototype,"finishAnimation",void 0),l([k(cc.Prefab)],t.prototype,"bubble",void 0),l([k(cc.Node)],t.prototype,"propMask",void 0),l([k(cc.Node)],t.prototype,"pumpClickNode",void 0),o=l([P],t)}(cc.Component));r.default=w,cc._RF.pop(),cc._RF.pop()},{}],CupMgr_Multi:[function(t,o,n){"use strict";cc._RF.push(o,"12c01CKPNhM8INVyuKGS4wW","CupMgr_Multi");var i=t,r=o,a=n,c=function(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(r,"12c01CKPNhM8INVyuKGS4wW","CupMgr_Multi");var s,l=(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),u=function(e,t,o,n){var i,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":c(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(r<3?i(a):r>3?i(t,o,a):i(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(a,"__esModule",{value:!0});var p=i("Cup"),d=i("CupMgr"),f=i("LevelManager"),h=i("const"),y=i("GameManager_Multi"),m=cc._decorator,g=m.ccclass,v=(m.property,function(t){function o(){var e=null!==t&&t.apply(this,arguments)||this;return e.cupPool=[],e.consecutiveMarkCount=0,e.initCfgs=[],e.targetCupCount=0,e.currentCupCount=0,e}return l(o,t),o.prototype.onLoad=function(){this.generateInitialCups()},o.prototype.update=function(e){t.prototype.update.call(this,e),this.initLevel()},o.prototype.getCupFromPool=function(e){for(var t=this.cupPool.length-1;t>=0;t--){var o=this.cupPool[t];if(o&&o.node&&o.node.name===e)return this.cupPool.splice(t,1),o}return null},o.prototype.recycleCupToPool=function(e){e&&-1===this.cupPool.indexOf(e)&&(e.reset(),this.cupPool.push(e))},o.prototype.clearPool=function(){this.cupPool.length=0},o.prototype.finishCup=function(e){var o=this;if(!(e.currentState===p.CupState.Finished||e.isFrozen()||e.hasMask()||e.currentState===p.CupState.ReadyToBeCollected||(y.default.getInstance().onFinishOneCup(e.node),t.prototype.finishCup.call(this,e),e.node.getNumberOfRunningActions()>0))){var n=e.node.position;cc.tween(e.node).call(function(){o.getCandidateCup(n)}).delay(1.4).parallel(cc.tween(e.node).by(.2,{y:.2*e.node.height},{easing:"sineOut"}).delay(.15).to(.6,{x:-1250},{easing:"sineOut"}),cc.tween(e.node).delay(.2).to(.2,{angle:15},{easing:"sineOut"})).call(function(){o.cups.splice(o.cups.indexOf(e),1),o.recycleCupToPool(e)}).start()}},o.prototype.getCandidateCup=function(e){var o=this.getRandomCandidateCupConfig();if(o){var n=this.getCupFromPool(this.getCupName(o.type));n?(console.error("\u4ece\u5bf9\u8c61\u6c60\u83b7\u53d6\u968f\u673a\u8865\u5145\u676f\u5b50",o),n.reset(),t.prototype.setUpCup.call(this,o,n),n.initCup(o)):(console.error("\u751f\u6210\u968f\u673a\u8865\u5145\u676f\u5b50",o),(n=f.default.getInstance().createOneCup(o,this.node)).node.parent=this.node,n.initCup(o),t.prototype.setUpCup.call(this,o,n)),this.cups.push(n),cc.director.emit(h.EventNames.GenerateCandidate),n.node.setPosition(1250,e.y+.2*n.node.height),cc.tween(n.node).delay(1.75).parallel(cc.tween(n.node).to(.6,{x:e.x},{easing:"sineIn"}).delay(.15).to(.2,{y:e.y},{easing:"sineIn"}),cc.tween(n.node).call(function(){n.node.angle=15}).delay(.6).to(.15,{angle:0},{easing:"sineOut"})).call(function(){n.orignPt=n.node.position,n.cupType!==p.CupType.Bomb&&n.cupType!==p.CupType.BombFrozen&&n.cupType!==p.CupType.BombMasked||n.startTimer()}).start()}},o.prototype.getCupName=function(e){switch(e){case p.CupType.Normal:return"cup";case p.CupType.Frozen:return"cup_frozen";case p.CupType.Masked:return"cup_masked";case p.CupType.Bomb:return"cup_bomb";case p.CupType.Locked:return"cup_ad";case p.CupType.BombFrozen:return"cup_bombFrozen";case p.CupType.BombMasked:return"cup_bombMasked";default:return"cup"}},o.prototype.getRandomCandidateCup=function(e){var o=this.getRandomCandidateCupConfig();if(o){var n=this.getCupFromPool(this.getCupName(o.type));n?(n.reset(),t.prototype.setUpCup.call(this,o,n),n.initCup(o)):((n=f.default.getInstance().createOneCup(o,this.node)).node.parent=this.node,n.initCup(o),t.prototype.setUpCup.call(this,o,n)),this.cups.push(n),cc.director.emit(h.EventNames.GenerateCandidate),n.node.setPosition(1250,e.y+.2*n.node.height),n.isFillingIn=!0,cc.tween(n.node).delay(1.75).parallel(cc.tween(n.node).to(.6,{x:e.x},{easing:"sineIn"}).delay(.15).to(.2,{y:e.y},{easing:"sineIn"}),cc.tween(n.node).call(function(){n.node.angle=15}).delay(.6).to(.15,{angle:0},{easing:"sineOut"})).call(function(){n.orignPt=n.node.position,n.isFillingIn=!1}).start()}},o.prototype.getRandomCandidateCupConfig=function(){var e={type:p.CupType.Normal,pos:{x:0,y:0},colorIds:[0,0,0,0]};e.colorIds=[0,0,0,0];var t=8;y.default.getInstance().currentScore>=50?t=9:y.default.getInstance().currentScore>=400&&(t=10);for(var o=0;o<e.colorIds.length;o++)e.colorIds[o]=Math.floor(Math.random()*t)+1;for(;new Set(e.colorIds).size<4;)for(o=0;o<e.colorIds.length;o++)e.colorIds[o]=Math.floor(Math.random()*t)+1;var n=this.handleTypeRandom();return this.handleType(n,e,t)},o.prototype.handleMarkLogic=function(e){var t,o=y.default.getInstance().currentScore,n=0;if(this.consecutiveMarkCount>=4)n=0;else{var i=Math.random();n=o>1e3?i<5/11?0:i<8/11?1:i<10/11?2:3:o>600?i<.5?0:i<.8?1:2:o>250?i<.6?0:1:0}if(0===n)return this.consecutiveMarkCount=0,e;this.consecutiveMarkCount++;for(var r=[0,1,2],a=r.length-1;a>0;a--){var c=Math.floor(Math.random()*(a+1));t=[r[c],r[a]],r[a]=t[0],r[c]=t[1]}var s=0;for(1===n?s=1:2===n?s=2:3===n&&(s=3),a=0;a<s;a++){var l=r[a];e.colorIds[l]+=100}return e},o.prototype.handleTypeRandom=function(){var e=[1,0,0,0,0,0,0],t=y.default.getInstance().currentScore;t>=5e3?e=[35,20,20,15,20,10,10]:t>=3e3?e=[30,15,15,10,15,5,0]:t>=1500?e=[25,20,10,10,10,0,0]:t>=800?e=[20,12,10,8,0,0,0]:t>=200?e=[8,4,4,0,0,0,0]:t>=100&&(e=[5,3,0,0,0,0,0]);for(var o=0,n=0;n<e.length;n++)o+=e[n];var i=Math.floor(Math.random()*o),r=0;for(n=0;n<e.length;n++)if(i<(r+=e[n]))return n;return Math.floor(7*Math.random())},o.prototype.handleType=function(e,t,o){var n=Math.random(),i=0,r=0;switch(e){case 1:t.type=p.CupType.Frozen,i=n<5/12?2:n<.75?3:n<11/12?4:5,t.frozenUnlockCount=i,console.error("\u751f\u6210\u51b0\u51bb\u676f");break;case 2:t.type=p.CupType.Masked,t.maskUnlockColorId=Math.floor(Math.random()*o)+1,i=n<5/12?2:n<.75?3:n<11/12?4:5,t.maskUnlockCount=i,console.error("\u751f\u6210\u906e\u7f69\u676f");break;case 3:for(var a=0,c=this.cups;a<c.length;a++)if(((y=c[a]).cupType===p.CupType.BombMasked||y.cupType===p.CupType.BombFrozen||y.cupType===p.CupType.Bomb)&&++r>=2)return t.type=p.CupType.Normal,t;t.type=p.CupType.Bomb,t.bombTime=120,console.error("\u751f\u6210\u70b8\u5f39\u676f");break;case 4:i=n<5/12?2:n<.75?3:n<11/12?4:5;var s=Math.floor(Math.random()*(i-1))+1,l=i-s;t.type=p.CupType.Frozen,t.frozenUnlockCount=s,t.maskUnlockColorId=Math.floor(Math.random()*o)+1,t.maskUnlockCount=l,console.error("\u751f\u6210\u906e\u7f69\u51b0\u51bb\u676f");break;case 5:for(var u=0,d=this.cups;u<d.length;u++)if(((y=d[u]).cupType===p.CupType.BombMasked||y.cupType===p.CupType.BombFrozen||y.cupType===p.CupType.Bomb)&&++r>=2)return t.type=p.CupType.Normal,t;t.type=p.CupType.BombMasked,t.bombTime=120,i=n<5/11?2:n<9/11?3:4,t.maskUnlockColorId=Math.floor(Math.random()*o)+1,t.maskUnlockCount=i,console.error("\u751f\u6210\u70b8\u5f39\u906e\u7f69\u676f");break;case 6:for(var f=0,h=this.cups;f<h.length;f++){var y;if(((y=h[f]).cupType===p.CupType.BombMasked||y.cupType===p.CupType.BombFrozen||y.cupType===p.CupType.Bomb)&&++r>=2)return t.type=p.CupType.Normal,t}t.type=p.CupType.BombFrozen,t.bombTime=120,i=n<5/11?2:n<9/11?3:4,t.frozenUnlockCount=i,console.error("\u751f\u6210\u70b8\u5f39\u51b0\u51bb\u676f");break;default:t.type=p.CupType.Normal,console.error("\u751f\u6210\u666e\u901a\u676f")}return t},o.prototype.generateInitialCups=function(){this.node.scale=.8;for(var e=[],t=1;;){++t>8&&(t=1);for(var o=0;o<4;o++)e.push(t);if(e.length>=152)break}for(var n=this.shuffleArray(e),i=2;i>=-2;i--)for(var r=-4;r<=4;r++)if(!(-2==i&&r>=3)){var a=[];if(0==i&&r>=-2&&r<=2)a=[0,0,0,0];else for(var c=0;c<4;c++){var s=n.pop();a.push(s)}var l={type:p.CupType.Normal,pos:{x:0+100*r,y:0+270*i},colorIds:a};0==i&&r>0&&r<=2&&(l.type=p.CupType.Locked),this.initCfgs.push(l)}this.targetCupCount=43,this.currentCupCount=0},o.prototype.initLevel=function(){if(!(this.currentCupCount>this.targetCupCount))for(var e=0;e<5;e++){if(this.currentCupCount>=this.targetCupCount){cc.director.emit(h.EventNames.LoadLevel),this.currentCupCount++;break}var t=this.initCfgs[this.currentCupCount];this.cups.push(f.default.getInstance().createOneCup(t,this.node)),this.currentCupCount++}},o.prototype.shuffleArray=function(t){for(var o=function(e){for(var t=0;t+3<e.length;t++)if(e[t]===e[t+1]&&e[t]===e[t+2]&&e[t]===e[t+3])return!0;return!1},n=function(e){for(var t=e.length-1;t>0;t--){var o=Math.floor(Math.random()*(t+1)),n=e[t];e[t]=e[o],e[o]=n}},i=0;i<2e3;i++){var r=t.slice();if(n(r),!o(r))return r}for(var a={},c=0,s=t;c<s.length;c++){var l=s[c];a[l]=(a[l]||0)+1}t.length;for(var u=[],p=function(){var e=u.slice(-3),i=null;3===e.length&&e[0]===e[1]&&e[1]===e[2]&&(i=e[0]);var r=Object.keys(a).map(Number).filter(function(e){return a[e]>0&&e!==i});if(r.length>0){var c=r[Math.floor(Math.random()*r.length)];return u.push(c),a[c]--,"continue"}for(var s=!1,l=0,p=Object.keys(a).map(Number).filter(function(e){return a[e]>0});l<p.length;l++){for(var d=p[l],f=0;f<=u.length;f++){for(var h=0,y=f-1;y>=0&&u[y]===d;y--)h++;for(var m=0,g=f;g<u.length&&u[g]===d;g++)m++;if(h+1+m<4){u.splice(f,0,d),a[d]--,s=!0;break}}if(s)break}if(!s){for(var v=0;v<5e3;v++){var _=t.slice();if(n(_),!o(_))return{value:_}}for(var S=[],b=0,C=Object.keys(a);b<C.length;b++)for(var P=C[b],k=0;k<a[+P];k++)S.push(+P);for(var w=0,I=S;w<I.length;w++){var T=I[w],A=!1;for(f=0;f<=u.length;f++){for(h=0,y=f-1;y>=0&&u[y]===T;y--)h++;for(m=0,g=f;g<u.length&&u[g]===T;g++)m++;if(h+1+m<4){u.splice(f,0,T),A=!0;break}}A||u.push(T)}return{value:u}}};Object.keys(a).some(function(e){return a[+e]>0});){var d=p();if("object"==e(d))return d.value}return u},u([g],o)}(d.default));a.default=v,cc._RF.pop(),cc._RF.pop()},{}],CupMgr:[function(e,t,o){"use strict";cc._RF.push(t,"162caJdeQxMJoFwNDNLc63b","CupMgr");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"162caJdeQxMJoFwNDNLc63b","CupMgr");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},p=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},d=function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<o;t++)for(var r=arguments[t],a=0,c=r.length;a<c;a++,i++)n[i]=r[a];return n};Object.defineProperty(r,"__esModule",{value:!0});var f=n("Cup"),h=n("LevelManager"),y=n("CommonData"),m=n("GameScene"),g=n("AudioManager"),v=n("GameManager"),_=n("const"),S=n("PackageManger"),b=n("CupTips"),C=n("FinishParticle"),P=n("UnlockData"),k=n("DataNexusEnum"),w=n("DataNexusSDK"),I=n("Water"),T=cc._decorator,A=T.ccclass,O=T.property,R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.waterCurrent=null,t.totalWater=0,t.finishedWater=0,t.currentLevelAdWatchedCount=0,t.itemInfos=[],t.cups=[],t.currentPool=[],t.waterCurrent1=null,t.current1Pool=[],t.ifFirstClick=!0,t.selected=null,t.unlockNode=null,t.bubble=null,t.bubblePool=[],t.activeBubbles=0,t.bubbleTimer=null,t.finishedCups=[],t._actions=[],t.propMask=null,t.isOrganizing=!1,t.isPumping=!1,t.pumpClickNode=null,t.emptyCupPosArray=[],t.addEmptyCupPrefab=null,t.ifAddTemp1EmptyCup=!1,t.guidePrefab=null,t.guideNode=null,t.rightNode=null,t.wrongNode=[],t.showFlags=[!0,!0,!0,!0,!0],t.isHiding=!1,t.step=0,t.rightPrefab=null,t.wrongPrefab=null,t.lastSelected=null,t.candidateCupCfgs=[],t.movingCupsCnt=0,t.candidateMaskFrozenWeight=[0,0,0],t.lastMaskColorId=-1,t}var o;return s(t,e),o=t,t.getInstance=function(){return o.instance?o.instance:null},t.prototype.onEnable=function(){o.instance=this},t.prototype.onLoad=function(){cc.director.on("load_level_finish",this.guide,this),cc.director.on("load_level_finish",this.checkAddEmptyType,this)},t.prototype.onDestroy=function(){cc.director.off("load_level_finish",this.guide,this),cc.director.off("load_level_finish",this.checkAddEmptyType,this),o.instance=null},t.prototype.start=function(){var e,t;cc.director.getScene().name==_.SceneNames.Game&&(null===(e=h.default.getInstance())||void 0===e||e.loadLevel()),cc.director.getScene().name==_.SceneNames.Main&&f.resetColors(),cc.director.getScene().name==_.SceneNames.RingFight&&(null===(t=h.default.getInstance())||void 0===t||t.loadLevel_RingFight()),this.selected=null,this._actions=[],this.startBubbleAnimation()},t.prototype.resetCupColors=function(){f.resetColors()},t.prototype.shuffleColors=function(){var e=Array.from({length:f.WaterColors.length},function(e,t){return t}),t=e.slice(0,4),o=e.slice(4);o.sort(function(){return Math.random()-.5});var n=(e=d(t,o)).map(function(e){return f.WaterColors[e]}),i=e.map(function(e){return f.SurfaceColors[e]}),r=e.map(function(e){return f.finishStart[e]}),a=e.map(function(e){return f.finishEnd[e]}),c=e.map(function(e){return f.SplashColors[e]}),s=e.map(function(e){return f.ColorIDRef[e]});f.setColors(n,i,r,a,c,s)},t.prototype.update=function(){1==y.default.CurrentLevel&&null!=this.guideNode&&cc.director.getScene().name==_.SceneNames.Game&&this.updateGuide()},t.prototype.setUpCup=function(e,t){return u(this,void 0,void 0,function(){return p(this,function(){return t.setCupInfo(e,this.onClickCup.bind(this)),t.orignPt=t.node.position,[2]})})},t.prototype.getCurrentFromPool=function(){if(this.currentPool.length>0){var e=this.currentPool.pop();return e.active=!0,e}return cc.instantiate(this.waterCurrent)},t.prototype.putCurrentToPool=function(e){e&&cc.isValid(e)&&(e.active=!1,e.parent=null,this.currentPool.push(e))},t.prototype.getCurrent1FromPool=function(){if(this.current1Pool.length>0){var e=this.current1Pool.pop();return e.active=!0,e}return cc.instantiate(this.waterCurrent1)},t.prototype.putCurrent1ToPool=function(e){e&&cc.isValid(e)&&(e.active=!1,e.parent=null,this.current1Pool.push(e))},t.prototype.onClickCup=function(e){var t=this,o=e.node.position;if(cc.director.emit(_.EventNames.OnClickCup,o),this.ifFirstClick&&(cc.director.emit(_.EventNames.FirstClickCup,e.node.parent),cc.director.emit(_.EventNames.Resume),this.ifFirstClick=!1),m.default.instance.resetFingerHintTimer(),e.isInteractable()){if(!this.isPumping)if(this.selected)if(this.selected==e)this.doSelect(e,!1),this.selected=null;else if(this.checkPour(this.selected,e)){b.default.instance.setToZero();var n=this.getPourNum(this.selected,e);cc.director.emit(_.EventNames.OnClickPour),this.selected.currentState=f.CupState.Pouring,this.startPour(this.selected,e,n),e.currentState=f.CupState.PouringIn}else{if(e.currentState==f.CupState.PouringIn)return;if(this.doSelect(this.selected,!1),e.currentState==f.CupState.Finished)return;if(e.cupType==f.CupType.Fixed||e.cupType==f.CupType.BombFixed)return;this.doSelect(e,!0),this.selected=e}else{if(e.currentState==f.CupState.Finished)return;if(e.currentState==f.CupState.PouringIn)return;if(e.cupType==f.CupType.Fixed||e.cupType==f.CupType.BombFixed)return void m.default.instance.PopupTips("\u74f6\u5b50\u88ab\u56fa\u5b9a\u4f4f\u5566",2);this.selected=e,this.doSelect(e,!0)}}else if(e.cupType==f.CupType.Locked||e.cupType==f.CupType.Temp1AD){if(y.default.ifTest&&y.default.ifSkipAd)return e.unlockCup(),void cc.director.emit(_.EventNames.DoPour);if(cc.director.getScene().name==_.SceneNames.Game&&y.default.Level<=2)return e.unlockCup(),cc.director.emit(_.EventNames.DoPour),void this.updateLockedCups();cc.director.getScene().name==_.SceneNames.Game&&(y.default.firstAdd||y.default.firstProp)?(this.selected&&this.doSelect(this.selected,!1),this.selected=e,e.playSelectHighlight(!0),v.default.platform.reportButtonEvent("GamePage_addCup_share",4),v.default.platform.showShare(function(){v.default.platform.reportShareEvent("GamePage_addCup_share"),v.default.platform.reportButtonEvent("GamePage_addCup_share",5),y.default.firstProp=!1,e.unlockCupWithTween(),t.updateLockedCups(),cc.director.emit(_.EventNames.DoPour),m.default.instance.resetFingerHintTimer()})):(v.default.platform.reportVideoEvent("GamePage_addBottle_video",1),w.default.instance.trackAdClick(k.RewardADEvent.UNLOCK_BOX),v.default.platform.showRewardAD(function(){w.default.instance.trackAdVideoFinish(k.RewardADEvent.UNLOCK_BOX),v.default.platform.reportVideoEvent("GamePage_addBottle_video",2),v.default.platform.reportAdPointEvent("AdPoint",t.getProgress()),e.unlockCupWithTween(),t.updateLockedCups(),cc.director.emit(_.EventNames.DoPour),m.default.instance.resetFingerHintTimer()}))}},t.prototype.doSelect=function(e,t){e.setAnchor(cc.v2(.5,.5)),v.default.playVibrateShort(),t&&e.clearPourInAnimation();var o=e.orignPt.y+(t?.2*e.node.height:0);t&&g.default.instance.playSFX(g.AudioRef.ChooseBottle),e.node.zIndex=t?99:0,cc.tween(e.node).stop(),e.node.stopAllActions(),e.playSelectHighlight(t),e.onSelectSurfaceAnimation(),e.cupType==f.CupType.Absorb&&t&&e.moveBottomNodesToParent(),e.cupType==f.CupType.Bomb&&t&&e.moveBottomNodesToParent(),cc.tween(e.node).to(.1,{y:o,angle:0}).call(function(){t?cc.tween(e.node).to(.5,{angle:-5},{easing:"sineOut"}).to(.5,{angle:0},{easing:"sineIn"}).to(.5,{angle:5},{easing:"sineOut"}).to(.5,{angle:0},{easing:"sineIn"}).union().repeatForever().start():(cc.tween(e.node).stop(),e.cupType==f.CupType.Absorb&&e.restoreBottomNodesParent(),e.cupType==f.CupType.Bomb&&e.restoreBottomNodesParent())}).start()},t.prototype.checkPour=function(e,t){var o=e.getTop(),n=t.getTop();return 0!=o.topColorId&&(t.cupType==f.CupType.SingleColor&&o.topColorId!=t.singleColorId?(m.default.instance.PopupTips("\u7279\u5b9a\u989c\u8272\u74f6\u5b50\u4ec5\u53ef\u5012\u5165\u540c\u8272\u6c34",2),!1):0==n.topColorId||n.emptyNum>0&&n.topColorId==o.topColorId)},t.prototype.isCollecting=function(){return y.default.Level%5!=0&&y.default.CurrentUnlockIndex<=y.default.collectionList.length||y.default.Level%5==0&&null!=P.default.CurrentUnlockItem},t.prototype.playFinishAnimation=function(e){C.default.getInstance().playFinishAnimation(e)},t.prototype.getBubbleFromPool=function(){if(this.bubblePool.length>0){var e=this.bubblePool.pop();return e.active=!0,e}return cc.instantiate(this.bubble)},t.prototype.putBubbleToPool=function(e){e&&cc.isValid(e)&&(e.active=!1,e.parent=null,this.bubblePool.push(e))},t.prototype.startBubbleAnimation=function(){},t.prototype.stopBubbleAnimation=function(){this.bubbleTimer&&(clearInterval(this.bubbleTimer),this.bubbleTimer=null)},t.prototype.playBubbleAnimation=function(e){var t=this,o=this.getBubbleFromPool();o.parent=e.node.parent,o.setPosition(e.node.position),o.getComponent(sp.Skeleton).setAnimation(0,"paopao",!1),o.getComponent(sp.Skeleton).setCompleteListener(function(){t.putBubbleToPool(o)})},t.prototype.startPour=function(e,t,o){var n=this,i=o,r=o;e.cupType!==f.CupType.Temp1&&e.cupType!==f.CupType.Absorb||(r=4,i=1),t.cupType!==f.CupType.Temp1&&t.cupType!==f.CupType.Absorb||(i=4,r=1),t.cupType!=f.CupType.Temp1&&t.cupType!=f.CupType.Absorb||e.cupType!=f.CupType.Temp1&&e.cupType!=f.CupType.Absorb||(r=4,i=4),t.node.zIndex=0,e.node.zIndex=99;var a=e.getTop(),c=cc.v2(t.node.position),s=(t.node.parent.convertToWorldSpaceAR(c),cc.view.getVisibleSize(),t.node.x>=e.node.x);c.y+=35+.5*t.node.height,c.x=c.x+(s?-0:0),c=t.node.parent.convertToWorldSpaceAR(c),e.setPourAnchor(s),c=e.node.parent.convertToNodeSpaceAR(c);var l=null;(l=t.cupType==f.CupType.Temp1||t.cupType==f.CupType.Absorb?this.getCurrent1FromPool():this.getCurrentFromPool()).active=!1;var u=this;l.scaleX=s?-1:1,this.selected=null,e.hiddenMark.active=!1,null!=e.keyNode&&(e.keyNode.active=!1);for(var p=0,d=f.SPLIT_COUNT-1;d>=0&&(0!=t.info.colorIds[d]||(t.info.colorIds[d]=a.topColorId,++p!=i));d--);t.cupType==f.CupType.ChangeColor&&t.buffer++,e.cupType==f.CupType.ChangeColor&&e.buffer++,e.moveToPour(c,s,r,function(){var o=g.AudioRef.WaterFlow;1==r||4==r?o=g.AudioRef.WaterFlow1:2==r?o=g.AudioRef.WaterFlow2:3==r&&(o=g.AudioRef.WaterFlow3),g.default.instance.playSFX(o);var c=e.node.convertToWorldSpaceAR(cc.v2());c=n.node.convertToNodeSpaceAR(c);var s=cc.v2(c.x,t.getWaterSurfacePosY());(s=n.node.convertToNodeSpaceAR(s)).x=c.x;var u=a.topColorId,p=f.WaterColors[u],d=f.SurfaceColors[u];f.SurfaceColors[u],l.parent=t.node,t.node.zIndex=2,l.setSiblingIndex(1),l.active=!0,l.setPosition(0,0),l.getChildByName("current_dark").color=(new cc.Color).fromHEX(p),l.getChildByName("current_light").color=(new cc.Color).fromHEX(d),t.startAddWater(a.topColorId,i,function(){n.onPourOneFinished(e,t,a.topColorId,r)})}.bind(this),function(){var o=e.node.convertToWorldSpaceAR(cc.v2());o=this.node.convertToNodeSpaceAR(o),t.cupType==f.CupType.Temp1||t.cupType==f.CupType.Absorb?u.putCurrent1ToPool(l):u.putCurrentToPool(l);var n=cc.v2(o.x,t.getWaterSurfacePosY(!0));(n=this.node.convertToNodeSpaceAR(n)).x=o.x,e.setNormalAnchor();var i=e.orignPt;cc.tween(e.node).call(function(){t.checkIsStrictFinshed()||(t.currentState=f.CupState.Idle)}).delay(.15).to(.25,{x:i.x,y:i.y,angle:0},{easing:"sineInOut"}).call(function(){var o,n;e.tryRevealKey(),e.checkIsStrictFinshed()||e.cupType===f.CupType.Absorb||(e.currentState=f.CupState.Idle),cc.director.emit("do_pour"),e.node.zIndex=0,t.node.zIndex=0,t.currentState!=f.CupState.Finished&&t.currentState!=f.CupState.ReadyToBeCollected||u.sortAllFinishedCups(),e.hiddenMark.active=!0,null!=e.keyNode&&(e.keyNode.active=!0);var i=e.getTop();if(e.cupType==f.CupType.Absorb&&e.restoreBottomNodesParent(),e.cupType==f.CupType.Bomb&&e.restoreBottomNodesParent(),i.topColorId%1e3>100){for(var r=[],a=0;a<f.SPLIT_COUNT;a++)r.push(e.info.colorIds[a]);for(a=0;a<i.topColorNum+i.emptyNum;a++)if(0!=r[a]){if(r[a]!=i.topColorId)break;r[a]-=100,null===(n=(o=e).onShowHidden)||void 0===n||n.call(o,a)}e.showHiddenWater(r)}}).start()}.bind(this))},t.prototype.onPourOneFinished=function(e,t,o,n,i){var r=this;void 0===i&&(i=!1),5==this._actions.length&&this._actions.shift(),t.stopPourInAnimation(o),i||(this._actions.push({from:e,to:t,colorId:o,num:n}),this.step++),e.cupType==f.CupType.Absorb&&(this._actions=[]),t.checkIsFinshed()&&this.scheduleOnce(function(){r.finishCup(t)},0)},t.prototype.updateLockedCups=function(){for(var e=0,t=this.cups.filter(function(e){return e.cupType===f.CupType.Locked||e.cupType===f.CupType.Temp1AD});e<t.length;e++)t[e].setUpLockCup()},t.prototype.onWaterCleared=function(e,t){void 0===t&&(t=1);for(var o=0,n=this.cups;o<n.length;o++)if((a=n[o]).frozenCount>0&&a.maskColorCount<=0){a.tryReduceFrozenCount();break}for(var i=0,r=this.cups;i<r.length;i++){var a;(a=r[i]).tryReduceMaskCondition(e,t)}},t.prototype.checkIfCanUndo=function(){for(var e=0,t=this.cups;e<t.length;e++){var o=t[e];if(o.cupType==f.CupType.ChangeColor&&o.isChangingColor)return!1;if(o.water._action==I.WaterAction.colorChange)return!1}return!0},t.prototype.undoAction=function(){this.itemInfos.push({item_type:k.ItemType.UNDO,item_num:1});var e=this._actions.pop();if(null==e)return!1;for(var t=e.from,o=e.to,n=e.num,i=(e.colorId,o),r=t,a=0,c=this.cups;a<c.length;a++)if(c[a].isPouring())return this._actions.push(e),!1;return null!=this.selected&&this.selected!=i&&this.doSelect(this.selected,!1),b.default.instance.setToZero(),this.startUndoPour(i,r,n),!0},t.prototype.startUndoPour=function(e,t,o){var n=this,i=o,r=o;e.cupType!==f.CupType.Temp1&&e.cupType!==f.CupType.Absorb||(r=4,i=1),t.cupType!==f.CupType.Temp1&&t.cupType!==f.CupType.Absorb||(i=4,r=1),t.cupType!=f.CupType.Temp1&&t.cupType!=f.CupType.Absorb||e.cupType!=f.CupType.Temp1&&e.cupType!=f.CupType.Absorb||(r=4,i=4),e.currentState==f.CupState.Finished&&(e.currentState=f.CupState.Idle,this.finishedWater-=4,e.reverseFinishAnimation()),e.clearPourInAnimation(),e.currentState=f.CupState.Pouring,t.currentState=f.CupState.PouringIn,t.node.zIndex=0,e.node.zIndex=99;var a=e.getTop(),c=cc.v2(t.node.position),s=t.node.parent.convertToWorldSpaceAR(c),l=cc.view.getVisibleSize(),u=s.x>.5*l.width;Math.abs(s.x-.5*l.width)<2&&(u=e.node.parent.convertToWorldSpaceAR(cc.v2(e.node.position)).x<.5*l.width),c.y+=35+.5*t.node.height,c.x=c.x+(u?-0:0),c=t.node.parent.convertToWorldSpaceAR(c),e.setPourAnchor(u),c=e.node.parent.convertToNodeSpaceAR(c);var p=null;(p=t.cupType==f.CupType.Temp1||t.cupType==f.CupType.Absorb?this.getCurrent1FromPool():this.getCurrentFromPool()).active=!1;var d=this;p.scaleX=u?-1:1,this.selected=null,e.setPourAnchor(u);for(var h=0,y=f.SPLIT_COUNT-1;y>=0&&(0!=t.info.colorIds[y]||(t.info.colorIds[y]=a.topColorId,++h!=i));y--);t.cupType==f.CupType.ChangeColor&&t.buffer++,e.cupType==f.CupType.ChangeColor&&e.buffer++,e.moveToPour(c,u,r,function(){var o=g.AudioRef.WaterFlow;1==r||4==r?o=g.AudioRef.WaterFlow1:2==r?o=g.AudioRef.WaterFlow2:3==r&&(o=g.AudioRef.WaterFlow3),g.default.instance.playSFX(o);var c=e.node.convertToWorldSpaceAR(cc.v2());cc.v2(c.x,t.getWaterSurfacePosY()).x=c.x,p.active=!0,p.parent=t.node,t.node.zIndex=100,p.setSiblingIndex(1);var s=a.topColorId,l=f.WaterColors[s],u=f.SurfaceColors[s];p.getChildByName("current_dark").color=(new cc.Color).fromHEX(l),p.getChildByName("current_light").color=(new cc.Color).fromHEX(u),t.startAddWater(a.topColorId,i,function(){n.onPourOneFinished(e,t,a.topColorId,r,!0)},!0)}.bind(this),function(){var o=e.node.convertToWorldSpaceAR(cc.v2()),n=cc.v2(o.x,t.getWaterSurfacePosY(!0));t.cupType==f.CupType.Temp1||t.cupType==f.CupType.Absorb?d.putCurrent1ToPool(p):d.putCurrentToPool(p),n.x=o.x,e.setNormalAnchor();var i=e.orignPt;cc.tween(e.node).call(function(){t.checkIsStrictFinshed()||(t.currentState=f.CupState.Idle)}).delay(.15).to(.25,{x:i.x,y:i.y,angle:0},{easing:"sineOut"}).call(function(){t.checkIsStrictFinshed()||(e.currentState=f.CupState.Idle),e.cupType==f.CupType.Bomb&&e.restoreBottomNodesParent(),cc.director.emit("do_pour"),e.node.zIndex=0,t.node.zIndex=0}).start()}.bind(this))},t.prototype.isOrgianizeAvailable=function(){for(var e=this.cups.filter(function(e){return e.currentState!=f.CupState.Finished&&e.isInteractable()}),t=0;t<e.length;t++)if(e[t].canOrganizeTopColor())return!0;return!1},t.prototype.organizeWater=function(){if(!this.cups.some(function(e){return e.isPouring()})){var e=this.cups.filter(function(e){return e.currentState!=f.CupState.Finished&&!e.isEmpty()});if(0!=e.length)for(var t=function(t){var o=e[t];if(!o.canOrganizeTopColor())return"continue";o.organizeTopColor(.5,function(){o.currentState=f.CupState.Idle,o.initWater(),cc.director.emit("do_pour")})},o=0;o<e.length;o++)t(o)}},t.prototype.canPumpWater=function(){var e=this.cups.filter(function(e){return!e.checkIsFinshed()&&!e.isEmpty()&&!1===e.hasMask()&&!1===e.isFrozen()&&e.cupType!==f.CupType.Locked&&e.cupType!==f.CupType.Temp1AD&&e.cupType!==f.CupType.Absorb&&e.cupType!==f.CupType.Temp1});if(0===e.length)return!1;for(var t=function(e){var t=e.getTop().topColorId;return 0===t?"continue":e.info.colorIds.some(function(e){return 0!==e&&e!==t})?{value:!0}:void 0},o=0,n=e;o<n.length;o++){var i=t(n[o]);if("object"==a(i))return i.value}return!1},t.prototype.pumpWater=function(){var e=this;b.default.instance.setToZero(),this.selected&&this.doSelect(this.selected,!1),m.default.instance.PopupTipsStay("\u8bf7\u70b9\u51fb\u4efb\u610f\u989c\u8272\u8ba9\u5176\u7f6e\u9876"),this._actions=[],this.propMask.active=!0,m.default.instance.root_Tips.y-=100,this.isPumping=!0,this.pumpClickNode.on(cc.Node.EventType.TOUCH_START,function(t){for(var o=t.getLocation(),n=[],i=null,r=null,a=0,c=e.cups;a<c.length;a++){var s=c[a];if(s.node.getBoundingBoxToWorld().contains(o)){i=s;break}}if(i)if(i.cupType===f.CupType.Locked||i.cupType===f.CupType.Temp1AD||i.isFrozen()||i.hasMask())m.default.instance.ChangeTipsStay("\u9009\u62e9\u7684\u74f6\u5b50\u8fd8\u6ca1\u6709\u89e3\u9501\u54e6",2);else if(i.currentState!==f.CupState.Finished&&i.currentState!==f.CupState.ReadyToBeCollected){var l=i.node.getChildByName("cupMask");n.push(l.children[0]),n.push(l.children[1]),n.push(l.children[2]),n.push(l.children[3]);for(var u=0,p=n;u<p.length;u++){var d=p[u];if(d.getBoundingBoxToWorld().contains(o)){r=d.name;break}}i&&r&&i.pumpWater(r,function(){i.initWater(),e.isPumping=!1,e.propMask.active=!1,m.default.instance.root_Tips.y+=100})&&(g.default.instance.playSFX(g.AudioRef.SortItem),m.default.instance.PopoutTips(),e.pumpClickNode.off(cc.Node.EventType.TOUCH_START))}else m.default.instance.ChangeTipsStay("\u8bf7\u9009\u62e9\u6ca1\u6709\u88c5\u6ee1\u7684\u74f6\u5b50",2);else e.cancelPumpWater()},this)},t.prototype.cancelPumpWater=function(){y.default.PropPump++,this.isPumping=!1,this.propMask.active=!1,this.scheduleOnce(function(){m.default.instance.root_Tips.y+=100},.3),m.default.instance.PopoutTips(),this.pumpClickNode.off(cc.Node.EventType.TOUCH_START),cc.director.emit(_.EventNames.DoPour)},t.prototype.sortEmptyCupPos=function(){this.emptyCupPosArray.sort(function(e,t){return e.y!==t.y?t.y-e.y:e.x-t.x})},t.prototype.canAddEmptyCup=function(){return this.cups.filter(function(e){return e.cupType==f.CupType.Locked||e.cupType==f.CupType.Temp1AD}).length>0||this.emptyCupPosArray.length>0},t.prototype.checkAddEmptyType=function(){this.ifAddTemp1EmptyCup=this.cups.some(function(e){return e.cupType===f.CupType.Temp1AD})},t.prototype.addEmptyCup=function(){var e=this.cups.filter(function(e){return e.cupType==f.CupType.Locked||e.cupType==f.CupType.Temp1AD});if(e.length>0){var t=e[0];return!this.selected||this.selected.cupType!=f.CupType.Locked&&this.selected.cupType!=f.CupType.Temp1AD||(t=this.selected),t.unlockCup(),null!=this.selected&&this.doSelect(this.selected,!1),this.selected=t,t.playSelectHighlight(!0),void cc.director.emit(_.EventNames.DoPour)}this.sortEmptyCupPos();var o=this.emptyCupPosArray.shift(),n={pos:cc.v2(1e3,o.y),colorIds:[0,0,0,0],type:f.CupType.Normal},i="chang";this.ifAddTemp1EmptyCup&&(n.type=f.CupType.Temp1,i="duan");var r=h.default.getInstance().createOneCup(n,this.node);this.cups.push(r),r.orignPt=o;var a=cc.instantiate(this.addEmptyCupPrefab);a.parent=cc.find("Canvas");var c=a.getComponent(sp.Skeleton);b.default.instance.setToZero(),c.setAnimation(0,i,!1),c.setCompleteListener(function(){a.destroy()}),cc.tween(r.node).to(.5,{x:o.x},{easing:"sineIn"}).call(function(){cc.director.emit(_.EventNames.DoPour),cc.director.emit(_.EventNames.UpdateTestNumber)}).start()},t.prototype.ifDeadLock=function(){if(this.isAnyCupRestoring())return!1;for(var e=this.cups.filter(function(e){return e.currentState!=f.CupState.Finished&&e.currentState!=f.CupState.ReadyToBeCollected&&e.canCheckDeadlock()}),t=[],o=[0,0,0,0,0,0,0,0,0,0,0],n=!0,i=0;i<e.length;i++){var r=e[i];if(!r.isEmpty()&&(n=!1,r.cupType!=f.CupType.Fixed&&r.cupType!=f.CupType.BombFixed)){for(var a=0,c=0;c<e.length;c++)if(i!==c){var s=e[c];if(s.cupType!=f.CupType.Absorb){if(s.isEmpty()&&s.cupType!=f.CupType.SingleColor)return!1;if(s.isEmpty()&&s.cupType==f.CupType.SingleColor&&r.getTop().topColorId==s.singleColorId)return a+=s.getTop().emptyNum,!1;if((s.getTop().topColorId==r.getTop().topColorId||100==Math.abs(s.getTop().topColorId%1e3-r.getTop().topColorId%1e3))&&(a+=s.getTop().emptyNum,r.canFinish(s)&&(0==t.includes(s)&&t.push(s),o[s.getTop().topColorId]++),r.canPourTo(s)))return!1}}if(a>=r.getTop().topColorNum)return!1}}for(var l=this.cups.filter(function(e){return e.currentState!=f.CupState.Finished&&e.currentState!=f.CupState.ReadyToBeCollected&&e.isFrozen()}),u=this.cups.filter(function(e){return e.currentState!=f.CupState.Finished&&e.currentState!=f.CupState.ReadyToBeCollected&&e.hasMask()}),p=0,d=l;p<d.length;p++)if((m=d[p]).frozenCount<=t.length)return!1;for(var h=0,y=u;h<y.length;h++){var m;if((m=y[h]).maskColorCount<=o[m.maskColorId])return!1}return!n},t.prototype.hasLockedCups=function(){return this.cups.some(function(e){return e.cupType===f.CupType.Locked||e.cupType===f.CupType.Temp1AD})},t.prototype.getLockedCups=function(){for(var e=0;e<this.cups.length;e++)if(this.cups[e].cupType===f.CupType.Locked||this.cups[e].cupType===f.CupType.Temp1AD)return this.cups[e].node;return null},t.prototype.ifDeadLockAllFinished=function(){if(y.default.Level<30)return!1;if(!this.isMultiLevel())return!1;if(S.default.instance.ifThirdUnlock)return this.ifDeadLockAfterThirdUnlock();for(var e=[0,0,0,0,0,0,0,0,0,0,0,0],t=[0,0,0,0,0,0,0,0,0,0,0,0],o=0,n=0,i=this.cups.filter(function(e){return!e.isFrozen()&&!e.hasMask()&&e.currentState!=f.CupState.Finished&&e.currentState!=f.CupState.ReadyToBeCollected});n<i.length;n++)if(!(p=i[n]).hasMask()&&!p.isFrozen())for(var r=0,a=p.info.colorIds;r<a.length;r++){var c=a[r];if(0!==c&&(c%1e3>100?(e[c%1e3-100]++,o++):(e[c]++,t[c]++),p.cupType===f.CupType.Temp1||p.cupType===f.CupType.Absorb))break}var s=this.cups.filter(function(e){return e.currentState==f.CupState.Finished||e.currentState==f.CupState.ReadyToBeCollected});if(null==S.default.instance.currentPackages[0])return!1;if(null==S.default.instance.currentPackages[1])return!1;for(var l=0,u=s;l<u.length;l++){var p,d=(p=u[l]).getTop().topColorId;if(d==S.default.instance.currentPackages[0].colorId)return!1;if(d==S.default.instance.currentPackages[1].colorId)return!1}var h=S.default.instance.currentPackages[0].colorId,m=S.default.instance.currentPackages[1].colorId;if(0==this.movingCupsCnt)if(h==m){if(t[h]+o<4)return!0}else if(t[h]+o<4&&t[m]+o<4)return!0;for(var g=0,v=e;g<v.length;g++)if(v[g]>=4)return!1;return!0},t.prototype.ifDeadLockAfterThirdUnlock=function(){if(y.default.Level<30)return!1;if(!this.isMultiLevel())return!1;if(!S.default.instance.ifThirdUnlock)return!1;for(var e=[0,0,0,0,0,0,0,0,0,0,0,0],t=[0,0,0,0,0,0,0,0,0,0,0,0],o=0,n=0,i=this.cups.filter(function(e){return!e.isFrozen()&&!e.hasMask()&&e.currentState!=f.CupState.Finished&&e.currentState!=f.CupState.ReadyToBeCollected});n<i.length;n++)for(var r=0,a=(u=i[n]).info.colorIds;r<a.length;r++){var c=a[r];if(0!==c&&(c%1e3>100?(e[c%1e3-100]++,o++):(e[c]++,t[c]++),u.cupType===f.CupType.Temp1||u.cupType===f.CupType.Absorb))break}if(null==S.default.instance.currentPackages[0])return!1;if(null==S.default.instance.currentPackages[1])return!1;if(null==S.default.instance.currentPackages[2])return!1;for(var s=0,l=this.cups.filter(function(e){return e.currentState==f.CupState.Finished||e.currentState==f.CupState.ReadyToBeCollected});s<l.length;s++){var u;if((v=(u=l[s]).getTop().topColorId)==S.default.instance.currentPackages[0].colorId)return!1;if(v==S.default.instance.currentPackages[1].colorId)return!1;if(v==S.default.instance.currentPackages[2].colorId)return!1}var p=S.default.instance.currentPackages[0].colorId,d=S.default.instance.currentPackages[1].colorId,h=S.default.instance.currentPackages[2].colorId;if(0==this.movingCupsCnt){var m={};for(var g in m[p]=4,m[d]=(m[d]||0)+4,m[h]=(m[h]||0)+4,console.error("needs:",m),m){var v;if(t[v=Number(g)]+o>m[v])return!1}return!0}for(var _=0,b=e;_<b.length;_++)if(b[_]>=4)return!1;return!0},t.prototype.canDyeWater=function(){var e=this.cups.filter(function(e){return!e.checkIsFinshed()});if(0===e.length)return!1;for(var t=new Set,o=0,n=this.cups;o<n.length;o++){var i=n[o];i.hasMask()&&t.add(i.getMaskUnlockColorId())}var r={};e.forEach(function(e){e.info.colorIds.forEach(function(e){if(0!==e){var t=e%100;r[t]||(r[t]=0),r[t]++}})});var a=Object.keys(r).map(function(e){return parseInt(e)});if(a.length<2)return!1;for(var c=0,s=0,l=a;s<l.length;s++){var u=l[s];(f=r[u])>c&&(c=f)}for(var p=0,d=a;p<d.length;p++){var f;if(u=d[p],!t.has(u)&&(f=r[u])<c&&f>=4)return!0}return!1},t.prototype.dyeWater=function(){var e=this;if(this.cups.some(function(e){return e.isPouring()}))return!1;this._actions=[];var t=this.cups.filter(function(e){return!e.checkIsFinshed()});if(0===t.length)return!1;for(var o=new Set,n=0,i=this.cups;n<i.length;n++){var r=i[n];r.hasMask()&&o.add(r.getMaskUnlockColorId())}var a={},c={};t.forEach(function(e){e.info.colorIds.forEach(function(t,o){if(0!==t){var n=t%100;a[n]||(a[n]=0,c[n]=[]),a[n]++,c[n].push({cup:e,index:o})}})});var s=Object.keys(a).map(function(e){return parseInt(e)});if(s.length<2)return!1;for(var l=-1,u=0,p=0,f=s;p<f.length;p++){var h=f[p];(v=a[h])>u&&(u=v,l=h)}for(var y=[],m=0,g=s;m<g.length;m++){var v;h=g[m],o.has(h)||(v=a[h])<u&&v>=4&&y.push(h)}if(0===y.length)return!1;for(var _=y[Math.floor(Math.random()*y.length)],S=c[_],b=[],C=d(S);b.length<4&&C.length>0;){var P=Math.floor(Math.random()*C.length);b.push(C[P]),C.splice(P,1)}return b.forEach(function(t){t.cup.info.colorIds[t.index]%1e3>100&&t.cup.onShowHidden(t.index);var o=[];(o=t.cup.info.colorIds)[t.index]=l,t.cup.dyeWater(o,function(){t.cup.initWater(),1==t.cup.checkIsFinshed()&&e.finishCup(t.cup)})}),!0},t.prototype.isAnyCupRestoring=function(){return this.cups.some(function(e){return e.currentState===f.CupState.Restoring})},t.prototype.finishCup=function(e){e.cupType!==f.CupType.Temp1&&e.cupType!==f.CupType.Absorb?(this._actions=[],e.currentState===f.CupState.Finished||e.isFrozen()||e.hasMask()||e.currentState===f.CupState.ReadyToBeCollected||(e.currentState=f.CupState.Finished,e.node.parent==this.node&&cc.director.getScene().name===_.SceneNames.GameModeMultiple?this.finishedWater+=4:g.default.instance.playSFX(g.AudioRef.FillWater),cc.director.emit(_.EventNames.CupFinish),this.playFinishAnimation(e),cc.director.getScene().name,_.SceneNames.GameModeMultiple,e.playFinishAnimation(),e.node.parent==this.node&&this.onWaterCleared(e.getTop().topColorId,1),cc.director.getScene().name===_.SceneNames.GameModeMultiple&&this.checkIsAllFinished()&&cc.director.emit("level_finish"))):e.currentState=f.CupState.Idle},t.prototype.getProgress=function(){var e=this.finishedWater/this.totalWater;return Math.round(1e4*e)/1e4},t.prototype.getPourNum=function(e,t){var o=e.getTop(),n=t.getTop();return e.cupType==f.CupType.Force?n.emptyNum:0==o.topColorId?0:0==n.topColorId?o.topColorNum:Math.min(o.topColorNum,n.emptyNum)},t.prototype.getActionNum=function(){return this._actions.length},t.prototype.checkIsAllFinished=function(){return cc.director.getScene().name===_.SceneNames.Game?S.default.instance.finishedPackageNum>=S.default.instance.targetPackageNum:this.finishedWater==this.totalWater},t.prototype.getDropNum=function(){return this.totalWater},t.prototype.guide=function(){if(y.default.Level>1||cc.director.getScene().name!==_.SceneNames.Game)return null!=this.guideNode&&(this.guideNode.destroy(),this.guideNode=null),void m.default.instance.PopoutTips();this.guideNode=cc.instantiate(this.guidePrefab),this.guideNode.parent=this.node,this.guideNode.zIndex=1e3,this.rightNode=cc.instantiate(this.rightPrefab),this.rightNode.parent=this.node,this.rightNode.zIndex=1e3,this.rightNode.active=!1,this.rightNode.opacity=0;for(var e=0;e<4;e++){var t=cc.instantiate(this.wrongPrefab);t.parent=this.node,t.zIndex=1e3,t.active=!1,t.opacity=0,this.wrongNode.push(t)}m.default.instance.PopupTipsStay("\u628a\u540c\u8272\u7684\u6c34\u5012\u5165\u4e00\u4e2a\u74f6\u5b50\u91cc")},t.prototype.hideAllWrongOrRightNodes=function(){var e=this;this.rightNode.active&&!this.showFlags[4]&&(this.showFlags[4]=!0,cc.tween(this.rightNode).to(.2,{opacity:0}).call(function(){e.rightNode.opacity=0,e.rightNode.active=!1}).start());for(var t=function(e){e.active&&!o.showFlags[o.wrongNode.indexOf(e)]&&(o.showFlags[o.wrongNode.indexOf(e)]=!0,cc.tween(e).to(.2,{opacity:0}).call(function(){e.opacity=0,e.active=!1}).start())},o=this,n=0,i=this.wrongNode;n<i.length;n++)t(i[n]);this.scheduleOnce(function(){e.isHiding=!1},.2)},t.prototype.showRightNode=function(e){!this.rightNode.active&&this.showFlags[4]&&(this.showFlags[4]=!1,this.rightNode.active=!0,cc.tween(this.rightNode).to(.2,{opacity:255}).start()),this.rightNode.setPosition(e.node.position.x,e.node.position.y+200)},t.prototype.showWrongNode=function(e){var t=this.wrongNode.findIndex(function(e){return!e.active});if(-1!==t){var o=this.wrongNode[t];!o.active&&this.showFlags[t]&&(this.showFlags[t]=!1,o.active=!0,cc.tween(o).to(.2,{opacity:255}).start()),this.wrongNode[t].setPosition(e.node.position.x,e.node.position.y+200)}},t.prototype.updateGuide=function(){if(!this.isHiding){if(this.cups.filter(function(e){return e.currentState==f.CupState.Idle}).length<2)return this.guideNode.active=!1,void this.hideAllWrongOrRightNodes();for(var e=0,t=this.cups;e<t.length;e++)if(t[e].currentState==f.CupState.Pouring)return this.guideNode.active=!1,void this.hideAllWrongOrRightNodes();if(this.checkIsAllFinished())this.guideNode.active=!1;else{var o=!1;if(null==this.selected){this.hideAllWrongOrRightNodes();for(var n=0;n<this.cups.length;n++){for(var i=0;i<this.cups.length;i++)if(n!=i){var r=this.cups[n],a=this.cups[i];if(!a.isFrozen()&&!a.hasMask()&&a.cupType!=f.CupType.Locked&&a.cupType!=f.CupType.Temp1AD&&!r.isEmpty()&&!a.isEmpty()&&r.canPourTo(a)){(p=r.node.position).y-=100,this.guideNode.setPosition(p),this.guideNode.active=!0,o=!0;break}}if(o)break}if(!o){var c=0,s=-1;for(n=0;n<this.cups.length;n++)if(!this.cups[n].isEmpty()&&this.cups[n].canCheckDeadlock()&&this.cups[n].currentState!=f.CupState.Finished){var l=this.cups[n].getTop().topColorNum,u=this.cups[n].getTop().emptyNum;if(l>c){if(l+u==4)continue;c=l,s=n}}(p=this.cups[s].node.position).y-=100,this.guideNode.setPosition(p),this.guideNode.active=!0}o=!1}else if(null!=this.selected){if(null!=this.selected&&this.lastSelected!=this.selected)return this.lastSelected=this.selected,this.hideAllWrongOrRightNodes(),void(this.isHiding=!0);for(i=this.cups.indexOf(this.selected),n=0;n<this.cups.length;n++)if(n!=i&&!(this.cups[n].isEmpty()||this.cups[n].isFrozen()||this.cups[n].hasMask()||this.cups[n].cupType==f.CupType.Locked||this.cups[n].cupType==f.CupType.Temp1AD)&&(this.selected.canPourTo(this.cups[n])||this.cups[n].isEmpty())){(p=this.cups[n].node.position).y-=100,this.guideNode.setPosition(p),this.showRightNode(this.cups[n]),o=!0;break}for(n=0;n<this.cups.length;n++)this.selected.getTop().topColorId==this.cups[n].getTop().topColorId||this.cups[n].currentState!=f.CupState.Idle||this.cups[n].isEmpty()||this.showWrongNode(this.cups[n]);if(!o)for(n=0;n<this.cups.length;n++)if(this.cups[n].isEmpty()){var p;(p=this.cups[n].node.position).y-=100,this.guideNode.setPosition(p),this.showRightNode(this.cups[n]),o=!0;break}if(!o)return void(this.guideNode.active=!1);o=!1}}}},t.prototype.isMultiLevel=function(){return!y.default.autoPlaying&&this.candidateCupCfgs.length>0},t.prototype.addCandidateCup=function(){var e=this;if(0!==this.candidateCupCfgs.length){this.sortEmptyCupPos(),this.movingCupsCnt++;var t=this.emptyCupPosArray.shift();this.updateCandidateCups(),this.candidateCupCfgs.length>2&&this.handleMaskFrozenCandidatesLogic();var o=this.candidateCupCfgs.shift();o.pos=cc.v2(1e3,t.y),cc.director.emit(_.EventNames.UpdateCandidateText,this.candidateCupCfgs.length);var n=h.default.getInstance().createOneCup(o,this.node);this.cups.push(n),n.orignPt=t,cc.tween(n.node).to(.5,{x:t.x},{easing:"sineIn"}).call(function(){cc.director.emit("do_pour"),cc.director.emit(_.EventNames.UpdateTestNumber),e.movingCupsCnt--}).start()}},t.prototype.updateCandidateCups=function(){if(cc.director.getScene().name===_.SceneNames.Game){for(var e=[],t=[],o=[],n=[],i=[],r=[],a=[],c=[],s=new Map,l=new Map,u=0,p=999,d=0,h=this.cups;d<h.length;d++)for(var y=h[d],m=0,g=y.info.colorIds;m<g.length&&(0===(k=g[m])||(k>100?s.set(k-100,(s.get(k-100)||0)+1):s.set(k,(s.get(k)||0)+1),y.cupType!==f.CupType.Temp1&&y.cupType!==f.CupType.Absorb));m++);for(var v=1;v<=10;v++)void 0===(w=s.get(v))&&(s.set(v,0),w=0),w>u&&(u=w),w<p&&w>0&&(p=w);for(v=1;v<=10;v++)(w=s.get(v))===u&&(a.push(v),a.push(v+100)),w===p&&(c.push(v),c.push(v+100));u=0,p=999;for(var S=0,b=this.candidateCupCfgs;S<b.length;S++)for(var C=0,P=(A=b[S]).colorIds;C<P.length;C++){var k;0!==(k=P[C])&&(k>100?l.set(k-100,(l.get(k-100)||0)+1):l.set(k,(l.get(k)||0)+1))}for(v=1;v<=10;v++)void 0===(w=l.get(v))&&(l.set(v,0),w=0),w<p&&w>0&&(p=w),w>u&&(u=w);for(v=1;v<=10;v++){var w;(w=l.get(v))===u&&(i.push(v),i.push(v+100)),w===p&&(r.push(v),r.push(v+100))}for(var I=0,T=this.candidateCupCfgs;I<T.length;I++){for(var A=T[I],O=0,R=i;O<R.length;O++){var N=R[O];if(A.colorIds.includes(N)){e.push(A);break}}for(var M=0,L=r;M<L.length;M++)if(N=L[M],A.colorIds.includes(N)){t.push(A);break}for(var E=0,F=a;E<F.length;E++)if(N=F[E],A.colorIds.includes(N)){o.push(A);break}for(var x=0,D=c;x<D.length;x++)if(N=D[x],A.colorIds.includes(N)){n.push(A);break}}var B=[2,1,2,1];0===e.length&&(B[0]=0),0===t.length&&(B[1]=0),0===o.length&&(B[2]=0),0===n.length&&(B[3]=0);var W=B,U=W.reduce(function(e,t){return e+t},0);if(0!==U){var j=Math.random()*U;console.error("\u968f\u673a\u8865\u5145\u2014\u2014\u968f\u673a\u6570 r:",j,"\u603b\u6743\u91cd total:",U,"\u6743\u91cd:",W);var G=0;for(v=0;v<W.length;v++)if((j-=W[v])<0){G=v;break}var H=null;switch(G){case 0:H=e[Math.floor(Math.random()*e.length)],console.error("\u8865\u51451 -- \u5019\u8865\u989c\u8272\u6700\u591a",H);break;case 1:H=t[Math.floor(Math.random()*t.length)],console.error("\u8865\u51452 -- \u5019\u8865\u989c\u8272\u6700\u5c11",H);break;case 2:H=o[Math.floor(Math.random()*o.length)],console.error("\u8865\u51453 -- \u573a\u4e0a\u989c\u8272\u6700\u591a",H);break;case 3:H=n[Math.floor(Math.random()*n.length)],console.error("\u8865\u51454 -- \u573a\u4e0a\u989c\u8272\u6700\u5c11",H)}for(v=0;v<this.candidateCupCfgs.length;v++)if(this.candidateCupCfgs[v].colorIds==H.colorIds){this.candidateCupCfgs[v]=this.candidateCupCfgs[0],this.candidateCupCfgs[0]=H;break}}}},t.prototype.handleMaskFrozenCandidatesLogic=function(){if(cc.director.getScene().name===_.SceneNames.Game&&!(this.currentLevelAdWatchedCount>=2)){for(var e=0,t=0,o=this.candidateMaskFrozenWeight;t<o.length;t++)e+=o[t];if(0!==e){for(var n=Math.random()*e,i=0,r=0;r<this.candidateMaskFrozenWeight.length;r++)if((n-=this.candidateMaskFrozenWeight[r])<0){i=r;break}switch(console.error("\u968f\u673a\u8865\u5145\u2014\u2014\u906e\u7f69\u51b0\u51bb\u968f\u673a\u6570 r:",n,"\u603b\u6743\u91cd totalWeight:",e,"\u6743\u91cd:",this.candidateMaskFrozenWeight,"\u9009\u62e9 picked:",i),i){case 0:return;case 1:this.handleMaskCandidateLogic();break;case 2:this.handleFrozenCandidateLogic()}}}},t.prototype.handleMaskCandidateLogic=function(){var e=this,t=this.cups.filter(function(e){return!e.isFrozen()&&!e.hasMask()&&e.currentState!=f.CupState.Finished&&e.currentState!=f.CupState.ReadyToBeCollected});if(0!==t.length){for(var o=new Map,n=[],i=[],r=0,a=t;r<a.length;r++)for(var c=a[r],s=0,l=c.info.colorIds;s<l.length;s++){var u=l[s];if(0!==u&&(u>100?o.set(u-100,(o.get(u-100)||0)+1):o.set(u,(o.get(u)||0)+1),c.cupType===f.CupType.Temp1||c.cupType===f.CupType.Temp1AD||c.cupType===f.CupType.Absorb))break}for(var p=1;p<=10;p++){var d=o.get(p);if(void 0!==d){(d=Math.floor(d/4))>=1&&i.push(p);for(var h=1;h<=d;h++){var y={id:p,num:h};n.push(y)}}}-1!=this.lastMaskColorId&&(i=i.filter(function(t){return t!=e.lastMaskColorId}));var m=i[Math.floor(Math.random()*i.length)];if(this.lastMaskColorId=m,n=n.filter(function(e){return e.id===m}),console.error("\u968f\u673a\u8865\u5145\u2014\u2014\u906e\u7f69\u5019\u9009\u5168:",n),0!==n.length){for(var g=[0,0,0,0],v=!1,_=0,S=n;_<S.length;_++)1===(y=S[_]).num?(g[0]=3,v=!0):2===y.num?(g[1]=2,v=!0):3===y.num?(g[2]=0,v=!0):4===y.num&&(g[3]=0,v=!0);if(v){var b=g,C=b.reduce(function(e,t){return e+t},0);if(0!==C){var P=Math.random()*C,k=0;for(p=0;p<b.length;p++)if((P-=b[p])<0){k=p;break}n=n.filter(function(e){return 0===k&&1===e.num||1===k&&2===e.num||2===k&&3===e.num||3===k&&4===e.num}),console.error("\u968f\u673a\u8865\u5145\u2014\u2014\u906e\u7f69\u5019\u9009:",n);var w=Math.floor(Math.random()*n.length);console.error("\u968f\u673a\u8865\u5145\u2014\u2014\u906e\u7f69\u5019\u9009\u968f\u673a\u6570:",w);var I=n[w],T=this.candidateCupCfgs[0];T.type=f.CupType.Masked,T.maskUnlockColorId=I.id,T.maskUnlockCount=I.num}}}}},t.prototype.handleFrozenCandidateLogic=function(){var e=this.cups.filter(function(e){return!e.isFrozen()&&!e.hasMask()&&e.currentState!=f.CupState.Finished&&e.currentState!=f.CupState.ReadyToBeCollected});if(0!==e.length){for(var t=0,o=0,n=[0,0,0,0,0,0,0,0,0,0,0,0],i=0,r=e;i<r.length;i++)for(var a=0,c=(p=r[i]).info.colorIds;a<c.length;a++){var s=c[a];if(0!==s&&(s>100?n[s-100]++:n[s]++,4===n[s]&&(n[s]=0,t+=4),p.cupType===f.CupType.Temp1||p.cupType===f.CupType.Absorb))break}if(0!==(o=Math.floor(t/4))){for(var l=0,u=this.cups.filter(function(e){return e.isFrozen()});l<u.length;l++){var p;o-=(p=u[l]).frozenCount}if(!(o<=0)){var d=[4,3,2,2];o<=3?d=[4,3,2]:o<=2?d=[4,3]:o<=1&&(d=[4]);var h=d,y=h.reduce(function(e,t){return e+t},0);if(0!==y){for(var m=Math.random()*y,g=0,v=0;v<h.length;v++)if((m-=h[v])<0){g=v;break}var _=g+1;if(!(_<=0)){var S=this.candidateCupCfgs[0];S.type=f.CupType.Frozen,S.frozenUnlockCount=_}}}}}},t.prototype.sortAllFinishedCups=function(){var e=this.cups.filter(function(e){return e.currentState===f.CupState.ReadyToBeCollected||e.currentState===f.CupState.Finished});e.sort(function(e,t){return t.node.y-e.node.y}),e.forEach(function(e,t){e.node.zIndex=5+t})},t.instance=null,l([O(cc.Prefab)],t.prototype,"waterCurrent",void 0),l([O(cc.Prefab)],t.prototype,"waterCurrent1",void 0),l([O(cc.Node)],t.prototype,"unlockNode",void 0),l([O(cc.Prefab)],t.prototype,"bubble",void 0),l([O(cc.Node)],t.prototype,"propMask",void 0),l([O(cc.Node)],t.prototype,"pumpClickNode",void 0),l([O(cc.Prefab)],t.prototype,"addEmptyCupPrefab",void 0),l([O(cc.Prefab)],t.prototype,"guidePrefab",void 0),l([O(cc.Prefab)],t.prototype,"rightPrefab",void 0),l([O(cc.Prefab)],t.prototype,"wrongPrefab",void 0),o=l([A],t)}(cc.Component);r.default=R,cc._RF.pop(),cc._RF.pop()},{}],CupShowCaseData:[function(e,t,o){"use strict";cc._RF.push(t,"1daa5gdIB9MhJLfG08wxf8a","CupShowCaseData");var n=e,i=t,r=o;cc._RF.push(i,"1daa5gdIB9MhJLfG08wxf8a","CupShowCaseData"),Object.defineProperty(r,"__esModule",{value:!0}),r.CupShowCaseData=void 0;var a=n("Cup");r.CupShowCaseData=[{cupId:1,name:"\u666e\u901a\u74f6\u5b50",description:"\u4e00\u4e2a\u666e\u901a\u7684\u74f6\u5b50\uff0c\u6742\u4e03\u6742\u516b\u4ec0\u4e48\u90fd\u88c5",cupType:a.CupType.Normal,ifTutorial:!1},{cupId:2,name:"\u51b0\u51bb\u74f6\u5b50",description:"\u6d88\u9664\u5176\u4ed6\u74f6\u5b50\u89e3\u51bb",cupType:a.CupType.Frozen,ifTutorial:!0},{cupId:3,name:"\u906e\u7f69\u74f6\u5b50",description:"\u6d88\u9664\u7279\u5b9a\u74f6\u5b50\u989c\u8272\u89e3\u9501",cupType:a.CupType.Masked,ifTutorial:!0},{cupId:4,name:"\u56fa\u5b9a\u74f6\u5b50",description:"\u88ab\u56fa\u5b9a\u4f4f\u7684\u74f6\u5b50\uff0c\u672a\u96c6\u6ee1\u524d\u65e0\u6cd5\u79fb\u52a8",cupType:a.CupType.Fixed,ifTutorial:!1},{cupId:5,name:"\u5355\u683c\u74f6\u5b50",description:"\u5c0f\u74f6\u5b50\u53ef\u4ee5\u7528\u6765\u4e34\u65f6\u5b58\u653e\u4e00\u683c\u6c34",cupType:a.CupType.Temp1,ifTutorial:!0},{cupId:6,name:"\u989c\u8272\u74f6\u5b50",description:"\u7279\u5b9a\u989c\u8272\u74f6\u5b50\u4ec5\u53ef\u5012\u5165\u540c\u8272\u6c34",cupType:a.CupType.SingleColor,ifTutorial:!0},{cupId:7,name:"\u70b8\u5f39\u74f6\u5b50",description:"\u5728\u5012\u8ba1\u65f6\u7ed3\u675f\u524d\uff0c\u96c6\u6ee1\u70b8\u5f39\u74f6\u5b50",cupType:a.CupType.Bomb,ifTutorial:!0},{cupId:8,name:"\u84c4\u6c34\u74f6\u5b50",description:"\u9700\u8981\u6d88\u8017\u6389\u84c4\u6c34\u74f6\u5b58\u50a8\u7684\u82e5\u5e72\u683c\u6c34",cupType:a.CupType.Absorb,ifTutorial:!0},{cupId:9,name:"\u4e0a\u6d6e\u74f6\u5b50",description:"\u74f6\u5b50\u4e2d\u6c34\u5c42\u4f1a\u4e0a\u6d6e",cupType:a.CupType.ChangeColor,ifTutorial:!0},{cupId:10,name:"\u4e0a\u9501\u74f6\u5b50",description:"\u9700\u8981\u6536\u96c6\u5230\u5bf9\u5e94\u7684\u94a5\u5319\u624d\u53ef\u4ee5\u89e3\u9501",cupType:a.CupType.Lock,ifTutorial:!0},{cupId:11,name:"\u656c\u8bf7\u671f\u5f85",description:"\u65b0\u74f6\u5b50\u5236\u4f5c\u4e2d......",cupType:a.CupType.Normal,ifTutorial:!1}],cc._RF.pop(),cc._RF.pop()},{}],CupShowCaseItem:[function(e,t,o){"use strict";cc._RF.push(t,"af301yPCwtOhpq73IsAvzEa","CupShowCaseItem");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"af301yPCwtOhpq73IsAvzEa","CupShowCaseItem");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=n("LevelData"),d=n("const"),f=n("CupShowCaseData"),h=cc._decorator,y=h.ccclass,m=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cups=[],t.text_name=null,t.text_unlockInfo=null,t.text_description=null,t.btn_play=null,t.frame_cup=null,t.grayMaterial=null,t.normalMaterial=null,t.cupNode=null,t.cupType=0,t}return s(t,e),t.prototype.updateItem=function(e){this.setCupIcon(e.cupId),this.cupType=e.cupType,this.text_name.string=e.name;var t=p.default.FIRST_TYPE[e.cupType];if(this.text_unlockInfo.string="\u7b2c"+t+"\u5173\u89e3\u9501",this.text_description.string=e.description,this.text_description.node.color=(new cc.Color).fromHEX("#c36b31"),this.text_description.node.getComponent(cc.LabelOutline).enabled=!1,this.btn_play.node.active=e.ifTutorial,e.cupId===f.CupShowCaseData.length)return this.setToBeContinued(),this.setGray(!0),void(this.btn_play.node.active=!1);u.default.Level<t?this.setGray(!0):this.setGray(!1)},t.prototype.playTutorial=function(){cc.director.emit(d.EventNames.PlayCupTutorial,this.cupType)},t.prototype.setGray=function(e){if(e){this.frame_cup.setMaterial(0,this.grayMaterial),this.btn_play.setMaterial(0,this.grayMaterial),this.btn_play.node.active=!1,this.text_unlockInfo.node.position=this.frame_cup.node.position,this.text_unlockInfo.node.y-=90,this.text_unlockInfo.node.active=!0,this.text_unlockInfo.node.color=(new cc.Color).fromHEX("#ffffff"),this.text_unlockInfo.node.getComponent(cc.LabelOutline).enabled=!0,this.text_unlockInfo.node.getComponent(cc.LabelOutline).color=(new cc.Color).fromHEX("#a24b12");for(var t=0,o=this.frame_cup.node.getComponentsInChildren(cc.Sprite);t<o.length;t++)o[t].setMaterial(0,this.grayMaterial)}else{this.frame_cup.setMaterial(0,this.normalMaterial),this.btn_play.setMaterial(0,this.normalMaterial),this.text_unlockInfo.node.active=!1;for(var n=0,i=this.frame_cup.node.getComponentsInChildren(cc.Sprite);n<i.length;n++)i[n].setMaterial(0,this.normalMaterial)}},t.prototype.setToBeContinued=function(){this.text_unlockInfo.string="",this.text_description.string="\u65b0\u74f6\u5b50\u5236\u4f5c\u4e2d......",this.text_description.node.color=cc.color(255,255,255),this.text_description.node.getComponent(cc.LabelOutline).enabled=!0,this.btn_play.node.active=!1,this.setGray(!0)},t.prototype.setCupIcon=function(e){var t=this.cups[e-1];this.cupNode&&cc.isValid(this.cupNode,!0)&&this.cupNode.destroy(),this.cupNode=null;var o=cc.instantiate(t);this.cupNode=o,o.parent=this.frame_cup.node,o.setPosition(0,0)},l([m([cc.Prefab])],t.prototype,"cups",void 0),l([m(cc.Label)],t.prototype,"text_name",void 0),l([m(cc.Label)],t.prototype,"text_unlockInfo",void 0),l([m(cc.Label)],t.prototype,"text_description",void 0),l([m(cc.Sprite)],t.prototype,"btn_play",void 0),l([m(cc.Sprite)],t.prototype,"frame_cup",void 0),l([m(cc.Material)],t.prototype,"grayMaterial",void 0),l([m(cc.Material)],t.prototype,"normalMaterial",void 0),l([y],t)}(cc.Component);r.default=g,cc._RF.pop(),cc._RF.pop()},{}],CupShowCasePanel:[function(e,t,o){"use strict";cc._RF.push(t,"b021cxA1g1BaYpWNYCQZbjv","CupShowCasePanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"b021cxA1g1BaYpWNYCQZbjv","CupShowCasePanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("GameManager"),p=n("CupShowCaseData"),d=n("CupShowCaseItem"),f=n("BasePanel"),h=cc._decorator,y=h.ccclass,m=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.items=[],t.text_page=null,t.btn_prevPage=null,t.btn_nextPage=null,t.currentViewNode=null,t.otherViewNode=null,t.currentPage=1,t.maxPage=4,t}return s(t,e),t.prototype.show=function(){this.init();var e=this.node.children[1];cc.director.emit("UpdateOpenPanelCount"),e&&(cc.Tween.stopAllByTarget(e),e.scale=.5,e.opacity=220,cc.tween(e).to(.3,{scale:1,opacity:255},{easing:"backOut"}).start())},t.prototype.hide=function(){var e=this,t=this.node.children[1];t&&(cc.Tween.stopAllByTarget(t),t.scale=1,t.opacity=255,cc.tween(t).to(.4,{scale:0,opacity:0},{easing:"backIn"}).call(function(){e.node.active=!1,cc.director.emit("UpdateOpenPanelCount")}).start())},t.prototype.onEnable=function(){u.default.platform.reportPageEvent("BottleCategoryPage"),this.currentPage=1,this.maxPage=Math.ceil(p.CupShowCaseData.length/this.items.length),this.updateItems(this.currentPage)},t.prototype.onBtn_PrevPage=function(){this.currentPage>1&&(this.currentPage--,this.updateItems(this.currentPage))},t.prototype.onBtn_NextPage=function(){this.currentPage<this.maxPage&&(this.currentPage++,this.updateItems(this.currentPage))},t.prototype.onBtn_Close=function(){this.hide()},t.prototype.updateItems=function(e){this.updatePageText(),this.updateBtns();for(var t=0;t<this.items.length;t++)3*e-3+t>=p.CupShowCaseData.length?this.items[t].node.active=!1:(this.items[t].node.active=!0,this.items[t].updateItem(p.CupShowCaseData[3*e-3+t]));this.itemFadeIn()},t.prototype.itemFadeIn=function(){for(var e=0;e<this.items.length;e++)this.items[e].node.opacity=0,this.items[e].node.stopAllActions(),cc.tween(this.items[e].node).delay(.05+.1*e).to(.3,{opacity:255},{easing:"sineIn"}).start()},t.prototype.updatePageText=function(){this.text_page.string=this.currentPage+"/"+this.maxPage},t.prototype.updateBtns=function(){this.currentPage<=1?(this.btn_prevPage.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.btn_prevPage.getComponent(cc.Button).interactable=!1,this.btn_nextPage.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")),this.btn_nextPage.getComponent(cc.Button).interactable=!0):this.currentPage==this.maxPage?(this.btn_prevPage.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")),this.btn_prevPage.getComponent(cc.Button).interactable=!0,this.btn_nextPage.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.btn_nextPage.getComponent(cc.Button).interactable=!1):(this.btn_prevPage.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")),this.btn_prevPage.getComponent(cc.Button).interactable=!0,this.btn_nextPage.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")),this.btn_nextPage.getComponent(cc.Button).interactable=!0)},l([m([d.default])],t.prototype,"items",void 0),l([m(cc.Label)],t.prototype,"text_page",void 0),l([m(cc.Node)],t.prototype,"btn_prevPage",void 0),l([m(cc.Node)],t.prototype,"btn_nextPage",void 0),l([y],t)}(f.default);r.default=g,cc._RF.pop(),cc._RF.pop()},{}],CupTips:[function(e,t,o){"use strict";cc._RF.push(t,"8a249U1m/FPB4G/VxCaQ5i7","CupTips");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"8a249U1m/FPB4G/VxCaQ5i7","CupTips");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AutoPlayUtil"),p=n("CommonData"),d=n("CupMgr"),f=cc._decorator,h=f.ccclass,y=(f.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.timer=0,t.cup1=null,t.cup2=null,t.isShowing=!0,t}var o;return s(t,e),o=t,Object.defineProperty(t,"instance",{get:function(){return o._instance||(o._instance=new o),o._instance},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){o._instance=this},t.prototype.start=function(){1==p.default.Level||p.default.Level>=6||this.schedule(this.onTimer,1)},t.prototype.onTimer=function(){this.timer++,this.timer>10&&1==this.isShowing&&this.showCupTips()},t.prototype.setToZero=function(){1==p.default.Level||p.default.Level>=6||(this.timer=0,this.stopBreathingAnimation(),this.isShowing=!0)},t.prototype.stopAnimation=function(){this.timer>10&&(this.isShowing=!1),this.stopBreathingAnimation()},t.prototype.onDestroy=function(){this.unschedule(this.onTimer)},t.prototype.stopBreathingAnimation=function(){this.cup1&&this.cup2&&(this.cup1.stopBreathingAnimation(),this.cup2.stopBreathingAnimation(),this.cup1=null,this.cup2=null)},t.prototype.showCupTips=function(){var e=u.AutoplayUtil;if(d.default.getInstance().ifDeadLock())this.stopBreathingAnimation();else if(!(d.default.getInstance().checkIsAllFinished()||this.cup1&&this.cup2))if(e.existPourablePairs(d.default.getInstance(),!1)){var t=e.pickRandomPourPair(d.default.getInstance(),!1),o=t[0],n=t[1];if(this.cup1=o,this.cup2=n,null==this.cup1||null==this.cup2)return;this.cup1.startBreathingAnimation(),this.cup2.startBreathingAnimation()}else if(e.existPourablePairs(d.default.getInstance(),!0)){var i=e.pickRandomPourPair(d.default.getInstance(),!0);if(o=i[0],n=i[1],this.cup1=o,this.cup2=n,null==this.cup1||null==this.cup2)return;this.cup1.startBreathingAnimation(),this.cup2.startBreathingAnimation()}else{var r=e.pickPourPair(d.default.getInstance());if(o=r[0],n=r[1],null==o||null==n)return;if(this.cup1=o,this.cup2=n,null==this.cup1||null==this.cup2)return;this.cup1.startBreathingAnimation(),this.cup2.startBreathingAnimation()}},t._instance=null,o=l([h],t)}(cc.Component));r.default=y,cc._RF.pop(),cc._RF.pop()},{}],Cup_17:[function(e,t,o){"use strict";cc._RF.push(t,"3fed8zjnuNE0at7XyBGoA7k","Cup_17");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"3fed8zjnuNE0at7XyBGoA7k","Cup_17");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},p=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.setColors=r.SPLIT_COUNT=r.HEIGHT_FACTOR=r.CupType=r.CupState=r.color_locked_surface=r.color_locked=r.SplashColors=r.SurfaceColors=r.WaterColors=void 0;var d,f,h=n("AudioManager"),y=n("GameManager_17"),m=n("Water_17"),g=cc._decorator,v=g.ccclass,_=g.property,S=g.executeInEditMode;r.WaterColors=["#000000","#ffdf28","#57f22a","#2cc1ff","#ff6ed8","#0616df","#6c21b8","#d71b13","#48e7aa","#f9721f","#703531"],r.SurfaceColors=["#000000","#fcff48","#78ff59","#3fd9ff","#f493e8","#2135ff","#8637dc","#f5433d","#77ffd4","#f4942d","#99625b"],r.SplashColors=["#000000","#feffa6","#acff99","#91e9ff","#ffb0f6","#4a59ff","#a058ed","#ff6b66","#adffe5","#ffa647","#ad736a"],r.color_locked="#333333",r.color_locked_surface="#666666",function(e){e[e.Idle=0]="Idle",e[e.Moving=1]="Moving",e[e.Selected=2]="Selected",e[e.Pouring=3]="Pouring",e[e.PouringIn=4]="PouringIn",e[e.Finished=5]="Finished",e[e.ColorChanging=6]="ColorChanging"}(d=r.CupState||(r.CupState={})),function(e){e[e.Normal=0]="Normal",e[e.Locked=1]="Locked"}(f=r.CupType||(r.CupType={})),r.HEIGHT_FACTOR=.925,r.SPLIT_COUNT=17;var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.water=null,t.currentState=d.Idle,t.cupType=f.Normal,t.dropAnimation=null,t.onClick=null,t.info=null,t.tween=null,t.hiddenMarkNode=null,t.adNode=null,t.dot=null,t.capNode=null,t}return s(t,e),t.prototype.update=function(){this.water.skewAngle!=this.node.angle&&(this.water.skewAngle=this.node.angle)},t.prototype.onBtn_click=function(){this.onClick&&this.onClick(this)},t.prototype.isPouring=function(){return Math.abs(this.node.angle)>1},t.prototype.isInteractable=function(){return this.cupType!=f.Locked&&(this.currentState==d.Idle||this.currentState==d.Selected)},t.prototype.initWater=function(){var e=this.info,t=[];this.hiddenMarkNode&&this.hiddenMarkNode.children.forEach(function(e){return e.active=!1});for(var o=r.SPLIT_COUNT-1;o>=0;o--){var n=e.colorIds[o];if(0!=n){var i=t[t.length-1];i&&i==n?i.height+=1/r.SPLIT_COUNT:t.push({intialIndex:o,height:1/r.SPLIT_COUNT,colorId:n})}}var a=this;t.forEach(function(e){var t=r.WaterColors[e.colorId]||"#538849",o=r.SurfaceColors[e.colorId]||"#538849";e.colorId>100&&(t=r.color_locked,o=r.color_locked_surface,a.showMark(e.intialIndex)),e.color=(new cc.Color).fromHEX(t),e.surfaceColor=(new cc.Color).fromHEX(o),e.height*=r.HEIGHT_FACTOR}),this.water.initInfos(t)},t.prototype.setCupInfo=function(e,t){this.info={cupType:f.Normal,colorIds:e},this.onClick=t,this.initWater(),this.reset()},t.prototype.setPourOutCallback=function(e,t){var o=this;this.water.setPourOutCallback(function(){e&&e(this)}.bind(this),function(){o.tween&&(o.tween.stop(),o.tween=null),t&&t(this)}.bind(this))},t.prototype.setPourInCallback=function(e){var t=this;this.water.setPourInCallback(function(){var o=t.checkIsFinshed();e&&e(this,o),o&&(t.currentState=d.Finished)}.bind(this))},t.prototype.hideMark=function(e){this.hiddenMarkNode&&(this.hiddenMarkNode.children[e].active=!1)},t.prototype.showMark=function(e){this.hiddenMarkNode&&(this.hiddenMarkNode.children[e].active=!0)},t.prototype.checkTop=function(){var e=this.getTop();if(null!=e.topColorId&&0!=e.topColorId&&e.topColorId>100){for(var t=this.info.colorIds,o=0;o<r.SPLIT_COUNT;o++)if(0!=t[o]){t[o]-=100,this.hideMark(o);break}this.initWater()}},t.prototype.lockCup=function(){this.cupType=f.Locked,this.info.cupType=f.Locked,this.adNode.active=!0},t.prototype.unlockCup=function(){this.cupType=f.Normal,this.info.cupType=f.Normal,h.default.instance.playSFX(h.AudioRef.OpenBottle),this.adNode.active=!1,y.default.instance.PopoutTips()},t.prototype.canPourTo=function(e){if(this===e)return!1;var t=this.getTop().topColorId,o=e.getTop().topColorId,n=this.getTop().topColorNum,i=e.getTop().emptyNum;return null!==t&&0!==i&&(null===o||o==t)&&i>=n},t.prototype.pumpWater=function(e,t){e=e.replace("Layer","");var o=parseInt(e);o--;var n=this.info.colorIds[o];if(n>=100&&(n-=100),this.info.colorIds[o]=n,0===n)return!1;var i=this.getTop();if(i.topColorId===n&&i.emptyNum+i.topColorNum>=o)return y.default.instance.ChangeTipsStay("\u8bf7\u9009\u62e9\u4e0d\u5728\u7b2c\u4e00\u5c42\u7684\u6c34",2),!1;for(var a=this.info.colorIds.slice(),c=new Array(r.SPLIT_COUNT).fill(0),s=i.emptyNum,l=o,u=o;l>=0&&a[l]===n;)l--;for(l++;u<r.SPLIT_COUNT&&a[u]===n;)u++;var p=--u-l+1;if(n==i.topColorId){for(var d=s;d<s+i.topColorNum+p;d++)c[d]=n;var f=s+i.topColorNum+p;for(d=s+i.topColorNum;d<r.SPLIT_COUNT;d++)(d<l||d>u)&&(c[f++]=a[d])}else{for(d=s;d<s+p;d++)c[d]=n;for(f=s+p,d=s;d<r.SPLIT_COUNT;d++)(d<l||d>u)&&(c[f++]=a[d])}this.info.colorIds=c;var h=[];for(d=r.SPLIT_COUNT-1;d>=0;d--){var m=c[d];0!=m&&(h[h.length-1],h.push({height:1/r.SPLIT_COUNT,colorId:m}))}return h.forEach(function(e){var t=r.WaterColors[e.colorId]||"#538849",o=r.SurfaceColors[e.colorId]||"#538849";e.colorId>100&&(t=r.color_locked,o=r.SurfaceColors[e.colorId-100]||"#538849"),e.color=(new cc.Color).fromHEX(t),e.surfaceColor=(new cc.Color).fromHEX(o),e.height*=r.HEIGHT_FACTOR}),this.water.startColorAnimation(h,.5,t),!0},t.prototype.isEmpty=function(){return 0==this.info.colorIds[16]},t.prototype.getTop=function(){for(var e=this.info.colorIds,t=0,o=0,n=0,i=0;i<r.SPLIT_COUNT;i++)if(0!=e[i]){if(0!=o&&o!=e[i])break;o=e[i],n++}else t++;return{emptyNum:t,topColorId:o,topColorNum:n,colorHex:r.WaterColors[o]||"#538849"}},t.prototype.removeTop=function(e,t){for(var o=this.info.colorIds,n=0;n<r.SPLIT_COUNT&&!(0!=o[n]&&o[n]==e&&(o[n]=0,--t<=0));n++);this.initWater()},t.prototype.addTop=function(e,t,o){return u(this,void 0,void 0,function(){var n,i;return p(this,function(a){switch(a.label){case 0:n=this.info.colorIds,cc.tween(this.node).to(.12,{scale:1.03}).to(.12,{scale:1}).start(),i=r.SPLIT_COUNT-1,a.label=1;case 1:return i>=0?0!=n[i]?[3,3]:(n[i]=e,this.initWater(),t--,[4,new Promise(function(e){return setTimeout(e,10)})]):[3,4];case 2:if(a.sent(),t<=0)return o&&o(),[3,4];a.label=3;case 3:return i--,[3,1];case 4:return[2]}})})},t.prototype.reset=function(){this.node.angle=0,this.water.skewAngle=0},t.prototype.setPourAnchor=function(e){var t=cc.v2(this.node.width/3,2);t.x=e?this.node.width-t.x:t.x,t.y=this.node.height-t.y,t.x=t.x/this.node.width,t.y=t.y/this.node.height,this.setAnchor(t)},t.prototype.setNormalAnchor=function(){this.setAnchor(cc.v2(.5,.5))},t.prototype.setAnchor=function(e){var t=this.node.getAnchorPoint(),o=this.node.getPosition(),n=this.water.node.getPosition();this.node.setAnchorPoint(e);var i,r,a,c=cc.v2(e.x-t.x,e.y-t.y),s=cc.v2(c.x*this.node.width,c.y*this.node.height);i=s,r=function(e){for(;e>360;)e-=360;for(;e<-360;)e+=360;return e%360*Math.PI/180}(this.node.angle),(a=cc.v2()).x=i.x*Math.cos(r)-i.y*Math.sin(r),a.y=i.x*Math.sin(r)+i.y*Math.cos(r),s=a,o.x+=s.x,o.y+=s.y,this.node.setPosition(o),n.x-=c.x*this.node.width,n.y-=c.y*this.node.height,this.water.node.setPosition(n)},t.prototype.checkIsFinshed=function(){return this.getTop().topColorNum==r.SPLIT_COUNT},t.prototype.getWaterSurfacePosY=function(e){void 0===e&&(e=!1);var t=this.getTop(),o=(r.SPLIT_COUNT-t.emptyNum)/r.SPLIT_COUNT;o<.02?o=.02:e&&(o-=1/r.SPLIT_COUNT*r.HEIGHT_FACTOR),o*=r.HEIGHT_FACTOR,o-=.48;var n=cc.v2(0,this.water.node.height*o);return(n=this.water.node.convertToWorldSpaceAR(n)).y},t.prototype.canFinish=function(e){if(this===e)return!1;if(this.getTop().topColorId!==e.getTop().topColorId)return!1;var t=this.getTop().topColorNum,o=e.getTop().emptyNum,n=e.getTop().topColorNum;return o<=t&&o+n==r.SPLIT_COUNT},t.prototype.playFinishAnimation=function(){this.capNode&&(this.capNode.active=!0,this.capNode.setPosition(0,390),cc.tween(this.capNode).to(.1,{y:410,scaleX:.2,scaleY:.6}).to(.1,{y:440,scaleX:.44,scaleY:.44},{easing:"sineOut"}).to(.2,{y:390},{easing:"sineIn"}).to(.1,{scaleX:.44,scaleY:.36}).to(.1,{scaleX:.4,scaleY:.4}).call(function(){h.default.instance.playSFX(h.AudioRef.CapFinish)}).start())},t.prototype.playDropAnimation=function(){var e=this;if(this.dropAnimation){this.dropAnimation.node.stopAllActions(),this.dropAnimation.node.color=(new cc.Color).fromHEX(r.SplashColors[this.getTop().topColorId])||cc.Color.WHITE;var t=this.getWaterSurfacePosY();t=this.water.node.convertToNodeSpaceAR(cc.v2(0,t)).y,this.dropAnimation.node.setPosition(0,t),this.dropAnimation.setAnimation(0,"xialuoshuidi",!1),this.dropAnimation.setCompleteListener(function(){e.dropAnimation.node.active=!1}),this.dropAnimation.node.active=!0}},l([_(m.default)],t.prototype,"water",void 0),l([_({type:cc.Enum(d),tooltip:"\u676f\u5b50\u72b6\u6001: 0:Idle 1:\u79fb\u52a8\u4e2d 2:\u9009\u4e2d 3:\u5012\u51fa\u4e2d 4:\u5012\u5165\u4e2d 5:\u5b8c\u6210 6:\u6574\u7406\u4e2d"})],t.prototype,"currentState",void 0),l([_({type:cc.Enum(f),tooltip:"\u676f\u5b50\u7c7b\u578b: 0:\u6b63\u5e38 1:\u5e7f\u544a\u89e3\u9501 2:\u56fa\u5b9a 3:\u51bb\u7ed3 4:\u906e\u7f69"})],t.prototype,"cupType",void 0),l([_(sp.Skeleton)],t.prototype,"dropAnimation",void 0),l([_(cc.Node)],t.prototype,"hiddenMarkNode",void 0),l([_(cc.Node)],t.prototype,"adNode",void 0),l([_(cc.Node)],t.prototype,"capNode",void 0),l([v,S()],t)}(cc.Component);r.default=b,r.setColors=function(e,t,o){r.WaterColors=e,r.SurfaceColors=t,r.SplashColors=o},cc._RF.pop(),cc._RF.pop()},{}],Cup_ED:[function(e,t,o){"use strict";cc._RF.push(t,"37e44pBeOxNTZx0Hq3vgN3A","Cup_ED");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"37e44pBeOxNTZx0Hq3vgN3A","Cup_ED");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0}),r.SPLIT_COUNT=r.HEIGHT_FACTOR=r.CupType=r.CupState=r.color_locked=r.setColors=r.SurfaceColors=r.WaterColors=void 0;var u,p,d=n("Water_ED"),f=n("AudioManager_ED"),h=n("CupMgr_ED"),y=n("Row_ED"),m=n("GameManager_ED"),g=n("WaterArrGenerate_ED"),v=cc._decorator,_=v.ccclass,S=v.property,b=v.executeInEditMode;r.WaterColors=["#000000","#D20003","#0CA3E0","#E3B400","00A565","#7808BF","#696BAC","#39CA15","#D44200","#7E2F21","#E444AC","#005F09"],r.SurfaceColors=["#000000","#FF2826","#4DCBFF","#FFE32C","#25CE99","#9631F2","#A498CE","#9DDD4D","#FF8412","#A84C32","#FD71FF","#46B85C"],r.setColors=function(e,t){r.WaterColors=e,r.SurfaceColors=t},r.color_locked="#333333",function(e){e[e.Idle=0]="Idle",e[e.Moving=1]="Moving",e[e.Selected=2]="Selected",e[e.Pouring=3]="Pouring",e[e.PouringIn=4]="PouringIn",e[e.Finished=5]="Finished",e[e.ColorChanging=6]="ColorChanging",e[e.Cover=7]="Cover",e[e.Remove=8]="Remove"}(u=r.CupState||(r.CupState={})),function(e){e[e.Normal=0]="Normal",e[e.Locked=1]="Locked",e[e.Fixed=2]="Fixed",e[e.Frozen=3]="Frozen",e[e.Masked=4]="Masked"}(p=r.CupType||(r.CupType={})),r.HEIGHT_FACTOR=.78,r.SPLIT_COUNT=4;var C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.water=null,t.currentState=u.Idle,t.cupType=p.Normal,t.maskColorId=0,t.maskColorCount=0,t.frozenCount=0,t.surface=null,t.surfaceHighlight=null,t.capNode=null,t.hiddenMark=null,t.cupImg_bottom=null,t.shadow=null,t.cover=null,t.bottleSke=null,t.bottle_uid=0,t.row=null,t.colIndex=0,t.bottle_leftRear=null,t.bottle_rightRear=null,t.onClick=null,t.info=null,t.pourIn=null,t.pourInRipple=null,t.cupImgBottomProjection=null,t.maskLabel=null,t.frozenLabel=null,t.adNode=null,t.dot=null,t}return s(t,e),t.prototype.update=function(){this.currentState!==u.Cover&&this.currentState!==u.Remove&&(this.updateSurface(),this.water.skewAngle!=this.node.angle&&(this.water.skewAngle=this.node.angle))},t.prototype.onLoad=function(){this.row=this.node.parent.parent.getComponent(y.default),this.row.cupAmounts++,this.colIndex=parseInt(this.node.name),this.bottle_uid=m.default.instance.bottlesCreated,m.default.instance.bottlesCreated++,this.orignPt=this.node.position},t.prototype.revealBottle=function(){this.currentState===u.Cover&&(f.default.instance.playBottleUnlock(),this.bottleSke.node.active=!0,this.bottleSke.animation="pzps",this.initBottle(g.default.createColorIds(this.row.row_uid)))},t.prototype.initBottle=function(e){if(this.currentState===u.Cover){this.water.node.active=!0,this.shadow.active=!0,this.cover.active=!1,this.currentState=u.Idle;var t={type:p.Normal,pos:{x:0,y:0},colorIds:e||[0,0,0,0]};this.initDefault(),this.setCupType(p.Normal),this.setColorIds(t.colorIds),this.setCupInfo(t),m.default.instance.bottlesShowed.set(this.bottle_uid,this),this.capNode.active=!1,this.capNode.setPosition(0,185)}},t.prototype.removeBottle=function(){var e=this;this.currentState===u.Finished&&(this.currentState=u.Remove,cc.tween(this.node).delay(.25).call(function(){e.water.onFadeOut(10,.05)}).to(.5,{y:this.node.y+this.node.height*this.node.parent.scale*.3,opacity:0}).call(function(){if(e.revealBottlesRear(),e.node.active=!1,e.row.cupAmounts--,m.default.instance.completedAmounts++,m.default.instance.bottlesShowed.delete(e.bottle_uid),0===e.row.cupAmounts){if(e.row.row_uid!==h.default.getInstance().foremostRowUid)return void(m.default.instance.bottleToReset=h.default.getInstance().getBottleToReset());var t=h.default.getInstance().getMoveRows();h.default.getInstance().pushForwardByGiven(0,t,function(){m.default.instance.checkIfDeadGame(),h.default.getInstance().foremostRowUid=e.row.row_uid+t,m.default.instance.bottleToReset=h.default.getInstance().getBottleToReset()})}else m.default.instance.checkIfDeadGame(),m.default.instance.bottleToReset=h.default.getInstance().getBottleToReset()}).start())},t.prototype.revealBottlesRear=function(){var e,t;null===(e=this.bottle_leftRear)||void 0===e||e.revealBottle(),null===(t=this.bottle_rightRear)||void 0===t||t.revealBottle()},t.prototype.resetBottle=function(){this.currentState===u.Remove&&(f.default.instance.playOpenBottle(),this.currentState=u.Cover,this.initBottle([0,0,0,0]),this.node.active=!0,this.row.cupAmounts++,cc.tween(this.node).to(.5,{y:this.node.y-this.node.height*this.node.parent.scale*.3,opacity:255}).call(function(){m.default.instance.bottleToReset=h.default.getInstance().getBottleToReset()}).start())},t.prototype.onBtn_click=function(){h.default.getInstance().onClickCup(this)},t.prototype.isPouring=function(){return Math.abs(this.node.angle)>1},t.prototype.isInteractable=function(){return this.cupType!=p.Locked&&this.cupType!=p.Frozen&&this.cupType!=p.Masked&&(this.currentState==u.Idle||this.currentState==u.Selected)},t.prototype.canCheckDeadlock=function(){return this.cupType!=p.Locked&&this.cupType!=p.Frozen&&this.cupType!=p.Masked},t.prototype.initWater=function(){for(var e=this.info,t=[],o=r.SPLIT_COUNT-1;o>=0;o--){var n=e.colorIds[o];if(0!=n){var i=t[t.length-1];i&&i==n?i.height+=1/r.SPLIT_COUNT:t.push({intialIndex:o,height:1/r.SPLIT_COUNT,colorId:n})}}var a=this;t.forEach(function(e){var t=r.WaterColors[e.colorId]||"#538849",o=r.SurfaceColors[e.colorId]||"#538849";e.colorId>100&&(t=r.color_locked,a.hiddenMark&&(a.hiddenMark.children[e.intialIndex].active=!0)),e.color=(new cc.Color).fromHEX(t),e.surfaceColor=(new cc.Color).fromHEX(o),e.height*=r.HEIGHT_FACTOR}),this.water.initInfos(t)},t.prototype.setCupInfo=function(e){var t,o,n;this.info.colorIds=e.colorIds,this.info.cupType=e.type,this.cupType=e.type,this.cupType===p.Masked?(this.maskColorId=null!==(t=e.maskUnlockColorId)&&void 0!==t?t:0,this.maskColorCount=null!==(o=e.maskUnlockCount)&&void 0!==o?o:0):this.cupType===p.Frozen&&(this.frozenCount=null!==(n=e.frozenUnlockCount)&&void 0!==n?n:0),this.initWater(),this.reset()},t.prototype.setCupClickEvent=function(e){this.onClick=e},t.prototype.updateSurface=function(){var e=this.water.getWaterCenter();e.y+=8,this.surface.node.setPosition(e.x,e.y+5),this.water._action==d.WaterAction.in?(this.surface.node.opacity=255,this.surfaceHighlight.timeScale=0,this.pourIn.node.active=!0,"sh"!==this.pourInRipple.animation&&(this.pourInRipple.animation="sh")):("sh"===this.pourInRipple.animation&&(this.pourInRipple.animation=null),this.pourIn.node.active=!1),this.pourIn.node.setPosition(e.x,e.y+5);var t=this.getTop().topColorId;if(0!=t&&0==this.water.skewAngle&&this.currentState==u.Idle){this.surface.node.opacity=255;var o=r.SurfaceColors[t]||"#538849";this.surface.node.color=(new cc.Color).fromHEX(o)}else if(this.surface.node.opacity=this.currentState==u.Finished?255:0,this.water._action==d.WaterAction.in){this.surface.node.opacity=255,this.surfaceHighlight.timeScale=0;var n=r.SurfaceColors[t]||"#538849";this.surface.node.color=(new cc.Color).fromHEX(n)}},t.prototype.onSelectSurfaceAnimation=function(){console.log("onSelectSurfaceAnimation"),this.surface.setAnimation(0,"sm",!1),this.surfaceHighlight.setAnimation(0,"ggsm",!1),this.surfaceHighlight.timeScale=1.5},t.prototype.setPourOutCallback=function(e,t){this.water.setPourOutCallback(function(){e&&e(this)}.bind(this),function(){t&&t(this)}.bind(this))},t.prototype.setPourInCallback=function(e){var t=this;this.water.setPourInCallback(function(){var o=t.checkIsFinshed();e&&e(this,o),o&&(t.currentState=u.Finished)}.bind(this))},t.prototype.playFinishAnimation=function(){this.capNode&&(this.capNode.active=!0,this.capNode.setPosition(0,200),this.surface.node.opacity=255,this.scheduleOnce(function(){f.default.instance.playCoverLid()},.55),cc.tween(this.capNode).to(.2,{y:230},{easing:"cubicOut"}).call(function(){}).delay(.1).to(.3,{y:185},{easing:"cubicIn"}).call(function(){}).start())},t.prototype.moveToPour=function(e,t,o,n,i,a){var c=this;this.setPourOutCallback(i,a);var s=this.water.getPourStartAngle(),l=this.water.getPourEndAngle(n),u=n;o&&(s*=-1,l*=-1),this.node.stopAllActions(),this.shadow.stopAllActions(),cc.tween(this.node).set({angle:0}).to(.3,{x:e.x,y:e.y,angle:s,scale:t}).call(function(){c.water.onStartPour(n)}).to(.2,{angle:l}).call(function(){}).start();for(var p=this.getTop(),d=this.info.colorIds,f=0;f<r.SPLIT_COUNT;f++){var h=d[f];if(0!=h){if(p.topColorId!=h)break;if(u--,d[f]=0,0==u)break}}},t.prototype.startAddWater=function(e,t,o){this.setPourInCallback(o);for(var n=0,i=r.SPLIT_COUNT-1;i>=0&&(0!=this.info.colorIds[i]||(this.info.colorIds[i]=e,++n!=t));i--);var a=r.WaterColors[e]||"#538849",c=r.SurfaceColors[e]||"#538849";this.water.addInfo({colorId:e,height:t/r.SPLIT_COUNT*r.HEIGHT_FACTOR,color:(new cc.Color).fromHEX(a),surfaceColor:(new cc.Color).fromHEX(c)})},t.prototype.tryReduceMaskCondition=function(e,t){return this.cupType===p.Masked&&(this.maskColorId===e&&(this.maskColorCount-=t,this.maskLabel.string=this.maskColorCount+""),this.maskColorCount<=0&&(this.cupType=p.Normal,this.unmaskCup(),!0))},t.prototype.unmaskCup=function(){this.cupType=p.Normal,this.maskLabel.node.active=!1,this.maskLabel.node.parent.active=!1,this.maskLabel.node.parent.parent.active=!1},t.prototype.tryReduceFrozenCount=function(){return this.cupType===p.Frozen&&(this.frozenCount-=1,this.frozenLabel.string=this.frozenCount+"",this.frozenCount<=0&&(this.cupType=p.Normal,this.unfreezeCup(),!0))},t.prototype.unfreezeCup=function(){this.cupType=p.Normal,this.frozenLabel.node.active=!1,this.frozenLabel.node.parent.active=!1,this.frozenLabel.node.parent.parent.active=!1},t.prototype.pumpWater=function(e,t){var o=parseInt(e[e.length-1]);o--,console.log(o);var n=this.info.colorIds[o];if(n>=100&&(n-=100),0===n)return console.log("\u6240\u9009\u4f4d\u7f6e\u6ca1\u6709\u6c34"),!1;var i=this.getTop();if(i.topColorId===n&&i.topColorNum>o)return!1;for(var a=this.info.colorIds.slice(),c=new Array(r.SPLIT_COUNT).fill(0),s=0,l=0;l<r.SPLIT_COUNT&&0==a[l];l++)s++;for(a[o]=0,c[s++]=n,1==o?(a[o+1]==n&&(a[o+1]=0,c[s++]=n),a[o+2]==n&&(a[o+2]=0,c[s++]=n)):2==o?(a[o+1]==n&&(a[o+1]=0,c[s++]=n),a[o-1]==n&&(a[o-1]=0,c[s++]=n)):3==o&&(a[o-1]==n&&(a[o-1]=0,c[s++]=n),a[o-2]==n&&(a[o-2]=0,c[s++]=n)),l=0;l<r.SPLIT_COUNT;l++)0!==a[l]&&s<r.SPLIT_COUNT&&(c[s++]=a[l]);console.log("newColorIds",c),this.info.colorIds=c;var u=[];for(l=r.SPLIT_COUNT-1;l>=0;l--){var p=c[l];0!=p&&(u[u.length-1],u.push({height:1/r.SPLIT_COUNT,colorId:p}))}return u.forEach(function(e){var t=r.WaterColors[e.colorId]||"#538849",o=r.SurfaceColors[e.colorId]||"#538849";e.colorId>100&&(t=r.color_locked,o=r.SurfaceColors[e.colorId-100]||"#538849"),e.color=(new cc.Color).fromHEX(t),e.surfaceColor=(new cc.Color).fromHEX(o),e.height*=r.HEIGHT_FACTOR}),this.water.startColorAnimation(u,.5,t),!0},t.prototype.unlockCup=function(){this.cupType=p.Normal,this.info.cupType=p.Normal,this.adNode.active=!1},t.prototype.canOrganizeTopColor=function(){if(this.isPouring())return!1;for(var e=this.info.colorIds.slice(),t={},o=0;o<e.length;o++)0!==(n=e[o])&&(t[n]||(t[n]=[]),t[n].push(o));for(var n in t){var i=t[n];for(o=1;o<i.length;o++)if(i[o]-i[o-1]>1)return!0}return!1},t.prototype.organizeTopColor=function(e,t){if(void 0===e&&(e=.5),void 0===t&&(t=null),this.isPouring())return!1;this.currentState=u.ColorChanging;var o=this.getTop();if(0==o.topColorId||o.topColorNum==r.SPLIT_COUNT)return!1;for(var n=this.info.colorIds.slice(),i=[],a=[-1,-1,-1,-1],c=[0,0,0,0],s=0,l=0;l<r.SPLIT_COUNT;l++){var p=n[l],d=a.indexOf(p);-1!=a.indexOf(p)?(a[d]=p,c[d]++):(a[s]=p,c[s]++,s++)}for(var f=0;-1!==a[f];){p=a[f];for(var h=c[f];h--;)i.push(p);f++}for(var y=!1,m=0;m<r.SPLIT_COUNT;m++)if(n[m]!=i[m]){y=!0;break}if(!y)return!1;this.info.colorIds=i;for(var g=[],v=r.SPLIT_COUNT-1;v>=0;v--){var _=i[v];0!=_&&(g[g.length-1],g.push({height:1/r.SPLIT_COUNT,colorId:_}))}return g.forEach(function(e){var t=r.WaterColors[e.colorId]||"#538849",o=r.SurfaceColors[e.colorId]||"#538849";e.colorId>100&&(t=r.color_locked,o=r.SurfaceColors[e.colorId-100]||"#538849"),e.color=(new cc.Color).fromHEX(t),e.surfaceColor=(new cc.Color).fromHEX(o),e.height*=r.HEIGHT_FACTOR}),this.water.startColorAnimation(g,e,t),!0},t.prototype.dyeWater=function(e,t){this.info.colorIds=e,console.log("dyeWater",e);for(var o=[],n=r.SPLIT_COUNT-1;n>=0;n--){var i=e[n];0!=i&&(o[o.length-1],o.push({height:1/r.SPLIT_COUNT,colorId:i}))}return o.forEach(function(e){var t=r.WaterColors[e.colorId]||"#538849",o=r.SurfaceColors[e.colorId]||"#538849";e.colorId>100&&(t=r.color_locked,o=r.SurfaceColors[e.colorId-100]||"#538849"),e.color=(new cc.Color).fromHEX(t),e.surfaceColor=(new cc.Color).fromHEX(o),e.height*=r.HEIGHT_FACTOR}),this.water.startColorAnimation(o,.5,t),!0},t.prototype.canPourTo=function(e){if(this===e)return!1;var t=this.getTop().topColorId,o=e.getTop().topColorId,n=this.getTop().topColorNum,i=e.getTop().topColorNum,a=e.getTop().emptyNum;return null!==t&&0!==a&&(null===o||o==t)&&(i+a==r.SPLIT_COUNT?n>=a:a>=n)},t.prototype.canFinish=function(){if(this.isPouring())return!1},t.prototype.addWaterImmediately=function(e,t){for(var o=0,n=r.SPLIT_COUNT-1;n>=0&&(0!=this.info.colorIds[n]||(this.info.colorIds[n]=e,++o!=t));n--);this.initWater()},t.prototype.removeTopWaterImmediately=function(e){for(var t=0,o=this.getTop(),n=this.info.colorIds,i=0;i<r.SPLIT_COUNT;i++){var a=n[i];if(0!=a){if(o.topColorId!=a)break;if(n[i]=0,++t>=e)break}}return this.initWater(),o},t.prototype.isEmpty=function(){return 0==this.info.colorIds[3]},t.prototype.onShowHidden=function(e){this.hiddenMark.children[e].active=!1},t.prototype.getTop=function(){for(var e=this.info.colorIds,t=0,o=0,n=0,i=0;i<r.SPLIT_COUNT;i++)if(0!=e[i]){if(0!=o&&o!=e[i])break;o=e[i],n++}else t++;return{emptyNum:t,topColorId:o,topColorNum:n,colorHex:r.WaterColors[o]||"#538849"}},t.prototype.reset=function(){this.node.angle=0,this.water.skewAngle=0},t.prototype.setPourAnchor=function(e){var t=cc.v2(this.node.width/2,2);t.x=e?this.node.width-t.x:t.x,t.y=this.node.height-t.y,t.x=t.x/this.node.width,t.y=t.y/this.node.height,this.setAnchor(t),this.cupImg_bottom.setAnchorPoint(cc.v2(t.x,t.y-.025))},t.prototype.setNormalAnchor=function(){this.setAnchor(cc.v2(.5,.5)),this.cupImg_bottom.setAnchorPoint(cc.v2(.5,.5))},t.prototype.setAnchor=function(e){var t=this.node.getAnchorPoint(),o=this.node.getPosition(),n=this.water.node.getPosition();this.node.setAnchorPoint(e);var i,r,a,c=cc.v2(e.x-t.x,e.y-t.y),s=cc.v2(c.x*this.node.width*this.node.scale,c.y*this.node.height*this.node.scale);i=s,r=function(e){for(;e>360;)e-=360;for(;e<-360;)e+=360;return e%360*Math.PI/180}(this.node.angle),(a=cc.v2()).x=i.x*Math.cos(r)-i.y*Math.sin(r),a.y=i.x*Math.sin(r)+i.y*Math.cos(r),s=a,o.x+=s.x,o.y+=s.y,this.node.setPosition(o),n.x-=c.x*this.node.width,n.y-=c.y*this.node.height,this.water.node.setPosition(n)},t.prototype.checkIsFinshed=function(){for(var e=!0,t=this.info.colorIds,o=null,n=0,i=0;i<r.SPLIT_COUNT;i++){if(null==o&&(o=t[i]),o!=t[i]){e=!1;break}0==t[i]&&n++}return n==r.SPLIT_COUNT&&(e=!0),e},t.prototype.checkIsStrictFinshed=function(){for(var e=!0,t=this.info.colorIds,o=null,n=0;n<r.SPLIT_COUNT;n++){if(null==o&&(o=t[n]),o!=t[n]){e=!1;break}if(0==t[n]){e=!1;break}}return e},t.prototype.getWaterSurfacePosY=function(e){void 0===e&&(e=!1);var t=this.getTop(),o=(r.SPLIT_COUNT-t.emptyNum)/r.SPLIT_COUNT;o<.02?o=.02:e&&(o-=1/r.SPLIT_COUNT*r.HEIGHT_FACTOR),o*=r.HEIGHT_FACTOR,o-=.5;var n=cc.v2(0,this.water.node.height*o);return(n=this.water.node.convertToWorldSpaceAR(n)).y},t.prototype.initDefault=function(){this.info={cupType:p.Normal,colorIds:[0,0,0,0]}},t.prototype.setCapacity=function(){},t.prototype.initDefault_Editor=function(){this.node.addComponent("CupDraggable_ED"),this.info={cupType:p.Normal,colorIds:[0,0,0,0]}},t.prototype.highlight=function(){this.node.scale=1.1;for(var e=this.node.parent.children,t=0;t<e.length;t++){var o=e[t];o!=this.node&&(o.scale=1)}},t.prototype.getCupType=function(){return this.cupType},t.prototype.setCupType=function(e){this.cupType=e,this.info.cupType=e},t.prototype.getFrozenUnlockCount=function(){return this.frozenCount},t.prototype.setFrozenUnlockCount=function(e){this.frozenCount=e,this.frozenLabel.string=e+"",this.info.frozenUnlockCount=e},t.prototype.getMaskUnlockColorId=function(){return this.maskColorId},t.prototype.setMaskUnlockColor=function(e){this.maskColorId=e,this.maskLabel.node.parent.color=(new cc.Color).fromHEX(r.WaterColors[e]||"#538849"),this.info.maskUnlockColorId=e},t.prototype.getMaskUnlockCount=function(){return this.maskColorCount},t.prototype.setColorIds=function(e){this.info.colorIds=e,this.initWater()},t.prototype.setMaskUnlockCount=function(e){this.maskColorCount=e,this.maskLabel.string=e+"",this.info.maskUnlockCount=e},t.prototype.getColorIds=function(){return this.info.colorIds},t.prototype.ifSingleColor=function(){var e=this.getTop();return e.emptyNum+e.topColorNum==r.SPLIT_COUNT},l([S(d.default)],t.prototype,"water",void 0),l([S({type:cc.Enum(u),tooltip:"\u676f\u5b50\u72b6\u6001: 0:Idle 1:\u79fb\u52a8\u4e2d 2:\u9009\u4e2d 3:\u5012\u51fa\u4e2d 4:\u5012\u5165\u4e2d 5:\u5b8c\u6210 6:\u6574\u7406\u4e2d 7:\u88ab\u906e\u76d6\uff08\u65e0\u9650\u6c34\u74f6\u6a21\u5f0f\uff09"})],t.prototype,"currentState",void 0),l([S({type:cc.Enum(p),tooltip:"\u676f\u5b50\u7c7b\u578b: 0:\u6b63\u5e38 1:\u5e7f\u544a\u89e3\u9501 2:\u56fa\u5b9a 3:\u51bb\u7ed3 4:\u906e\u7f69"})],t.prototype,"cupType",void 0),l([S({type:cc.Integer,tooltip:"\u906e\u7f69\u676f\u5b50\u89e3\u9501\u9700\u6c42\u989c\u8272id,0\u4e3a\u4efb\u610f\u989c\u8272"})],t.prototype,"maskColorId",void 0),l([S({type:cc.Integer,tooltip:"\u906e\u7f69\u676f\u5b50\u89e3\u9501\u9700\u6c42\u6570\u91cf"})],t.prototype,"maskColorCount",void 0),l([S({type:cc.Integer,tooltip:"\u51bb\u7ed3\u676f\u5b50\u89e3\u9501\u9700\u6c42\u6570\u91cf"})],t.prototype,"frozenCount",void 0),l([S(sp.Skeleton)],t.prototype,"surface",void 0),l([S(sp.Skeleton)],t.prototype,"surfaceHighlight",void 0),l([S(cc.Node)],t.prototype,"capNode",void 0),l([S(cc.Node)],t.prototype,"hiddenMark",void 0),l([S({type:cc.Node,tooltip:"\u74f6\u5b50\u5e95\u5c42\u56fe"})],t.prototype,"cupImg_bottom",void 0),l([S({type:cc.Node,tooltip:"\u74f6\u5b50\u9634\u5f71"})],t.prototype,"shadow",void 0),l([S({type:cc.Node,tooltip:"\u5916\u5c42\u906e\u6321"})],t.prototype,"cover",void 0),l([S({type:sp.Skeleton,tooltip:"\u5916\u5c42\u906e\u6321"})],t.prototype,"bottleSke",void 0),l([S(sp.Skeleton)],t.prototype,"pourIn",void 0),l([S(sp.Skeleton)],t.prototype,"pourInRipple",void 0),l([S(cc.Label)],t.prototype,"maskLabel",void 0),l([S(cc.Label)],t.prototype,"frozenLabel",void 0),l([S(cc.Node)],t.prototype,"adNode",void 0),l([_,b()],t)}(cc.Component);r.default=C,cc._RF.pop(),cc._RF.pop()},{}],Cup_Long:[function(e,t,o){"use strict";cc._RF.push(t,"a1c0157ZMxHS6m9tmMhjjgB","Cup_Long");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"a1c0157ZMxHS6m9tmMhjjgB","Cup_Long");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0}),r.SPLIT_COUNT_LONG=r.CupType=r.CupState=r.color_locked_surface=r.color_locked=r.setColors=r.finishEnd=r.finishStart=r.SplashColors=r.SurfaceColors=r.WaterColors=r.HEIGHT_FACTOR=void 0;var u,p,d=n("Water_Long"),f=n("AudioManager"),h=cc._decorator,y=h.ccclass,m=h.property,g=h.executeInEditMode;r.HEIGHT_FACTOR=.93,r.WaterColors=["#000000","#C30D08","#191AC1","#F7C212","#74A912","#601995","#5861A9","#0097d7","#e45700","#75262a","#ff6ed8"],r.SurfaceColors=["#000000","#E72C2C","#3d5ad1","#ffe24b","#A0CF2B","#A43DFE","#848ED6","#43c3fa","#f4861b","#b25651","#f493e8"],r.SplashColors=["#000000","#FF4C4C","#526EDE","#ffef93","#BAE846","#B866FF","#9BA5F2","#7adeff","#ffa245","#cc6d68","#ffb0f6"],r.finishStart=["#000000","#ffdabb","#abc8ff","#fbffc6","#e4ffb4","#f0bbff","#cecbfa","#b3f5ff","#fae9b4","#f0cb9e","#f0bbff"],r.finishEnd=["#000000","#ffa79900","#7e98ff00","#fff0b300","#bbdd6700","#ce9aff00","#b3c2ff00","#85cdeb00","#feba9d00","#f7a68100","#ffb3ff00"],r.setColors=function(e,t,o,n,i){r.WaterColors=e,r.SurfaceColors=t,r.finishStart=o,r.finishEnd=n,r.SplashColors=i},r.color_locked="#333333",r.color_locked_surface="#666666",function(e){e[e.Idle=0]="Idle",e[e.Moving=1]="Moving",e[e.Selected=2]="Selected",e[e.Pouring=3]="Pouring",e[e.PouringIn=4]="PouringIn",e[e.Finished=5]="Finished",e[e.ColorChanging=6]="ColorChanging"}(u=r.CupState||(r.CupState={})),function(e){e[e.Normal=0]="Normal",e[e.Locked=1]="Locked",e[e.Fixed=2]="Fixed",e[e.Frozen=3]="Frozen",e[e.Masked=4]="Masked",e[e.SingleColor=5]="SingleColor",e[e.Bomb=6]="Bomb",e[e.Temp1=7]="Temp1",e[e.Temp1AD=8]="Temp1AD",e[e.Absorb=9]="Absorb"}(p=r.CupType||(r.CupType={})),r.SPLIT_COUNT_LONG=28;var v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.water=null,t.currentState=u.Idle,t.cupType=p.Normal,t.maskColorId=0,t.maskColorCount=0,t.frozenCount=0,t.surface=null,t.surfaceHighlight=null,t.showHiddenMarkPrefab=null,t.capNode=null,t.hiddenMark=null,t.goal=0,t.progress=0,t.frame=0,t.onClick=null,t.info=null,t.pourInSurface=null,t.pourInSurfaceHightlight=null,t.pourInSplash=null,t.pourInSplashHighlight=null,t.pourInRipple=null,t.tween=null,t.dot=null,t}return s(t,e),t.prototype.update=function(){this.updateSurface(),this.water.skewAngle!=this.node.angle&&(this.water.skewAngle=this.node.angle)},t.prototype.onBtn_click=function(){this.onClick&&this.onClick(this)},t.prototype.isPouring=function(){return Math.abs(this.node.angle)>1},t.prototype.isInteractable=function(){return this.cupType!=p.Locked&&this.cupType!=p.Frozen&&this.cupType!=p.Masked&&(this.currentState==u.Idle||this.currentState==u.Selected)},t.prototype.canCheckDeadlock=function(){return this.cupType!=p.Locked&&this.cupType!=p.Frozen&&this.cupType!=p.Masked},t.prototype.initWater=function(){var e=this.info;this.hiddenMark&&this.hiddenMark.children.forEach(function(e){return e.active=!1});for(var t=[],o=r.SPLIT_COUNT_LONG-1;o>=0;o--){var n=e.colorIds[o];if(0!=n){var i=t[t.length-1];i&&i==n?i.height+=1/r.SPLIT_COUNT_LONG:t.push({intialIndex:o,height:1/r.SPLIT_COUNT_LONG,colorId:n})}}var a=this;t.forEach(function(e){var t=r.WaterColors[e.colorId]||"#538849",o=r.SurfaceColors[e.colorId]||"#538849";e.colorId>100&&(t=r.color_locked,o=r.color_locked_surface,a.hiddenMark&&(a.hiddenMark.children[e.intialIndex].active=!0)),e.color=(new cc.Color).fromHEX(t),e.surfaceColor=(new cc.Color).fromHEX(o),e.height*=r.HEIGHT_FACTOR}),this.water.initInfos(t)},t.prototype.initCup=function(e){this.initDefault(),this.setCupType(e.type),this.setColorIds(e.colorIds),this.reverseFinishAnimation(),this.currentState=u.Idle,this.initWater(),this.reset()},t.prototype.setCupInfo=function(e,t){var o,n,i;this.info.colorIds=e.colorIds,this.info.cupType=e.type,this.onClick=t,this.cupType=e.type,this.cupType===p.Masked?(this.maskColorId=null!==(o=e.maskUnlockColorId)&&void 0!==o?o:0,this.maskColorCount=null!==(n=e.maskUnlockCount)&&void 0!==n?n:0):this.cupType===p.Frozen&&(this.frozenCount=null!==(i=e.frozenUnlockCount)&&void 0!==i?i:0),this.initWater(),this.reset()},t.prototype.updateSurface=function(){var e=this.water.getWaterCenter();e.y+=24,this.surface.node.setPosition(e.x,e.y),this.water._action==d.WaterAction.in&&(this.surface.node.opacity=255,this.surfaceHighlight.timeScale=0,this.pourInSurface.node.active=!0,this.pourInSurface.node.opacity=255,this.pourInSurface.node.setPosition(e.x,e.y+1));var t=this.getTop().topColorId;if(0!=t&&0==this.water.skewAngle&&this.currentState==u.Idle){this.surface.node.opacity=255;var o=this.getTop().emptyNum;void 0===this.water.infos[3-o]||void 0===this.water.infos[3-o].surfaceColor?this.surface.node.color=(new cc.Color).fromHEX(r.SurfaceColors[t]||"#538849"):this.surface.node.color=this.water.infos[3-o].surfaceColor}else if(this.surface.node.opacity=this.currentState==u.Finished?255:0,this.currentState==u.Finished){this.surface.node.opacity=255,this.surfaceHighlight.timeScale=0;var n=this.getTop().emptyNum;this.surface.node.color=this.water.infos[3-n].surfaceColor}else if(this.water._action==d.WaterAction.in){this.surface.node.opacity=255,this.surfaceHighlight.timeScale=0,r.WaterColors[t];var i=r.SurfaceColors[t]||"#538849";t>100&&(r.color_locked,i=r.color_locked_surface),this.surface.node.color=(new cc.Color).fromHEX(i)}else if(this.water._action==d.WaterAction.colorChange){this.surface.node.opacity=255,this.surfaceHighlight.timeScale=0;var a=this.getTop().emptyNum;this.surface.node.color=this.water.infos[3-a].surfaceColor}},t.prototype.playPourInAnimation=function(e){var t,o,n,i,a=this;void 0===e&&(e=0),this.pourInSurface.animation=null,this.pourInSurfaceHightlight.animation=null,this.pourInSplash.animation=null,this.pourInSplashHighlight.animation=null,this.pourInRipple.animation=null,this.pourInSurface.node.active=!0,this.pourInSurface.node.opacity=255;var c=r.SplashColors[e]||"#538849",s=r.SurfaceColors[e]||"#538849";this.pourInSurface.node.color=(new cc.Color).fromHEX(s),this.pourInSplash.node.color=(new cc.Color).fromHEX(c),"smd_start"!==(null===(t=this.pourInSurface.getCurrent(0))||void 0===t?void 0:t.animation.name)&&(this.pourInSurface.setAnimation(0,"smd_start",!1).listener={complete:function(e){"smd_start"===e.animation.name&&a.pourInSurface.setAnimation(0,"smd_channel",!0)}}),"sms_start"!==(null===(o=this.pourInSurfaceHightlight.getCurrent(0))||void 0===o?void 0:o.animation.name)&&(this.pourInSurfaceHightlight.setAnimation(0,"sms_start",!1).listener={complete:function(e){"sms_start"===e.animation.name&&a.pourInSurfaceHightlight.setAnimation(0,"sms_channel",!0)}}),"sds_start"!==(null===(n=this.pourInSplashHighlight.getCurrent(0))||void 0===n?void 0:n.animation.name)&&(this.pourInSplashHighlight.setAnimation(0,"sds_start",!1).listener={complete:function(e){"sds_start"===e.animation.name&&a.pourInSplashHighlight.setAnimation(0,"sds_channel",!0)}}),"sms_start"!==(null===(i=this.pourInSplash.getCurrent(0))||void 0===i?void 0:i.animation.name)&&(this.pourInSplash.setAnimation(0,"sdd_start",!1).listener={complete:function(e){"sdd_start"===e.animation.name&&a.pourInSplash.setAnimation(0,"sdd_channel",!0)}}),this.pourInRipple.animation=null,this.pourInRipple.setAnimation(0,"bw_channel",!0)},t.prototype.stopPourInAnimation=function(e){var t=this;void 0===e&&(e=0);var o=this.water.getWaterCenter();o.y+=26,this.pourInSurface.node.setPosition(o.x,o.y+1),this.surfaceHighlight.timeScale=0,this.pourInSurface.animation=null,this.pourInSurfaceHightlight.animation=null,this.pourInSplash.animation=null,this.pourInSplashHighlight.animation=null,this.pourInRipple.animation=null,this.pourInSurface.setAnimation(0,"smd_end",!1).listener={complete:function(e){"smd_end"===e.animation.name&&t.scheduleOnce(function(){t.pourInSurface.node.opacity=0,t.pourInSurface.node.active=!1},.1)}},this.pourInSurfaceHightlight.setAnimation(0,"sms_end",!1),this.pourInSplash.setAnimation(0,"sdd_end",!1),this.pourInSplashHighlight.setAnimation(0,"sds_end",!1),this.pourInRipple.setAnimation(0,"bw_end",!1)},t.prototype.clearPourInAnimation=function(){this.pourInSurface.animation=null,this.pourInSurfaceHightlight.animation=null,this.pourInSplash.animation=null,this.pourInSplashHighlight.animation=null,this.pourInRipple.animation=null},t.prototype.onSelectSurfaceAnimation=function(){this.surface.setAnimation(0,"sm",!1),this.surfaceHighlight.setAnimation(0,"ggsm",!1),this.surfaceHighlight.timeScale=1},t.prototype.setPourOutCallback=function(e,t){var o=this;this.water.setPourOutCallback(function(){e&&e(this)}.bind(this),function(){o.tween&&(o.tween.stop(),o.tween=null),t&&t(this)}.bind(this))},t.prototype.setPourInCallback=function(e){var t=this;this.water.setPourInCallback(function(){var o=t.checkIsFinshed();e&&e(this,o),o&&(t.currentState=u.Finished)}.bind(this))},t.prototype.playFinishAnimation=function(){var e=this;if(this.capNode){this.capNode.active=!0,this.capNode.setPosition(0,665),this.capNode.opacity=0,this.capNode.scaleX=.2,this.capNode.scaleY=.4,this.surface.node.opacity=255;var t=this.node.scale;cc.tween(this.capNode).delay(.6).to(.15,{y:680,scaleX:.4,scaleY:.8,opacity:255},{easing:"sineIn"}).to(.15,{y:700,scaleX:1,scaleY:1},{easing:"sineOut"}).to(.2,{y:665},{easing:"sineIn"}).call(function(){e.setAnchor(cc.v2(.5,0)),f.default.instance.playSFX(f.AudioRef.CapFinish),cc.tween(e.node).to(.06,{scale:t-.005},{easing:"smooth"}).to(.06,{scale:t+.005},{easing:"smooth"}).to(.06,{scale:t},{easing:"smooth"}).call(function(){e.setAnchor(cc.v2(.5,.5))}).start()}).to(.12,{scaleX:1.1,scaleY:.9}).to(.12,{scaleX:1,scaleY:1}).start()}},t.prototype.reverseFinishAnimation=function(){this.node.scaleX=1,this.node.scaleY=1,this.capNode&&(this.capNode.active=!1)},t.prototype.startAddWater=function(e,t,o){this.setPourInCallback(o);var n=r.WaterColors[e]||"#538849",i=r.SurfaceColors[e]||"#538849";this.playPourInAnimation(e),this.water.addInfo({colorId:e,height:t/r.SPLIT_COUNT_LONG*r.HEIGHT_FACTOR,color:(new cc.Color).fromHEX(n),surfaceColor:(new cc.Color).fromHEX(i)})},t.prototype.addWaterImmediately=function(e,t){for(var o=0,n=r.SPLIT_COUNT_LONG-1;n>=0&&(0!=this.info.colorIds[n]||(this.info.colorIds[n]=e,++o!=t));n--);this.initWater()},t.prototype.removeTopWaterImmediately=function(e){for(var t=0,o=this.getTop(),n=this.info.colorIds,i=0;i<r.SPLIT_COUNT_LONG;i++){var a=n[i];if(0!=a){if(o.topColorId!=a)break;if(n[i]=0,++t>=e)break}}return this.initWater(),o},t.prototype.isEmpty=function(){return 0==this.info.colorIds[3]},t.prototype.getTop=function(){for(var e=this.info.colorIds,t=0,o=0,n=0,i=0;i<r.SPLIT_COUNT_LONG;i++)if(0!=e[i]){if(0!=o&&o!=e[i])break;o=e[i],n++}else t++;return{emptyNum:t,topColorId:o,topColorNum:n,colorHex:r.WaterColors[o]||"#538849"}},t.prototype.reset=function(){this.node.angle=0,this.water.skewAngle=0},t.prototype.setPourAnchor=function(e){var t=cc.v2(this.node.width/3,2*this.node.scaleX);t.x=e?this.node.width-t.x:t.x,t.y=this.node.height-t.y,t.x=t.x/this.node.width,t.y=t.y/this.node.height,this.setAnchor(t)},t.prototype.setNormalAnchor=function(){this.setAnchor(cc.v2(.5,.5))},t.prototype.setAnchor=function(e){var t=this.node.getAnchorPoint(),o=this.node.getPosition(),n=this.water.node.getPosition(),i=this.node.children[0].getPosition();this.node.setAnchorPoint(e);var r,a,c,s=cc.v2(e.x-t.x,e.y-t.y),l=cc.v2(s.x*this.node.width*this.node.scale,s.y*this.node.height*this.node.scale);r=l,a=function(e){for(;e>360;)e-=360;for(;e<-360;)e+=360;return e%360*Math.PI/180}(this.node.angle),(c=cc.v2()).x=r.x*Math.cos(a)-r.y*Math.sin(a),c.y=r.x*Math.sin(a)+r.y*Math.cos(a),l=c,o.x+=l.x,o.y+=l.y,this.node.setPosition(o),n.x-=s.x*this.node.width,n.y-=s.y*this.node.height,this.water.node.setPosition(n),i.x-=s.x*this.node.width,i.y-=s.y*this.node.height,this.node.children[0].setPosition(i)},t.prototype.checkIsFinshed=function(){for(var e=!0,t=this.info.colorIds,o=null,n=0,i=0;i<r.SPLIT_COUNT_LONG;i++){if(null==o&&(o=t[i]),o!=t[i]){e=!1;break}0==t[i]&&n++}return n==r.SPLIT_COUNT_LONG&&(e=!0),e},t.prototype.checkIsStrictFinshed=function(){for(var e=!0,t=this.info.colorIds,o=null,n=0;n<r.SPLIT_COUNT_LONG;n++){if(null==o&&(o=t[n]),o!=t[n]){e=!1;break}if(0==t[n]){e=!1;break}}return e},t.prototype.isSingleColor=function(){for(var e=this.info.colorIds,t=null,o=0;o<r.SPLIT_COUNT_LONG;o++)if(0!=e[o]&&(null==t&&(t=e[o]),t!=e[o]))return!1;return!0},t.prototype.getWaterSurfacePosY=function(e){void 0===e&&(e=!1);var t=this.getTop(),o=(r.SPLIT_COUNT_LONG-t.emptyNum)/r.SPLIT_COUNT_LONG;o<.02?o=.02:e&&(o-=1/r.SPLIT_COUNT_LONG*r.HEIGHT_FACTOR),o*=r.HEIGHT_FACTOR,o-=.5;var n=cc.v2(0,this.water.node.height*o);return(n=this.water.node.convertToWorldSpaceAR(n)).y},t.prototype.initDefault=function(){this.info={cupType:p.Normal,colorIds:[0,0,0,0]}},t.prototype.setCapacity=function(){},t.prototype.initLong=function(){this.info={cupType:p.Fixed,colorIds:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},t.prototype.initDefault_Editor=function(){this.node.addComponent("CupDraggable"),this.info={cupType:p.Normal,colorIds:[0,0,0,0]}},t.prototype.highlight=function(){this.node.scale=1.1;for(var e=this.node.parent.children,t=0;t<e.length;t++){var o=e[t];o!=this.node&&(o.scale=1)}},t.prototype.getCupType=function(){return this.cupType},t.prototype.setCupType=function(e){this.cupType=e,this.info.cupType=e},t.prototype.getFrozenUnlockCount=function(){return this.frozenCount},t.prototype.getMaskUnlockColorId=function(){return this.maskColorId},t.prototype.getMaskUnlockCount=function(){return this.maskColorCount},t.prototype.setColorIds=function(e){this.info.colorIds=e,this.initWater()},t.prototype.getColorIds=function(){for(var e=[],t=0;t<r.SPLIT_COUNT_LONG;t++)e.push(this.info.colorIds[t]);return e},l([m(d.default)],t.prototype,"water",void 0),l([m({type:cc.Enum(u),tooltip:"\u676f\u5b50\u72b6\u6001: 0:Idle 1:\u79fb\u52a8\u4e2d 2:\u9009\u4e2d 3:\u5012\u51fa\u4e2d 4:\u5012\u5165\u4e2d 5:\u5b8c\u6210 6:\u6574\u7406\u4e2d"})],t.prototype,"currentState",void 0),l([m({type:cc.Enum(p),tooltip:"\u676f\u5b50\u7c7b\u578b: 0:\u6b63\u5e38 1:\u5e7f\u544a\u89e3\u9501 2:\u56fa\u5b9a 3:\u51bb\u7ed3 4:\u906e\u7f69"})],t.prototype,"cupType",void 0),l([m({type:cc.Integer,tooltip:"\u906e\u7f69\u676f\u5b50\u89e3\u9501\u9700\u6c42\u989c\u8272id,0\u4e3a\u4efb\u610f\u989c\u8272"})],t.prototype,"maskColorId",void 0),l([m({type:cc.Integer,tooltip:"\u906e\u7f69\u676f\u5b50\u89e3\u9501\u9700\u6c42\u6570\u91cf"})],t.prototype,"maskColorCount",void 0),l([m({type:cc.Integer,tooltip:"\u51bb\u7ed3\u676f\u5b50\u89e3\u9501\u9700\u6c42\u6570\u91cf"})],t.prototype,"frozenCount",void 0),l([m(sp.Skeleton)],t.prototype,"surface",void 0),l([m(sp.Skeleton)],t.prototype,"surfaceHighlight",void 0),l([m(cc.Prefab)],t.prototype,"showHiddenMarkPrefab",void 0),l([m(cc.Node)],t.prototype,"capNode",void 0),l([m(cc.Node)],t.prototype,"hiddenMark",void 0),l([m(sp.Skeleton)],t.prototype,"pourInSurface",void 0),l([m(sp.Skeleton)],t.prototype,"pourInSurfaceHightlight",void 0),l([m(sp.Skeleton)],t.prototype,"pourInSplash",void 0),l([m(sp.Skeleton)],t.prototype,"pourInSplashHighlight",void 0),l([m(sp.Skeleton)],t.prototype,"pourInRipple",void 0),l([y,g()],t)}(cc.Component);r.default=v,cc._RF.pop(),cc._RF.pop()},{}],Cup:[function(e,t,o){"use strict";cc._RF.push(t,"74668nsikNO2o1a3I9mV4Xi","Cup");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"74668nsikNO2o1a3I9mV4Xi","Cup");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0}),r.SPLIT_COUNT=r.CupType=r.CupState=r.color_locked_surface=r.color_locked=r.resetColors=r.setColors=r.finishEnd=r.finishStart=r.SplashColors=r.SurfaceColors=r.WaterColors=r.ColorIDRef=r.HEIGHT_FACTOR=void 0;var u,p,d=n("Water"),f=n("CupInfoUI"),h=n("AudioManager"),y=n("GameScene"),m=n("CupMgr"),g=n("const"),v=n("GameScene_Long"),_=n("CommonData"),S=n("GameManager"),b=n("Key"),C=n("DataNexusSDK"),P=n("DataNexusEnum"),k=cc._decorator,w=k.ccclass,I=k.property;k.executeInEditMode,r.HEIGHT_FACTOR=.75,r.ColorIDRef=[0,1,2,3,4,5,6,7,8,9,10],r.WaterColors=["#000000","#C30D08","#191AC1","#F7C212","#74A912","#601995","#5861A9","#0097d7","#e45700","#75262a","#ff6ed8"],r.SurfaceColors=["#000000","#E72C2C","#3d5ad1","#ffe24b","#A0CF2B","#A43DFE","#848ED6","#43c3fa","#f4861b","#b25651","#f493e8"],r.SplashColors=["#000000","#FF4C4C","#526EDE","#ffef93","#BAE846","#B866FF","#9BA5F2","#7adeff","#ffa245","#cc6d68","#ffb0f6"],r.finishStart=["#000000","#ffdabb","#abc8ff","#fbffc6","#e4ffb4","#f0bbff","#cecbfa","#b3f5ff","#fae9b4","#f0cb9e","#f0bbff"],r.finishEnd=["#000000","#ffa79900","#7e98ff00","#fff0b300","#bbdd6700","#ce9aff00","#b3c2ff00","#85cdeb00","#feba9d00","#f7a68100","#ffb3ff00"],r.setColors=function(e,t,o,n,i,a){r.WaterColors=e,r.SurfaceColors=t,r.finishStart=o,r.finishEnd=n,r.SplashColors=i,r.ColorIDRef=a},r.resetColors=function(){r.WaterColors=["#000000","#C30D08","#191AC1","#F7C212","#74A912","#601995","#5861A9","#0097d7","#e45700","#75262a","#ff6ed8"],r.SurfaceColors=["#000000","#E72C2C","#3d5ad1","#ffe24b","#A0CF2B","#A43DFE","#848ED6","#43c3fa","#f4861b","#b25651","#f493e8"],r.SplashColors=["#000000","#FF4C4C","#526EDE","#ffef93","#BAE846","#B866FF","#9BA5F2","#7adeff","#ffa245","#cc6d68","#ffb0f6"],r.finishStart=["#000000","#ffdabb","#abc8ff","#fbffc6","#e4ffb4","#f0bbff","#cecbfa","#b3f5ff","#fae9b4","#f0cb9e","#f0bbff"],r.finishEnd=["#000000","#ffa79900","#7e98ff00","#fff0b300","#bbdd6700","#ce9aff00","#b3c2ff00","#85cdeb00","#feba9d00","#f7a68100","#ffb3ff00"],r.ColorIDRef=[0,1,2,3,4,5,6,7,8,9,10]},r.color_locked="#333333",r.color_locked_surface="#666666",function(e){e[e.Idle=0]="Idle",e[e.Moving=1]="Moving",e[e.Selected=2]="Selected",e[e.Pouring=3]="Pouring",e[e.PouringIn=4]="PouringIn",e[e.Finished=5]="Finished",e[e.ColorChanging=6]="ColorChanging",e[e.ReadyToBeCollected=7]="ReadyToBeCollected",e[e.Restoring=8]="Restoring"}(u=r.CupState||(r.CupState={})),function(e){e[e.Normal=0]="Normal",e[e.Locked=1]="Locked",e[e.Fixed=2]="Fixed",e[e.Frozen=3]="Frozen",e[e.Masked=4]="Masked",e[e.SingleColor=5]="SingleColor",e[e.Bomb=6]="Bomb",e[e.Temp1=7]="Temp1",e[e.Temp1AD=8]="Temp1AD",e[e.Absorb=9]="Absorb",e[e.BombFixed=10]="BombFixed",e[e.BombFrozen=11]="BombFrozen",e[e.BombMasked=12]="BombMasked",e[e.Temp1Frozen=13]="Temp1Frozen",e[e.ChangeColor=14]="ChangeColor",e[e.Lock=15]="Lock",e[e.Fragile=16]="Fragile",e[e.Stubborn=17]="Stubborn",e[e.Force=18]="Force"}(p=r.CupType||(r.CupType={})),r.SPLIT_COUNT=4;var T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.water=null,t.currentState=u.Idle,t.cupType=p.Normal,t.maskColorId=0,t.maskColorCount=0,t.frozenCount=0,t.surface=null,t.surfaceHighlight=null,t.showHiddenMarkPrefab=null,t.capNode=null,t.hiddenMark=null,t.highlightNode=null,t.goal=0,t.progress=0,t.frame=0,t.isFillingIn=!1,t.heightFactor=r.HEIGHT_FACTOR,t.onClick=null,t.info=null,t.pourInSurface=null,t.pourInSurfaceHightlight=null,t.pourInSplash=null,t.pourInSplashHighlight=null,t.pourInRipple=null,t.thumbAnimation=null,t.tween=null,t.maskNodes=[],t.maskPrefab=null,t.maskLabel=null,t.frozenLabel=null,t.adNode=null,t.adFrames=[],t.keyPrefab=null,t.keyNode=null,t.keyIds=[0,0,0,0],t.keyNodes=[null,null,null,null],t.breathingTween=null,t.dot=null,t}return s(t,e),t.prototype.update=function(){this.updateSurface(),this.water.skewAngle!=this.node.angle&&(this.water.skewAngle=this.node.angle)},t.prototype.onBtn_click=function(){null!=f.default.getInstance()&&f.default.getInstance().bindToCup(this),this.onClick&&this.onClick(this)},t.prototype.isPouring=function(){return Math.abs(this.node.angle)>1},t.prototype.isInteractable=function(){return!(this.isFillingIn||this.maskColorCount>0||this.cupType==p.Locked||this.cupType==p.Temp1AD||this.isFrozen()||this.hasMask()||this.cupType==p.BombFrozen||this.cupType==p.BombMasked||this.currentState!=u.Idle&&this.currentState!=u.Selected&&this.currentState!=u.PouringIn&&this.currentState!=u.Restoring||this.water._action==d.WaterAction.colorChange)},t.prototype.canCheckDeadlock=function(){return this.cupType!=p.Locked&&this.cupType!=p.Temp1AD&&!this.isFrozen()&&!this.hasMask()&&this.cupType!=p.Lock},t.prototype.initWater=function(){var e=this.info;this.hiddenMark&&this.hiddenMark.children.forEach(function(e){return e.active=!1});for(var t=[],o=r.SPLIT_COUNT-1;o>=0;o--){var n=e.colorIds[o];if(0!=n){var i=t[t.length-1];i&&i==n?i.height+=1/r.SPLIT_COUNT:t.push({intialIndex:o,height:1/r.SPLIT_COUNT,colorId:n%1e3})}}var a=this;t.forEach(function(e){var t=r.WaterColors[e.colorId%1e3]||"#538849",o=r.SurfaceColors[e.colorId%1e3]||"#538849";e.colorId%1e3>100&&(t=r.color_locked,o=r.color_locked_surface,a.hiddenMark&&(a.hiddenMark.children[e.intialIndex].active=!0)),e.color=(new cc.Color).fromHEX(t),e.surfaceColor=(new cc.Color).fromHEX(o),e.height*=a.heightFactor}),this.water.initInfos(t)},t.prototype.initCup=function(e){var t,o,n,i;this.initDefault(),this.setCupType(e.type),this.setColorIds(e.colorIds),this.reverseFinishAnimation(),this.currentState=u.Idle,e.maskUnlockCount&&e.maskUnlockCount>0&&(this.maskColorId=null!==(t=e.maskUnlockColorId)&&void 0!==t?t:0,this.maskColorCount=null!==(o=e.maskUnlockCount)&&void 0!==o?o:0,this.setMask(e.maskUnlockColorId,e.maskUnlockCount)),e.frozenUnlockCount&&e.frozenUnlockCount>0&&(this.frozenCount=null!==(n=e.frozenUnlockCount)&&void 0!==n?n:0,this.frozenLabel.node.parent.parent.active=!0,this.frozenLabel.node.active=!0,this.frozenLabel.node.parent.getComponent(sp.Skeleton).animation=null,this.setFrozenUnlockCount(this.frozenCount)),e.bombTime&&e.bombTime>0&&(this.bombTime=null!==(i=e.bombTime)&&void 0!==i?i:120,this.setBombTime(this.bombTime)),this.initWater(),this.reset()},t.prototype.setCupInfo=function(e,t){var o,n,i;this.info.colorIds=e.colorIds,this.info.cupType=e.type,this.onClick=t,this.cupType=e.type,this.cupType!==p.Masked&&this.cupType!==p.BombMasked||(this.maskColorId=null!==(o=e.maskUnlockColorId)&&void 0!==o?o:0,this.maskColorCount=null!==(n=e.maskUnlockCount)&&void 0!==n?n:0),this.cupType!==p.Frozen&&this.cupType!==p.BombFrozen||(this.frozenCount=null!==(i=e.frozenUnlockCount)&&void 0!==i?i:0),this.cupType!==p.Locked&&this.cupType!==p.Temp1AD||this.setUpLockCup(),this.initWater(),this.reset()},t.prototype.updateSurface=function(){var e=this.water.getWaterCenter();if(e.y+=8,this.cupType!=p.Temp1&&this.cupType!=p.Absorb||(e.y-=5),this.surface.node.setPosition(e.x,e.y),this.water._action==d.WaterAction.in&&this.pourInSurface.node.setPosition(e.x,e.y),this.water.ifShowPourInSurface||this.currentState!=u.PouringIn){if(this.water.infos.length<=0)return this.surface.node.opacity=0,this.surfaceHighlight.node.opacity=0,this.pourInSurface.node.opacity=0,this.pourInSurfaceHightlight.node.opacity=0,this.pourInSplash.node.opacity=0,this.pourInSplashHighlight.node.opacity=0,void(this.pourInRipple.node.opacity=0);this.water._action==d.WaterAction.in&&(this.surface.node.opacity=255,this.surfaceHighlight.node.opacity=180,this.pourInSurface.node.active=!0,this.pourInSurface.node.opacity=255,this.pourInSurfaceHightlight.node.opacity=180,this.pourInSurface.node.setPosition(e.x,e.y));var t=this.getTop().topColorId;if(0!=(t%=1e3)&&this.currentState!=u.Pouring){this.surface.node.opacity=255,this.surfaceHighlight.node.opacity=180;var o=this.getTop().emptyNum;void 0===this.water.infos[3-o]||void 0===this.water.infos[3-o].surfaceColor?this.surface.node.color=(new cc.Color).fromHEX(r.SurfaceColors[t]||"#538849"):this.surface.node.color=this.water.infos[3-o].surfaceColor}else if(this.surface.node.opacity=this.currentState==u.Finished?255:0,this.currentState==u.Pouring&&(this.surface.node.opacity=0),this.currentState==u.Finished)this.surface.node.opacity=255,this.surfaceHighlight.node.opacity=180,this.surface.node.color=this.water.infos[0].surfaceColor;else if(this.water._action==d.WaterAction.in){this.surface.node.opacity=255,this.surfaceHighlight.node.opacity=180,r.WaterColors[t];var n=r.SurfaceColors[t]||"#538849";t%1e3>100&&(r.color_locked,n=r.color_locked_surface),this.surface.node.color=(new cc.Color).fromHEX(n)}else if(this.water._action==d.WaterAction.colorChange){this.surface.node.opacity=255,this.surfaceHighlight.node.opacity=180;var i=this.getTop().emptyNum;this.surface.node.color=this.water.infos[3-i].surfaceColor}}},t.prototype.playPourInAnimation=function(e){var t,o,n,i,a=this;void 0===e&&(e=0),this.pourInSurface.animation=null,this.pourInSurfaceHightlight.animation=null,this.pourInSplash.animation=null,this.pourInSplashHighlight.animation=null,this.pourInRipple.animation=null,this.pourInSplash.node.opacity=255,this.pourInSplashHighlight.node.opacity=255,this.pourInRipple.node.opacity=255;var c=r.SplashColors[e]||"#538849",s=r.SurfaceColors[e]||"#538849";this.pourInSurface.node.color=(new cc.Color).fromHEX(s),this.pourInSplash.node.color=(new cc.Color).fromHEX(c),this.pourInSurface.node.active=!0,this.pourInSurface.node.opacity=255,this.pourInSurfaceHightlight.node.opacity=180,"smd_start"!==(null===(t=this.pourInSurface.getCurrent(0))||void 0===t?void 0:t.animation.name)&&(this.pourInSurface.setAnimation(0,"smd_start",!1).listener={complete:function(e){"smd_start"===e.animation.name&&a.pourInSurface.setAnimation(0,"smd_channel",!0)}}),"sms_start"!==(null===(o=this.pourInSurfaceHightlight.getCurrent(0))||void 0===o?void 0:o.animation.name)&&(this.pourInSurfaceHightlight.setAnimation(0,"sms_start",!1).listener={complete:function(e){"sms_start"===e.animation.name&&a.pourInSurfaceHightlight.setAnimation(0,"sms_channel",!0)}}),"sds_start"!==(null===(n=this.pourInSplashHighlight.getCurrent(0))||void 0===n?void 0:n.animation.name)&&(this.pourInSplashHighlight.setAnimation(0,"sds_start",!1).listener={complete:function(e){"sds_start"===e.animation.name&&a.pourInSplashHighlight.setAnimation(0,"sds_channel",!0)}}),"sms_start"!==(null===(i=this.pourInSplash.getCurrent(0))||void 0===i?void 0:i.animation.name)&&(this.pourInSplash.setAnimation(0,"sdd_start",!1).listener={complete:function(e){"sdd_start"===e.animation.name&&a.pourInSplash.setAnimation(0,"sdd_channel",!0)}}),this.pourInRipple.animation=null,this.pourInRipple.setAnimation(0,"bw_channel",!0)},t.prototype.stopPourInAnimation=function(e){var t=this;void 0===e&&(e=0);var o=this.water.getWaterCenter();o.y+=13,this.cupType!=p.Temp1&&this.cupType!=p.Absorb||(o.y-=5),this.pourInSurface.node.setPosition(o.x,o.y),this.pourInSurface.animation=null,this.pourInSurfaceHightlight.animation=null,this.pourInSplash.animation=null,this.pourInSplashHighlight.animation=null,this.pourInRipple.animation=null,this.pourInSurface.setAnimation(0,"smd_end",!1).listener={complete:function(e){"smd_end"===e.animation.name&&t.scheduleOnce(function(){t.pourInSurface.node.opacity=0,t.pourInSurface.node.active=!1},.1)}},this.pourInSurfaceHightlight.setAnimation(0,"sms_end",!1),this.pourInSplash.setAnimation(0,"sdd_end",!1),this.pourInSplashHighlight.setAnimation(0,"sds_end",!1),this.pourInRipple.setAnimation(0,"bw_end",!1)},t.prototype.clearPourInAnimation=function(){this.pourInSurface.animation=null,this.pourInSurfaceHightlight.animation=null,this.pourInSplash.animation=null,this.pourInSplashHighlight.animation=null,this.pourInRipple.animation=null},t.prototype.onSelectSurfaceAnimation=function(){this.surface.animation=null,this.surfaceHighlight.animation=null,this.surface.setAnimation(0,"smd_start",!1),this.surface.setAnimation(1,"smd_channel",!1),this.surface.setAnimation(2,"smd_end",!1),this.surfaceHighlight.setAnimation(0,"sms_start",!1),this.surfaceHighlight.setAnimation(1,"sms_channel",!1),this.surfaceHighlight.setAnimation(2,"sms_end",!1)},t.prototype.setPourOutCallback=function(e,t,o){void 0===o&&(o=!1);var n=this;this.water.setPourOutCallback(function(){e&&e(this)}.bind(this),function(){n.tween&&(n.tween.stop(),n.tween=null),n.cupType==p.ChangeColor&&n.changeColor(),t&&t(this)}.bind(this))},t.prototype.setPourInCallback=function(e,t){void 0===t&&(t=!1);var o=this;this.water.setPourInCallback(function(){var n=o.checkIsFinshed();n||o.cupType==p.ChangeColor&&(t?o.changeColorUndo():o.changeColor()),e&&e(this,n)}.bind(this))},t.prototype.playFinishAnimation=function(){if(this.capNode){var e=this;this.capNode.active=!0,this.capNode.setPosition(0,115),this.capNode.opacity=0,this.capNode.scaleX=.2,this.capNode.scaleY=.4,this.surface.node.opacity=255,this.surfaceHighlight.node.opacity=180;var t=this.node.scale;cc.tween(this.capNode).delay(.6).to(.15,{y:130,scaleX:.4,scaleY:.8,opacity:255},{easing:"sineIn"}).to(.15,{y:145,scaleX:1,scaleY:1},{easing:"sineOut"}).to(.2,{y:115},{easing:"sineIn"}).call(function(){S.default.playVibrateShort(),e.setAnchor(cc.v2(.5,0)),h.default.instance.playSFX(h.AudioRef.CapFinish),cc.tween(e.node).to(.12,{scaleX:t+.2,scaleY:t-.1}).to(.06,{scaleX:t,scaleY:t+.03}).to(.06,{scale:t},{easing:"smooth"}).call(function(){e.setAnchor(cc.v2(.5,.5)),e.playThumbAnimation()}).start()}).to(.12,{scaleX:1.1,scaleY:.9}).to(.12,{scaleX:1,scaleY:1}).delay(.2).call(function(){e.currentState=u.ReadyToBeCollected,e.scheduleOnce(function(){cc.director.emit(g.EventNames.TryCollect)},0),cc.director.getScene().name!=g.SceneNames.Game&&cc.director.getScene().name!=g.SceneNames.GameModeMultiple||m.default.getInstance().sortAllFinishedCups()}).start()}},t.prototype.playThumbAnimation=function(){if(this.thumbAnimation){this.thumbAnimation.active=!0;var e=this.thumbAnimation.getComponent(sp.Skeleton);e&&(this.thumbAnimation.scale=.05,e.setAnimation(0,"hz",!0),cc.tween(this.thumbAnimation).to(.3,{scale:.25},{easing:"backOut"}).start())}},t.prototype.hideThumbAnimation=function(){var e=this;cc.tween(this.thumbAnimation).to(.3,{opacity:0},{easing:"smooth"}).call(function(){e.thumbAnimation.active=!1,e.thumbAnimation.opacity=255}).start()},t.prototype.reverseFinishAnimation=function(){this.node.scaleX=1,this.node.scaleY=1,this.capNode&&(this.capNode.active=!1)},t.prototype.moveToPour=function(e,t,o,n,i,a){var c=this;void 0===a&&(a=!1),this.playSelectHighlight(!1),this.setPourOutCallback(n,i,a);var s=this.water.getPourStartAngle(),l=this.water.getPourEndAngle(o),u=o;t&&(s*=-1,l*=-1),this.node.stopAllActions(),this.tween=cc.tween(this.node).set({angle:0}).to(.15,{x:e.x,y:e.y,angle:s},{easing:"sineIn"}).call(function(){c.water.onStartPour(o)}).to(.2,{angle:l}).call(function(){c.tween=null}).start();for(var p=this.getTop(),d=this.info.colorIds,f=0;f<r.SPLIT_COUNT;f++){var h=d[f]%1e3;if(0!=h){if(p.topColorId!=h)break;if(u--,d[f]=0,0==u)break}}},t.prototype.startAddWater=function(e,t,o,n){void 0===n&&(n=!1),this.setPourInCallback(o,n),e%=1e3;var i=r.WaterColors[e]||"#538849",a=r.SurfaceColors[e]||"#538849";this.playPourInAnimation(e),this.water.addInfo({colorId:e,height:t/r.SPLIT_COUNT*this.heightFactor,color:(new cc.Color).fromHEX(i),surfaceColor:(new cc.Color).fromHEX(a)})},t.prototype.startAddWaterForce=function(e,t,o){var n=this;this.setPourInCallback(o);var i=t/r.SPLIT_COUNT*this.heightFactor/e.length;this.playPourInAnimation(e[0]%1e3),e.forEach(function(e){e%=1e3;var t=r.WaterColors[e]||"#538849",o=r.SurfaceColors[e]||"#538849";n.water.addInfo({colorId:e,height:i,color:(new cc.Color).fromHEX(t),surfaceColor:(new cc.Color).fromHEX(o)})})},t.prototype.hasMask=function(){return this.maskColorCount>0},t.prototype.isFrozen=function(){return this.frozenCount>0},t.prototype.tryReduceMaskCondition=function(e,t){return!(this.maskColorCount<=0)&&(this.maskColorId===e&&(this.maskColorCount-=t,this.maskLabel.string=this.maskColorCount+""),this.maskColorCount<=0&&(this.unmaskCup(),!0))},t.prototype.unmaskCup=function(){var e=this;h.default.instance.playSFX(h.AudioRef.OpenBottle),this.cupType==p.Masked&&(this.cupType=p.Normal),this.cupType==p.BombMasked&&(this.cupType=p.Bomb),this.isFrozen()&&this.updateFrozenCount(),cc.tween(this.maskLabel.node.parent.parent).to(.3,{opacity:0},{easing:"smooth"}).call(function(){e.maskLabel.node.parent.parent.active=!1,e.maskLabel.node.parent.parent.opacity=255,e.unmaskNodes(),e.checkIsStrictFinshed()&&m.default.getInstance().finishCup(e)}).start()},t.prototype.unmaskNodes=function(){this.maskNodes.length>0&&this.maskNodes.forEach(function(e){cc.tween(e).to(.3,{opacity:255},{easing:"smooth"}).start()})},t.prototype.updateFrozenCount=function(){var e=m.default.getInstance().cups.filter(function(e){return!e.isFrozen()&&!e.hasMask()&&e.currentState!=u.Finished&&e.currentState!=u.ReadyToBeCollected});if(0!==e.length){for(var t,o=0,n=[0,0,0,0,0,0,0,0,0,0,0,0],i=0,r=e;i<r.length;i++)for(var a=r[i],c=0,s=a.info.colorIds;c<s.length;c++){var l=s[c];if(0!==l&&(l%1e3>100?n[l%1e3-100]++:n[l]++,4===n[l]&&(n[l]=0,o+=4),a.cupType===p.Temp1||a.cupType===p.Absorb))break}if((t=Math.floor(o/4))<=0)return this.cupType=p.Normal,this.maskNodes=[],this.frozenCount=0,void(this.info.frozenUnlockCount=0);this.frozenCount>t&&(this.frozenCount=t,this.info.frozenUnlockCount=t,this.frozenLabel.string=this.frozenCount+"")}},t.prototype.tryReduceFrozenCount=function(){return!!this.isFrozen()&&!this.hasMask()&&(this.frozenCount-=1,this.frozenLabel.string=this.frozenCount+"",this.frozenCount<=0&&(this.unfreezeCup(),!0))},t.prototype.unfreezeCup=function(){var e=this;h.default.instance.playSFX(h.AudioRef.OpenBottle),this.cupType==p.Temp1Frozen||this.cupType==p.Temp1?this.cupType=p.Temp1:this.cupType==p.BombFrozen?this.cupType=p.Bomb:this.cupType=p.Normal;var t=this.frozenLabel.node.parent.getComponent(sp.Skeleton);this.frozenLabel.node.active=!1,t.setAnimation(0,"broke",!1),t.setCompleteListener(function(){cc.tween(e.frozenLabel.node.parent.parent).to(.3,{opacity:0},{easing:"smooth"}).call(function(){e.frozenLabel.node.parent.parent.active=!1,e.frozenLabel.node.parent.parent.opacity=255,e.checkIsStrictFinshed()&&m.default.getInstance().finishCup(e)}).start()})},t.prototype.pumpWater=function(e,t){var o=parseInt(e[e.length-1]);o--;var n=this.info.colorIds[o];if(n%1e3>=100&&(n-=100),0===n)return!1;var i=this.getTop();if(i.topColorId===n&&i.emptyNum+i.topColorNum>=o)return cc.director.getScene().name==g.SceneNames.GameModeFillLong?(v.default.instance.ChangeTipsStay("\u8bf7\u9009\u62e9\u4e0d\u5728\u7b2c\u4e00\u5c42\u7684\u6c34",2),!1):(y.default.instance.ChangeTipsStay("\u8bf7\u9009\u62e9\u4e0d\u5728\u7b2c\u4e00\u5c42\u7684\u6c34",2),!1);for(var a=this.info.colorIds.slice(),c=new Array(r.SPLIT_COUNT).fill(0),s=[o],l=o-1;l>=0&&a[l]==n;l--)s.push(l);for(l=o+1;l<r.SPLIT_COUNT&&a[l]==n;l++)s.push(l);var u=[],p=[];for(l=0;l<r.SPLIT_COUNT;l++)0==a[l]?u.push(l):-1==s.indexOf(l)&&p.push(l);var d=new Map;for(l=0;l<r.SPLIT_COUNT;l++)if(u.length>0)c[l]=0,u.shift();else if(s.length>0)c[l]=n,d.set(s[0],l),s.shift();else if(p.length>0){var f=p.shift();d.set(f,l),c[l]=a[f]}console.error("moveMap:",d),console.error("newColorIds:",c),this.moveKeyToTop(d),this.info.colorIds=c;var h=[];for(l=r.SPLIT_COUNT-1;l>=0;l--){var m=c[l];0!=m&&(h[h.length-1],h.push({height:1/r.SPLIT_COUNT,colorId:m%1e3}))}var _=this;return h.forEach(function(e){var t=r.WaterColors[e.colorId]||"#538849",o=r.SurfaceColors[e.colorId]||"#538849";e.colorId%1e3>100&&(t=r.color_locked,o=r.color_locked_surface),e.color=(new cc.Color).fromHEX(t),e.surfaceColor=(new cc.Color).fromHEX(o),e.height*=_.heightFactor}),this.water.startColorAnimation(h,.5,t),!0},t.prototype.setUpLockCup=function(){0!=this.adFrames.length&&(_.default.firstProp&&cc.director.getScene().name==g.SceneNames.Game?this.setShareUnlock():this.setAdUnlock(),_.default.Level<=2&&cc.director.getScene().name==g.SceneNames.Game&&this.setFreeUnlock())},t.prototype.setAdUnlock=function(){0!=this.adFrames.length&&(this.adNode.getComponent(cc.Sprite).spriteFrame=this.adFrames[0],C.default.instance.trackAdPlacementShow(P.RewardADEvent.UNLOCK_BOX))},t.prototype.setShareUnlock=function(){0!=this.adFrames.length&&(this.adNode.getComponent(cc.Sprite).spriteFrame=this.adFrames[1])},t.prototype.setFreeUnlock=function(){0!=this.adFrames.length&&(this.adNode.getComponent(cc.Sprite).spriteFrame=this.adFrames[2])},t.prototype.unlockCup=function(){this.cupType==p.Temp1AD?(this.cupType=p.Temp1,this.info.cupType=p.Temp1,this.water.speedFactor=.25,this.heightFactor=.5,this.water.heightFactor=.5):(this.cupType=p.Normal,this.info.cupType=p.Normal),h.default.instance.playSFX(h.AudioRef.OpenBottle),this.adNode.active=!1,cc.director.getScene().name==g.SceneNames.Game&&y.default.instance.PopoutTips()},t.prototype.unlockCupWithTween=function(){var e=this;cc.tween(this.adNode).to(.5,{scale:1.2},{easing:"smooth"}).to(.3,{scale:0},{easing:"smooth"}).call(function(){e.unlockCup()}).start()},t.prototype.canOrganizeTopColor=function(){if(this.isPouring())return!1;for(var e=this.info.colorIds.slice(),t={},o=0;o<e.length;o++)0===(n=e[o])||n%1e3>100||(t[n]||(t[n]=[]),t[n].push(o));for(var n in t){var i=t[n];for(o=1;o<i.length;o++)if(i[o]-i[o-1]>1)return!0}return!1},t.prototype.organizeTopColor=function(e,t){if(void 0===e&&(e=.5),void 0===t&&(t=null),this.isPouring())return!1;this.currentState=u.ColorChanging;var o=this.getTop();if(0==o.topColorId||o.topColorNum==r.SPLIT_COUNT)return!1;for(var n=this.info.colorIds.slice(),i=[],a=[-1,-1,-1,-1],c=[0,0,0,0],s=0,l=0;l<r.SPLIT_COUNT;l++){var p=n[l],d=a.indexOf(p);-1!=a.indexOf(p)?(a[d]=p,c[d]++):(a[s]=p,c[s]++,s++)}for(var f=0;-1!==a[f];){p=a[f];for(var h=c[f];h--;)i.push(p);f++}for(var y=!1,m=0;m<r.SPLIT_COUNT;m++)if(n[m]!=i[m]){y=!0;break}if(!y)return!1;this.info.colorIds=i;for(var g=[],v=r.SPLIT_COUNT-1;v>=0;v--){var _=i[v];0!=_&&(g[g.length-1],g.push({height:1/r.SPLIT_COUNT,colorId:_%1e3}))}var S=this;return g.forEach(function(e){var t=r.WaterColors[e.colorId]||"#538849",o=r.SurfaceColors[e.colorId]||"#538849";e.colorId%1e3>100&&(t=r.color_locked,o=r.color_locked_surface),e.color=(new cc.Color).fromHEX(t),e.surfaceColor=(new cc.Color).fromHEX(o),e.height*=S.heightFactor}),this.water.startColorAnimation(g,e,t),!0},t.prototype.dyeWater=function(e,t){this.info.colorIds=e;for(var o=[],n=r.SPLIT_COUNT-1;n>=0;n--){var i=e[n];0!=i&&(o[o.length-1],o.push({height:1/r.SPLIT_COUNT,colorId:i%1e3}))}var a=this;return o.forEach(function(e){var t=r.WaterColors[e.colorId]||"#538849",o=r.SurfaceColors[e.colorId]||"#538849";e.colorId%1e3>100&&(t=r.color_locked,o=r.color_locked_surface),e.color=(new cc.Color).fromHEX(t),e.surfaceColor=(new cc.Color).fromHEX(o),e.height*=a.heightFactor}),this.water.startColorAnimation(o,.5,t),!0},t.prototype.canPourTo=function(e){if(this===e)return!1;var t=this.getTop().topColorId,o=e.getTop().topColorId;if(e.cupType===p.SingleColor&&t!==e.singleColorId)return!1;var n=this.getTop().topColorNum,i=e.getTop().emptyNum;return null!==t&&0!==i&&(this.cupType!==p.Temp1||e.cupType!==p.Temp1||i!=n)&&(this.cupType!==p.Absorb||e.cupType!==p.Temp1||i!=n)&&(null===o||o==t)&&i>=n},t.prototype.canFinish=function(e){if(this===e)return!1;if(this.getTop().topColorId!==e.getTop().topColorId)return!1;var t=this.getTop().topColorNum,o=e.getTop().emptyNum,n=e.getTop().topColorNum;return o<=t&&o+n==r.SPLIT_COUNT},t.prototype.playSelectHighlight=function(e){e?(this.highlightNode.opacity=0,cc.tween(this.highlightNode).to(.2,{opacity:255}).start()):(this.highlightNode.opacity=255,cc.tween(this.highlightNode).to(.2,{opacity:0}).start())},t.prototype.showHiddenWater=function(e,t){this.info.colorIds=e;for(var o=[],n=r.SPLIT_COUNT-1;n>=0;n--){var i=e[n];0!=i&&(o[o.length-1],o.push({height:1/r.SPLIT_COUNT,colorId:i%1e3}))}var a=this;return o.forEach(function(e){var t=r.WaterColors[e.colorId]||"#538849",o=r.SurfaceColors[e.colorId]||"#538849";e.colorId%1e3>100&&(t=r.color_locked,o=r.color_locked_surface),e.color=(new cc.Color).fromHEX(t),e.surfaceColor=(new cc.Color).fromHEX(o),e.height*=a.heightFactor}),this.water.startColorAnimation(o,.5,t),!0},t.prototype.addWaterImmediately=function(e,t){for(var o=0,n=r.SPLIT_COUNT-1;n>=0&&(0!=this.info.colorIds[n]||(this.info.colorIds[n]=e,++o!=t));n--);this.initWater()},t.prototype.removeTopWaterImmediately=function(e){for(var t=0,o=this.getTop(),n=this.info.colorIds,i=0;i<r.SPLIT_COUNT;i++){var a=n[i];if(0!=a){if(o.topColorId!=a)break;if(n[i]=0,++t>=e)break}}return this.initWater(),o},t.prototype.setUpKey=function(e){for(var t=0;t<e.length;t++){var o=e[t];if(o>1e3){e[t]=o%1e3;var n=Math.floor(o/1e3);this.keyIds[t]=n;var i=cc.instantiate(this.keyPrefab);this.keyNodes[t]=i,i.getComponent(b.default).setKeyType(n),i.parent=this.keyNode,i.setPosition(this.hiddenMark.children[t].getPosition()),o%1e3>100&&(this.keyIds[t]=-this.keyIds[t],i.active=!1,i.scale=0)}}},t.prototype.moveKeyUp=function(){for(var e=1;e<this.keyIds.length;e++){var t=this.keyIds[e];this.keyIds[e-1]=t}this.keyIds[this.keyIds.length-1]=0;var o=this.hiddenMark.children,n=function(e){var t=i.keyNodes[e];if(i.keyNodes[e-1]=t,!t)return"continue";var n=o[e-1].getPosition();cc.tween(t).delay(.5).to(.25,{opacity:0}).call(function(){t.setPosition(n)}).to(.25,{opacity:255}).start()},i=this;for(e=1;e<this.keyNodes.length;e++)n(e);this.keyNodes[this.keyNodes.length-1]=null},t.prototype.moveKeyToTop=function(e){for(var t=this,o=function(o){if(0==n.keyIds[o])return"continue";var i=e.get(o);if(i===o)return"continue";n.keyIds[i]=n.keyIds[o],n.keyIds[o]=0;var r=n.keyNodes[o];n.keyNodes[i]=r,n.keyNodes[o]=null;var a=n.hiddenMark.children[i].getPosition();if(!r)return"continue";cc.tween(r).delay(.4).to(.25,{opacity:0}).call(function(){r.setPosition(a)}).to(.25,{opacity:255}).call(function(){t.tryRevealKey()}).start()},n=this,i=0;i<r.SPLIT_COUNT;i++)o(i)},t.prototype.forceRevealKey=function(){},t.prototype.tryRevealKey=function(){for(var e=this,t=this.getTop().emptyNum,o=function(t){var o=n.keyIds[t];if(0==o)return"continue";var i=n.keyNodes[t];if(!i)return"continue";cc.director.emit(g.EventNames.RevealKey,o,n.node.parent);var r=.1;n.keyIds[t]=0,o>0?(r=.2,n.cupType===p.ChangeColor&&(r=.5),cc.tween(i).delay(r).to(.3,{scaleX:0,scaleY:0},{easing:"backIn"}).call(function(){e.keyNodes[t].destroy(),e.keyNodes[t]=null}).start()):(r=1,cc.tween(i).call(function(){i.active=!0}).delay(r).to(.3,{scaleX:.4,scaleY:.4},{easing:"backOut"}).delay(.2).to(.3,{scaleX:0,scaleY:0},{easing:"backIn"}).call(function(){e.keyNodes[t].destroy(),e.keyNodes[t]=null}).start())},n=this,i=0;i<=t;i++)o(i)},t.prototype.isEmpty=function(){return this.cupType===p.Temp1||this.cupType===p.Absorb?0==this.info.colorIds[0]:0==this.info.colorIds[3]},t.prototype.startBreathingAnimation=function(){this.breathingTween||(this.setAnchor(cc.v2(.5,0)),this.breathingTween=cc.tween(this.node).repeatForever(cc.tween().to(.5,{scaleX:1.05,scaleY:1.05},{easing:"sineInOut"}).to(.5,{scaleX:1,scaleY:1},{easing:"sineInOut"}).to(.5,{scaleX:1.05,scaleY:1.05},{easing:"sineInOut"}).to(.5,{scaleX:1,scaleY:1},{easing:"sineInOut"}).delay(1)).start())},t.prototype.stopBreathingAnimation=function(){this.breathingTween&&(this.breathingTween.stop(),this.breathingTween=null,this.setAnchor(cc.v2(.5,.5)),this.node.scale=1)},t.prototype.onShowHidden=function(e){var t=this.hiddenMark.children[e],o=new cc.Vec2(t.x,t.y),n=cc.instantiate(this.showHiddenMarkPrefab);n.parent=this.hiddenMark,n.setPosition(o),n.getComponent(sp.Skeleton).setCompleteListener(function(){n.destroy()}),n.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),t.active=!1},t.prototype.getTop=function(){for(var e=this.info.colorIds,t=0,o=0,n=0,i=0;i<r.SPLIT_COUNT;i++)if(0!=e[i]){if(0!=o&&o!=e[i])break;o=e[i],n++}else t++;return this.cupType!==p.Temp1&&this.cupType!==p.Absorb||(t>0&&(t=1),n>0&&(n=1)),{emptyNum:t,topColorId:o,topColorNum:n,colorHex:r.WaterColors[o]||"#538849"}},t.prototype.getTopStrict=function(){for(var e=this.info.colorIds,t=0,o=0,n=0,i=0;i<r.SPLIT_COUNT;i++)if(0!=e[i]){if(0!=o&&o!=e[i])break;o=e[i],n++}else t++;return this.cupType!==p.Temp1&&this.cupType!==p.Absorb||(t>0&&(t=1),n>0&&(n=1)),{emptyNum:t,topColorId:o,topColorNum:n}},t.prototype.reset=function(){this.node.angle=0,this.water.skewAngle=0,this.thumbAnimation&&(this.thumbAnimation.active=!1),this.cupType!=p.Bomb&&this.cupType!=p.BombMasked&&this.cupType!=p.BombFrozen||cc.director.getScene().name==g.SceneNames.Challenge&&(this.bombTime=120,this.ifDefused=!1)},t.prototype.setPourAnchor=function(e){var t=cc.v2(20,0);t.x=e?this.node.width-t.x:t.x,t.y=this.node.height-t.y,t.x=t.x/this.node.width,t.y=t.y/this.node.height,this.setAnchor(t)},t.prototype.setNormalAnchor=function(){this.setAnchor(cc.v2(.5,.5))},t.prototype.setAnchor=function(e){var t=this.node.getAnchorPoint(),o=this.node.getPosition(),n=this.water.node.getPosition(),i=this.node.children[0].getPosition();this.node.setAnchorPoint(e);var r,a,c,s=cc.v2(e.x-t.x,e.y-t.y),l=cc.v2(s.x*this.node.width*this.node.scale,s.y*this.node.height*this.node.scale);r=l,a=function(e){for(;e>360;)e-=360;for(;e<-360;)e+=360;return e%360*Math.PI/180}(this.node.angle),(c=cc.v2()).x=r.x*Math.cos(a)-r.y*Math.sin(a),c.y=r.x*Math.sin(a)+r.y*Math.cos(a),l=c,o.x+=l.x,o.y+=l.y,this.node.setPosition(o),n.x-=s.x*this.node.width,n.y-=s.y*this.node.height,this.water.node.setPosition(n),i.x-=s.x*this.node.width,i.y-=s.y*this.node.height,this.node.children[0].setPosition(i)},t.prototype.checkIsFinshed=function(){for(var e=!0,t=this.info.colorIds,o=null,n=0,i=0;i<r.SPLIT_COUNT;i++){if(null==o&&(o=t[i]),o!=t[i]){e=!1;break}0==t[i]&&n++}return n==r.SPLIT_COUNT&&(e=!0),e},t.prototype.checkIsStrictFinshed=function(){if(this.cupType==p.Temp1)return!1;for(var e=!0,t=this.info.colorIds,o=null,n=0;n<r.SPLIT_COUNT;n++){if(null==o&&(o=t[n]),o!=t[n]){e=!1;break}if(0==t[n]){e=!1;break}}return e},t.prototype.isSingleColor=function(){for(var e=this.info.colorIds,t=null,o=0;o<r.SPLIT_COUNT;o++)if(0!=e[o]&&(null==t&&(t=e[o]),t!=e[o]))return!1;return!0},t.prototype.getWaterSurfacePosY=function(e){void 0===e&&(e=!1);var t=this.getTop(),o=(r.SPLIT_COUNT-t.emptyNum)/r.SPLIT_COUNT;o<.02?o=.02:e&&(o-=1/r.SPLIT_COUNT*this.heightFactor),o*=this.heightFactor,o-=.5;var n=cc.v2(0,this.water.node.height*o);return(n=this.water.node.convertToWorldSpaceAR(n)).y},t.prototype.initDefault=function(){this.info={cupType:p.Normal,colorIds:[0,0,0,0]}},t.prototype.setCapacity=function(){},t.prototype.initDefault_Editor=function(){this.node.addComponent("CupDraggable"),this.info={cupType:p.Normal,colorIds:[0,0,0,0]}},t.prototype.highlight=function(){this.node.scale=1.1;for(var e=this.node.parent.children,t=0;t<e.length;t++){var o=e[t];o!=this.node&&(o.scale=1)}},t.prototype.getCupType=function(){return this.cupType},t.prototype.setMask=function(e,t){null==this.maskLabel?((i=cc.instantiate(this.maskPrefab)).parent=this.node.children[1],i.setPosition(0,2),this.maskLabel=i.getComponentInChildren(cc.Label),this.cupType!=p.Temp1&&this.cupType!=p.Temp1AD&&this.cupType!=p.Absorb||(i.y=65)):this.maskLabel.node.parent.parent.active=!0;for(var o=0,n=this.maskNodes;o<n.length;o++){var i;(i=n[o]).active=!0,i.opacity=0}this.setMaskUnlockColor(e),this.setMaskUnlockCount(t)},t.prototype.setCupType=function(e){this.cupType=e,this.info.cupType=e,e!=p.Temp1&&e!=p.Temp1AD&&e!=p.Absorb&&e!=p.Temp1Frozen||(this.water.speedFactor=.25,this.heightFactor=.5,this.water.heightFactor=.5)},t.prototype.getFrozenUnlockCount=function(){return this.frozenCount},t.prototype.setFrozenUnlockCount=function(e){this.frozenCount=e,this.frozenLabel.string=e+"",this.info.frozenUnlockCount=e},t.prototype.getMaskUnlockColorId=function(){return this.maskColorId},t.prototype.setMaskUnlockColor=function(e){this.maskColorId=e,this.maskLabel.node.parent.color=(new cc.Color).fromHEX(r.WaterColors[e]||"#538849"),this.info.maskUnlockColorId=e},t.prototype.getMaskUnlockCount=function(){return this.maskColorCount},t.prototype.setColorIds=function(e){this.info.colorIds=e,this.initWater()},t.prototype.setMaskUnlockCount=function(e){this.maskColorCount=e,this.maskLabel.string=e+"",this.info.maskUnlockCount=e},t.prototype.getColorIds=function(){for(var e=[],t=0;t<r.SPLIT_COUNT;t++)e.push(this.info.colorIds[t]);return e},l([I(d.default)],t.prototype,"water",void 0),l([I({type:cc.Enum(u),tooltip:"\u676f\u5b50\u72b6\u6001: 0:Idle 1:\u79fb\u52a8\u4e2d 2:\u9009\u4e2d 3:\u5012\u51fa\u4e2d 4:\u5012\u5165\u4e2d 5:\u5b8c\u6210 6:\u6574\u7406\u4e2d"})],t.prototype,"currentState",void 0),l([I({type:cc.Enum(p),tooltip:"\u676f\u5b50\u7c7b\u578b: 0:\u6b63\u5e38 1:\u5e7f\u544a\u89e3\u9501 2:\u56fa\u5b9a 3:\u51bb\u7ed3 4:\u906e\u7f69"})],t.prototype,"cupType",void 0),l([I({type:cc.Integer,tooltip:"\u906e\u7f69\u676f\u5b50\u89e3\u9501\u9700\u6c42\u989c\u8272id,0\u4e3a\u4efb\u610f\u989c\u8272"})],t.prototype,"maskColorId",void 0),l([I({type:cc.Integer,tooltip:"\u906e\u7f69\u676f\u5b50\u89e3\u9501\u9700\u6c42\u6570\u91cf"})],t.prototype,"maskColorCount",void 0),l([I({type:cc.Integer,tooltip:"\u51bb\u7ed3\u676f\u5b50\u89e3\u9501\u9700\u6c42\u6570\u91cf"})],t.prototype,"frozenCount",void 0),l([I(sp.Skeleton)],t.prototype,"surface",void 0),l([I(sp.Skeleton)],t.prototype,"surfaceHighlight",void 0),l([I(cc.Prefab)],t.prototype,"showHiddenMarkPrefab",void 0),l([I(cc.Node)],t.prototype,"capNode",void 0),l([I(cc.Node)],t.prototype,"hiddenMark",void 0),l([I(cc.Node)],t.prototype,"highlightNode",void 0),l([I(sp.Skeleton)],t.prototype,"pourInSurface",void 0),l([I(sp.Skeleton)],t.prototype,"pourInSurfaceHightlight",void 0),l([I(sp.Skeleton)],t.prototype,"pourInSplash",void 0),l([I(sp.Skeleton)],t.prototype,"pourInSplashHighlight",void 0),l([I(sp.Skeleton)],t.prototype,"pourInRipple",void 0),l([I(cc.Node)],t.prototype,"thumbAnimation",void 0),l([I([cc.Node])],t.prototype,"maskNodes",void 0),l([I(cc.Prefab)],t.prototype,"maskPrefab",void 0),l([I(cc.Label)],t.prototype,"maskLabel",void 0),l([I(cc.Label)],t.prototype,"frozenLabel",void 0),l([I(cc.Node)],t.prototype,"adNode",void 0),l([I([cc.SpriteFrame])],t.prototype,"adFrames",void 0),l([I(cc.Prefab)],t.prototype,"keyPrefab",void 0),l([I(cc.Node)],t.prototype,"keyNode",void 0),l([w],t)}(cc.Component);r.default=T,cc._RF.pop(),cc._RF.pop()},{}],DailyRewardPanel:[function(e,t,o){"use strict";cc._RF.push(t,"f3d5eVsGR9CaIjgJqLle6V7","DailyRewardPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"f3d5eVsGR9CaIjgJqLle6V7","DailyRewardPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("GameManager"),p=n("StaminaManager"),d=n("BasePanel"),f=cc._decorator,h=f.ccclass,y=(f.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.onBtn_Quit=function(){this.hide()},t.prototype.onBtn_Reward=function(){var e=this;u.default.platform.reportButtonEvent("GamePage_addEnergy_share",0),u.default.platform.showShare(function(){p.default.instance.enableInfinite(),e.hide()})},l([h],t)}(d.default));r.default=y,cc._RF.pop(),cc._RF.pop()},{}],DataManager_ED:[function(e,t,o){"use strict";cc._RF.push(t,"6a55ebDCHJCWamMEpn8ztwH","DataManager_ED");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"6a55ebDCHJCWamMEpn8ztwH","DataManager_ED");var a=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(i,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,l=(c.property,function(){function e(){}return Object.defineProperty(e,"bestScore",{get:function(){var e=cc.sys.localStorage.getItem("bestScore_ED");return e?parseInt(e):0},set:function(e){cc.sys.localStorage.setItem("bestScore_ED",e.toString())},enumerable:!1,configurable:!0}),a([s],e)}());i.default=l,cc._RF.pop(),cc._RF.pop()},{}],DataManager_SS:[function(e,t,o){"use strict";cc._RF.push(t,"a2a444J33ZFCam+V1xFGIQY","DataManager_SS");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"a2a444J33ZFCam+V1xFGIQY","DataManager_SS");var a=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(i,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,l=(c.property,cc.Enum({num:1,str:2,bool:3,obj:4})),u=function(){function e(){}return Object.defineProperty(e,"riseSpeed",{get:function(){return this.ifSlow?750:this.ifTwiceSpeed?3900:1600},enumerable:!1,configurable:!0}),Object.defineProperty(e,"moveSpeed",{get:function(){return this.ifSlow?750:this.ifTwiceSpeed?3900:1600},enumerable:!1,configurable:!0}),Object.defineProperty(e,"fallSpeed",{get:function(){return this.ifSlow?750:this.ifTwiceSpeed?3200:1e3},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ifPassedGuide",{get:function(){return this._ifPassedGuide},set:function(e){this._ifPassedGuide=e,cc.sys.localStorage.setItem("ifPassedGuide_SS",e?"true":"false")},enumerable:!1,configurable:!0}),Object.defineProperty(e,"curLevel",{get:function(){return this.level},set:function(e){this.level=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"level",{get:function(){return this._level=parseInt(cc.sys.localStorage.getItem("level_SS"))||1,isNaN(this._level)&&(this._level=1),this._level},set:function(e){e=Math.max(1,e),this._level=e,cc.sys.localStorage.setItem("level_SS",e.toString())},enumerable:!1,configurable:!0}),Object.defineProperty(e,"levelConfigured",{get:function(){return this._levelConfigured},set:function(e){e=Math.max(1,e),this._levelConfigured=e,cc.sys.localStorage.setItem("levelConfigured_SS",e.toString())},enumerable:!1,configurable:!0}),Object.defineProperty(e,"musicOn",{get:function(){return this._musicOn},set:function(e){this._musicOn=e,cc.sys.localStorage.setItem("musicOn_SS",e?"true":"false")},enumerable:!1,configurable:!0}),Object.defineProperty(e,"soundOn",{get:function(){return this._soundOn},set:function(e){this._soundOn=e,cc.sys.localStorage.setItem("soundOn_SS",e?"true":"false")},enumerable:!1,configurable:!0}),Object.defineProperty(e,"vibrateOn",{get:function(){return this._vibrateOn},set:function(e){this._vibrateOn=e,cc.sys.localStorage.setItem("vibrateOn_SS",e?"true":"false")},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ifTwiceSpeed",{get:function(){return this._ifTwiceSpeed},set:function(e){this._ifTwiceSpeed=e,cc.sys.localStorage.setItem("ifTwiceSpeed_SS",e?"true":"false")},enumerable:!1,configurable:!0}),Object.defineProperty(e,"collectAmount",{get:function(){return this._collectAmount},set:function(e){this._collectAmount=e,cc.sys.localStorage.setItem("collectAmount_SS",e.toString())},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ifSideReward",{get:function(){if(this._gotSideRewardTimes<this.sideRewardMax){var e=new Date,t={y:e.getFullYear(),m:e.getMonth(),d:e.getDate()};return!this.gotSideRewardTimeStamp||this.gotSideRewardTimeStamp.y!==t.y||this.gotSideRewardTimeStamp.m!==t.m||this.gotSideRewardTimeStamp.d!==t.d}return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e,"gotSideRewardTimes",{get:function(){return this._gotSideRewardTimes},set:function(e){this._gotSideRewardTimes=e,cc.sys.localStorage.setItem("gotSideRewardTimes_SS",e.toString())},enumerable:!1,configurable:!0}),Object.defineProperty(e,"gotSideRewardTimeStamp",{get:function(){var e=cc.sys.localStorage.getItem("gotSRTimeStamp_SS");return e?JSON.parse(e):null},set:function(e){cc.sys.localStorage.setItem("gotSRTimeStamp_SS",JSON.stringify(e))},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ifInviteReward",{get:function(){if(this._gotInviteRewardTimes<this.inviteRewardMax){var e=new Date,t={y:e.getFullYear(),m:e.getMonth(),d:e.getDate()};return!this.gotInviteRewardTimeStamp||this.gotInviteRewardTimeStamp.y!==t.y||this.gotInviteRewardTimeStamp.m!==t.m||this.gotInviteRewardTimeStamp.d!==t.d}return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e,"gotInviteRewardTimes",{get:function(){return this._gotInviteRewardTimes},set:function(e){this._gotInviteRewardTimes=e,cc.sys.localStorage.setItem("gotInviteRewardTimes_SS",e.toString())},enumerable:!1,configurable:!0}),Object.defineProperty(e,"gotInviteRewardTimeStamp",{get:function(){var e=cc.sys.localStorage.getItem("gotIRTimeStamp_SS");return e?JSON.parse(e):null},set:function(e){cc.sys.localStorage.setItem("gotIRTimeStamp_SS",JSON.stringify(e))},enumerable:!1,configurable:!0}),Object.defineProperty(e,"withdrawTimes",{get:function(){return this._withdrawTimes},set:function(e){this._withdrawTimes=e,cc.sys.localStorage.setItem("withdrawTimes_SS",e.toString())},enumerable:!1,configurable:!0}),Object.defineProperty(e,"addListTimes",{get:function(){return this._addListTimes},set:function(e){this._addListTimes=e,cc.sys.localStorage.setItem("addListTimes_SS",e.toString())},enumerable:!1,configurable:!0}),Object.defineProperty(e,"putTopTimes",{get:function(){return this._putTopTimes},set:function(e){this._putTopTimes=e,cc.sys.localStorage.setItem("putTopTimes_SS",e.toString())},enumerable:!1,configurable:!0}),e.loadLocalData=function(){this._ifPassedGuide=this.getLocalItem("ifPassedGuide_SS",l.bool,!1),this._level=this.getLocalItem("level_SS",l.num,1),this._levelConfigured=this.getLocalItem("levelConfigured_SS",l.num,1),this._musicOn=this.getLocalItem("musicOn_SS",l.bool,!0),this._soundOn=this.getLocalItem("soundOn_SS",l.bool,!0),this._vibrateOn=this.getLocalItem("vibrateOn_SS",l.bool,!0),this._ifTwiceSpeed=this.getLocalItem("ifTwiceSpeed_SS",l.bool,!1),this.localCollectDataInit(),this._gotSideRewardTimes=this.getLocalItem("gotSideRewardTimes_SS",l.num,0),this._gotInviteRewardTimes=this.getLocalItem("gotInviteRewardTimes_SS",l.num,0),this._withdrawTimes=this.getLocalItem("withdrawTimes_SS",l.num,0),this._addListTimes=this.getLocalItem("addListTimes_SS",l.num,0),this._putTopTimes=this.getLocalItem("putTopTimes_SS",l.num,0)},e.getLocalItem=function(e,t,o){var n=cc.sys.localStorage.getItem(e);switch(t){case 1:return n?parseInt(n):o;case 2:return n||o;case 3:return"true"===n||"false"!==n&&o;case 4:return n?JSON.parse(n):o}},e.localCollectDataInit=function(){var e=cc.sys.localStorage.getItem("level_SS"),t=cc.sys.localStorage.getItem("ifDataInherited_SS");e&&"true"!==t?(this.collectAmount=Math.min(parseInt(e)-1,this.collectAmountMax),cc.sys.localStorage.setItem("ifDataInherited_SS","true")):this._collectAmount=this.getLocalItem("collectAmount_SS",l.num,0)},e.ifSlow=!1,e.ifOpenGap=!1,e._ifPassedGuide=!1,e._level=1,e.levelConfiguredMax=224,e._levelConfigured=1,e._musicOn=!0,e._soundOn=!0,e._vibrateOn=!0,e._ifTwiceSpeed=!1,e.collectAmountMax=100,e._collectAmount=0,e.sideRewardMax=3,e._gotSideRewardTimes=0,e.inviteRewardMax=3,e._gotInviteRewardTimes=0,e._withdrawTimes=0,e._addListTimes=0,e._putTopTimes=0,a([s],e)}();i.default=u,cc._RF.pop(),cc._RF.pop()},{}],DataManager:[function(e,t,o){"use strict";cc._RF.push(t,"48049QDwdNEYI0M0AuTHiGb","DataManager");var n=e,i=t,r=o;cc._RF.push(i,"48049QDwdNEYI0M0AuTHiGb","DataManager");var a=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},c=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0});var s=n("CollectionManager"),l=n("CommonData"),u=n("SignInManager"),p=n("FinishEffectDataManager"),d=n("GoldDataManager"),f=n("UnlockData"),h=n("config"),y=n("ThemeDataManager"),m="https://api.flysheeep.com/api/pour_water/get_user_info",g="https://api.flysheeep.com/api/pour_water/set_rank",v=function(){function e(){}return e.init=function(){},e.getLocalUserData=function(){for(var e="",t=1;t<=s.default.capCollectionList.length;t++)s.default.CapUnlockMap[t]?e+="1":e+="0";var o="";for(t=1;t<=s.default.characterCollectionList.length;t++)s.default.CharacterUnlockMap[t]?o+="1":o+="0";var n={};n.ThemeUnlockMap=y.default.ThemeUnlockMap,n.FinishEffectUnlockMap=p.default.FinishEffectUnlockMap,n.EventMap=u.default.instance.DayStateMap,n.PropUndo=l.default.PropUndo,n.PropPump=l.default.PropPump,n.PropDye=l.default.PropDye,n.PropAddCup=l.default.PropAddCup,n.OrderNum=l.default.OrderNum;var i=JSON.stringify(n);return console.error("get local userdata:",l.default.Level),{level:l.default.Level,levelChanllenge:l.default.LevelChallenge,drinkIndex:l.default.CurrentUnlockIndex,winStreak:l.default.WinStreak,capMap:e,characterMap:o,userData:i}},e.tryUpdateUserData=function(t,o){if(void 0===t&&(t=!1),void 0===o&&(o=function(){}),!cc.sys.isBrowser){var n;if(h.currentPlatform===h.platformEnum.wechat)n=wx;else{if(h.currentPlatform!==h.platformEnum.toutiao)return;n=tt}var i=e.getLocalUserData(),r={level:1,levelChanllenge:1,drinkIndex:1,winStreak:0,capMap:"",characterMap:"",userData:""},a={level:1,levelChanllenge:1,drinkIndex:1,winStreak:0,capMap:"",characterMap:"",userData:""};new Promise(function(t,o){n.request({url:m,method:"POST",header:{"content-type":"application/json","x-appid":l.default.appId},data:{open_id:l.default.openId,app_id:l.default.appId},success:function(o){if(o.data.data){var n=e.decodeProgress(o.data.data.progress);r.level=n.level,r.levelChanllenge=n.levelChanllenge,r.drinkIndex=n.drinkIndex,r.winStreak=n.winStreak,r.capMap=o.data.data.cap,r.characterMap=o.data.data.rider,r.userData=o.data.data.user_data,t()}},fail:function(e){o(e)}})}).then(function(){if(r.drinkIndex!==i.drinkIndex||r.level!==i.level||r.levelChanllenge!==i.levelChanllenge||r.winStreak!==i.winStreak||r.capMap!==i.capMap||r.characterMap!==i.characterMap||r.userData!==i.userData||(t&&f.default.initUnlockArray(),t)){var n=!0;a.level=Math.max(i.level,r.level),i.level==r.level&&(n=!1),a.levelChanllenge=Math.max(i.levelChanllenge,r.levelChanllenge),a.drinkIndex=Math.max(i.drinkIndex,r.drinkIndex),a.winStreak=t?Math.max(i.winStreak,r.winStreak):i.winStreak;for(var c=0;c<i.capMap.length;c++)"1"===i.capMap.charAt(c)||"1"===r.capMap.charAt(c)?a.capMap+="1":a.capMap+="0";var s={};null!=r.userData&&""!=r.userData?s=JSON.parse(r.userData):(s.ThemeUnlockMap={},s.FinishEffectUnlockMap={},s.EventMap={},s.PropUndo=0,s.PropPump=0,s.PropDye=0,s.PropAddCup=0,s.OrderNum=0);for(var l=JSON.parse(i.userData),p={ThemeUnlockMap:{},FinishEffectUnlockMap:{},EventMap:{}},d=0,h=["PropUndo","PropPump","PropDye","PropAddCup"];d<h.length;d++){var y=h[d];t?0==l[y]&&(p[y]=s[y]||0):p[y]=l[y]}for(var y in p.OrderNum=Math.max(l.OrderNum||0,s.OrderNum||0),l.ThemeUnlockMap)!0===l.ThemeUnlockMap[y]||!0===s.ThemeUnlockMap[y]?p.ThemeUnlockMap[y]=!0:p.ThemeUnlockMap[y]=!1;for(var y in l.FinishEffectUnlockMap)!0===l.FinishEffectUnlockMap[y]||!0===s.FinishEffectUnlockMap[y]?p.FinishEffectUnlockMap[y]=!0:p.FinishEffectUnlockMap[y]=!1;for(null==s.EventMap&&(s.EventMap={}),p.EventMap=u.default.instance.getFinalEventMap(s.EventMap,l.EventMap),a.userData=JSON.stringify(p),c=0;c<i.characterMap.length;c++)"1"===i.characterMap.charAt(c)||"1"===r.characterMap.charAt(c)?a.characterMap+="1":a.characterMap+="0";e.setLocalUserData(a,t),e.uploadUserData(a,n,o)}})}},e.setLocalUserData=function(e,t){void 0===t&&(t=!1),l.default.Level=e.level,l.default.LevelChallenge=e.levelChanllenge,l.default.CurrentUnlockIndex=e.drinkIndex,l.default.WinStreak=e.winStreak;for(var o=1;o<=s.default.capCollectionList.length;o++)s.default.setCapUnlockMap(o,"1"===e.capMap.charAt(o-1));for(o=1;o<=s.default.characterCollectionList.length;o++)s.default.setCharacterUnlockMap(o,"1"===e.characterMap.charAt(o-1));var n=JSON.parse(e.userData);for(var i in n.ThemeUnlockMap)y.default.setThemeUnlockMap(i,n.ThemeUnlockMap[i]);for(var i in n.FinishEffectUnlockMap)p.default.setFinishEffectUnlockMap(parseInt(i),n.FinishEffectUnlockMap[i]);u.default.instance.DayStateMap=n.EventMap,void 0!==n.PropUndo&&(l.default.PropUndo=n.PropUndo),void 0!==n.PropPump&&(l.default.PropPump=n.PropPump),void 0!==n.PropDye&&(l.default.PropDye=n.PropDye),void 0!==n.PropAddCup&&(l.default.PropAddCup=n.PropAddCup),void 0!==n.OrderNum&&(l.default.OrderNum=n.OrderNum),s.default.syncProgress(),t&&f.default.initUnlockArray()},e.uploadUserData=function(t,o,n){if(void 0===o&&(o=!0),void 0===n&&(n=function(){}),!cc.sys.isBrowser){var i;if(h.currentPlatform===h.platformEnum.wechat)i=wx;else{if(h.currentPlatform!==h.platformEnum.toutiao)return;i=tt}var r=e.encodeProgress(t),a=l.default.Level;1==l.default.ifSkipAd&&(a=1),i.request({url:"https://api.flysheeep.com/api/pour_water/update_user_info",method:"POST",header:{"content-type":"application/json","x-appid":l.default.appId},data:{open_id:l.default.openId,app_id:l.default.appId,head_url:l.default.avatarUrl,nick_name:l.default.nickName,progress:r,cap:t.capMap,rider:t.characterMap,user_data:t.userData},success:function(){console.error("\u4e0a\u4f20\u7528\u6237\u6570\u636e\u6210\u529f"),n&&n()},fail:function(){console.error("\u4e0a\u4f20\u7528\u6237\u6570\u636e\u5931\u8d25")}}),o&&i.request({url:g,method:"POST",header:{"content-type":"application/json","x-appid":l.default.appId},data:{open_id:l.default.openId,app_id:l.default.appId,rank_level:a,game_mode:1},success:function(){console.error("\u4e0a\u4f20\u6392\u884c\u699c\u6570\u636e\u6210\u529f")},fail:function(){console.error("\u4e0a\u4f20\u6392\u884c\u699c\u6570\u636e\u5931\u8d25")}})}},e.tryUpdateGoldCoin=function(t){if(void 0===t&&(t=!1),!cc.sys.isBrowser){var o;if(h.currentPlatform===h.platformEnum.wechat)o=wx;else{if(h.currentPlatform!==h.platformEnum.toutiao)return;o=tt}var n=d.default.Gold,i=0,r=new Promise(function(e,t){o.request({url:m,method:"POST",header:{"content-type":"application/json","x-appid":l.default.appId},data:{open_id:l.default.openId,app_id:l.default.appId},success:function(t){t.data.data&&(i=t.data.data.coin,e())},fail:function(e){t(e)}})});t&&r.then(function(){(0==n||null==n||null==n)&&i>=0?d.default.Gold=i:e.uploadGoldCoin(n)})}},e.uploadGoldCoin=function(e,t,o){if(void 0===t&&(t=null),void 0===o&&(o=null),!cc.sys.isBrowser){var n;if(h.currentPlatform===h.platformEnum.wechat)n=wx;else{if(h.currentPlatform!==h.platformEnum.toutiao)return;n=tt}n.request({url:"https://api.flysheeep.com/api/pour_water/update_data_int",method:"POST",header:{"content-type":"application/json","x-appid":l.default.appId},data:{open_id:l.default.openId,app_id:l.default.appId,coin:e},success:function(){t&&t()},fail:function(){o&&o()}})}},e.updateChallengeRecord=function(e){if(!cc.sys.isBrowser){var t;if(h.currentPlatform===h.platformEnum.wechat)t=wx;else{if(h.currentPlatform!==h.platformEnum.toutiao)return;t=tt}t.request({url:g,method:"POST",header:{"content-type":"application/json","x-appid":l.default.appId},data:{open_id:l.default.openId,app_id:l.default.appId,rank_level:e,game_mode:2},success:function(){console.error("\u4e0a\u4f20\u6311\u6218\u6392\u884c\u699c\u6570\u636e\u6210\u529f")},fail:function(){console.error("\u4e0a\u4f20\u6311\u6218\u6392\u884c\u699c\u6570\u636e\u5931\u8d25")}})}},e.getUserEventData=function(){return a(this,void 0,void 0,function(){var e,t,o;return c(this,function(n){switch(n.label){case 0:if(cc.sys.isBrowser)return[2];if(h.currentPlatform===h.platformEnum.wechat)e=wx;else{if(h.currentPlatform!==h.platformEnum.toutiao)return[2];e=tt}return t={level:1,levelChanllenge:1,drinkIndex:1,winStreak:0,capMap:"",characterMap:"",userData:""},[4,new Promise(function(o,n){e.request({url:m,method:"POST",header:{"content-type":"application/json","x-appid":l.default.appId},data:{open_id:l.default.openId,app_id:l.default.appId},success:function(e){e.data.data&&(t.userData=e.data.data.user_data,o())},fail:function(e){n(e)}})})];case 1:return n.sent(),o={},null!=t.userData&&""!=t.userData?o=JSON.parse(t.userData):o.EventMap={},[2,o.EventMap]}})})},e.clearUserData=function(){var t={level:-1,levelChanllenge:1,drinkIndex:1,winStreak:0,capMap:"",characterMap:"",userData:""};t.userData=JSON.stringify({ThemeUnlockMap:{},FinishEffectUnlockMap:{},EventMap:{},PropUndo:0,PropPump:0,PropDye:0,PropAddCup:0,OrderNum:0});for(var o=0;o<s.default.capCollectionList.length;o++)t.capMap+="0";for(o=0;o<s.default.characterCollectionList.length;o++)t.characterMap+="0";e.uploadUserData(t)},e.decodeProgress=function(e){if(null==e||""==e)return{level:1,levelChanllenge:1,drinkIndex:1,winStreak:0};var t=e.split(",");return{level:Number(t[0]),levelChanllenge:Number(t[1]),drinkIndex:Number(t[2]),winStreak:Number(t[3])}},e.encodeProgress=function(e){return e.level+","+e.levelChanllenge+","+e.drinkIndex+","+e.winStreak},e.userData=null,e}();r.default=v,cc._RF.pop(),cc._RF.pop()},{}],DataMultipleMode:[function(e,t,o){"use strict";cc._RF.push(t,"6e5a69dEzlKx72na4/JlJn8","DataMultipleMode");var n=t,i=o;cc._RF.push(n,"6e5a69dEzlKx72na4/JlJn8","DataMultipleMode"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(){},cc._RF.pop(),cc._RF.pop()},{}],DataNexusEnum:[function(e,t,o){"use strict";cc._RF.push(t,"b56cfKjWX9Fb6tERL3xa2wb","DataNexusEnum");var n=t,i=o;cc._RF.push(n,"b56cfKjWX9Fb6tERL3xa2wb","DataNexusEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.WishListType=i.ShareTarget=i.ActionType=i.RewardADEvent=i.ItemType=void 0,function(e){e[e.DIAMOND=1]="DIAMOND",e[e.HAMMER=2]="HAMMER",e[e.MAGNET=3]="MAGNET",e[e.BOMB=4]="BOMB",e[e.BOTTLE=5]="BOTTLE",e[e.SUCTION_CUP=6]="SUCTION_CUP",e[e.HAIR_REMOVER=7]="HAIR_REMOVER",e[e.FLAMETHROWER=8]="FLAMETHROWER",e[e.NAIL=9]="NAIL",e[e.WOOL=10]="WOOL",e[e.UNIVERSAL=11]="UNIVERSAL",e[e.DISORDER=12]="DISORDER",e[e.MOVE_OUT=13]="MOVE_OUT",e[e.COMPLETE=14]="COMPLETE",e[e.UNDO=15]="UNDO",e[e.SWAP=16]="SWAP",e[e.MOVE=17]="MOVE",e[e.SUCTION=18]="SUCTION",e[e.REMOVE=19]="REMOVE",e[e.SHUFFLE=20]="SHUFFLE",e[e.FLIP=21]="FLIP",e[e.RESET=22]="RESET",e[e.DISORDER2=23]="DISORDER2",e[e.TURNOVER_CARD=24]="TURNOVER_CARD",e[e.REFRESH=25]="REFRESH",e[e.PROBE=26]="PROBE",e[e.SKIP=27]="SKIP",e[e.ADD_CONTAINER=28]="ADD_CONTAINER",e[e.ADD_HOLE=29]="ADD_HOLE",e[e.ADD_PARKING_SPACE=30]="ADD_PARKING_SPACE",e[e.FREEZE_TIME=31]="FREEZE_TIME",e[e.AUTO_CLICK=32]="AUTO_CLICK",e[e.ELIMATE_SPECIFIED=33]="ELIMATE_SPECIFIED",e[e.ELIMATE_ALL=34]="ELIMATE_ALL",e[e.ELIMATE_RANDOM=35]="ELIMATE_RANDOM",e[e.SORT=36]="SORT",e[e.REMOVE_MASK=37]="REMOVE_MASK",e[e.TRANSPARENT=38]="TRANSPARENT",e[e.SHORTEN=39]="SHORTEN",e[e.CRAFT=40]="CRAFT",e[e.FULL_SCREEN_ATTACK=41]="FULL_SCREEN_ATTACK",e[e.CUT_ROPE=42]="CUT_ROPE",e[e.INVINCIBLE=43]="INVINCIBLE",e[e.UNIVERSAL_BOX=44]="UNIVERSAL_BOX",e[e.UNIVERSAL_SCREW=45]="UNIVERSAL_SCREW",e[e.OTHER=46]="OTHER"}(i.ItemType||(i.ItemType={})),function(e){e[e.REVIVE=1]="REVIVE",e[e.STAMINA=2]="STAMINA",e[e.LEVEL=3]="LEVEL",e[e.GOLD=4]="GOLD",e[e.ADD_TIME=5]="ADD_TIME",e[e.DIAMOND=6]="DIAMOND",e[e.MAKE_UP_SIGN=7]="MAKE_UP_SIGN",e[e.TREASURE_CHEST=8]="TREASURE_CHEST",e[e.SPEED_UP_ACTION=9]="SPEED_UP_ACTION",e[e.MULTI_RECEIVE=10]="MULTI_RECEIVE",e[e.NO_AD_CARD=11]="NO_AD_CARD",e[e.OFFLINE_INCOME=12]="OFFLINE_INCOME",e[e.GET_GIFT_PACK=13]="GET_GIFT_PACK",e[e.TURN_TABLE_LOTTERY=14]="TURN_TABLE_LOTTERY",e[e.PET=15]="PET",e[e.REPLAY=16]="REPLAY",e[e.UNDO=17]="UNDO",e[e.SWAP=18]="SWAP",e[e.MOVE=19]="MOVE",e[e.SUCTION=20]="SUCTION",e[e.BOMB=21]="BOMB",e[e.CHANGE=22]="CHANGE",e[e.TITLE=23]="TITLE",e[e.MORE_GAMEPLAY=24]="MORE_GAMEPLAY",e[e.REFRESH=25]="REFRESH",e[e.GENERATE_EMPTY_BOTTLE=26]="GENERATE_EMPTY_BOTTLE",e[e.TIP=27]="TIP",e[e.GET_ANSWER=28]="GET_ANSWER",e[e.REMOVE=29]="REMOVE",e[e.SHUFFLE=30]="SHUFFLE",e[e.FLIP=31]="FLIP",e[e.RESET=32]="RESET",e[e.UPGRADE_INCOME=33]="UPGRADE_INCOME",e[e.PROBE=34]="PROBE",e[e.SKIP=35]="SKIP",e[e.DAILY_LIMITED_PURCHASE=36]="DAILY_LIMITED_PURCHASE",e[e.ADD_CONTAINER=37]="ADD_CONTAINER",e[e.ADD_HOLE=38]="ADD_HOLE",e[e.ADD_PARKING_SPACE=39]="ADD_PARKING_SPACE",e[e.FREEZE_TIME=40]="FREEZE_TIME",e[e.AUTO_CLICK=41]="AUTO_CLICK",e[e.THEME=42]="THEME",e[e.ELIMINATE_SPECIFIED=43]="ELIMINATE_SPECIFIED",e[e.ELIMINATE_ALL=44]="ELIMINATE_ALL",e[e.ELIMINATE_RANDOM=45]="ELIMINATE_RANDOM",e[e.SORT=46]="SORT",e[e.REMOVE_MASK=47]="REMOVE_MASK",e[e.TRANSPARENT=48]="TRANSPARENT",e[e.SHORTEN=49]="SHORTEN",e[e.CRAFT=50]="CRAFT",e[e.FULL_SCREEN_ATTACK=51]="FULL_SCREEN_ATTACK",e[e.CUT_ROPE=52]="CUT_ROPE",e[e.INVINCIBLE=53]="INVINCIBLE",e[e.UNIVERSAL_BOX=54]="UNIVERSAL_BOX",e[e.UNIVERSAL_SCREW=55]="UNIVERSAL_SCREW",e[e.UNLOCK_PLOT=56]="UNLOCK_PLOT",e[e.UNLOCK_CHAPTER=57]="UNLOCK_CHAPTER",e[e.UNLOCK_LEVEL=58]="UNLOCK_LEVEL",e[e.UNLOCK_MUSIC=59]="UNLOCK_MUSIC",e[e.UNLOCK_ACTION=60]="UNLOCK_ACTION",e[e.UNLOCK_TURRET=61]="UNLOCK_TURRET",e[e.UNLOCK_CHARACTER=62]="UNLOCK_CHARACTER",e[e.UNLOCK_EMPTY_SLOT=63]="UNLOCK_EMPTY_SLOT",e[e.UNLOCK_MAP=64]="UNLOCK_MAP",e[e.UNLOCK_BOX=65]="UNLOCK_BOX",e[e.UNLOCK_DECORATION_BLUEPRINT=66]="UNLOCK_DECORATION_BLUEPRINT",e[e.UNLOCK_SKIN=67]="UNLOCK_SKIN",e[e.OTHER=68]="OTHER"}(i.RewardADEvent||(i.RewardADEvent={})),function(e){e.RE_ACTIVE="RE_ACTIVE",e.LOAD_FINISH="LOAD_FINISH",e.SHARE="SHARE",e.ADD_TO_WISHLIST="ADD_TO_WISHLIST",e.SUBSCRIBE="SUBSCRIBE",e.TUTORIAL_START="TUTORIAL_START",e.LEVEL_ENTER="LEVEL_ENTER",e.LEVEL_EXIT="LEVEL_EXIT",e.LEVEL_LOSE="LEVEL_LOSE",e.LEVEL_PASS="LEVEL_PASS",e.HOMEPAGE_VIEW="HOMEPAGE_VIEW",e.SIGN_CLICK="SIGN_CLICK",e.GIFT_GET="GIFT_GET",e.RANKLIST_ENTER="RANKLIST_ENTER",e.GAMECLUB_ENTER="GAMECLUB_ENTER",e.LOTTERY_CLICK="LOTTERY_CLICK",e.MALL_CLICK="MALL_CLICK",e.BUY_PROP="BUY_PROP",e.ENTER_CHALLENGE_MODE="ENTER_CHALLENGE_MODE",e.THEME_CLICK="THEME_CLICK",e.GET_ITEM="GET_ITEM",e.USE_ITEM="USE_ITEM",e.AD_PLACEMENT_SHOW="AD_PLACEMENT_SHOW",e.AD_CLICK="AD_CLICK",e.AD_VIDEO_FINISH="AD_VIDEO_FINISH",e.AD_IMPRESSION="AD_IMPRESSION"}(i.ActionType||(i.ActionType={})),function(e){e.APP_MESSAGE="APP_MESSAGE",e.TIME_LINE="TIME_LINE"}(i.ShareTarget||(i.ShareTarget={})),function(e){e.DEFAULT="default",e.MY="my",e.DESKTOP="desktop",e.OTHER="others"}(i.WishListType||(i.WishListType={})),cc._RF.pop(),cc._RF.pop()},{}],DataNexusSDK:[function(e,t,o){"use strict";cc._RF.push(t,"30c0b88qutM46Qi/02EaIsR","DataNexusSDK");var n=e,i=t,r=o;cc._RF.push(i,"30c0b88qutM46Qi/02EaIsR","DataNexusSDK"),Object.defineProperty(r,"__esModule",{value:!0});var a=n("DataNexusEnum"),c=n("index"),s=n("config"),l=function(){function e(){this.sdk=null}return Object.defineProperty(e,"instance",{get:function(){return s.currentPlatform!==s.platformEnum.wechat?new Proxy({},{get:function(){return function(){}}}):(this._instance||(this._instance=new e),this._instance)},enumerable:!1,configurable:!0}),e.prototype.init=function(){try{this.sdk=new c.SDK({user_action_set_id:1219261209,secret_key:"2ac2dd171ff16b594bf0bef5947ee1ef",appid:"wxeb3a3f764474c346"}),console.log("DnSDK new success")}catch(e){console.error("DnSDK new error:",e)}this.sdk&&this.sdk.onAppStart()},e.prototype.setOpenId=function(e){if(this.sdk){var t=this.sdk.setOpenId(e);console.log("DnSDK setOpenId: code=",t.code,"msg=",t.message)}},e.prototype.track=function(e,t){if(void 0===t&&(t={}),this.sdk){var o=this.sdk.track(e,t);console.log("DnSDK track: action_type=",e,"params=",t),console.log("DnSDK track res: code=",o.code,"msg=",o.message)}},e.prototype.trackRegister=function(){this.sdk&&this.sdk.onRegister()},e.prototype.trackReActive=function(e){this.track(a.ActionType.RE_ACTIVE,{backFlowDay:e})},e.prototype.trackLoadFinish=function(){this.track(a.ActionType.LOAD_FINISH)},e.prototype.trackShare=function(e){this.track(a.ActionType.SHARE,{target:e})},e.prototype.trackAddToWishlist=function(e){this.track(a.ActionType.ADD_TO_WISHLIST,{type:e})},e.prototype.trackSubscribe=function(){this.track(a.ActionType.SUBSCRIBE)},e.prototype.trackTutorialStart=function(){this.track(a.ActionType.TUTORIAL_START)},e.prototype.trackTutorialFinish=function(){this.sdk&&this.sdk.onTutorialFinish()},e.prototype.trackLevelEnter=function(e){var t=this._buildLevelParams(e);e.enter_level_name&&(t.enter_level_name=e.enter_level_name),this.track(a.ActionType.LEVEL_ENTER,t)},e.prototype.trackLevelExit=function(e){this._trackLevelResult(a.ActionType.LEVEL_EXIT,e)},e.prototype.trackLevelLose=function(e){this._trackLevelResult(a.ActionType.LEVEL_LOSE,e)},e.prototype.trackLevelPass=function(e){this._trackLevelResult(a.ActionType.LEVEL_PASS,e)},e.prototype.trackHomepageView=function(){this.track(a.ActionType.HOMEPAGE_VIEW)},e.prototype.trackSignClick=function(){this.track(a.ActionType.SIGN_CLICK)},e.prototype.trackGiftGet=function(){this.track(a.ActionType.GIFT_GET)},e.prototype.trackRanklistEnter=function(){this.track(a.ActionType.RANKLIST_ENTER)},e.prototype.trackGameclubEnter=function(){this.track(a.ActionType.GAMECLUB_ENTER)},e.prototype.trackLotteryClick=function(){this.track(a.ActionType.LOTTERY_CLICK)},e.prototype.trackMallClick=function(){this.track(a.ActionType.MALL_CLICK)},e.prototype.trackBuyProp=function(){this.track(a.ActionType.BUY_PROP)},e.prototype.trackEnterChallengeMode=function(){this.track(a.ActionType.ENTER_CHALLENGE_MODE)},e.prototype.trackThemeClick=function(){this.track(a.ActionType.THEME_CLICK)},e.prototype.trackGetItem=function(e){this.track(a.ActionType.GET_ITEM,{item_source:e})},e.prototype.trackUseItem=function(e){this.track(a.ActionType.USE_ITEM,{item_source:e})},e.prototype.trackAdPlacementShow=function(e){this.track(a.ActionType.AD_PLACEMENT_SHOW,{ad_placement_name:e})},e.prototype.trackAdClick=function(e){this.track(a.ActionType.AD_CLICK,{ad_placement_name:e})},e.prototype.trackAdVideoFinish=function(e){this.track(a.ActionType.AD_VIDEO_FINISH,{ad_placement_name:e})},e.prototype.trackAdImpression=function(e){this.track(a.ActionType.AD_IMPRESSION,{ad_type:e})},e.prototype._buildLevelParams=function(e){var t={level_id:e.level_id};return"number"==typeof e.enter_level_id&&(t.enter_level_id=Math.round(100*e.enter_level_id)/100),e.game_mode&&(t.game_mode=e.game_mode),void 0!==e.chapter_id&&(t.chapter_id=e.chapter_id),void 0!==e.coin_amount&&(t.coin_amount=e.coin_amount),void 0!==e.stamina_value&&(t.stamina_value=e.stamina_value),void 0!==e.level_value&&(t.level_value=e.level_value),t},e.prototype._trackLevelResult=function(e,t){var o=this._buildLevelParams(t);if(o.ad_cnt=t.ad_cnt,void 0!==t.duration&&(o.duration=t.duration),t.items)if("string"==typeof t.items[0])o.items=t.items;else{var n=[];t.items.forEach(function(e){n.push("item_type:"+e.item_type+",item_num:"+e.item_num)})}this.track(e,o)},e}();r.default=l,cc._RF.pop(),cc._RF.pop()},{}],DragModelInfo:[function(e,t,o){"use strict";cc._RF.push(t,"c358fYMbC9JC6zlDK8z8Nni","DragModelInfo");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"c358fYMbC9JC6zlDK8z8Nni","DragModelInfo");var a,c=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(i,"__esModule",{value:!0});var l=cc._decorator,u=l.ccclass,p=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.start=function(){var e=this;this.node.getChildByName("background").on(cc.Node.EventType.TOUCH_MOVE,function(t){var o=e.node.getParent().convertToNodeSpaceAR(t.getLocation());e.node.setPosition(o),e.checkInScreen()}),this.node.getChildByName("background").on(cc.Node.EventType.TOUCH_END,function(){e.curLocalX=e.node.position.x,e.curLocalY=e.node.position.y})},t.prototype.update=function(){this.checkInScreen()},t.prototype.checkInScreen=function(){var e=cc.view.getVisibleSize(),t=cc.view.getVisibleOrigin(),o=new cc.Vec2;o.x=t.x-e.width/2,o.y=t.y-e.height/2;var n=new cc.Vec2;if(n.x=t.x+e.width/2,n.y=t.y+e.height/2,o=cc.Camera.main.node.convertToWorldSpaceAR(o),n=cc.Camera.main.node.convertToWorldSpaceAR(n),o=this.node.getParent().convertToNodeSpaceAR(o),n=this.node.getParent().convertToNodeSpaceAR(n),this.node.x<n.x&&this.node.y<n.y&&this.node.x>o.x&&this.node.y>o.y);else{console.error("\u8d85\u51fa\u4e86\u5c4f\u5e55\u8303\u56f4");var i=this.node.getParent().convertToNodeSpaceAR(cc.Camera.main.node.convertToWorldSpaceAR(t));i.x+=e.width/4,i.y+=e.width/4,this.node.setPosition(i)}},t.prototype.onEnable=function(){},s([u],t)}(cc.Component));i.default=p,cc._RF.pop(),cc._RF.pop()},{}],DrinkCollectionPanel:[function(e,t,o){"use strict";cc._RF.push(t,"9d14blGDsRFZ7nnqBwoB+gI","DrinkCollectionPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"9d14blGDsRFZ7nnqBwoB+gI","DrinkCollectionPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("BasePanel"),p=n("CommonData"),d=n("AudioManager"),f=n("GameManager"),h=cc._decorator,y=h.ccclass,m=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.text_1=null,t.text_2=null,t}return s(t,e),t.prototype.show=function(e){this.init();var t=this.node;cc.director.emit("UpdateOpenPanelCount"),t&&(cc.Tween.stopAllByTarget(t),t.setPosition(0,-2170),t.scale=1,t.opacity=255,cc.tween(t).to(.4,{y:0},{easing:"sineOut"}).call(function(){e&&e()}).start())},t.prototype.onEnable=function(){f.default.platform.reportPageEvent("CollectionPage"),1==p.default.CurrentUnlockIndex?(this.text_1.active=!0,this.text_2.active=!0):(this.text_1.active=!1,this.text_2.active=!1)},t.prototype.onBtn_home=function(){d.default.instance.playSFX(d.AudioRef.ClickButton),this.hide()},t.prototype.onBtn_Continue=function(){d.default.instance.playSFX(d.AudioRef.ClickButton),"Main"===cc.director.getScene().name?cc.director.loadScene("Game"):this.hide()},t.prototype.hide=function(e){var t=this,o=this.node;o&&(cc.Tween.stopAllByTarget(o),o.scale=1,o.opacity=255,cc.tween(o).to(.4,{y:-2170},{easing:"sineIn"}).call(function(){t.node.active=!1,e&&e(),cc.director.emit("UpdateOpenPanelCount")}).start())},t.prototype.onBtn_close=function(){this.hide()},l([m(cc.Node)],t.prototype,"text_1",void 0),l([m(cc.Node)],t.prototype,"text_2",void 0),l([y],t)}(u.default);r.default=g,cc._RF.pop(),cc._RF.pop()},{}],DrinkPanel:[function(e,t,o){"use strict";cc._RF.push(t,"92f4bKCyN5JzoTFZ9Enll+K","DrinkPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"92f4bKCyN5JzoTFZ9Enll+K","DrinkPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("BasePanel"),p=n("CommonData"),d=n("config"),f=n("AudioManager"),h=n("UIManager"),y=n("CollectionManager"),m=n("GameManager"),g=n("UnlockData"),v=n("Puzzle"),_=n("ThemeDataManager"),S=n("GoldDataManager"),b=n("const"),C=cc._decorator,P=C.ccclass,k=C.property,w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.drinkImage=null,t.drinkName=null,t.puzzle=null,t.Animation_Title=null,t.Animation_Titleback=null,t.uiManager=null,t.btn_change=null,t.btn_collection=null,t.light_back=null,t.icon_goldBig=null,t.icon_goldSmall=null,t.icon_goldTiny=null,t.type=0,t.sidebarBtn=null,t}return s(t,e),t.prototype.onEnable=function(){var e=this;this.uiManager=this.node.parent.getComponent(h.default),this.btn_collection.scale=0,this.setUpImageAndName(),this.CheckSidebar(),f.default.instance.playSFX(f.AudioRef.DrinkFinish),this.Animation_Title&&(this.Animation_Title.setAnimation(0,"gxhd_start",!1),this.Animation_Title.setCompleteListener(function(){e.Animation_Title.setAnimation(0,"gxhd_idle",!0)})),this.Animation_Titleback&&(this.Animation_Titleback.setAnimation(0,"animation",!1),this.Animation_Titleback.setCompleteListener(function(){e.Animation_Titleback.setAnimation(0,"animation_loop",!0)})),this.light_back&&(this.light_back.angle=0,cc.tween(this.light_back).by(5,{angle:-360}).union().repeatForever().start())},t.prototype.onDisable=function(){p.default.CurrentLevel%5==0&&(g.default.unlockArray.shift(),g.default.saveUnlockArray())},t.prototype.show=function(){var e=this;this.init();var t=this.drinkImage.node.parent;cc.director.emit("UpdateOpenPanelCount"),t&&(cc.Tween.stopAllByTarget(t),t.scale=.5,t.opacity=0,cc.tween(t).to(.2,{scale:1.1,opacity:200},{easing:"smooth"}).to(.2,{scale:1,opacity:255},{easing:"smooth"}).call(function(){cc.director.emit("setDrinkPanelInfo"),e.showCollectionBtn()}).start())},t.prototype.showCollectionBtn=function(){this.btn_collection.active&&cc.tween(this.btn_collection).to(.5,{scale:1},{easing:"backOut"}).start()},t.prototype.setUpImageAndName=function(){var e=this,t="";t=p.default.CurrentUnlockIndex<=30?"Drink1":p.default.CurrentUnlockIndex<=60?"Drink2":"Drink3";var o=p.default.CurrentUnlockIndex;if(this.type=0,p.default.CurrentLevel%5==0){var n=g.default.CurrentUnlockItem;if(null==n)return;switch(n.type){case g.UnlockType.CAP:t="Caps",o=g.default.CurrentUnlockItem.id,this.type=1,this.btn_change.active=!0,this.btn_collection.active=!0;break;case g.UnlockType.RIDER:t="Animals",o=g.default.CurrentUnlockItem.id,this.type=2,this.btn_change.active=!0,this.btn_collection.active=!0;break;case g.UnlockType.THEME:this.type=3;var i=g.default.CurrentUnlockItem.id;_.default.setThemeUnlockMap(i,!0),this.puzzle.node.active=!0;var r=i.split("_"),a=parseInt(r[0]),c=parseInt(r[1]);return this.puzzle.setUp(a,!0,c),this.drinkName.string=_.default.ThemeNameMap[a],this.btn_change.active=!1,void(_.default.ThemeUnlockMap[a]&&(this.btn_change.active=!0,this.btn_collection.active=!0));case g.UnlockType.GOLD:return this.type=4,2==g.default.CurrentUnlockItem.id?(this.drinkImage.spriteFrame=this.icon_goldBig,this.drinkName.string="\u91d1\u5e01x300",S.default.Gold+=300):1==g.default.CurrentUnlockItem.id?(this.drinkImage.spriteFrame=this.icon_goldSmall,this.drinkName.string="\u91d1\u5e01x150",S.default.Gold+=150):3==g.default.CurrentUnlockItem.id&&(this.drinkImage.spriteFrame=this.icon_goldTiny,this.drinkImage.node.scale=2,this.drinkName.string="\u91d1\u5e01x50",S.default.Gold+=50),void(this.btn_change.active=!1)}}0===this.type&&(this.btn_change.active=!1);var s=cc.assetManager.getBundle(t);s?this.loadDrinkTexture(s,o,this.type):cc.assetManager.loadBundle(t,function(t,n){t?cc.error("\u52a0\u8f7dDrinkTexture\u8d44\u6e90\u5305\u5931\u8d25:",t):e.loadDrinkTexture(n,o,e.type)})},t.prototype.loadDrinkTexture=function(e,t,o){var n=this;e.load(""+t,cc.Texture2D,function(e,i){e?cc.error("\u52a0\u8f7d\u56fe\u7247"+t+"\u5931\u8d25:",e):(n.drinkImage.spriteFrame=new cc.SpriteFrame(i),0===o?(n.drinkImage.node.scale=.7,n.drinkName.string=p.default.collectionList[p.default.CurrentUnlockIndex-1],p.default.CurrentUnlockIndex++):1===o?(n.drinkImage.node.scale=3,n.drinkName.string=y.default.capNameMap[t],y.default.setCapUnlockMap(t,!0)):2===o&&(n.drinkName.string=y.default.characterNameMap[t],n.drinkImage.node.scale=1,y.default.setCharacterUnlockMap(t,!0)))})},t.prototype.onBtn_Close=function(){var e=this;f.default.instance.playSFX(f.AudioRef.ClickButton),this.uiManager.node.children.forEach(function(e){e.active=!1}),this.uiManager.showPanel("GameOverMainPanel");var t=this.drinkImage.node.parent;t&&(cc.Tween.stopAllByTarget(t),t.scale=1,t.opacity=255,cc.tween(t).to(.2,{scale:0,opacity:200},{easing:"smooth"}).call(function(){t=e.node,e.node.active=!1}).call(function(){cc.find("Canvas").emit("UpdateOpenPanelCount")}).start())},t.prototype.onBtn_Change=function(){var e=this;f.default.instance.playSFX(f.AudioRef.ClickButton),1===this.type?p.default.SelectedCapIndex=g.default.CurrentUnlockItem.id:2===this.type?p.default.SelectedCharacterIndex=g.default.CurrentUnlockItem.id:3===this.type&&(_.default.CurrentSelectedThemeIndex=parseInt(g.default.CurrentUnlockItem.id[0]),cc.director.emit(b.EventNames.ChangeBg)),this.uiManager.node.children.forEach(function(e){e.active=!1}),this.uiManager.showPanel("GameOverMainPanel");var t=this.drinkImage.node.parent;t&&(cc.Tween.stopAllByTarget(t),t.scale=1,t.opacity=255,cc.tween(t).to(.2,{scale:0,opacity:200},{easing:"smooth"}).call(function(){t=e.node,e.node.active=!1}).call(function(){cc.find("Canvas").emit("UpdateOpenPanelCount")}).start())},t.prototype.onBtn_Collection=function(){f.default.instance.playSFX(f.AudioRef.ClickButton),this.uiManager.showPanel("CollectionPanel")},t.prototype.CheckSidebar=function(){if(p.default.Level<=5)this.sidebarBtn.active=!1;else if(d.currentPlatform===d.platformEnum.toutiao){var e=this,t=!1;p.default.SideBarRewardCount>7||p.default.isToday(p.default.LastGetRewardDate)?this.sidebarBtn.active=!1:(p.default.ifOpenBySidebar&&!p.default.isToday(p.default.LastGetRewardDate)&&(t=!0),window.tt&&d.currentPlatform===d.platformEnum.toutiao&&tt.onShow(function(t){"homepage"===t.launch_from&&"sidebar_card"===t.location&&(p.default.ifOpenBySidebar=!0,p.default.isToday(p.default.LastGetRewardDate)||e.uiManager.showPanel("SidebarPanel"))}),d.currentPlatform===d.platformEnum.toutiao?m.default.platform.checkSidebarState().then(function(){e.sidebarBtn.active=!0,"021036"===m.default.platform.getLaunchOptions("scene")&&(p.default.ifOpenBySidebar=!0,p.default.isToday(p.default.LastGetRewardDate)||e.uiManager.showPanel("SidebarPanel"))}).catch(function(){e.sidebarBtn.active=!1}):e.sidebarBtn.active=!1,t&&e.uiManager.showPanel("SidebarPanel"))}else this.sidebarBtn.active=!1},t.prototype.onBtn_Sidebar=function(){var e=this;if(f.default.instance.playSFX(f.AudioRef.ClickButton),m.default.platform.reportButtonEvent("GameOverPage_giftBtn",0),p.default.isToday(p.default.LastGetRewardDate))return m.default.platform.showTips("\u4eca\u65e5\u5df2\u9886\u53d6\u8fc7\u5956\u52b1"),void cc.tween(this.sidebarBtn).to(.2,{opacity:0,scale:0},{easing:"smooth"}).call(function(){e.sidebarBtn.active=!1}).start();this.uiManager.showPanel("SidebarPanel")},l([k(cc.Sprite)],t.prototype,"drinkImage",void 0),l([k(cc.Label)],t.prototype,"drinkName",void 0),l([k(v.default)],t.prototype,"puzzle",void 0),l([k(sp.Skeleton)],t.prototype,"Animation_Title",void 0),l([k(sp.Skeleton)],t.prototype,"Animation_Titleback",void 0),l([k(h.default)],t.prototype,"uiManager",void 0),l([k(cc.Node)],t.prototype,"btn_change",void 0),l([k(cc.Node)],t.prototype,"btn_collection",void 0),l([k(cc.Node)],t.prototype,"light_back",void 0),l([k(cc.SpriteFrame)],t.prototype,"icon_goldBig",void 0),l([k(cc.SpriteFrame)],t.prototype,"icon_goldSmall",void 0),l([k(cc.SpriteFrame)],t.prototype,"icon_goldTiny",void 0),l([k(cc.Node)],t.prototype,"sidebarBtn",void 0),l([P],t)}(u.default);r.default=w,cc._RF.pop(),cc._RF.pop()},{}],EndStreakPanel:[function(e,t,o){"use strict";cc._RF.push(t,"3cbbdBXzJhAOa8LUp+JfteM","EndStreakPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"3cbbdBXzJhAOa8LUp+JfteM","EndStreakPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("CollectionManager"),d=n("CommonData"),f=n("CupMgr"),h=n("const"),y=n("GameManager"),m=n("GoldDataManager"),g=n("DataNexusEnum"),v=n("DataNexusSDK"),_=n("StaminaManager"),S=n("GameScene"),b=n("BasePanel"),C=[[1,0,0,0],[0,1,0,0],[0,0,1,0]],P=cc._decorator,k=P.ccclass,w=P.property,I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.text_toUnlock=null,t.winStreakSlider=null,t.winStreakLabel=null,t.sliderNumbers=[],t.CheckMark=[],t.text_Tips=null,t.btn_Restart=null,t.btn_Exit=null,t.iconFrames=[],t.icon3=null,t.icon71=null,t.icon72=null,t.reward3=[0,0,0,0],t.reward7=[0,0,0,0],t.capNode1=null,t.characterNode1=null,t.node7=null,t.unlockNode=null,t}return s(t,e),t.prototype.show=function(e){this.node.active=!0,this.node.opacity=255,this.node.scale=1;var t=this.node.getChildByName("Root");cc.director.emit("UpdateOpenPanelCount"),t&&(cc.Tween.stopAllByTarget(t),t.scale=.5,t.opacity=0,cc.tween(t).to(.2,{scale:1.1,opacity:150},{easing:"smooth"}).to(.2,{scale:1,opacity:255},{easing:"smooth"}).call(function(){e&&e()}).start())},t.prototype.hide=function(e){var t=this,o=this.node.getChildByName("Root");cc.director.emit(h.EventNames.CloseSetting),o&&(cc.Tween.stopAllByTarget(o),o.scale=1,o.opacity=255,cc.tween(o).to(.2,{scale:.5,opacity:100},{easing:"smooth"}).call(function(){t.node.active=!1,e&&e(),cc.director.emit("UpdateOpenPanelCount")}).start())},t.prototype.initPanel=function(e){1===e?(this.text_Tips.string="\u91cd\u5f00\u4f1a\u4e2d\u65ad\u8fde\u80dc",this.btn_Restart.active=!0,this.btn_Exit.active=!1):2===e&&(this.text_Tips.string="\u56de\u5230\u4e3b\u9875\u4f1a\u4e2d\u65ad\u8fde\u80dc",this.btn_Restart.active=!1,this.btn_Exit.active=!0),v.default.instance.trackAdPlacementShow(g.RewardADEvent.OTHER),this.checkWinStreak(),this.checkCollectionUnlock()},t.prototype.checkCollectionUnlock=function(){var e=d.default.WinStreak,t=9999,o=9999;p.default.CurrentCapByWinStreakIndex<=p.default.unlockCapByWinStreakArray.length&&(t=p.default.unlockCapByWinStreakArray[p.default.CurrentCapByWinStreakIndex-1]),p.default.CurrentCharacterByWinStreakIndex<=p.default.unlockCharacterByWinStreakArray.length&&(o=p.default.unlockCharacterByWinStreakArray[p.default.CurrentCharacterByWinStreakIndex-1]);var n=Math.min(t,o);9999!==n&&e!=n?n===t?(this.text_toUnlock.node.active=!0,this.text_toUnlock.string="\u8ddd\u79bb\u83b7\u53d6\u65b0\u74f6\u76d6\u4ec5\u5269"+(t-e)+"\u6b21\u8fde\u80dc"):n===o&&(this.text_toUnlock.node.active=!0,this.text_toUnlock.string="\u8ddd\u79bb\u83b7\u53d6\u65b0\u9a91\u624b\u4ec5\u5269"+(o-e)+"\u6b21\u8fde\u80dc"):this.text_toUnlock.node.active=!1},t.prototype.checkWinStreak=function(){var e=d.default.WinStreak;this.winStreakLabel.string="\u5f53\u524d\u8fde\u80dc\uff1a"+e;for(var t=Math.floor(e/7),o=0;o<this.sliderNumbers.length;o++)this.sliderNumbers[o].string=(7*t+o+1).toString();this.reward3=C[d.default.Reward3],this.reward7=d.default.Reward7;var n=e%7;this.winStreakSlider.fillRange=n/7,1==this.reward3[0]&&(this.icon3.spriteFrame=this.iconFrames[0]),1==this.reward3[1]&&(this.icon3.spriteFrame=this.iconFrames[1]),1==this.reward3[2]&&(this.icon3.spriteFrame=this.iconFrames[2]);var i=!0;for(o=0;o<3;o++)1==this.reward7[o]&&(i?(this.icon71.spriteFrame=this.iconFrames[o+0],i=!1):this.icon72.spriteFrame=this.iconFrames[o+0]);var r=7*(t+1);if(r==p.default.unlockCapByWinStreakArray[p.default.CurrentCapByWinStreakIndex-1]){this.node7.active=!1,this.unlockNode.active=!0,this.capNode1.active=!0;var a=this.capNode1.getComponent(cc.Sprite),c=p.default.unlockCapByWinStreakArrayIndex[p.default.CurrentCapByWinStreakIndex-1];this.setSpriteFrame(a,c,"Caps"),this.characterNode1.active=!1}else r==p.default.unlockCharacterByWinStreakArray[p.default.CurrentCharacterByWinStreakIndex-1]?(this.node7.active=!1,this.unlockNode.active=!0,this.capNode1.active=!1,this.characterNode1.active=!0,a=this.characterNode1.getComponent(cc.Sprite),c=p.default.unlockCharacterByWinStreakArrayIndex[p.default.CurrentCharacterByWinStreakIndex-1],this.setSpriteFrame(a,c,"Animals")):(this.node7.active=!0,this.unlockNode.active=!1);n<3?(this.CheckMark[0].active=!1,this.CheckMark[1].active=!1):n<7?(this.CheckMark[0].active=!0,this.CheckMark[1].active=!1):(this.CheckMark[0].active=!0,this.CheckMark[1].active=!0)},t.prototype.onBtn_Resume=function(){u.default.instance.playSFX(u.AudioRef.ClickClose),this.hide()},t.prototype.onBtn_ConfirmExit=function(){var e;_.default.instance.energy,cc.director.getScene().name===h.SceneNames.Game&&(y.default.platform.reportAdPointEvent("WinProgress_BreakFirst",d.default.WinStreak),d.default.WinStreak=0,(e={level_id:d.default.CurrentLevel,ad_cnt:f.default.getInstance().currentLevelAdWatchedCount}).duration=S.default.instance.getLevelTime(),e.game_mode=cc.director.getScene().name,e.stamina_value=_.default.instance.energy,e.coin_amount=m.default.Gold,v.default.instance.trackLevelExit(e)),y.default.platform.reportButtonEvent("GameSetPage_ReturnHomeBtn",0),cc.director.loadScene(h.SceneNames.Main)},t.prototype.onBtn_Sustain=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),this.btn_Exit.active?(y.default.platform.reportButtonEvent("GameSetPage_ReturnHomeBtn",0),y.default.platform.reportVideoEvent("GameSetPage_ReturnHomeBtn_video",1),v.default.instance.trackAdClick(g.RewardADEvent.OTHER),y.default.platform.showRewardAD(function(){v.default.instance.trackAdVideoFinish(g.RewardADEvent.OTHER),y.default.platform.reportVideoEvent("GameSetPage_ReturnHomeBtn_video",2);var e={level_id:d.default.CurrentLevel,ad_cnt:f.default.getInstance().currentLevelAdWatchedCount};e.duration=S.default.instance.getLevelTime(),e.game_mode=cc.director.getScene().name,e.stamina_value=_.default.instance.energy,e.coin_amount=m.default.Gold,v.default.instance.trackLevelExit(e),cc.director.loadScene("Main")})):(y.default.platform.reportButtonEvent("GameSetPage_RestartBtn",0),y.default.platform.reportVideoEvent("GameSetPage_RestartBtn_video",1),v.default.instance.trackAdClick(g.RewardADEvent.OTHER),y.default.platform.showRewardAD(function(){v.default.instance.trackAdVideoFinish(g.RewardADEvent.OTHER),y.default.platform.reportVideoEvent("GameSetPage_RestartBtn_video",2);var e={level_id:d.default.CurrentLevel,ad_cnt:f.default.getInstance().currentLevelAdWatchedCount};e.duration=S.default.instance.getLevelTime(),e.game_mode=cc.director.getScene().name,e.stamina_value=_.default.instance.energy,e.coin_amount=m.default.Gold,v.default.instance.trackLevelExit(e),cc.director.loadScene(cc.director.getScene().name)}))},t.prototype.onBtn_Restart=function(){if(u.default.instance.playSFX(u.AudioRef.ClickButton),_.default.instance.energy<=0)this.hide(),S.default.instance.uiManager.showPanel("EnergyPanel");else{if(_.default.instance.consume(1),y.default.platform.reportPageEvent("RestartGame"),cc.director.getScene().name===h.SceneNames.Game&&(y.default.platform.reportAdPointEvent("WinProgress_BreakFirst",d.default.WinStreak),d.default.WinStreak=0),y.default.platform.reportButtonEvent("GameSetPage_RestartBtn",0),cc.director.getScene().name===h.SceneNames.Game){var e={level_id:d.default.CurrentLevel,ad_cnt:f.default.getInstance().currentLevelAdWatchedCount};e.duration=S.default.instance.getLevelTime(),e.game_mode=cc.director.getScene().name,e.stamina_value=_.default.instance.energy,e.coin_amount=m.default.Gold,v.default.instance.trackLevelExit(e)}cc.director.loadScene(cc.director.getScene().name)}},t.prototype.setSpriteFrame=function(e,t,o){var n=cc.assetManager.getBundle(o);n?n.load(t+"d",cc.Texture2D,function(n,i){n?console.error("\u52a0\u8f7d\u56fe\u7247"+t+"\u5931\u8d25:",n):(e.spriteFrame=new cc.SpriteFrame(i),"Animals"===o&&(e.node.scale=.15))}):cc.assetManager.loadBundle(o,function(n,i){i.load(t+"d",cc.Texture2D,function(n,i){n?console.error("\u52a0\u8f7d\u56fe\u7247"+t+"\u5931\u8d25:",n):(e.spriteFrame=new cc.SpriteFrame(i),"Animals"===o&&(e.node.scale=.15))}),n&&console.error("\u52a0\u8f7dCaps\u8d44\u6e90\u5305\u5931\u8d25:",n)})},l([w(cc.Label)],t.prototype,"text_toUnlock",void 0),l([w(cc.Sprite)],t.prototype,"winStreakSlider",void 0),l([w(cc.Label)],t.prototype,"winStreakLabel",void 0),l([w([cc.Label])],t.prototype,"sliderNumbers",void 0),l([w([cc.Node])],t.prototype,"CheckMark",void 0),l([w(cc.Label)],t.prototype,"text_Tips",void 0),l([w(cc.Node)],t.prototype,"btn_Restart",void 0),l([w(cc.Node)],t.prototype,"btn_Exit",void 0),l([w([cc.SpriteFrame])],t.prototype,"iconFrames",void 0),l([w(cc.Sprite)],t.prototype,"icon3",void 0),l([w(cc.Sprite)],t.prototype,"icon71",void 0),l([w(cc.Sprite)],t.prototype,"icon72",void 0),l([w(cc.Node)],t.prototype,"capNode1",void 0),l([w(cc.Node)],t.prototype,"characterNode1",void 0),l([w(cc.Node)],t.prototype,"node7",void 0),l([w(cc.Node)],t.prototype,"unlockNode",void 0),l([k],t)}(b.default);r.default=I,cc._RF.pop(),cc._RF.pop()},{}],EnergyPanel:[function(e,t,o){"use strict";cc._RF.push(t,"d8d4bNRAyNMaI2Ay5GEyX+n","EnergyPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"d8d4bNRAyNMaI2Ay5GEyX+n","EnergyPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=n("const"),d=n("GameManager"),f=n("DataNexusEnum"),h=n("DataNexusSDK"),y=n("StaminaManager"),m=n("BasePanel"),g=cc._decorator,v=g.ccclass,_=g.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btn_Ad=null,t.bg=null,t}return s(t,e),t.prototype.onEnable=function(){d.default.platform.reportPageEvent("EnergyExhaustPage"),y.default.instance.canShareToday()?this.btn_Ad.active=!1:this.btn_Ad.active=!0,h.default.instance.trackAdPlacementShow(f.RewardADEvent.STAMINA)},t.prototype.show=function(e){this.init();var t=this.bg;cc.director.emit("UpdateOpenPanelCount"),t&&(cc.Tween.stopAllByTarget(t),t.scale=.5,t.opacity=0,cc.tween(t).to(.2,{scale:1.1,opacity:150},{easing:"smooth"}).to(.2,{scale:1,opacity:255},{easing:"smooth"}).call(function(){e&&e()}).start())},t.prototype.hide=function(){var e=this;if(1===this.node.scale){var t=this.bg;t&&(cc.Tween.stopAllByTarget(t),t.scale=1,t.opacity=255,cc.tween(t).to(.2,{scale:.5,opacity:100},{easing:"smooth"}).call(function(){e.node.active=!1,cc.director.emit("UpdateOpenPanelCount")}).start())}},t.prototype.onBtn_Ad=function(){var e=this;d.default.platform.reportVideoEvent("GamePage_addEnergy_video",1),h.default.instance.trackAdClick(f.RewardADEvent.STAMINA),d.default.platform.showRewardAD(function(){h.default.instance.trackAdVideoFinish(f.RewardADEvent.STAMINA),y.default.instance.enableInfinite(),d.default.platform.reportVideoEvent("GamePage_addEnergy_video",2),cc.director.getScene().name===p.SceneNames.Game&&(u.default.currentLevelReplayedTime++,u.default.WinStreak=0),cc.director.getScene().name===p.SceneNames.Main?e.hide():cc.director.loadScene(cc.director.getScene().name)})},t.prototype.onBtn_Share=function(){var e=this;d.default.platform.reportButtonEvent("GamePage_addEnergy_share",0),d.default.platform.showShare(function(){y.default.instance.enableInfinite(),y.default.instance.markSharedToday(),cc.director.getScene().name===p.SceneNames.Game&&(u.default.currentLevelReplayedTime++,u.default.WinStreak=0),cc.director.getScene().name===p.SceneNames.Main?e.hide():(u.default.currentLevelReplayedTime++,cc.director.loadScene(cc.director.getScene().name))})},l([_(cc.Node)],t.prototype,"btn_Ad",void 0),l([_(cc.Node)],t.prototype,"bg",void 0),l([v],t)}(m.default);r.default=S,cc._RF.pop(),cc._RF.pop()},{}],Event2Bg:[function(e,t,o){"use strict";cc._RF.push(t,"8d5caoe6flKep7eteDjFkXF","Event2Bg");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"8d5caoe6flKep7eteDjFkXF","Event2Bg");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("SignInManager"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bgSprite=null,t.bgFrames=[],t}return s(t,e),t.prototype.onLoad=function(){2==u.default.instance.getMonth()?this.bgSprite.spriteFrame=this.bgFrames[1]:this.bgSprite.spriteFrame=this.bgFrames[0]},l([f(cc.Sprite)],t.prototype,"bgSprite",void 0),l([f([cc.SpriteFrame])],t.prototype,"bgFrames",void 0),l([d],t)}(cc.Component);r.default=h,cc._RF.pop(),cc._RF.pop()},{}],Event2MainButton:[function(e,t,o){"use strict";cc._RF.push(t,"35af5qmW6ZEKav4qezkUIhl","Event2MainButton");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"35af5qmW6ZEKav4qezkUIhl","Event2MainButton");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("SignInManager"),p=cc._decorator,d=p.ccclass,f=p.property,h=p.menu,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t}return s(t,e),t.prototype.onLoad=function(){u.default.instance.isEvent2Active()?this.node.active=!0:this.node.active=!1},t.prototype.onEnable=function(){this.label.string="\u5269\u4f59"+(29-u.default.instance.getDay())+"\u5929"},l([f(cc.Label)],t.prototype,"label",void 0),l([d,h("Event/Event2MainButton")],t)}(cc.Component);r.default=y,cc._RF.pop(),cc._RF.pop()},{}],EventDescPanel:[function(e,t,o){"use strict";cc._RF.push(t,"fbb29meH8lBvbp2eeGJaK+I","EventDescPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"fbb29meH8lBvbp2eeGJaK+I","EventDescPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("BasePanel"),d=n("SignInManager"),f=cc._decorator,h=f.ccclass,y=f.property,m=f.menu,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lbl_desc=null,t.root=null,t}return s(t,e),t.prototype.show=function(e){this.init();var t=this.root;cc.director.emit("UpdateOpenPanelCount"),t&&(cc.Tween.stopAllByTarget(t),t.scale=.5,t.opacity=220,cc.tween(t).to(.3,{scale:1,opacity:255},{easing:"backOut"}).call(function(){e&&e()}).start())},t.prototype.hide=function(e){var t=this,o=this.root;o&&(cc.Tween.stopAllByTarget(o),o.scale=1,o.opacity=255,cc.tween(o).to(.4,{scale:0,opacity:0},{easing:"backIn"}).call(function(){t.node.active=!1,e&&"function"==typeof e&&e(),cc.director.emit("UpdateOpenPanelCount")}).start())},t.prototype.onBtn_close=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),this.hide()},t.prototype.init=function(){var e=this.lbl_desc.string,t="\u96ea\u82b1";2==d.default.instance.getMonth()&&(t="\u70df\u82b1"),e=e.replace(/tt/g,t),this.lbl_desc.string=e},l([y(cc.Label)],t.prototype,"lbl_desc",void 0),l([y(cc.Node)],t.prototype,"root",void 0),l([h,m("Event/EventDescPanel")],t)}(p.default);r.default=g,cc._RF.pop(),cc._RF.pop()},{}],EventEffectPanel:[function(e,t,o){"use strict";cc._RF.push(t,"2453awVOoVIGJ9gXY4CS6wL","EventEffectPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"2453awVOoVIGJ9gXY4CS6wL","EventEffectPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("DataManager"),d=n("FinishEffectDataManager"),f=n("GameManager"),h=n("GoldDataManager"),y=n("BasePanel"),m=n("SignInManager"),g=cc._decorator,v=g.ccclass,_=g.property,S=g.menu,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.text_gold=null,t.root=null,t}return s(t,e),t.prototype.updateGold=function(){this.text_gold.string=h.default.Gold.toString()},t.prototype.getCurrentEffectId=function(){return 1==m.default.instance.getMonth()?9:2==m.default.instance.getMonth()?10:void 0},t.prototype.show=function(e){var t=this;this.init(),this.updateGold(),this.text_gold.node.parent.active=!1;var o=this.root;cc.director.emit("UpdateOpenPanelCount"),o&&(cc.Tween.stopAllByTarget(o),o.scale=.5,o.opacity=220,cc.tween(o).to(.3,{scale:1,opacity:255},{easing:"backOut"}).call(function(){e&&e(),t.text_gold.node.parent.active=!0,t.text_gold.node.parent.scale=0,cc.tween(t.text_gold.node.parent).to(.3,{scale:1},{easing:"backOut"}).start()}).start())},t.prototype.hide=function(e){var t=this,o=this.root;o&&(cc.Tween.stopAllByTarget(o),o.scale=1,o.opacity=255,cc.tween(o).to(.4,{scale:0,opacity:0},{easing:"backIn"}).call(function(){t.node.active=!1,e&&"function"==typeof e&&e(),cc.director.emit("UpdateOpenPanelCount")}).start())},t.prototype.onBtn_close=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),this.hide()},t.prototype.onBtn_Buy=function(){var e=this;if(u.default.instance.playSFX(u.AudioRef.ClickButton),f.default.platform.reportButtonEvent("Button_EventEffect",0),cc.sys.isBrowser)return d.default.setFinishEffectUnlockMap(this.getCurrentEffectId(),!0),h.default.Gold-=d.default.FinishEffectUnlockPriceMap[this.getCurrentEffectId()],console.error("\u8d2d\u4e70\u6210\u529f\uff01"),void this.hide();h.default.Gold>=d.default.FinishEffectUnlockPriceMap[this.getCurrentEffectId()]?p.default.uploadGoldCoin(h.default.Gold-d.default.FinishEffectUnlockPriceMap[this.getCurrentEffectId()],function(){f.default.platform.showTips("\u8d2d\u4e70\u6210\u529f!"),f.default.platform.reportButtonEvent("Button_EventEffect",1),console.error("\u8d2d\u4e70\u6210\u529f\uff01"),h.default.Gold-=d.default.FinishEffectUnlockPriceMap[e.getCurrentEffectId()],e.updateGold(),d.default.setFinishEffectUnlockMap(e.getCurrentEffectId(),!0),e.hide()},function(){f.default.platform.showTips("\u8d2d\u4e70\u5931\u8d25!\u8bf7\u91cd\u8bd5"),f.default.platform.reportButtonEvent("Button_EventEffect",2),console.error("\u8d2d\u4e70\u5931\u8d25\uff01")}):(console.error("\u91d1\u5e01\u4e0d\u8db3\uff0c\u8d2d\u4e70\u5931\u8d25\uff01"),f.default.platform.showTips("\u91d1\u5e01\u4e0d\u8db3\uff0c\u8d2d\u4e70\u5931\u8d25\uff01"),f.default.platform.reportButtonEvent("Button_EventEffect",2))},l([_(cc.Label)],t.prototype,"text_gold",void 0),l([_(cc.Node)],t.prototype,"root",void 0),l([v,S("Event/EventEffectPanel")],t)}(y.default);r.default=b,cc._RF.pop(),cc._RF.pop()},{}],EventItem:[function(e,t,o){"use strict";cc._RF.push(t,"6764d3V3MpLtpTdzb2uf6m/","EventItem");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"6764d3V3MpLtpTdzb2uf6m/","EventItem");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CollectionManager"),p=n("ThemeDataManager"),d=n("const"),f=n("GameManager"),h=n("UnlockData"),y=n("EventManager"),m=n("EventResignPanel"),g=n("SignInEnum"),v=n("SignInManager"),_=cc._decorator,S=_.ccclass,b=_.property,C=_.menu,P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemIcon=null,t.frame=null,t.slider=null,t.resignNode=null,t.checkNode=null,t.maskNode=null,t.index=0,t.type=h.UnlockType.EVENT,t.rewardId=0,t.state=g.SignInState.LOCKED,t.breathingTween=null,t.tagBreathingTween=null,t}return s(t,e),t.prototype.onEnable=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onBtn_GetReward,this),this.node.on(cc.Node.EventType.TOUCH_START,this.onBtn_Resign,this),cc.director.on(d.EventNames.UpdateState,this.setState,this)},t.prototype.onDisable=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onBtn_GetReward,this),this.node.off(cc.Node.EventType.TOUCH_START,this.onBtn_Resign,this),cc.director.off(d.EventNames.UpdateState,this.setState,this)},t.prototype.setIndex=function(e){this.index=e,this.setItem(),this.setSlider(),this.setState()},t.prototype.setItem=function(){var e=v.default.instance.getRewardInfo(this.index%100);switch(this.type=e.type,this.rewardId=e.id,e.type){case h.UnlockType.GOLD:this.type=h.UnlockType.GOLD,this.itemIcon.spriteFrame=y.default.instance.item_coin;break;case h.UnlockType.EVENT:this.type=h.UnlockType.EVENT,this.itemIcon.spriteFrame=y.default.instance.item_event;break;case h.UnlockType.CAP:this.type=h.UnlockType.CAP;for(var t=0;t<y.default.instance.items_cap.length;t++){var o=y.default.instance.items_cap[t];if(o.name===e.id.toString()){this.itemIcon.spriteFrame=o;break}}break;case h.UnlockType.THEME:this.type=h.UnlockType.THEME;var n=e.id.split("_"),i=parseInt(n[1]);this.itemIcon.node.scale=.6,this.itemIcon.spriteFrame=y.default.instance.items_bg[i-1]}},t.prototype.setSlider=function(){if(this.slider){var e=v.default.instance.getCurrentDayIndex();this.index<e?this.slider.spriteFrame=y.default.instance.slider_passed:this.slider.spriteFrame=y.default.instance.slider_default}},t.prototype.setState=function(){var e=this,t=v.default.instance.calculateDayIndex(v.default.instance.getMonth(),this.index),o=v.default.instance.DayStateMap[t];switch(this.state=o,this.node.getChildByName("Text").getComponent(cc.LabelOutline),o){case g.SignInState.LOCKED:this.stopBreathAnimation(),this.stopTagBreathAnimation(),this.frame.spriteFrame=y.default.instance.frame_default,this.maskNode.active=!1,this.checkNode.active=!1,this.resignNode.active=!1;break;case g.SignInState.CLAIMED:this.stopBreathAnimation(),this.stopTagBreathAnimation(),this.frame.spriteFrame=y.default.instance.frame_default,this.maskNode.active=!0,this.checkNode.active=!0,this.resignNode.active=!1;break;case g.SignInState.MISSED:this.stopBreathAnimation(),this.scheduleOnce(function(){e.startTagBreathAnimation()},3),this.frame.spriteFrame=y.default.instance.frame_default,this.maskNode.active=!1,this.checkNode.active=!1,this.resignNode.active=!0;break;case g.SignInState.READY:this.frame.spriteFrame=y.default.instance.frame_ready,this.maskNode.active=!1,this.checkNode.active=!1,this.resignNode.active=!1,this.stopTagBreathAnimation(),this.scheduleOnce(function(){e.startBreathAnimation()},3)}},t.prototype.onBtn_GetReward=function(){if(this.state===g.SignInState.READY){for(var e=0,t=v.default.instance.getStartDay();t<=v.default.instance.getEndDay();t++){var o=v.default.instance.calculateDayIndex(v.default.instance.getMonth(),t);if(v.default.instance.DayStateMap[o]===g.SignInState.READY&&e++,e>1)return void this.onBtn_GetRewardAll()}f.default.platform.reportButtonEvent("Button_EventReward",0),this.type===h.UnlockType.CAP?u.default.setCapUnlockMap(this.rewardId,!0):this.type===h.UnlockType.THEME?p.default.setThemeUnlockMap(this.rewardId,!0):this.type===h.UnlockType.RIDER&&u.default.setCharacterUnlockMap(this.rewardId,!0);var n=v.default.instance.calculateDayIndex(v.default.instance.getMonth(),this.index);v.default.instance.setDayStateMap(n,g.SignInState.CLAIMED),this.setState(),this.type!==h.UnlockType.EVENT?(y.default.instance.showPanel("EventRewardPanel").getComponent("EventRewardPanel").setUpImageAndName(this.type,this.rewardId),y.default.instance.eventPanel.initBtnGo()):y.default.instance.playSnowFlakeCollectEffect(this.node.convertToWorldSpaceAR(cc.Vec2.ZERO))}},t.prototype.onBtn_GetRewardAll=function(){y.default.instance.onBtn_GetAllReward()},t.prototype.onBtn_Resign=function(){if(this.state===g.SignInState.MISSED)if(v.default.instance.resignCount<=0)f.default.platform.showTips("\u4eca\u65e5\u8865\u7b7e\u6b21\u6570\u5df2\u7528\u5b8c~");else{var e=y.default.instance.showPanel("EventResignPanel");this.type!==h.UnlockType.EVENT?e.getComponent(m.default).setUpImageAndName(this.type,this.rewardId,this.index):e.getComponent(m.default).setUpImageAndName(this.type,this.rewardId,this.index,this.node)}},t.prototype.startBreathAnimation=function(){this.breathingTween=cc.tween(this.node).to(1,{scale:1.04},{easing:"sineInOut"}).to(1,{scale:.88},{easing:"sineInOut"}).union().repeatForever().start()},t.prototype.stopBreathAnimation=function(){this.unscheduleAllCallbacks(),this.breathingTween&&this.breathingTween.stop(),this.node.scale=1},t.prototype.startTagBreathAnimation=function(){this.tagBreathingTween=cc.tween(this.resignNode).to(1,{scale:1.05},{easing:"sineInOut"}).to(1,{scale:.95},{easing:"sineInOut"}).union().repeatForever().start()},t.prototype.stopTagBreathAnimation=function(){this.unscheduleAllCallbacks(),this.tagBreathingTween&&this.tagBreathingTween.stop(),this.resignNode.scale=1},l([b(cc.Sprite)],t.prototype,"itemIcon",void 0),l([b(cc.Sprite)],t.prototype,"frame",void 0),l([b(cc.Sprite)],t.prototype,"slider",void 0),l([b(cc.Node)],t.prototype,"resignNode",void 0),l([b(cc.Node)],t.prototype,"checkNode",void 0),l([b(cc.Node)],t.prototype,"maskNode",void 0),l([S,C("Event/EventItem")],t)}(cc.Component);r.default=P,cc._RF.pop(),cc._RF.pop()},{}],EventMainButton:[function(e,t,o){"use strict";cc._RF.push(t,"41662M/sBJMhKM+wqP35x31","EventMainButton");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"41662M/sBJMhKM+wqP35x31","EventMainButton");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("SignInManager"),p=cc._decorator,d=p.ccclass,f=p.property,h=p.menu,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t}return s(t,e),t.prototype.onLoad=function(){u.default.instance.isEventActive()?this.node.active=!0:this.node.active=!1},t.prototype.onEnable=function(){this.label.string=""+(32-u.default.instance.getDay())},l([f(cc.Label)],t.prototype,"label",void 0),l([d,h("Event/EventMainButton")],t)}(cc.Component);r.default=y,cc._RF.pop(),cc._RF.pop()},{}],EventManager:[function(e,t,o){"use strict";cc._RF.push(t,"de57cYPgeNCcY1j3pGv+tbc","EventManager");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"de57cYPgeNCcY1j3pGv+tbc","EventManager");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("CollectionManager"),d=n("ThemeDataManager"),f=n("const"),h=n("GameManager"),y=n("UnlockData"),m=n("EventItem"),g=n("EventPanel"),v=n("EventRewardAllPanel"),_=n("PenguinProgressNode"),S=n("SignInEnum"),b=n("SignInManager"),C=cc._decorator,P=C.ccclass,k=C.property,w=C.menu,I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.frame_default=null,t.frame_ready=null,t.slider_default=null,t.slider_passed=null,t.item_event=null,t.items_bg=[],t.item_coin=null,t.items_cap=[],t.eventEffect=null,t.otherPnlNode=null,t.panels=[],t.eventPanel=null,t.penguinProgressNode=null,t.currentResignIndex=-1,t}var o;return s(t,e),o=t,Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new o),this._instance},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){o._instance=this},t.prototype.onBtn_Description=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),this.showPanel("EventDescPanel")},t.prototype.onBtn_GetAllReward=function(){h.default.platform.reportButtonEvent("EventPage_GetAllRewards",0);var e=[];u.default.instance.playSFX(u.AudioRef.ClickButton);for(var t=0;t<this.eventPanel.itemNode.children.length;t++){var o=this.eventPanel.itemNode.children[t].getComponent(m.default),n=o.index,i=b.default.instance.calculateDayIndex(b.default.instance.getMonth(),n),r=o.type,a=o.rewardId;if(b.default.instance.DayStateMap[i]===S.SignInState.READY){r===y.UnlockType.CAP?p.default.setCapUnlockMap(a,!0):r===y.UnlockType.THEME?d.default.setThemeUnlockMap(a,!0):r===y.UnlockType.RIDER?p.default.setCharacterUnlockMap(a,!0):r===y.UnlockType.EVENT&&this.playSnowFlakeCollectEffect(o.node.convertToWorldSpaceAR(cc.Vec2.ZERO));var c=b.default.instance.calculateDayIndex(b.default.instance.getMonth(),n);b.default.instance.setDayStateMap(c,S.SignInState.CLAIMED),e.push(c),console.error("rewardArray push",c)}}this.showPanel("EventRewardAllPanel").getComponent(v.default).setUpAllRewards(e),cc.director.emit(f.EventNames.UpdateState),this.eventPanel.initBtnGo()},t.prototype.playSnowFlakeCollectEffect=function(e){var t=this;b.default.instance.eventToken+=1;var o=cc.instantiate(this.eventEffect);o.parent=this.eventPanel.rootNode;var n=this.eventPanel.rootNode.convertToNodeSpaceAR(e);o.setPosition(n);var i=cc.v2(-250,180);cc.tween(o).to(1,{position:cc.v3(i)},{easing:"sineInOut"}).call(function(){t.penguinProgressNode.addOneSlider(),o.destroy()}).start()},t.prototype.showPanel=function(e){var t=this.otherPnlNode.getChildByName(e);if(t)return t.active=!1,t.active=!0,t.getComponent(e).show(),t.setSiblingIndex(this.otherPnlNode.childrenCount-1),t;for(var o=0;o<this.panels.length;o++)if(this.panels[o].name===e){var n=cc.instantiate(this.panels[o]);return this.otherPnlNode.addChild(n),n.getComponent(e).show(),n.setSiblingIndex(this.otherPnlNode.childrenCount-1),n}},t._instance=null,l([k(cc.SpriteFrame)],t.prototype,"frame_default",void 0),l([k(cc.SpriteFrame)],t.prototype,"frame_ready",void 0),l([k(cc.SpriteFrame)],t.prototype,"slider_default",void 0),l([k(cc.SpriteFrame)],t.prototype,"slider_passed",void 0),l([k(cc.SpriteFrame)],t.prototype,"item_event",void 0),l([k([cc.SpriteFrame])],t.prototype,"items_bg",void 0),l([k(cc.SpriteFrame)],t.prototype,"item_coin",void 0),l([k([cc.SpriteFrame])],t.prototype,"items_cap",void 0),l([k(cc.Prefab)],t.prototype,"eventEffect",void 0),l([k(cc.Node)],t.prototype,"otherPnlNode",void 0),l([k([cc.Prefab])],t.prototype,"panels",void 0),l([k(g.default)],t.prototype,"eventPanel",void 0),l([k(_.default)],t.prototype,"penguinProgressNode",void 0),o=l([P,w("Event/EventManager")],t)}(cc.Component);r.default=I,cc._RF.pop(),cc._RF.pop()},{}],EventNotifyPanel:[function(e,t,o){"use strict";cc._RF.push(t,"2099b11wutKgJln5iQBaOXM","EventNotifyPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"2099b11wutKgJln5iQBaOXM","EventNotifyPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("GameManager"),d=n("BasePanel"),f=cc._decorator,h=f.ccclass,y=f.property,m=f.menu,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.root=null,t}return s(t,e),t.prototype.show=function(e){p.default.platform.reportPageEvent("Page_Promotional"),this.init();var t=this.root;cc.director.emit("UpdateOpenPanelCount"),t&&(cc.Tween.stopAllByTarget(t),t.scale=.5,t.opacity=220,cc.tween(t).to(.3,{scale:.85,opacity:255},{easing:"backOut"}).call(function(){e&&e()}).start())},t.prototype.hide=function(e){var t=this,o=this.root;o&&(cc.Tween.stopAllByTarget(o),o.scale=.85,o.opacity=255,cc.tween(o).to(.4,{scale:0,opacity:0},{easing:"backIn"}).call(function(){t.node.active=!1,e&&"function"==typeof e&&e(),cc.director.emit("UpdateOpenPanelCount")}).start())},t.prototype.onBtn_hide=function(){this.hide()},t.prototype.onBtn_participate=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),p.default.platform.reportButtonEvent("Button_GoEvent",0),this.node.parent.getComponent("UIManager").showEventPanel("EventPanel"),this.hide()},l([y(cc.Node)],t.prototype,"root",void 0),l([h,m("Event/EventNotifyPanel")],t)}(d.default);r.default=g,cc._RF.pop(),cc._RF.pop()},{}],EventPanel:[function(e,t,o){"use strict";cc._RF.push(t,"a83612kxtVMEq+sjLJOMYfE","EventPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"a83612kxtVMEq+sjLJOMYfE","EventPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("FinishEffectDataManager"),d=n("const"),f=n("GameManager"),h=n("UnlockData"),y=n("BasePanel"),m=n("EventItem"),g=n("EventManager"),v=n("EventRewardAllPanel"),_=n("EventRewardPanel"),S=n("FadeIn"),b=n("SignInEnum"),C=n("SignInManager"),P=cc._decorator,k=P.ccclass,w=P.property,I=P.menu,T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rootNode=null,t.btn_home=null,t.btn_go=null,t.titleNode=null,t.effectNode=null,t.penguinNode=null,t.snowProgressNode=null,t.targetProgressNode=null,t.calendarNode=null,t.coupletNode=null,t.coupletNode2=null,t.itemNode=null,t.bg=null,t.text_daily=null,t.btnFrame_continue=null,t.btnFrame_getReward=null,t.btnFrame_go=null,t.btnGoState=0,t}return s(t,e),t.prototype.onEnable=function(){cc.director.on(d.EventNames.UpdateState,this.initBtnGo,this)},t.prototype.onDisable=function(){cc.director.off(d.EventNames.UpdateState,this.initBtnGo,this)},t.prototype.onBtn_EffectShop=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),1==C.default.instance.getMonth()&&p.default.FinishEffectUnlockMap[9]||2==C.default.instance.getMonth()&&p.default.FinishEffectUnlockMap[10]?f.default.platform.showTips("\u5df2\u7ecf\u89e3\u9501\u8be5\u7279\u6548\uff01"):g.default.instance.showPanel("EventEffectPanel")},t.prototype.onBtn_Go=function(){if(1===this.btnGoState)return g.default.instance.onBtn_GetAllReward(),void this.initBtnGo();u.default.instance.playSFX(u.AudioRef.ClickButton);var e=cc.director.getScene().name;e===d.SceneNames.Game?(f.default.platform.reportButtonEvent("EventPage_Continue",0),this.hide()):e===d.SceneNames.Main&&(f.default.platform.reportButtonEvent("EventPage_GoGame",0),cc.director.loadScene(d.SceneNames.Game))},t.prototype.initBtnGo=function(){if(C.default.instance.getDay()>C.default.instance.getEndDay())return this.btnGoState=0,this.btn_go.getComponent(cc.Sprite).spriteFrame=this.btnFrame_continue,this.targetProgressNode.active=!1,this.text_daily.node.parent.active=!1,this.btn_go.x=0,this.btn_go.y=-560,void(2==C.default.instance.getMonth()&&(this.btn_go.y=-660));if(console.error(C.default.instance.isDailyTaskCompleted),!C.default.instance.isDailyTaskCompleted)return this.btn_go.getComponent(cc.Sprite).spriteFrame=this.btnFrame_go,this.text_daily.string="\u4efb\u52a1\uff1a\u901a\u8fc75\u4e2a\u5173\u5361",2==C.default.instance.getMonth()&&(this.text_daily.string="\u4efb\u52a1\uff1a\u901a\u8fc78\u4e2a\u5173\u5361"),void(this.btnGoState=0);this.text_daily.string="\u4eca\u65e5\u4efb\u52a1\u5df2\u5b8c\u6210";for(var e=C.default.instance.getStartDay();e<=C.default.instance.getEndDay();e++){var t=C.default.instance.calculateDayIndex(C.default.instance.getMonth(),e),o=C.default.instance.DayStateMap[t];if(console.error("cIndex",t),console.error("state",o),o===b.SignInState.READY)return this.btn_go.getComponent(cc.Sprite).spriteFrame=this.btnFrame_getReward,void(this.btnGoState=1)}this.btn_go.getComponent(cc.Sprite).spriteFrame=this.btnFrame_continue,this.btnGoState=0},t.prototype.show=function(){var e=this;this.init(),C.default.instance.ifNotified=!0,f.default.platform.reportPageEvent("Page_Event"),C.default.instance.fetchServerTime(),C.default.instance.updateDayStateMap(),this.initBtnGo(),this.node.active=!0,this.node.opacity=255;var t=this.rootNode;cc.director.getScene().name===d.SceneNames.Game?this.btn_home.active=!1:this.btn_home.active=!0,cc.director.emit("UpdateOpenPanelCount"),t&&(cc.Tween.stopAllByTarget(t),t.scale=1,this.opening(),this.scheduleOnce(function(){var t=C.default.instance.checkAndResendRewards();if(t.length>0){for(var o=!1,n=0,i=t;n<i.length;n++)if(i[n].type!==h.UnlockType.EVENT){o=!0;break}if(o)(f=g.default.instance.showPanel("EventRewardAllPanel")).getComponent(v.default).setUpAllRewardsByInfo(t);else{for(var r=C.default.instance.getMonth()-1,a=C.default.instance.getRewardInfo(r),c=C.default.instance.getStartDay(r),s=C.default.instance.getEndDay(r),l=!0,u=c;u<=s;u++){var p=C.default.instance.calculateDayIndex(r,u),d=C.default.instance.DayStateMap[p];if(a[u].type===h.UnlockType.EVENT&&d!==b.SignInState.CLAIMED){l=!1;break}}if(l){cc.find("Canvas").emit("UpdateOpenPanelCount"),e.node.active=!1;var f=g.default.instance.showPanel("EventRewardPanel"),y={type:h.UnlockType.RIDER,id:0};return 1==r&&(y.id=7),2==r&&(y.id=8),void f.getComponent(_.default).setUpImageAndName(y.type,y.id)}}}else C.default.instance.isFirstOpenEvent&&(C.default.instance.isFirstOpenEvent=!1,g.default.instance.showPanel("EventDescPanel"))},1.5))},t.prototype.opening=function(){this.bg.fadeIn(),this.titleNode.scale=0;var e=400;2==C.default.instance.getMonth()&&(e=600),this.penguinNode.x-=e,this.snowProgressNode.scale=0,this.effectNode.scale=0,this.btn_home.scale=0,this.calendarNode.scale=0,this.targetProgressNode.scale=0,this.btn_go.scale=0,this.coupletNode&&(this.coupletNode.scaleY=0),cc.tween(this.btn_home).delay(.1).to(.4,{scale:1},{easing:"backOut"}).start(),cc.tween(this.titleNode).delay(.1).to(.4,{scale:1},{easing:"backOut"}).start(),cc.tween(this.penguinNode).delay(.2).by(.5,{x:e},{easing:"sineOut"}).start(),this.coupletNode&&cc.tween(this.coupletNode).delay(.2).to(.4,{scaleY:1},{easing:"sineOut"}).start(),this.coupletNode2&&cc.tween(this.coupletNode2).delay(.2).to(.4,{scaleY:1},{easing:"sineOut"}).start(),cc.tween(this.effectNode).delay(.2).to(.4,{scale:1},{easing:"backOut"}).start(),cc.tween(this.snowProgressNode).delay(.6).to(.4,{scale:1},{easing:"backOut"}).start(),cc.tween(this.calendarNode).delay(.4).to(.3,{scale:1},{easing:"sineOut"}).start();for(var t=0;t<this.itemNode.children.length;t++){var o=this.itemNode.children[t];o.getComponent(m.default).setIndex(t+C.default.instance.getStartDay()),o.scale=0,cc.tween(o).delay(.6).delay(.015*t).to(.4,{scale:1},{easing:"backOut"}).start()}cc.tween(this.targetProgressNode).delay(.8).to(.4,{scale:1},{easing:"backOut"}).start(),C.default.instance.isDailyTaskCompleted?cc.tween(this.btn_go).delay(.8).to(.4,{scale:.8},{easing:"backOut"}).start():cc.tween(this.btn_go).delay(.8).to(.4,{scale:1},{easing:"backOut"}).start()},t.prototype.ending=function(e){var t=this,o=400;2==C.default.instance.getMonth()&&(o=600),cc.Tween.stopAllByTarget(this.btn_home),cc.Tween.stopAllByTarget(this.titleNode),cc.Tween.stopAllByTarget(this.penguinNode),cc.Tween.stopAllByTarget(this.effectNode),cc.Tween.stopAllByTarget(this.snowProgressNode),cc.Tween.stopAllByTarget(this.calendarNode),cc.Tween.stopAllByTarget(this.targetProgressNode),cc.Tween.stopAllByTarget(this.btn_go);for(var n=0,i=this.itemNode.children;n<i.length;n++){var r=i[n];cc.Tween.stopAllByTarget(r)}this.bg.fadeOutAndDisable(),cc.tween(this.btn_go).to(.4,{scale:0},{easing:"backIn"}).start(),cc.tween(this.targetProgressNode).to(.4,{scale:0},{easing:"backIn"}).start();for(var a=this.itemNode.children.length-1;a>=0;a--){var c=(r=this.itemNode.children[a]).getComponent(m.default);c.stopBreathAnimation(),c.stopTagBreathAnimation(),cc.tween(r).delay(.01*a).to(.2,{scale:0},{easing:"backIn"}).start()}cc.tween(this.snowProgressNode).delay(.1).to(.4,{scale:0},{easing:"backIn"}).start(),cc.tween(this.calendarNode).delay(.2).to(.4,{scale:0},{easing:"backIn"}).start(),cc.tween(this.effectNode).delay(.3).to(.4,{scale:0},{easing:"backIn"}).start(),cc.tween(this.penguinNode).delay(.3).by(.4,{x:-o},{easing:"sineIn"}).start(),this.coupletNode&&cc.tween(this.coupletNode).delay(.3).to(.4,{scaleY:0},{easing:"sineIn"}).start(),this.coupletNode2&&cc.tween(this.coupletNode2).delay(.3).to(.4,{scaleY:0},{easing:"sineIn"}).start(),cc.tween(this.btn_home).delay(.4).to(.3,{scale:0},{easing:"backIn"}).start(),cc.tween(this.titleNode).delay(.4).to(.4,{scale:0},{easing:"backIn"}).delay(.5).call(function(){t.node.active=!1,e&&"function"==typeof e&&e(),cc.director.emit("UpdateOpenPanelCount"),t.penguinNode.x+=o}).start()},t.prototype.hide=function(e){1===this.bg.obj.val&&this.ending(e)},l([w(cc.Node)],t.prototype,"rootNode",void 0),l([w(cc.Node)],t.prototype,"btn_home",void 0),l([w(cc.Node)],t.prototype,"btn_go",void 0),l([w(cc.Node)],t.prototype,"titleNode",void 0),l([w(cc.Node)],t.prototype,"effectNode",void 0),l([w(cc.Node)],t.prototype,"penguinNode",void 0),l([w(cc.Node)],t.prototype,"snowProgressNode",void 0),l([w(cc.Node)],t.prototype,"targetProgressNode",void 0),l([w(cc.Node)],t.prototype,"calendarNode",void 0),l([w(cc.Node)],t.prototype,"coupletNode",void 0),l([w(cc.Node)],t.prototype,"coupletNode2",void 0),l([w(cc.Node)],t.prototype,"itemNode",void 0),l([w(S.default)],t.prototype,"bg",void 0),l([w(cc.Label)],t.prototype,"text_daily",void 0),l([w(cc.SpriteFrame)],t.prototype,"btnFrame_continue",void 0),l([w(cc.SpriteFrame)],t.prototype,"btnFrame_getReward",void 0),l([w(cc.SpriteFrame)],t.prototype,"btnFrame_go",void 0),l([k,I("Event/EventPanel")],t)}(y.default);r.default=T,cc._RF.pop(),cc._RF.pop()},{}],EventResignPanel:[function(e,t,o){"use strict";cc._RF.push(t,"6caa3pa3W1FPI8Hn0KwSOfe","EventResignPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"6caa3pa3W1FPI8Hn0KwSOfe","EventResignPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("BasePanel"),p=n("CommonData"),d=n("AudioManager"),f=n("CollectionManager"),h=n("GameManager"),y=n("UnlockData"),m=n("ThemeDataManager"),g=n("const"),v=n("EventManager"),_=n("SignInManager"),S=n("SignInEnum"),b=n("EventRewardPanel"),C=cc._decorator,P=C.ccclass,k=C.property,w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ItemImg=null,t.snowIconNode=null,t.text_times=null,t.type=0,t.rewardId=0,t.dayIndex=0,t.root=null,t}return s(t,e),t.prototype.onEnable=function(){d.default.instance.playSFX(d.AudioRef.DrinkFinish),this.initEffect(),this.updateText(),cc.director.on(g.EventNames.UpdateState,this.updateText,this)},t.prototype.initEffect=function(){},t.prototype.onDisable=function(){p.default.CurrentLevel%5==0&&(y.default.unlockArray.shift(),y.default.saveUnlockArray()),cc.director.off(g.EventNames.UpdateState,this.updateText,this)},t.prototype.updateText=function(){this.text_times.string=_.default.instance.resignCount+"/3"},t.prototype.show=function(e){this.init();var t=this.root;cc.director.emit("UpdateOpenPanelCount"),t&&(cc.Tween.stopAllByTarget(t),t.scale=.5,t.opacity=220,cc.tween(t).to(.3,{scale:.85,opacity:255},{easing:"backOut"}).call(function(){e&&e()}).start())},t.prototype.hide=function(e){var t=this,o=this.root;o&&(cc.Tween.stopAllByTarget(o),o.scale=.85,o.opacity=255,cc.tween(o).to(.4,{scale:0,opacity:0},{easing:"backIn"}).call(function(){t.node.active=!1,e&&"function"==typeof e&&e(),cc.director.emit("UpdateOpenPanelCount")}).start())},t.prototype.setUpImageAndName=function(e,t,o,n){var i=this;void 0===n&&(n=null),this.snowIconNode=n,console.error("setUpImageAndName",e,t);var r=null,a="";switch(this.dayIndex=o,this.rewardId=t,this.type=e,e){case y.UnlockType.GOLD:switch(t){case 100:this.ItemImg.spriteFrame=v.default.instance.item_coin}break;case y.UnlockType.RIDER:a="Characters",(r=cc.assetManager.getBundle(a))?this.loadTexture(r,Number(t),2):cc.assetManager.loadBundle(a,function(e,o){e?cc.error("\u52a0\u8f7dBundle"+a+"\u5931\u8d25:",e):i.loadTexture(o,Number(t),2)});break;case y.UnlockType.CAP:a="Caps",(r=cc.assetManager.getBundle(a))?this.loadTexture(r,Number(t),1):cc.assetManager.loadBundle(a,function(e,o){e?cc.error("\u52a0\u8f7dBundle"+a+"\u5931\u8d25:",e):i.loadTexture(o,Number(t),1)});break;case y.UnlockType.EVENT:this.ItemImg.spriteFrame=v.default.instance.item_event,this.ItemImg.node.scale=2;break;case y.UnlockType.THEME:var c=t;m.default.setThemeUnlockMap(c,!0);var s=t.split("_"),l=parseInt(s[1]);this.ItemImg.spriteFrame=v.default.instance.items_bg[l-1]}},t.prototype.loadTexture=function(e,t,o){var n=this;e.load(""+t,cc.Texture2D,function(e,i){e?console.error("\u52a0\u8f7d\u56fe\u7247"+t+"\u5931\u8d25:",e):(n.ItemImg.spriteFrame=new cc.SpriteFrame(i),1===o?(n.ItemImg.node.scale=3,f.default.setCapUnlockMap(t,!0)):2===o&&(n.ItemImg.node.scale=1,f.default.setCharacterUnlockMap(t,!0)))})},t.prototype.onBtn_Close=function(){var e=this;d.default.instance.playSFX(d.AudioRef.ClickButton);var t=this.ItemImg.node.parent;t&&(cc.Tween.stopAllByTarget(t),t.scale=1,t.opacity=255,cc.tween(t).to(.2,{scale:0,opacity:200},{easing:"smooth"}).call(function(){t=e.node,e.node.active=!1}).call(function(){cc.find("Canvas").emit("UpdateOpenPanelCount")}).start())},t.prototype.onBtn_Change=function(){var e=this;d.default.instance.playSFX(d.AudioRef.ClickButton),1===this.type?p.default.SelectedCapIndex=y.default.CurrentUnlockItem.id:2===this.type?p.default.SelectedCharacterIndex=y.default.CurrentUnlockItem.id:3===this.type&&(m.default.CurrentSelectedThemeIndex=parseInt(y.default.CurrentUnlockItem.id[0]),cc.director.emit(g.EventNames.ChangeBg));var t=this.ItemImg.node.parent;t&&(cc.Tween.stopAllByTarget(t),t.scale=1,t.opacity=255,cc.tween(t).to(.2,{scale:0,opacity:200},{easing:"smooth"}).call(function(){t=e.node,e.node.active=!1}).call(function(){cc.find("Canvas").emit("UpdateOpenPanelCount")}).start())},t.prototype.onBtn_Resign=function(){var e=this;d.default.instance.playSFX(d.AudioRef.ClickButton),_.default.instance.resignCount<=0?h.default.platform.showTips("\u4eca\u65e5\u8865\u7b7e\u6b21\u6570\u5df2\u7528\u5b8c\uff0c\u660e\u65e5\u518d\u6765\u5427\uff01"):(h.default.platform.reportVideoEvent("Event_Resign",1),h.default.platform.showRewardAD(function(){v.default.instance.showPanel("EventRewardPanel").getComponent(b.default).setUpImageAndName(e.type,e.rewardId),e.onBtn_Close(),e.snowIconNode&&v.default.instance.playSnowFlakeCollectEffect(e.snowIconNode.convertToWorldSpaceAR(cc.Vec2.ZERO)),h.default.platform.reportVideoEvent("Event_Resign",2);var t=_.default.instance.calculateDayIndex(_.default.instance.getMonth(),e.dayIndex);_.default.instance.setDayStateMap(t,S.SignInState.CLAIMED),cc.director.emit(g.EventNames.UpdateState),_.default.instance.resignCount--}))},l([k(cc.Sprite)],t.prototype,"ItemImg",void 0),l([k(cc.Label)],t.prototype,"text_times",void 0),l([k(cc.Node)],t.prototype,"root",void 0),l([P],t)}(u.default);r.default=w,cc._RF.pop(),cc._RF.pop()},{}],EventRewardAllPanel:[function(e,t,o){"use strict";cc._RF.push(t,"7063288XTBC6K3uYb5xH32S","EventRewardAllPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"7063288XTBC6K3uYb5xH32S","EventRewardAllPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("BasePanel"),p=n("CommonData"),d=n("AudioManager"),f=n("UIManager"),h=n("UnlockData"),y=n("EventRewardItem"),m=n("EventRewardPanel"),g=n("EventManager"),v=n("SignInManager"),_=n("SignInEnum"),S=cc._decorator,b=S.ccclass,C=S.property,P=S.menu,k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rootNode=null,t.itemNode=null,t.itemPrefab=null,t.Animation_Title=null,t.Animation_Titleback=null,t.uiManager=null,t.btn_collection=null,t.dialogNode=null,t.dialogNodeLast=null,t.type=0,t.id=0,t.ifShowRiderUnlock=!1,t.riderInfo={type:h.UnlockType.RIDER,id:0},t.isLastMonth=!1,t}return s(t,e),t.prototype.onEnable=function(){this.uiManager=cc.Canvas.instance.node.getChildByName("UIRoot").getComponent(f.default),this.btn_collection.scale=0,this.dialogNode.scale=0,this.dialogNodeLast.scale=0,d.default.instance.playSFX(d.AudioRef.DrinkFinish),this.initEffect()},t.prototype.initEffect=function(){var e=this;this.Animation_Title&&(this.Animation_Title.setAnimation(0,"gxhd_start",!1),this.Animation_Title.setCompleteListener(function(){e.Animation_Title.setAnimation(0,"gxhd_idle",!0)})),this.Animation_Titleback&&(this.Animation_Titleback.setAnimation(0,"animation",!1),this.Animation_Titleback.setCompleteListener(function(){e.Animation_Titleback.setAnimation(0,"animation_loop",!0)}))},t.prototype.onDisable=function(){p.default.CurrentLevel%5==0&&(h.default.unlockArray.shift(),h.default.saveUnlockArray())},t.prototype.show=function(){var e=this;this.init();var t=this.rootNode;cc.director.emit("UpdateOpenPanelCount"),t&&(cc.Tween.stopAllByTarget(t),t.scale=.5,t.opacity=0,cc.tween(t).to(.2,{scale:1.1,opacity:200},{easing:"smooth"}).to(.2,{scale:1,opacity:255},{easing:"smooth"}).call(function(){e.showCollectionBtn()}).start())},t.prototype.showCollectionBtn=function(){this.btn_collection.active&&cc.tween(this.btn_collection).to(.5,{scale:1},{easing:"backOut"}).start(),this.isLastMonth?cc.tween(this.dialogNodeLast).delay(.6).to(.5,{scale:1},{easing:"backOut"}).start():cc.tween(this.dialogNode).delay(.4).to(.5,{scale:1},{easing:"backOut"}).start()},t.prototype.setUpAllRewards=function(e){for(var t=[],o=0;o<e.length;o++){var n=cc.instantiate(this.itemPrefab);n.parent=this.itemNode,n.getComponent(y.default).setIndex(e[o]),t.push(n)}this.setUpLayout(t)},t.prototype.setUpAllRewardsByInfo=function(e){this.isLastMonth=!0;for(var t=[],o=0;o<e.length;o++)if(e[o].type!==h.UnlockType.RIDER){var n=cc.instantiate(this.itemPrefab);n.parent=this.itemNode,n.getComponent(y.default).setInfo(e[o]),t.push(n)}else this.ifShowRiderUnlock=!0,this.riderInfo=e[o];this.setUpLayout(t)},t.prototype.setUpLayout=function(e){for(var t=e.length,o=Math.ceil(t/3),n=150*(o-1)/2,i=0;i<t;i++){var r=e[i],a=Math.floor(i/3),c=i%3,s=3;if(a===o-1){var l=t%3;0!==l&&(s=l)}var u=-200*(s-1)/2;r.x=u+200*c,r.y=n-150*a}},t.prototype.onBtn_Close=function(){var e=this;d.default.instance.playSFX(d.AudioRef.ClickButton);var t=this.rootNode;if(t){if(this.ifShowRiderUnlock){t.scale=0;for(var o=v.default.instance.getMonth()-1,n=v.default.instance.getRewardInfo(o),i=v.default.instance.getStartDay(o),r=v.default.instance.getEndDay(o),a=!0,c=i;c<=r;c++){var s=v.default.instance.calculateDayIndex(o,c),l=v.default.instance.DayStateMap[s];if(n[c].type===h.UnlockType.EVENT&&l!==_.SignInState.CLAIMED){a=!1;break}}if(a)return cc.find("Canvas").emit("UpdateOpenPanelCount"),this.node.active=!1,void g.default.instance.showPanel("EventRewardPanel").getComponent(m.default).setUpImageAndName(this.riderInfo.type,this.riderInfo.id)}cc.Tween.stopAllByTarget(t),t.scale=1,t.opacity=255,cc.tween(t).to(.2,{scale:0,opacity:200},{easing:"smooth"}).call(function(){t=e.node,e.node.active=!1}).call(function(){cc.find("Canvas").emit("UpdateOpenPanelCount")}).start()}},t.prototype.onBtn_Collection=function(){d.default.instance.playSFX(d.AudioRef.ClickButton),this.uiManager.showPanel("CollectionPanel")},l([C(cc.Node)],t.prototype,"rootNode",void 0),l([C(cc.Node)],t.prototype,"itemNode",void 0),l([C(cc.Prefab)],t.prototype,"itemPrefab",void 0),l([C(sp.Skeleton)],t.prototype,"Animation_Title",void 0),l([C(sp.Skeleton)],t.prototype,"Animation_Titleback",void 0),l([C(f.default)],t.prototype,"uiManager",void 0),l([C(cc.Node)],t.prototype,"btn_collection",void 0),l([C(cc.Node)],t.prototype,"dialogNode",void 0),l([C(cc.Node)],t.prototype,"dialogNodeLast",void 0),l([b,P("Event/EventRewardAllPanel")],t)}(u.default);r.default=k,cc._RF.pop(),cc._RF.pop()},{}],EventRewardItem:[function(e,t,o){"use strict";cc._RF.push(t,"af32b084JpIWZIuoaqZ3wVF","EventRewardItem");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"af32b084JpIWZIuoaqZ3wVF","EventRewardItem");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("UnlockData"),p=n("EventManager"),d=n("SignInManager"),f=cc._decorator,h=f.ccclass,y=f.property,m=f.menu,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemIcon=null,t.lightNode=null,t.index=0,t.type=u.UnlockType.EVENT,t.rewardId=0,t}return s(t,e),t.prototype.onEnable=function(){this.lightNode&&(this.lightNode.angle=0,cc.tween(this.lightNode).by(5,{angle:-360}).union().repeatForever().start())},t.prototype.onDisable=function(){},t.prototype.setIndex=function(e){this.index=e,this.setItem()},t.prototype.setInfo=function(e){switch(this.type=e.type,this.rewardId=e.id,e.type){case u.UnlockType.GOLD:this.type=u.UnlockType.GOLD,this.itemIcon.spriteFrame=p.default.instance.item_coin;break;case u.UnlockType.EVENT:this.type=u.UnlockType.EVENT,this.itemIcon.spriteFrame=p.default.instance.item_event;break;case u.UnlockType.CAP:this.type=u.UnlockType.CAP,this.loadIcon("Caps",""+e.id);break;case u.UnlockType.THEME:this.type=u.UnlockType.THEME;var t=e.id.split("_");this.loadIcon("Theme",t[0]+"/"+e.id,.6)}},t.prototype.loadIcon=function(e,t,o){var n=this;void 0===o&&(o=1);var i=cc.assetManager.getBundle(e);i?this.loadTexture(i,t,o):cc.assetManager.loadBundle(e,function(i,r){i?cc.error("\u52a0\u8f7dBundle"+e+"\u5931\u8d25:",i):n.loadTexture(r,t,o)})},t.prototype.loadTexture=function(e,t,o){var n=this;e.load(t,cc.Texture2D,function(e,i){e?console.error("\u52a0\u8f7d\u56fe\u7247"+t+"\u5931\u8d25:",e):n.isValid&&(n.itemIcon.spriteFrame=new cc.SpriteFrame(i),n.itemIcon.node.scale=o)})},t.prototype.setItem=function(){var e=d.default.instance.getRewardInfo(this.index%100);this.setInfo(e)},l([y(cc.Sprite)],t.prototype,"itemIcon",void 0),l([y(cc.Node)],t.prototype,"lightNode",void 0),l([h,m("Event/EventRewardItem")],t)}(cc.Component);r.default=g,cc._RF.pop(),cc._RF.pop()},{}],EventRewardPanel:[function(e,t,o){"use strict";cc._RF.push(t,"81f09ia61hFcqPK1fQ8txzC","EventRewardPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"81f09ia61hFcqPK1fQ8txzC","EventRewardPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("BasePanel"),p=n("CommonData"),d=n("AudioManager"),f=n("UIManager"),h=n("CollectionManager"),y=n("UnlockData"),m=n("Puzzle"),g=n("ThemeDataManager"),v=n("GoldDataManager"),_=n("const"),S=n("EventManager"),b=n("SignInManager"),C=cc._decorator,P=C.ccclass,k=C.property,w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ItemImg=null,t.ItemName=null,t.puzzle=null,t.Animation_Title=null,t.Animation_Titleback=null,t.uiManager=null,t.btn_change=null,t.btn_collection=null,t.light_back=null,t.icon_goldBig=null,t.icon_goldSmall=null,t.icon_goldTiny=null,t.type=0,t.id=0,t}return s(t,e),t.prototype.onEnable=function(){this.uiManager=cc.Canvas.instance.node.getChildByName("UIRoot").getComponent(f.default),this.btn_collection.scale=0,d.default.instance.playSFX(d.AudioRef.DrinkFinish),this.initEffect()},t.prototype.initEffect=function(){var e=this;this.Animation_Title&&(this.Animation_Title.setAnimation(0,"gxhd_start",!1),this.Animation_Title.setCompleteListener(function(){e.Animation_Title.setAnimation(0,"gxhd_idle",!0)})),this.Animation_Titleback&&(this.Animation_Titleback.setAnimation(0,"animation",!1),this.Animation_Titleback.setCompleteListener(function(){e.Animation_Titleback.setAnimation(0,"animation_loop",!0)})),this.light_back&&(this.light_back.angle=0,cc.tween(this.light_back).by(5,{angle:-360}).union().repeatForever().start())},t.prototype.onDisable=function(){p.default.CurrentLevel%5==0&&(y.default.unlockArray.shift(),y.default.saveUnlockArray())},t.prototype.show=function(){var e=this;this.init();var t=this.ItemImg.node.parent;cc.director.emit("UpdateOpenPanelCount"),t&&(cc.Tween.stopAllByTarget(t),t.scale=.5,t.opacity=0,cc.tween(t).to(.2,{scale:1.1,opacity:200},{easing:"smooth"}).to(.2,{scale:1,opacity:255},{easing:"smooth"}).call(function(){e.showCollectionBtn()}).start())},t.prototype.showCollectionBtn=function(){this.btn_collection.active&&cc.tween(this.btn_collection).to(.5,{scale:1},{easing:"backOut"}).start()},t.prototype.setUpImageAndName=function(e,t){var o=this;if("string"==typeof t){var n=[];t.indexOf("_")>=0?(n=t.split("_"),this.id=parseInt(n[0])):this.id=parseInt(t[0])}else"number"==typeof t&&(this.id=t);this.type=e;var i=null,r="";switch(this.puzzle.node.active=!1,this.btn_change.active=!1,this.btn_collection.active=!1,this.ItemImg.node.active=!0,e){case y.UnlockType.GOLD:switch(this.ItemImg.node.scale=2,t){case 100:this.ItemImg.spriteFrame=S.default.instance.item_coin,this.ItemName.string="\u91d1\u5e01x100",v.default.Gold+=100}break;case y.UnlockType.RIDER:r="Animals",i=cc.assetManager.getBundle(r),this.btn_collection.active=!0,i?this.loadTexture(i,Number(t),2):cc.assetManager.loadBundle(r,function(e,n){e?cc.error("\u52a0\u8f7dBundle"+r+"\u5931\u8d25:",e):o.loadTexture(n,Number(t),2)});break;case y.UnlockType.CAP:r="Caps",(i=cc.assetManager.getBundle(r))?this.loadTexture(i,Number(t),1):cc.assetManager.loadBundle(r,function(e,n){e?cc.error("\u52a0\u8f7dBundle"+r+"\u5931\u8d25:",e):o.loadTexture(n,Number(t),1)}),this.btn_change.active=!0,this.btn_collection.active=!0;break;case y.UnlockType.EVENT:this.ItemImg.spriteFrame=S.default.instance.item_event,this.ItemImg.node.scale=2;var a="\u96ea\u82b1";2==b.default.instance.getMonth()&&(a="\u9a6c\u8e44\u94c1"),this.ItemName.string=a;break;case y.UnlockType.THEME:this.ItemImg.node.active=!1;var c=t;g.default.setThemeUnlockMap(c,!0),this.puzzle.node.active=!0,n=t.split("_");var s=parseInt(n[0]),l=parseInt(n[1]);this.puzzle.setUp(s,!0,l),this.ItemName.string=g.default.ThemeNameMap[s],this.btn_change.active=!1,g.default.ThemeUnlockMap[s]&&(this.btn_change.active=!0,this.btn_collection.active=!0)}},t.prototype.loadTexture=function(e,t,o){var n=this;e.load(""+t,cc.Texture2D,function(e,i){e?console.error("\u52a0\u8f7d\u56fe\u7247"+t+"\u5931\u8d25:",e):(n.ItemImg.spriteFrame=new cc.SpriteFrame(i),1===o?(n.ItemImg.node.scale=2.5,n.ItemName.string=h.default.capNameMap[t]):2===o&&(n.ItemName.string=h.default.characterNameMap[t],n.ItemImg.node.scale=1,h.default.setCharacterUnlockMap(t,!0)))})},t.prototype.onBtn_Close=function(){var e=this;d.default.instance.playSFX(d.AudioRef.ClickButton);var t=this.ItemImg.node.parent;t&&(cc.Tween.stopAllByTarget(t),t.scale=1,t.opacity=255,cc.tween(t).to(.2,{scale:0,opacity:200},{easing:"smooth"}).call(function(){t=e.node,e.node.active=!1}).call(function(){cc.find("Canvas").emit("UpdateOpenPanelCount")}).start())},t.prototype.onBtn_Change=function(){d.default.instance.playSFX(d.AudioRef.ClickButton),this.type===y.UnlockType.CAP?p.default.SelectedCapIndex=this.id:this.type===y.UnlockType.RIDER?p.default.SelectedCharacterIndex=this.id:this.type===y.UnlockType.THEME&&(g.default.CurrentSelectedThemeIndex=this.id,cc.director.emit(_.EventNames.ChangeBg)),this.onBtn_Close()},t.prototype.onBtn_Collection=function(){d.default.instance.playSFX(d.AudioRef.ClickButton),this.uiManager.showPanel("CollectionPanel")},l([k(cc.Sprite)],t.prototype,"ItemImg",void 0),l([k(cc.Label)],t.prototype,"ItemName",void 0),l([k(m.default)],t.prototype,"puzzle",void 0),l([k(sp.Skeleton)],t.prototype,"Animation_Title",void 0),l([k(sp.Skeleton)],t.prototype,"Animation_Titleback",void 0),l([k(f.default)],t.prototype,"uiManager",void 0),l([k(cc.Node)],t.prototype,"btn_change",void 0),l([k(cc.Node)],t.prototype,"btn_collection",void 0),l([k(cc.Node)],t.prototype,"light_back",void 0),l([k(cc.SpriteFrame)],t.prototype,"icon_goldBig",void 0),l([k(cc.SpriteFrame)],t.prototype,"icon_goldSmall",void 0),l([k(cc.SpriteFrame)],t.prototype,"icon_goldTiny",void 0),l([P],t)}(u.default);r.default=w,cc._RF.pop(),cc._RF.pop()},{}],ExternalManager_BP:[function(e,t,o){"use strict";cc._RF.push(t,"4b736MrHUFObJMO9/0iKZAK","ExternalManager_BP");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"4b736MrHUFObJMO9/0iKZAK","ExternalManager_BP");var c=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var s=n("CommonData"),l=n("GameManager"),u=cc._decorator.ccclass,p=function(){function e(){}return e.showRewardAd=function(e){this.platform?this.platform.showRewardAD(e):e&&e()},e.showShare=function(e){this.platform?this.platform.showShare(e):e&&e()},e.vibrateShort=function(){this.platform&&this.CommonData.VibrationOn&&this.platform.vibrateShort()},e.backHome=function(){cc.director.loadScene("Main")},e.platform=l.default.platform,e.CommonData=s.default,c([u],e)}();r.default=p,cc._RF.pop(),cc._RF.pop()},{}],ExternalManager_ED:[function(e,t,o){"use strict";cc._RF.push(t,"ca9518/wL9KmL5exHEYna14","ExternalManager_ED");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"ca9518/wL9KmL5exHEYna14","ExternalManager_ED");var c=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var s=n("CommonData"),l=n("GameManager"),u=cc._decorator,p=u.ccclass,d=(u.property,function(){function e(){}return e.showRewardAd=function(e){this.platform?this.platform.showRewardAD(e):e&&e()},e.showShare=function(e){this.platform?this.platform.showShare(e):e&&e()},e.vibrateShort=function(){this.platform&&this.CommonData.VibrationOn&&this.platform.vibrateShort()},e.backHome=function(){cc.director.loadScene("Main")},e.platform=l.default.platform,e.CommonData=s.default,c([p],e)}());r.default=d,cc._RF.pop(),cc._RF.pop()},{}],FadeIn:[function(e,t,o){"use strict";cc._RF.push(t,"accb1dkqUdLO7WLyhlZHwBp","FadeIn");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"accb1dkqUdLO7WLyhlZHwBp","FadeIn");var a,c=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(i,"__esModule",{value:!0});var l=cc._decorator,u=l.ccclass,p=l.property,d=l.menu,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.duration=1,t.obj={val:0},t.tweenInstance=null,t}return c(t,e),t.prototype.fadeIn=function(){var e=this;this.node.active=!0;var t=this.node.getComponent(cc.Sprite);if(t){var o=t.getMaterial(0);o&&(o.setProperty("progress",0),this.obj.val=0,this.tweenInstance&&this.tweenInstance.stop(),this.tweenInstance=cc.tween(this.obj).to(this.duration,{val:1},{easing:"sineInOut",onUpdate:function(n){cc.isValid(e.node)&&cc.isValid(t)&&o.setProperty("progress",n.val)}}).start())}else console.warn("[FadeIn] component requires a cc.Sprite component attached to the node.")},t.prototype.fadeOutAndDisable=function(){var e=this,t=this.node.getComponent(cc.Sprite);if(t){var o=t.getMaterial(0);o&&(this.obj.val=1,this.tweenInstance=cc.tween(this.obj).delay(.3).to(this.duration-.1,{val:0},{easing:"quadOut",onUpdate:function(n){cc.isValid(e.node)&&cc.isValid(t)&&o.setProperty("progress",n.val)}}).call(function(){cc.isValid(e.node)&&(e.node.active=!1)}).start())}else console.warn("[FadeIn] component requires a cc.Sprite component attached to the node.")},s([p({tooltip:"\u52a8\u753b\u65f6\u957f (\u79d2)"})],t.prototype,"duration",void 0),s([u,d("Event/FadeIn")],t)}(cc.Component);i.default=f,cc._RF.pop(),cc._RF.pop()},{}],FeedTimer:[function(e,t,o){"use strict";cc._RF.push(t,"fe28bVoMdVMv6MGUMPvffx/","FeedTimer");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"fe28bVoMdVMv6MGUMPvffx/","FeedTimer");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=n("GameManager"),d=n("GameScene"),f=cc._decorator,h=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.timerLabel=null,t.totalTime=0,t.currentTime=0,t.isRunning=!1,t}return s(t,e),t.prototype.onEnable=function(){this.updateDisplay(),this.startTimer(120)},t.prototype.update=function(e){this.isRunning&&this.currentTime>0&&(this.currentTime-=e,this.currentTime<=0&&(this.currentTime=0,this.isRunning=!1),this.updateDisplay())},t.prototype.startTimer=function(e){this.totalTime=e,this.currentTime=e,this.isRunning=!0},t.prototype.stopTimer=function(){this.isRunning=!1},t.prototype.resetTimer=function(){this.currentTime=this.totalTime,this.isRunning=!1,this.updateDisplay()},t.prototype.updateDisplay=function(){var e=Math.floor(this.currentTime/60),t=Math.floor(this.currentTime%60),o=Math.floor(this.currentTime%1*100),n=e.toString().padStart(2,"0")+":"+t.toString().padStart(2,"0")+":"+o.toString().padStart(2,"0")+"\u540e\u6d88\u5931";this.timerLabel&&(this.timerLabel.string=n)},t.prototype.onBtn_GetFeedReward=function(){var e=this;this.node.opacity<255||(this.stopTimer(),cc.tween(this.node).to(.5,{opacity:0}).call(function(){p.default.showRewardPanel([0,1,0,0]),u.default.PropPump++,d.default.instance.updateUI(),e.node.destroy()}).start())},l([y(cc.Label)],t.prototype,"timerLabel",void 0),l([h],t)}(cc.Component);r.default=m,cc._RF.pop(),cc._RF.pop()},{}],FileManager_ED:[function(e,t,o){"use strict";cc._RF.push(t,"315212uVc5PD75afLmVuFcm","FileManager_ED");var n,i=t,r=o;cc._RF.push(i,"315212uVc5PD75afLmVuFcm","FileManager_ED"),Object.defineProperty(r,"__esModule",{value:!0}),function(e){e[e.DATA_URL=0]="DATA_URL",e[e.TEXT=1]="TEXT",e[e.BINARY=2]="BINARY",e[e.ARRAYBUFFER=3]="ARRAYBUFFER"}(n||(n={}));var a=function(){function e(){}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.openLocalFile=function(e,t){var o=document.getElementById("file_input");o||((o=document.createElement("input")).id="file_input",o.setAttribute("id","file_input"),o.setAttribute("type","file"),o.setAttribute("class","fileToUpload"),o.style.opacity="0",o.style.position="absolute",o.setAttribute("left","-999px"),document.body.appendChild(o)),e=e||".*",o.setAttribute("accept",e),o.onchange=function(){var e=o.files;if(e&&e.length>0){var n=e[0];t&&t(n)}},o.click()},e.prototype.readLocalFile=function(e,t,o){var i=new FileReader;switch(i.onload=function(){o&&(i.readyState==FileReader.DONE?o(i.result):o(null))},t){case n.DATA_URL:i.readAsDataURL(e);break;case n.TEXT:i.readAsText(e);break;case n.BINARY:i.readAsBinaryString(e);break;case n.ARRAYBUFFER:i.readAsArrayBuffer(e)}},e.prototype.saveForBrowser=function(e,t){if(cc.sys.isBrowser){console.log("\u6d4f\u89c8\u5668");var o=new Blob([e],{type:"application/json"}),n=document.createElement("a");n.download=t,n.innerHTML="Download File",null!=window.webkitURL?n.href=window.webkitURL.createObjectURL(o):(n.href=window.URL.createObjectURL(o),n.style.display="none",document.body.appendChild(n)),n.click()}},e}();r.default=a,cc._RF.pop(),cc._RF.pop()},{}],FileManager:[function(e,t,o){"use strict";cc._RF.push(t,"cb992XPkWJOU4fe4EBUhAFJ","FileManager");var n,i=t,r=o;cc._RF.push(i,"cb992XPkWJOU4fe4EBUhAFJ","FileManager"),Object.defineProperty(r,"__esModule",{value:!0}),function(e){e[e.DATA_URL=0]="DATA_URL",e[e.TEXT=1]="TEXT",e[e.BINARY=2]="BINARY",e[e.ARRAYBUFFER=3]="ARRAYBUFFER"}(n||(n={}));var a=function(){function e(){}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.openLocalFile=function(e,t){var o=document.getElementById("file_input");o||((o=document.createElement("input")).id="file_input",o.setAttribute("id","file_input"),o.setAttribute("type","file"),o.setAttribute("class","fileToUpload"),o.style.opacity="0",o.style.position="absolute",o.setAttribute("left","-999px"),document.body.appendChild(o)),e=e||".*",o.setAttribute("accept",e),o.onchange=function(){var e=o.files;if(e&&e.length>0){var n=e[0];t&&t(n)}},o.click()},e.prototype.readLocalFile=function(e,t,o){var i=new FileReader;switch(i.onload=function(){o&&(i.readyState==FileReader.DONE?o(i.result):o(null))},t){case n.DATA_URL:i.readAsDataURL(e);break;case n.TEXT:i.readAsText(e);break;case n.BINARY:i.readAsBinaryString(e);break;case n.ARRAYBUFFER:i.readAsArrayBuffer(e)}},e.prototype.saveForBrowser=function(e,t){if(cc.sys.isBrowser){var o=new Blob([e],{type:"application/json"}),n=document.createElement("a");n.download=t,n.innerHTML="Download File",null!=window.webkitURL?n.href=window.webkitURL.createObjectURL(o):(n.href=window.URL.createObjectURL(o),n.style.display="none",document.body.appendChild(n)),n.click()}},e}();r.default=a,cc._RF.pop(),cc._RF.pop()},{}],FinishEffectDataManager:[function(e,t,o){"use strict";cc._RF.push(t,"add27CXu2RNy5wPe0WYw0ep","FinishEffectDataManager");var n=e,i=t,r=o;cc._RF.push(i,"add27CXu2RNy5wPe0WYw0ep","FinishEffectDataManager"),Object.defineProperty(r,"__esModule",{value:!0});var a=n("CommonData"),c=n("CollectionData"),s=n("SignInManager"),l=function(){function e(){}return Object.defineProperty(e,"FinishEffectUnlockPriceMap",{get:function(){return 1!=s.default.instance.getMonth()?e.finishEffectUnlockPriceMap[9]=6666:2!=s.default.instance.getMonth()&&(e.finishEffectUnlockPriceMap[10]=6666),e.finishEffectUnlockPriceMap},enumerable:!1,configurable:!0}),Object.defineProperty(e,"FinishEffectUnlockMap",{get:function(){var t=a.default.getStorage("finishEffectUnlockMap");if(t){var o=JSON.parse(t);for(var n in o)e._finishEffectUnlockMap[n]=o[n]}return e._finishEffectUnlockMap},enumerable:!1,configurable:!0}),e.setFinishEffectUnlockMap=function(t,o){var n=a.default.getStorage("finishEffectUnlockMap");n&&(e._finishEffectUnlockMap=JSON.parse(n)),e._finishEffectUnlockMap[t]=o,e.saveFinishEffectUnlockMap()},e.saveFinishEffectUnlockMap=function(){var t=JSON.stringify(e._finishEffectUnlockMap);a.default.setStorage("finishEffectUnlockMap",t)},e.unlockAllFinishEffects=function(){for(var t in e._finishEffectUnlockMap)e._finishEffectUnlockMap[t]=!0;e.saveFinishEffectUnlockMap()},Object.defineProperty(e,"CurrentFinishEffectIndex",{get:function(){var t=a.default.getStorage("currentFinishEffectIndex");return t&&(e._currentFinishEffectIndex=parseInt(t)),e._currentFinishEffectIndex},set:function(t){e._currentFinishEffectIndex=t,a.default.setStorage("currentFinishEffectIndex",t.toString())},enumerable:!1,configurable:!0}),e._currentFinishEffectIndex=1,e.finishEffectUnlockPriceMap=c.finishEffectUnlockPriceMap,e.FinishEffectNameMap=c.FinishEffectNameMap,e._finishEffectUnlockMap=c._finishEffectUnlockMap,e}();r.default=l,cc._RF.pop(),cc._RF.pop()},{}],FinishEffectData:[function(e,t,o){"use strict";cc._RF.push(t,"e3443fx/r9P7aP0N11GPgat","FinishEffectData");var n=t,i=o;cc._RF.push(n,"e3443fx/r9P7aP0N11GPgat","FinishEffectData"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(){},cc._RF.pop(),cc._RF.pop()},{}],FinishParticle:[function(e,t,o){"use strict";cc._RF.push(t,"2a0cbjJvg9PpK7AhmFndE1U","FinishParticle");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"2a0cbjJvg9PpK7AhmFndE1U","FinishParticle");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("Cup"),d=n("CupMgr"),f=n("const"),h=n("FinishEffectDataManager"),y=n("BundleManager"),m=[7,8],g=[10],v={1:"finishParticle",2:"leaf",3:"star",4:"butterfly",5:"water",6:"diamond",7:"finishSpine",8:"finishSpine",9:"snow",10:"fireworkParticle"},_=cc._decorator,S=_.ccclass,b=(_.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.finishPrefab=null,t.fireworkSpinePrefab=null,t.finishiAniPool=[],t}var o;return s(t,e),o=t,t.getInstance=function(){return this.instance?this.instance:null},t.prototype.onLoad=function(){o.instance=this,this.loadAsset()},t.prototype.loadAsset=function(e){var t=this,o=h.default.CurrentFinishEffectIndex,n=v[o];if(n){var i="EffectPrefab";(m.includes(o)||g.includes(o))&&(i="SpineEffectPrefab"),y.default.getInstance().loadBundle(i,function(i,r){i?cc.error(i):r.load(n,cc.Prefab,function(n,i){n?cc.error(n):(t.finishPrefab=i,10===o?r.load("fireworkSpine",cc.Prefab,function(o,n){t.fireworkSpinePrefab=n,e&&e()}):e&&e())})})}},t.prototype.getfinishiAniFromPool=function(){if(this.finishiAniPool.length>0){var e=this.finishiAniPool.pop();return e.active=!0,e}return this.finishPrefab?cc.instantiate(this.finishPrefab):(cc.warn("No prefab loaded for finish animation"),null)},t.prototype.putFinishiToPool=function(e){e&&cc.isValid(e)&&(e.active=!1,e.parent=null,this.finishiAniPool.push(e))},t.prototype.playFinishSpineAnimation=function(e){var t=this,o=this.getfinishiAniFromPool(),n=o.getComponent(sp.Skeleton);o.parent=e.node.parent,o.zIndex=1e3,o.scale=e.node.scale,o.setPosition(e.node.position.x,e.node.position.y-.5*e.node.height+5),7==h.default.CurrentFinishEffectIndex?n.setAnimation(0,"pz",!1):8==h.default.CurrentFinishEffectIndex&&n.setAnimation(0,"gm",!1),n.setCompleteListener(function(){e.node.parent==d.default.getInstance().node&&(d.default.getInstance().finishedWater+=4,cc.director.emit(f.EventNames.Rise,d.default.getInstance().finishedWater/d.default.getInstance().totalWater)),t.putFinishiToPool(o)})},t.prototype.playFireworkAnimation=function(e){if(this.fireworkSpinePrefab){var t=cc.instantiate(this.fireworkSpinePrefab),o=t.getComponent(sp.Skeleton);t.parent=e.node.parent,t.zIndex=1e3,t.scale=e.node.scale,t.setPosition(e.node.position.x,e.node.position.y+.5*e.node.height),o.setAnimation(0,"firework",!1),u.default.instance.playSFX(u.AudioRef.FireWork),o.setCompleteListener(function(){t.destroy()})}else cc.warn("fireworkSpinePrefab not loaded")},t.prototype.playFinishAnimation=function(e){var t=this;if(m.includes(h.default.CurrentFinishEffectIndex))this.playFinishSpineAnimation(e);else{var o=0,n=0,i=0;cc.director.getScene().name==f.SceneNames.Game?(o=d.default.getInstance().unlockNode.x,n=d.default.getInstance().unlockNode.y,i=cc.v2(e.node.position.x-o,e.node.position.y-n).mag()/1e3):cc.director.getScene().name==f.SceneNames.Challenge&&(o=0,n=881.25,i=cc.v2(e.node.position.x-o,e.node.position.y-n).mag()/1e3);var r=this.getfinishiAniFromPool(),a=this.getfinishiAniFromPool(),c=this.getfinishiAniFromPool(),s=this.getfinishiAniFromPool(),l=r.getComponent(cc.ParticleSystem),u=a.getComponent(cc.ParticleSystem),y=c.getComponent(cc.ParticleSystem),v=s.getComponent(cc.ParticleSystem);if(r.scale=e.node.scale,a.scale=e.node.scale,c.scale=e.node.scale,s.scale=e.node.scale,1==h.default.CurrentFinishEffectIndex){var _=p.finishStart[e.info.colorIds[0]],S=p.finishEnd[e.info.colorIds[0]];r.getComponent(cc.ParticleSystem).startColor=(new cc.Color).fromHEX(_),a.getComponent(cc.ParticleSystem).startColor=(new cc.Color).fromHEX(_),c.getComponent(cc.ParticleSystem).startColor=(new cc.Color).fromHEX(_),s.getComponent(cc.ParticleSystem).startColor=(new cc.Color).fromHEX(_),r.getComponent(cc.ParticleSystem).endColor=(new cc.Color).fromHEX(S),a.getComponent(cc.ParticleSystem).endColor=(new cc.Color).fromHEX(S),c.getComponent(cc.ParticleSystem).endColor=(new cc.Color).fromHEX(S),s.getComponent(cc.ParticleSystem).endColor=(new cc.Color).fromHEX(S)}r.parent=e.node.parent,r.zIndex=1e3,a.parent=e.node.parent,a.zIndex=-1,c.parent=e.node.parent,c.zIndex=1e3,s.parent=e.node.parent,s.zIndex=-1;for(var b=[],C=[],P=[],k=[],w=[],I=0,T=r.getComponentsInChildren(cc.ParticleSystem);I<T.length;I++){var A=T[I];b.push(A),P.push(A)}for(var O=0,R=c.getComponentsInChildren(cc.ParticleSystem);O<R.length;O++)A=R[O],b.push(A),k.push(A);for(var N=0,M=a.getComponentsInChildren(cc.ParticleSystem);N<M.length;N++)A=M[N],C.push(A),P.push(A);for(var L=0,E=s.getComponentsInChildren(cc.ParticleSystem);L<E.length;L++)A=E[L],C.push(A),k.push(A);b.push(l),b.push(y),C.push(u),C.push(v),P.push(l),P.push(u),k.push(y),k.push(v),w.push(l),w.push(y),w.push(u),w.push(v);var F=b.concat(C);r.setPosition(e.node.position.x-.6*e.node.width,e.node.position.y-.45*e.node.height),a.setPosition(e.node.position.x-.6*e.node.width,e.node.position.y-.45*e.node.height),c.setPosition(e.node.position.x+.6*e.node.width,e.node.position.y-.45*e.node.height),s.setPosition(e.node.position.x+.6*e.node.width,e.node.position.y-.45*e.node.height);for(var x=r.getComponent(cc.ParticleSystem).emissionRate,D=0;D<F.length;D++)F[D].emissionRate=x,F[D].node.opacity=0;var B=cc.tween;if(cc.director.getScene().name===f.SceneNames.Game&&d.default.getInstance().isCollecting()&&e.node.parent==d.default.getInstance().node&&!g.includes(h.default.CurrentFinishEffectIndex)||cc.director.getScene().name===f.SceneNames.Challenge){B(r).to(.05,{opacity:255}).bezierTo(.4*.9,cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y-.2*e.node.height)).call(function(){for(var e=0,t=b;e<t.length;e++)t[e].emissionRate=0;for(var o=0;o<r.childrenCount;o++){var n=r.children[o].getComponent(cc.MotionStreak);n&&(n.node.opacity=0),(n=c.children[o].getComponent(cc.MotionStreak))&&(n.node.opacity=0)}}).bezierTo(.225,cc.v2(e.node.position.x,e.node.position.y+.1*e.node.height),cc.v2(e.node.position.x,e.node.position.y-.2*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y+.1*e.node.height)).call(function(){for(var e=0,t=b;e<t.length;e++){t[e].emissionRate=x;for(var o=0;o<r.childrenCount;o++){var n=r.children[o].getComponent(cc.MotionStreak);n&&(n.reset(),n.node.opacity=255),(n=c.children[o].getComponent(cc.MotionStreak))&&(n.reset(),n.node.opacity=255)}}}).bezierTo(.4*.9,cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y+.6*e.node.height)).call(function(){for(var e=0,t=F;e<t.length;e++)t[e].emissionRate=x}).bezierTo(i,cc.v2(e.node.x,n-.5*(n-e.node.y)),cc.v2(o-.5*(o-e.node.x),n),cc.v2(o,n)).call(function(){e.node.parent==d.default.getInstance().node&&(d.default.getInstance().finishedWater+=4,cc.director.emit(f.EventNames.Rise,d.default.getInstance().finishedWater/d.default.getInstance().totalWater));for(var t=0,o=F;t<o.length;t++)o[t].emissionRate=0;cc.director.getScene().name===f.SceneNames.Challenge&&cc.director.emit(f.EventNames.playFinishSFX)}).delay(1).call(function(){for(var e=0,o=F;e<o.length;e++){var n=o[e];n.emissionRate=x,n.node.opacity=0}for(var i=0,r=w;i<r.length;i++){var a=r[i];t.putFinishiToPool(a.node)}}).start();var W=cc.tween().to(.05,{opacity:255}).bezierTo(.4*.9,cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y-.2*e.node.height)).bezierTo(.225,cc.v2(e.node.position.x,e.node.position.y+.1*e.node.height),cc.v2(e.node.position.x,e.node.position.y-.2*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y+.1*e.node.height)).bezierTo(.4*.9,cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y+.6*e.node.height)).bezierTo(i,cc.v2(e.node.x,n-.5*(n-e.node.y)),cc.v2(o-.5*(o-e.node.x),n),cc.v2(o,n)).delay(1).start(),U=cc.tween().to(.05,{opacity:255}).bezierTo(.4*.9,cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y-.2*e.node.height)).bezierTo(.225,cc.v2(e.node.position.x,e.node.position.y+.1*e.node.height),cc.v2(e.node.position.x,e.node.position.y-.2*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y+.1*e.node.height)).bezierTo(.4*.9,cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y+.6*e.node.height)).bezierTo(i,cc.v2(e.node.x,n-.5*(n-e.node.y)),cc.v2(o-.5*(o-e.node.x),n),cc.v2(o,n)).delay(1).start(),j=cc.tween().to(.05,{opacity:255});W.clone(a).start(),U.clone(c).start(),U.clone(s).start();for(var G=0,H=F;G<H.length;G++){var z=H[G];z.node!==r&&z.node!==c&&z.node!==a&&z.node!==s&&j.clone(z.node).start()}}else{B(r).to(.05,{opacity:255}).bezierTo(.4*.9,cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y-.2*e.node.height)).call(function(){for(var e=0,t=b;e<t.length;e++)t[e].emissionRate=0;for(var o=0;o<r.childrenCount;o++){var n=r.children[o].getComponent(cc.MotionStreak);n&&(n.node.opacity=0),(n=c.children[o].getComponent(cc.MotionStreak))&&(n.node.opacity=0)}}).bezierTo(.225,cc.v2(e.node.position.x,e.node.position.y+.1*e.node.height),cc.v2(e.node.position.x,e.node.position.y-.2*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y+.1*e.node.height)).call(function(){for(var e=0,t=b;e<t.length;e++){t[e].emissionRate=x;for(var o=0;o<r.childrenCount;o++){var n=r.children[o].getComponent(cc.MotionStreak);n&&(n.reset(),n.node.opacity=255),(n=c.children[o].getComponent(cc.MotionStreak))&&(n.reset(),n.node.opacity=255)}}}).bezierTo(.4*.9,cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y+.5*e.node.height)).call(function(){for(var o=0,n=F;o<n.length;o++)n[o].emissionRate=0;for(var i=0;i<r.childrenCount;i++){var l=r.children[i].getComponent(cc.MotionStreak);l&&(l.node.opacity=0),(l=c.children[i].getComponent(cc.MotionStreak))&&(l.node.opacity=0),(l=s.children[i].getComponent(cc.MotionStreak))&&(l.node.opacity=0),(l=a.children[i].getComponent(cc.MotionStreak))&&(l.node.opacity=0)}10==h.default.CurrentFinishEffectIndex&&t.playFireworkAnimation(e)}).delay(1).call(function(){for(var e=0,o=F;e<o.length;e++){var n=o[e];n.emissionRate=x,n.node.opacity=0}for(var i=0,l=w;i<l.length;i++){var u=l[i];t.putFinishiToPool(u.node)}for(var p=0;p<r.childrenCount;p++){var d=r.children[p].getComponent(cc.MotionStreak);d&&(d.node.opacity=255),(d=c.children[p].getComponent(cc.MotionStreak))&&(d.node.opacity=255),(d=s.children[p].getComponent(cc.MotionStreak))&&(d.node.opacity=255),(d=a.children[p].getComponent(cc.MotionStreak))&&(d.node.opacity=255)}}).start(),W=cc.tween().to(.05,{opacity:255}).bezierTo(.4*.9,cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y-.2*e.node.height)).bezierTo(.225,cc.v2(e.node.position.x,e.node.position.y+.1*e.node.height),cc.v2(e.node.position.x,e.node.position.y-.2*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y+.1*e.node.height)).bezierTo(.4*.9,cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y+.5*e.node.height)).delay(1).start(),U=cc.tween().to(.05,{opacity:255}).bezierTo(.4*.9,cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y-.35*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y-.2*e.node.height)).bezierTo(.225,cc.v2(e.node.position.x,e.node.position.y+.1*e.node.height),cc.v2(e.node.position.x,e.node.position.y-.2*e.node.height),cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y+.1*e.node.height)).bezierTo(.4*.9,cc.v2(e.node.position.x+.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y+.25*e.node.height),cc.v2(e.node.position.x-.6*e.node.width,e.node.position.y+.5*e.node.height)).delay(1).start(),j=cc.tween().to(.05,{opacity:255}),W.clone(a).start(),U.clone(c).start(),U.clone(s).start();for(var V=0,q=F;V<q.length;V++){var X=q[V];X.node!==r&&X.node!==c&&X.node!==a&&X.node!==s&&j.clone(X.node).start()}}}},o=l([S],t)}(cc.Component));r.default=b,cc._RF.pop(),cc._RF.pop()},{}],FragileCup:[function(e,t,o){"use strict";cc._RF.push(t,"0480bqB8rBMiLzmBlziWoD9","FragileCup");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"0480bqB8rBMiLzmBlziWoD9","FragileCup");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("const"),p=n("Cup"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.maxBreakRound=3,t.crackNode=null,t.currentBreakRound=0,t}return s(t,e),t.prototype.onEnable=function(){cc.director.on(u.EventNames.CupFinish,this.onCupFinish,this),cc.director.on(u.EventNames.ResumeAllBombs,this.onRevive,this),this.updateCrackVisual()},t.prototype.onDisable=function(){cc.director.off(u.EventNames.CupFinish,this.onCupFinish,this),cc.director.off(u.EventNames.ResumeAllBombs,this.onRevive,this)},t.prototype.onCupFinish=function(){this.currentState!==p.CupState.Finished&&this.currentState!==p.CupState.ReadyToBeCollected&&(this.currentBreakRound++,this.updateCrackVisual(),this.currentBreakRound>=this.maxBreakRound&&this.breakCup())},t.prototype.onRevive=function(){this.currentBreakRound=0,this.updateCrackVisual()},t.prototype.updateCrackVisual=function(){if(this.crackNode)if(this.currentBreakRound<=0)this.crackNode.active=!1,this.crackNode.scaleY=0;else{this.crackNode.active=!0;var e=Math.min(this.currentBreakRound/this.maxBreakRound,1);this.crackNode.scaleY=e}},t.prototype.breakCup=function(){cc.director.emit(u.EventNames.PauseAllBombs),this.scheduleOnce(function(){cc.director.emit(u.EventNames.Explode)},.5)},l([h({tooltip:"\u8fbe\u5230\u6b64\u8f6e\u6570\u65f6\u7834\u788e\uff08\u6bcf\u5f53\u6709\u5176\u4ed6\u74f6\u5b50\u5b8c\u6210\u7b97\u4e00\u8f6e\uff09"})],t.prototype,"maxBreakRound",void 0),l([h({type:cc.Node,tooltip:"\u8868\u73b0\u88c2\u7eb9\u7684\u8282\u70b9\uff0c\u4f1a\u968f\u7740\u8f6e\u6570\u589e\u52a0scaleY"})],t.prototype,"crackNode",void 0),l([f],t)}(p.default);r.default=y,cc._RF.pop(),cc._RF.pop()},{}],GameClubPanel:[function(e,t,o){"use strict";cc._RF.push(t,"6e127R76xRA4aWFCUZ84xnF","GameClubPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"6e127R76xRA4aWFCUZ84xnF","GameClubPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=n("const"),d=n("GameManager"),f=n("BasePanel"),h=n("config"),y=n("CollectionManager"),m=n("DataManager"),g=cc._decorator,v=g.ccclass,_=g.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Btn_Join=null,t.Btn_Reward=null,t.Mask=null,t.Panel=null,t.ifCreatedBtn=!1,t}return s(t,e),t.prototype.onLoad=function(){window.wx&&h.currentPlatform===h.platformEnum.wechat&&window.wx.onShow(this.getGameClubData)},t.prototype.onDestroy=function(){window.wx&&h.currentPlatform===h.platformEnum.wechat&&window.wx.offShow(this.getGameClubData)},t.prototype.onEnable=function(){var e=this,t=this;!u.default.IfJoinGameClub||u.default.IfGetGameClubReward?(d.default.createGameClubButton(this.Btn_Join),this.ifCreatedBtn=!0,this.scheduleOnce(function(){e.ifCreatedBtn&&d.default.showGameClubButton()},0),d.default.platform.getGameClubData(function(e){var o=e.encryptedData,n=e.iv;window.wx.request({url:"https://api.flysheeep.com/api/expro/ecpm_wx_decrypt",header:{"Content-Type":"application/json","x-appid":u.default.appId},data:{appid:u.default.appId,openid:u.default.openId,encrypted_data:o,iv:n},method:"POST",success:function(e){var o=e.data.data.raw_string,n=JSON.parse(o);u.default.IfJoinGameClub=0!==n.dataList[0].value,u.default.IfJoinGameClub&&!1===u.default.IfGetGameClubReward&&(t.Btn_Reward.active=!0,d.default.destroyGameClubButton(),t.ifCreatedBtn=!1)},fail:function(){}})})):this.Btn_Reward.active=!0},t.prototype.getGameClubData=function(){var e=this;d.default.platform.getGameClubData(function(t){var o=t.encryptedData,n=t.iv;window.wx.request({url:"https://api.flysheeep.com/api/expro/ecpm_wx_decrypt",header:{"Content-Type":"application/json","x-appid":u.default.appId},data:{appid:u.default.appId,openid:u.default.openId,encrypted_data:o,iv:n},method:"POST",success:function(t){var o=t.data.data.raw_string,n=JSON.parse(o);u.default.IfJoinGameClub=0!==n.dataList[0].value,u.default.IfJoinGameClub&&!1===u.default.IfGetGameClubReward&&(e.Btn_Reward.active=!0,d.default.destroyGameClubButton(),e.ifCreatedBtn=!1)},fail:function(){}})})},t.prototype.onBtn_HowToJoin=function(){this.Mask.active=!0;var e=this.Panel;e.active=!0,this.ifCreatedBtn&&d.default.hideGameClubButton(),e&&(cc.Tween.stopAllByTarget(e),e.scale=.5,e.opacity=220,cc.tween(e).to(.3,{scale:1,opacity:255},{easing:"backOut"}).start())},t.prototype.onBtn_Close=function(){this.hide()},t.prototype.hide=function(){e.prototype.hide.call(this),this.ifCreatedBtn&&d.default.destroyGameClubButton(),cc.director.emit(p.EventNames.CreateMainGameClubButton)},t.prototype.onBtn_Reward=function(){u.default.IfGetGameClubReward=!0,this.hide();var e=cc.assetManager.getBundle("Panels");e?e.load("RewardPanel",cc.Prefab,function(e,t){if(e)return null;var o=cc.instantiate(t);o.parent=cc.find("Canvas");var n=o.getComponent("RewardPanel");y.default.setCapUnlockMap(15,!0),m.default.tryUpdateUserData(),n.initGameClubReward(),n.show()}):cc.assetManager.loadBundle("Panels",function(t){if(t)return null;e.load("RewardPanel",cc.Prefab,function(e,t){if(e)return null;var o=cc.instantiate(t);o.parent=cc.find("Canvas");var n=o.getComponent("RewardPanel");y.default.setCapUnlockMap(15,!0),m.default.tryUpdateUserData(),n.initGameClubReward(),n.show()})})},t.prototype.onBtn_ClosePanel=function(){var e=this,t=this.Panel;if(t){if(1!==t.scale)return;cc.Tween.stopAllByTarget(t),t.scale=1,t.opacity=255,cc.tween(t).to(.4,{scale:0,opacity:0},{easing:"backIn"}).call(function(){t.active=!1,e.Mask.active=!1,e.ifCreatedBtn&&d.default.showGameClubButton()}).start()}},l([_(cc.Node)],t.prototype,"Btn_Join",void 0),l([_(cc.Node)],t.prototype,"Btn_Reward",void 0),l([_(cc.Node)],t.prototype,"Mask",void 0),l([_(cc.Node)],t.prototype,"Panel",void 0),l([v],t)}(f.default);r.default=S,cc._RF.pop(),cc._RF.pop()},{}],GameLosePanel:[function(e,t,o){"use strict";cc._RF.push(t,"6c230K+SzpK+qWZDcAgt/Ta","GameLosePanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"6c230K+SzpK+qWZDcAgt/Ta","GameLosePanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("CommonData"),d=n("CupMgr"),f=n("const"),h=n("GameManager"),y=n("GoldDataManager"),m=n("DataNexusEnum"),g=n("DataNexusSDK"),v=n("StaminaManager"),_=n("GameScene"),S=n("BasePanel"),b=cc._decorator,C=b.ccclass,P=b.property,k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Animation_Title=null,t.text=null,t.btn_Revive=null,t.btn_ReviveFree=null,t}return s(t,e),t.prototype.onEnable=function(){g.default.instance.trackAdPlacementShow(m.RewardADEvent.REVIVE);var e={level_id:p.default.CurrentLevel,ad_cnt:d.default.getInstance().currentLevelAdWatchedCount};e.duration=_.default.instance.getLevelTime(),e.game_mode=cc.director.getScene().name,e.stamina_value=v.default.instance.energy,e.coin_amount=y.default.Gold,g.default.instance.trackLevelLose(e),u.default.instance.playSFX(u.AudioRef.GameOver),this.initTitle()},t.prototype.initPanel=function(e){1===e?(p.default.WinStreak>0?this.text.string="\u8fde\u80dc\u5df2\u4e2d\u65ad":this.text.string="",this.btn_Revive.active=!1):2===e&&(this.text.string="\u8fde\u80dc\u5c06\u88ab\u4e2d\u65ad\uff0c\u8981\u590d\u6d3b\u4fdd\u6301\u8fde\u80dc\u5417\uff1f",this.btn_Revive.active=!0,this.btn_ReviveFree.active=!1,p.default.ifFirstRevive&&(this.btn_ReviveFree.active=!0,this.text.string="\u8fde\u80dc\u5c06\u88ab\u4e2d\u65ad\uff0c\u9996\u6b21\u590d\u6d3b\u514d\u8d39",this.btn_Revive.active=!1))},t.prototype.initTitle=function(){var e=this;this.Animation_Title&&(this.Animation_Title.setAnimation(0,"start",!1),this.Animation_Title.setCompleteListener(function(){e.Animation_Title.setAnimation(0,"idle",!0)}))},t.prototype.onBtn_Restart=function(){if(cc.director.getScene().name==f.SceneNames.Game){var e={level_id:p.default.CurrentLevel,ad_cnt:d.default.getInstance().currentLevelAdWatchedCount};e.duration=Math.round((Date.now()-this.startTime)/1e3),e.game_mode=cc.director.getScene().name,e.stamina_value=v.default.instance.energy,e.coin_amount=y.default.Gold,g.default.instance.trackLevelPass(e)}u.default.instance.playSFX(u.AudioRef.ClickButton),p.default.autoPlaying?cc.director.loadScene(cc.director.getScene().name):v.default.instance.energy<=0?cc.director.getScene().name===f.SceneNames.Game&&_.default.instance.uiManager.showPanel("EnergyPanel"):(p.default.ifTest||cc.director.getScene().name!==f.SceneNames.Game&&cc.director.getScene().name!==f.SceneNames.GameLong||v.default.instance.consume(1),h.default.platform.reportPageEvent("RestartGame"),cc.director.getScene().name===f.SceneNames.Game&&(h.default.platform.reportAdPointEvent("WinProgress_BreakFirst",p.default.WinStreak),p.default.WinStreak=0),cc.director.loadScene(cc.director.getScene().name))},t.prototype.onBtn_Revive=function(){var e=this;u.default.instance.playSFX(u.AudioRef.ClickButton),g.default.instance.trackAdClick(m.RewardADEvent.REVIVE),h.default.platform.reportVideoEvent("GameOverPage_reviveBtn",1),h.default.platform.showRewardAD(function(){h.default.platform.reportVideoEvent("GameOverPage_reviveBtn",2),g.default.instance.trackAdVideoFinish(m.RewardADEvent.REVIVE),cc.director.emit(f.EventNames.ResumeAllBombs),p.default.ifFirstRevive=!1,e.hide()})},t.prototype.onBtn_ReviveFree=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),this.hide(),p.default.ifFirstRevive=!1,cc.director.emit(f.EventNames.ResumeAllBombs)},l([P(sp.Skeleton)],t.prototype,"Animation_Title",void 0),l([P(cc.Label)],t.prototype,"text",void 0),l([P(cc.Node)],t.prototype,"btn_Revive",void 0),l([P(cc.Node)],t.prototype,"btn_ReviveFree",void 0),l([C],t)}(S.default);r.default=k,cc._RF.pop(),cc._RF.pop()},{}],GameManager_17:[function(e,t,o){"use strict";cc._RF.push(t,"262b16ZmZlOj7GfL8wUjaCv","GameManager_17");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"262b16ZmZlOj7GfL8wUjaCv","GameManager_17");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("CupMgr_17"),d=n("CommonData"),f=n("UIManager"),h=n("PropPanel"),y=n("GameManager"),m=n("config"),g=n("AutoPlayerLong"),v=cc._decorator,_=v.ccclass,S=v.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cupMgr=null,t.uiManager=null,t.autoPlayer=null,t.text_level=null,t.text_actionNum=null,t.text_propCount=[],t.propBtns=[],t.propEffects=[],t.root_Tips=null,t.root_Tips_finger=null,t.top=null,t.text_Tips=null,t.bottom=null,t.TestNode=null,t.btn_Setting=null,t.btn_AutoPlay=null,t.btn_AutoPlayLevel=null,t.startTime=0,t.tipsStay="",t.propPanel=null,t.text_AutoPlay=null,t.clickTimeAutoPlay=0,t}var o;return s(t,e),o=t,Object.defineProperty(t,"instance",{get:function(){return this._instance},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){var e=this,t=cc.find("Canvas").getComponent(cc.Canvas);d.default.ratio<2.23?(t.fitHeight=!0,t.fitWidth=!1):(t.fitHeight=!1,t.fitWidth=!0),"windows"===d.default.platform&&(t.fitHeight=!0,t.fitWidth=!1),o._instance=this,cc.director.on("level_finished_long",this.onFinishOneLevel,this),cc.director.on("water_drop",this.onPourAction,this),cc.director.on("use_prop",function(t){e.useProp(t)},this),cc.director.on("load_level",this.updateUI,this),cc.director.on("load_level",this.opening,this),cc.director.on("color_changed",this.updateUI,this),u.default.instance.playBGM(u.AudioRef.LevelBGM,!0),d.default.mode="challenge"},t.prototype.onDestroy=function(){var e=this;cc.director.off("level_finished_long",this.onFinishOneLevel,this),cc.director.off("water_drop",this.onPourAction,this),cc.director.off("use_prop",function(t){e.useProp(t)},this),cc.director.off("load_level",this.updateUI,this),cc.director.off("load_level",this.opening,this),cc.director.off("color_changed",this.updateUI,this)},t.prototype.start=function(){y.default.platform.reportPageEvent("Startlevel"),this.cupMgr=p.default.getInstance(),this.autoPlayer=this.node.getComponent(g.default),this.text_level.string="\u7b2c "+d.default.LevelChallenge+" \u5173",this.startTime=Date.now(),this.TestNode.active=d.default.ifTest,m.currentPlatform===m.platformEnum.toutiao?(this.btn_AutoPlay.active=!1,this.btn_AutoPlayLevel.active=!0):m.currentPlatform===m.platformEnum.wechat&&(this.btn_AutoPlay.active=!0,this.btn_AutoPlayLevel.active=!0)},t.prototype.opening=function(){cc.tween(this.bottom).to(.6,{y:-835},{easing:"sineIn"}).start(),cc.tween(this.top).to(.6,{y:835},{easing:"sineIn"}).call(function(){cc.director.emit("load_level_finish")}).start(),cc.tween(p.default.getInstance().node).to(.4,{x:0},{easing:"sineIn"}).start()},t.prototype.updateUI=function(){this.updateCoutnersUI(),this.updateButtonsUI(),this.updateTipsUI()},t.prototype.updateButtonsUI=function(){this.bottom.active=!0,p.default.getInstance().ifDeadLock()&&(p.default.getInstance().hasLockedCups()||(this.propEffects[0].node.active=!0,this.propEffects[0].setAnimation(0,"huojian",!0),this.propEffects[1].node.active=!0,this.propEffects[1].setAnimation(0,"huojian",!0))),p.default.getInstance().getActionNum()<1?(this.propBtns[0].node.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.propEffects[0].node.active=!1,this.propBtns[0].node.opacity=254):(this.propBtns[0].node.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")),this.propBtns[0].node.opacity=255),p.default.getInstance().canPumpWater()?(this.propBtns[1].node.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")),this.propBtns[1].node.opacity=255):(this.propBtns[1].node.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.propEffects[1].node.active=!1,this.propBtns[1].node.opacity=254)},t.prototype.onFinishOneLevel=function(){d.default.LevelChallenge++,d.default.UnlockDrops+=20,m.currentPlatform===m.platformEnum.toutiao?y.default.platform.setRank(d.default.Level):(m.currentPlatform,m.platformEnum.wechat),u.default.instance.playSFX(u.AudioRef.Victory),this.uiManager.showPanel("GameOverPanel")},t.prototype.onPourAction=function(){this.updateUI()},t.prototype.useProp=function(e){switch(e){case 0:this.onBtn_undo();break;case 2:this.onBtn_pump()}},t.prototype.updateCoutnersUI=function(){this.text_propCount[0].string=d.default.PropUndo+"",d.default.PropUndo>99&&(this.text_propCount[0].string="99+"),this.text_propCount[1].string=d.default.PropPump+"",d.default.PropPump>99&&(this.text_propCount[1].string="99+"),d.default.PropUndo<=0?(this.text_propCount[0].node.active=!1,this.text_propCount[0].node.parent.children[1].active=!0,this.text_propCount[0].node.y=3,this.text_propCount[0].fontSize=40):(this.text_propCount[0].node.active=!0,this.text_propCount[0].node.parent.children[1].active=!1,this.text_propCount[0].fontSize=30,this.text_propCount[0].node.y=0),d.default.PropPump<=0?(this.text_propCount[1].node.active=!1,this.text_propCount[1].node.parent.children[1].active=!0,this.text_propCount[1].node.y=3,this.text_propCount[1].fontSize=40):(this.text_propCount[1].node.active=!0,this.text_propCount[1].node.parent.children[1].active=!1,this.text_propCount[1].fontSize=30,this.text_propCount[1].node.y=0),this.text_actionNum.string=p.default.getInstance().getActionNum()+""},t.prototype.updateTipsUI=function(){if(p.default.getInstance().ifDeadLock()){var e=p.default.getInstance().getLockedCups();p.default.getInstance().hasLockedCups()&&this.PopupTips("\u5361\u4f4f\u5566\uff0c\u5feb\u89e3\u9501\u4e00\u4e2a\u65b0\u676f\u5b50\u5427\uff01",8),e?this.PopupTips("\u5361\u4f4f\u5566\uff0c\u5feb\u89e3\u9501\u4e00\u4e2a\u65b0\u676f\u5b50\u5427\uff01",8,e):this.PopupTips("\u5361\u4f4f\u5566\uff0c\u7528\u4e2a\u9053\u5177\u8bd5\u8bd5\u5427\uff01",8)}},t.prototype.PopupTips=function(e,t,o){var n=this;void 0===t&&(t=5),void 0===o&&(o=null),this.root_Tips_finger.active=!!o,o&&this.root_Tips_finger.setPosition(this.root_Tips.convertToNodeSpaceAR(o.convertToWorldSpaceAR(cc.Vec2.ZERO))),this.root_Tips.active=!0,this.text_Tips.string=e,this.root_Tips.stopAllActions(),this.root_Tips.runAction(cc.sequence(cc.fadeIn(.2),cc.delayTime(t),cc.fadeOut(.2),cc.callFunc(function(){n.root_Tips.active=!1})))},t.prototype.ChangeTipsStay=function(e,t){var o=this;void 0===t&&(t=2),this.text_Tips.string=e,this.scheduleOnce(function(){o.text_Tips.string=o.tipsStay},t)},t.prototype.PopupTipsStay=function(e){this.root_Tips.active=!0,this.root_Tips_finger.active=!1,this.text_Tips.string=e,this.tipsStay=e,this.root_Tips.stopAllActions(),this.root_Tips.runAction(cc.fadeIn(.2))},t.prototype.PopoutTips=function(){var e=this;this.root_Tips.stopAllActions(),!0===this.root_Tips.active&&this.root_Tips.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){e.root_Tips.active=!1})))},t.prototype.unlockDrink=function(){this.uiManager.showPanel("DrinkPanel")},t.prototype.onBtn_undo=function(){d.default.Level>3&&d.default.PropUndo>0&&d.default.PropUndo--,p.default.getInstance().undoLastAction(),this.updateCoutnersUI()},t.prototype.onBtn_undoProp=function(){var e=this;this.PopoutTips,y.default.platform.reportButtonEvent("GamePage_withdrawBtn",0),u.default.instance.playSFX(u.AudioRef.ClickButton),this.propBtns[0].node.opacity<255?this.PopupTips("\u6682\u65e0\u53ef\u64a4\u56de\u7684\u64cd\u4f5c",2):"Game"==cc.director.getScene().name&&d.default.Level<=3||d.default.PropUndo>0?this.onBtn_undo():(y.default.platform.reportVideoEvent("GameFillLongPage_withdrawBtn",1),y.default.platform.showRewardAD(function(){y.default.platform.reportVideoEvent("GameFillLongPage_withdrawBtn",2),e.onBtn_undo()}))},t.prototype.onBtn_pump=function(){d.default.PropPump>0&&d.default.PropPump--,p.default.getInstance().pumpWater(),this.text_actionNum.string=p.default.getInstance().getActionNum()+"",this.updateCoutnersUI()},t.prototype.onBtn_pumpProp=function(){var e=this;this.PopoutTips,u.default.instance.playSFX(u.AudioRef.ClickButton),y.default.platform.reportButtonEvent("GamePage_topUpBtn",0),this.propBtns[1].node.opacity<255?this.PopupTips("\u6682\u65e0\u53ef\u62bd\u53d6\u7684\u6c34",2):d.default.PropPump>0?this.onBtn_pump():(y.default.platform.reportVideoEvent("GameFillLongPage_topUpBtn",1),y.default.platform.showRewardAD(function(){y.default.platform.reportVideoEvent("GameFillLongPage_topUpBtn",2),e.onBtn_pump()}))},t.prototype.onBtn_Pause=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),this.uiManager.showPanel("SettingPanel")},t.prototype.onBtn_StartMake=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),this.uiManager.showPanel("DrinkMakingPanel")},t.prototype.onBtn_Collection=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),y.default.platform.reportButtonEvent("GameOverPage_collectionBtn",0),this.uiManager.showPanel("CollectionPanel")},t.prototype.getLevelTime=function(){return Math.floor((Date.now()-this.startTime)/1e3)},t.prototype.onBtn_AutoPlay=function(){d.default.autoPlaying?(this.autoPlayer.StopAutoPlay(),this.text_AutoPlay.string="\u81ea\u52a8\u73a9(\u5173)"):(this.autoPlayer.StartAutoPlay(),this.text_AutoPlay.string="\u81ea\u52a8\u73a9(\u5f00)")},t.prototype.onBtn_AutoPlayLevel=function(){d.default.ifTest&&(this.clickTimeAutoPlay++,this.clickTimeAutoPlay>=5&&(this.clickTimeAutoPlay=0,this.onBtn_AutoPlay()))},t.prototype.updateAutoPlayText=function(){d.default.autoPlaying?this.text_AutoPlay.string="\u81ea\u52a8\u73a9(\u5f00)":this.text_AutoPlay.string="\u81ea\u52a8\u73a9(\u5173)"},t._instance=null,l([S(p.default)],t.prototype,"cupMgr",void 0),l([S(f.default)],t.prototype,"uiManager",void 0),l([S(g.default)],t.prototype,"autoPlayer",void 0),l([S(cc.Label)],t.prototype,"text_level",void 0),l([S(cc.Label)],t.prototype,"text_actionNum",void 0),l([S([cc.Label])],t.prototype,"text_propCount",void 0),l([S([cc.Button])],t.prototype,"propBtns",void 0),l([S([sp.Skeleton])],t.prototype,"propEffects",void 0),l([S(cc.Node)],t.prototype,"root_Tips",void 0),l([S(cc.Node)],t.prototype,"root_Tips_finger",void 0),l([S(cc.Node)],t.prototype,"top",void 0),l([S(cc.Label)],t.prototype,"text_Tips",void 0),l([S(cc.Node)],t.prototype,"bottom",void 0),l([S(cc.Node)],t.prototype,"TestNode",void 0),l([S(cc.Node)],t.prototype,"btn_Setting",void 0),l([S(cc.Node)],t.prototype,"btn_AutoPlay",void 0),l([S(cc.Node)],t.prototype,"btn_AutoPlayLevel",void 0),l([S(h.default)],t.prototype,"propPanel",void 0),l([S(cc.Label)],t.prototype,"text_AutoPlay",void 0),o=l([_],t)}(cc.Component);r.default=b,cc._RF.pop(),cc._RF.pop()},{}],GameManager_BP:[function(e,t,o){"use strict";cc._RF.push(t,"d7026U5nOtNLYAT8B4JQA2w","GameManager_BP");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"d7026U5nOtNLYAT8B4JQA2w","GameManager_BP");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},p=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0});var d=n("BottleMgr_BP"),f=n("LevelDataMgr_BP"),h=n("UIManager_BP"),y=n("AudioManager_BP"),m=cc._decorator,g=m.ccclass,v=m.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bottleMgr=null,t.uiManager=null,t.levelLabel=null,t.operationLabel=null,t.difficultyLabel=null,t.questionLabel=null,t.undoBtn=null,t.resetBtn=null,t.promptBtn=null,t.levelsData=null,t.currentLevel=1,t.completedLevels=0,t.ifGamePause=!1,t}var o;return s(t,e),o=t,t.prototype.onLoad=function(){o.instance=this},t.prototype.start=function(){return u(this,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:return this.levelsData&&(e=this.levelsData.json||this.levelsData,Array.isArray(e)?f.LevelDataMgr_BP.setLevelsData(e):cc.warn("levelsData \u683c\u5f0f\u9519\u8bef\uff0c\u671f\u671b\u6570\u7ec4")),[4,f.LevelDataMgr_BP.initAsync()];case 1:return t.sent(),this.setupEventListeners(),this.startLevel(this.currentLevel),[2]}})})},t.prototype.setupEventListeners=function(){var e=this;this.undoBtn&&this.undoBtn.on(cc.Node.EventType.TOUCH_END,function(){e.ifGamePause||e.bottleMgr.IsPouringNow||e.onUndoClick()}),this.resetBtn&&this.resetBtn.on(cc.Node.EventType.TOUCH_END,function(){e.ifGamePause||e.bottleMgr.IsPouringNow||e.onResetClick()}),this.promptBtn&&this.promptBtn.on(cc.Node.EventType.TOUCH_END,function(){e.uiManager&&e.uiManager.onPromptClick(e.currentLevel)}),this.bottleMgr.node.on("levelReady",function(){e.updateUI()}),this.bottleMgr.node.on("levelComplete",function(){e.onLevelComplete()})},t.prototype.startLevel=function(e){return u(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return this.currentLevel=e,[4,this.bottleMgr.initLevel(e)];case 1:return t.sent(),this.uiManager&&this.uiManager.onLevelChanged(e),this.updateUI(),[2]}})})},t.prototype.updateUI=function(){if(this.levelLabel&&(this.levelLabel.string="\u7b2c "+this.currentLevel+" \u5173"),this.operationLabel){var e=this.bottleMgr.getOperationCount();this.operationLabel.string="\u64cd\u4f5c: "+e}if(this.difficultyLabel){var t=this.currentLevel<=1?1:Math.min(Math.ceil(this.currentLevel/2),10);this.difficultyLabel.string="\u96be\u5ea6: "+"\u2605".repeat(t)}if(this.questionLabel){var o=f.LevelDataMgr_BP.getLevelData(this.currentLevel);this.questionLabel.string=(null==o?void 0:o.question)||""}},t.prototype.onLevelComplete=function(){y.default.instance.playVictory(),this.completedLevels++,cc.log("\u606d\u559c\uff01\u5b8c\u6210\u7b2c "+this.currentLevel+" \u5173\uff0c\u5df2\u5b8c\u6210 "+this.completedLevels+" \u4e2a\u5173\u5361"),this.uiManager&&this.uiManager.showGameOverPanel(this.completedLevels)},t.prototype.notifyLevelComplete=function(){this.onLevelComplete()},t.prototype.onUndoClick=function(){y.default.instance.playBtn(),this.ifGamePause||(this.bottleMgr.node.getComponent(d.default).undo(),this.updateUI())},t.prototype.onResetClick=function(){y.default.instance.playBtn(),this.bottleMgr.resetLevel(),this.updateUI()},t.prototype.pauseGame=function(){this.ifGamePause=!0,cc.director.pause()},t.prototype.resumeGame=function(){this.ifGamePause=!1,cc.director.resume()},t.prototype.getCurrentLevel=function(){return this.currentLevel},t.prototype.getCompletedLevels=function(){return this.completedLevels},t.prototype.jumpToLevel=function(e){this.startLevel(e)},t.instance=null,l([v(d.default)],t.prototype,"bottleMgr",void 0),l([v(h.default)],t.prototype,"uiManager",void 0),l([v(cc.Label)],t.prototype,"levelLabel",void 0),l([v(cc.Label)],t.prototype,"operationLabel",void 0),l([v(cc.Label)],t.prototype,"difficultyLabel",void 0),l([v(cc.Label)],t.prototype,"questionLabel",void 0),l([v(cc.Node)],t.prototype,"undoBtn",void 0),l([v(cc.Node)],t.prototype,"resetBtn",void 0),l([v(cc.Node)],t.prototype,"promptBtn",void 0),l([v(cc.JsonAsset)],t.prototype,"levelsData",void 0),o=l([g],t)}(cc.Component);r.default=_,cc._RF.pop(),cc._RF.pop()},{}],GameManager_ED:[function(e,t,o){"use strict";cc._RF.push(t,"d57a2+1+9tO57gYVg/aMjQb","GameManager_ED");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"d57a2+1+9tO57gYVg/aMjQb","GameManager_ED");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager_ED"),p=n("AutoPlayer_ED"),d=n("ExternalManager_ED"),f=n("Cup_ED"),h=n("CupMgr_ED"),y=n("countdownCtrl_ED"),m=n("UIManager_ED"),g=n("config"),v=cc._decorator,_=v.ccclass,S=v.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.completedLabel=null,t.countdown=null,t.tip=null,t.tipLabel=null,t.progressLabel=null,t.addFreeTimesLabel=null,t.withdrawFreeTimesLabel=null,t.removeFreeTimesLabel=null,t.addBtn=null,t.withdrawBtn=null,t.autoPlayer=null,t.text_AutoPlay=null,t.btn_AutoPlay=null,t.btn_AutoPlayLevel=null,t.clickTimeAutoPlay=0,t.PosYList=[],t.rowsCreated=0,t.bottlesCreated=0,t.rowLists=[],t.bottlesShowed=new Map,t.addTimes=0,t.withdrawTimes=0,t.removeTimes=0,t._addFreeTimes=0,t._withdrawFreeTimes=0,t._removeFreeTimes=0,t.ifGamePause=!1,t.operationRecords=[],t._completedAmounts=0,t.ifTipShowed=!1,t._bottleToReset=null,t.propState=0,t}var o;return s(t,e),o=t,t.prototype.onBtn_AutoPlay=function(){d.default.CommonData.autoPlaying?(null!=this.autoPlayer&&this.autoPlayer.StopAutoPlay(),this.text_AutoPlay.string="\u81ea\u52a8\u73a9(\u5173)"):(null!=this.autoPlayer&&this.autoPlayer.StartAutoPlay(),this.text_AutoPlay.string="\u81ea\u52a8\u73a9(\u5f00)")},t.prototype.onBtn_AutoPlayLevel=function(){d.default.CommonData.ifTest&&(this.clickTimeAutoPlay++,this.clickTimeAutoPlay>=5&&(this.clickTimeAutoPlay=0,this.onBtn_AutoPlay()))},t.prototype.updateAutoPlayText=function(){d.default.CommonData.autoPlaying?this.text_AutoPlay.string="\u81ea\u52a8\u73a9(\u5f00)":this.text_AutoPlay.string="\u81ea\u52a8\u73a9(\u5173)"},Object.defineProperty(t.prototype,"addFreeTimes",{get:function(){return this._addFreeTimes},set:function(e){this._addFreeTimes=e,this.addFreeTimesLabel.string=e+"",this.addFreeTimesLabel.node.parent.active=e>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"withdrawFreeTimes",{get:function(){return this._withdrawFreeTimes},set:function(e){this._withdrawFreeTimes=e,this.withdrawFreeTimesLabel.string=e+"",this.withdrawFreeTimesLabel.node.parent.active=e>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"removeFreeTimes",{get:function(){return this._removeFreeTimes},set:function(e){this._removeFreeTimes=e,this.removeFreeTimesLabel.string=e+"",this.removeFreeTimesLabel.node.parent.active=e>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"completedAmounts",{get:function(){return this._completedAmounts},set:function(e){this._completedAmounts=e,this.completedLabel.string="x"+this._completedAmounts},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){o.instance=this,this.addFreeTimes=1,this.withdrawFreeTimes=1,this.removeFreeTimes=1,this._adaPter()},t.prototype._adaPter=function(){var e=cc.find("Canvas").getComponent(cc.Canvas),t=cc.view.getVisibleSize().height/cc.view.getVisibleSize().width;cc.sys.isBrowser&&(t=1),console.log("\u9002\u914d\u6bd4\u7387\uff1a",t),t<2?(e.fitHeight=!0,e.fitWidth=!1):(e.fitHeight=!1,e.fitWidth=!0)},t.prototype.start=function(){this.bottleToReset=null,this.operationRecords=[],this.onOperationRecording(),g.currentPlatform===g.platformEnum.toutiao?(this.btn_AutoPlay.active=!1,this.btn_AutoPlayLevel.active=!0):g.currentPlatform===g.platformEnum.wechat&&(this.btn_AutoPlay.active=!0,this.btn_AutoPlayLevel.active=!0)},t.prototype.onEnable=function(){this.eventRegist()},t.prototype.onDisable=function(){this.eventRegist()},t.prototype.eventRegist=function(){},t.prototype.eventCancel=function(){},t.prototype.checkIfPouring=function(){return-1!==Array.from(this.bottlesShowed.values()).map(function(e){return e.currentState}).indexOf(f.CupState.Pouring)},t.prototype.checkIfDeadGame=function(){var e=this;this.unscheduleAllCallbacks(),this.scheduleOnce(function(){var t=h.default.getInstance().ifDeadLock(),o=h.default.getInstance().checkIfInvalid();(t||o)&&e.showTip()},5)},t.prototype.showTip=function(){var e=this;if(!this.ifTipShowed){this.ifTipShowed=!0,this.tip.active=!0;var t=this.addTimes<5||this.withdrawTimes<5||this.removeTimes<5;this.tipLabel.string=t?"\u5361\u4f4f\u5566\uff0c\u518d\u4e0d\u4f7f\u7528\u9053\u5177\u5c31\u8981\u6b47\u83dc\u54af\uff01":"\u5361\u4f4f\u5566\uff0c\u9053\u5177\u4e5f\u7528\u5149\u5566\uff01\u5b8c\u86cb\u5566\uff01",this.progressLabel.string=this.completedAmounts+"\u4e2a\u74f6\u5b50",this.tip.setPosition(-265,-440),this.tip.y=this.tip.y-100,this.tip.opacity=0,cc.tween(this.tip).to(.5,{y:this.tip.y+100,opacity:255}).call(function(){e.countdown.getComponent(y.default).startCountdown(t,function(){e.hideTip(),m.default.instance.showPanel(m.default.instance.pnlEnum.gameOver)}),e.countdown.scale=0,e.countdown.opacity=0,cc.tween(e.countdown).to(.25,{scale:1,opacity:255}).start()}).start()}},t.prototype.hideTip=function(){this.ifTipShowed=!1,this.tip.active=!1,this.tip.stopAllActions(),this.countdown.stopAllActions(),this.countdown.getComponent(y.default).stopCountDown()},Object.defineProperty(t.prototype,"bottleToReset",{get:function(){return this._bottleToReset},set:function(e){this._bottleToReset=e,this.addBtn.opacity=e?255:150},enumerable:!1,configurable:!0}),t.prototype.onOperationRecording=function(){this.withdrawBtn.opacity=this.operationRecords.length>0?255:150},t.prototype.Add=function(){this.unscheduleAllCallbacks(),h.default.getInstance().PropAdd(this.bottleToReset),this.addTimes++},t.prototype.Withdraw=function(){this.unscheduleAllCallbacks(),h.default.getInstance().undoAction(),this.withdrawTimes++},t.prototype.Remove=function(){this.unscheduleAllCallbacks(),h.default.getInstance().PropRemove(),this.removeTimes++},t.prototype.clickSetting=function(){u.default.instance.playBtn(),m.default.instance.showPanel(m.default.instance.pnlEnum.setting)},t.prototype.clickAdd=function(){this.bottleToReset&&(this.addFreeTimes>0?(this.addFreeTimes--,this.hideTip(),this.Add()):d.default.CommonData.ifTest?(u.default.instance.playBtn(),this.hideTip(),this.Add()):(this.propState=1,u.default.instance.playBtn(),m.default.instance.showPanel(m.default.instance.pnlEnum.prop)))},t.prototype.clickWithdraw=function(){this.checkIfPouring()||(u.default.instance.playBtn(),this.operationRecords.length>0&&(this.withdrawFreeTimes>0?(this.withdrawFreeTimes--,this.hideTip(),this.Withdraw()):d.default.CommonData.ifTest?(u.default.instance.playBtn(),this.hideTip(),this.Withdraw()):(this.propState=2,m.default.instance.showPanel(m.default.instance.pnlEnum.prop))))},t.prototype.clickRemove=function(){u.default.instance.playBtn(),this.removeFreeTimes>0?(this.removeFreeTimes--,this.hideTip(),this.Remove()):d.default.CommonData.ifTest?(u.default.instance.playBtn(),this.hideTip(),this.Remove()):(this.propState=3,m.default.instance.showPanel(m.default.instance.pnlEnum.prop))},t.instance=null,l([S(cc.Label)],t.prototype,"completedLabel",void 0),l([S(cc.Node)],t.prototype,"countdown",void 0),l([S(cc.Node)],t.prototype,"tip",void 0),l([S(cc.Label)],t.prototype,"tipLabel",void 0),l([S(cc.Label)],t.prototype,"progressLabel",void 0),l([S(cc.Label)],t.prototype,"addFreeTimesLabel",void 0),l([S(cc.Label)],t.prototype,"withdrawFreeTimesLabel",void 0),l([S(cc.Label)],t.prototype,"removeFreeTimesLabel",void 0),l([S(cc.Node)],t.prototype,"addBtn",void 0),l([S(cc.Node)],t.prototype,"withdrawBtn",void 0),l([S(p.default)],t.prototype,"autoPlayer",void 0),l([S(cc.Label)],t.prototype,"text_AutoPlay",void 0),l([S(cc.Node)],t.prototype,"btn_AutoPlay",void 0),l([S(cc.Node)],t.prototype,"btn_AutoPlayLevel",void 0),o=l([_],t)}(cc.Component);r.default=b,cc._RF.pop(),cc._RF.pop()},{}],GameManager_Long:[function(e,t,o){"use strict";cc._RF.push(t,"3df59WFc5RFK4af71AYSbqf","GameManager_Long");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"3df59WFc5RFK4af71AYSbqf","GameManager_Long");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("LevelManager_Long"),p=n("const"),d=n("UIManager"),f=cc._decorator,h=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.text_time=null,t.text_step=null,t.uiManager=null,t.time=0,t.step=0,t.candicatesLeft=0,t}var o;return s(t,e),o=t,t.getInstance=function(){return o.instance?o.instance:null},t.prototype.onLoad=function(){o.instance=this,cc.director.on(p.EventNames.LoadLevelFinish,this.init,this),cc.director.on(p.EventNames.OnClickPour,this.minusStep,this),cc.director.on(p.EventNames.Pause,this.stopTimer,this),cc.director.on(p.EventNames.Resume,this.startTimer,this),cc.director.on(p.EventNames.LevelFinish,this.stopTimer,this),cc.director.on(p.EventNames.GameLose,this.gameLose,this),cc.director.on(p.EventNames.OnClickCup,this.checkStep,this),cc.director.on(p.EventNames.OnVideoAdStart,this.pauseTimer,this),cc.director.on(p.EventNames.OnVideoAdEnd,this.resumeTimer,this)},t.prototype.onDestroy=function(){o.instance=null,cc.director.off(p.EventNames.LoadLevelFinish,this.init,this),cc.director.off(p.EventNames.OnClickPour,this.minusStep,this),cc.director.off(p.EventNames.Pause,this.stopTimer,this),cc.director.off(p.EventNames.Resume,this.startTimer,this),cc.director.off(p.EventNames.LevelFinish,this.stopTimer,this),cc.director.off(p.EventNames.GameLose,this.gameLose,this),cc.director.off(p.EventNames.OnClickCup,this.checkStep,this),cc.director.off(p.EventNames.OnVideoAdStart,this.pauseTimer,this),cc.director.off(p.EventNames.OnVideoAdEnd,this.resumeTimer,this),this.stopTimer()},t.prototype.init=function(){this.time=u.default.getInstance().time,this.step=u.default.getInstance().step,this.updateTimeUI(),this.updateStepUI(),this.startTimer()},t.prototype.startTimer=function(){cc.director.getScheduler().schedule(this.tick,this,1,cc.macro.REPEAT_FOREVER,0,!1)},t.prototype.stopTimer=function(){cc.director.getScheduler().unschedule(this.tick,this)},t.prototype.pauseTimer=function(){cc.director.getScheduler().pauseTarget(this)},t.prototype.resumeTimer=function(){cc.director.getScheduler().resumeTarget(this)},t.prototype.tick=function(){this.time--,this.time<=0&&(this.time=0,this.stopTimer(),this.uiManager.showPanel("AddTimePanel")),this.updateTimeUI()},t.prototype.updateTimeUI=function(){var e=Math.floor(this.time/60),t=this.time%60;this.text_time.string=e.toString().padStart(2,"0")+":"+t.toString().padStart(2,"0")},t.prototype.addStep=function(){this.step++,this.updateStepUI()},t.prototype.checkStep=function(){this.step<=0&&(this.stopTimer(),this.uiManager.showPanel("AddStepPanel"))},t.prototype.minusStep=function(){this.step--,this.step<=0&&(this.step=0,this.stopTimer(),this.uiManager.showPanel("AddStepPanel")),this.updateStepUI()},t.prototype.updateStepUI=function(){this.text_step.string=this.step.toString()},t.prototype.gameLose=function(){cc.director.getScheduler().unschedule(this.tick,this),this.uiManager.showPanel("LosePanel")},t.instance=null,l([y(cc.Label)],t.prototype,"text_time",void 0),l([y(cc.Label)],t.prototype,"text_step",void 0),l([y(d.default)],t.prototype,"uiManager",void 0),o=l([h],t)}(cc.Component);r.default=m,cc._RF.pop(),cc._RF.pop()},{}],GameManager_Multi:[function(e,t,o){"use strict";cc._RF.push(t,"bef36hxmC5Fm5A8IQCXgn9r","GameManager_Multi");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"bef36hxmC5Fm5A8IQCXgn9r","GameManager_Multi");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("CommonData"),d=n("LevelManager"),f=n("const"),h=n("DataManager"),y=n("GameManager"),m=n("DataNexusEnum"),g=n("DataNexusSDK"),v=n("UIManager"),_=cc._decorator,S=_.ccclass,b=_.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.text_time=null,t.text_step=null,t.text_candicatesLeft=null,t.uiManager=null,t.slider=null,t.slider_time=null,t.text_score=null,t.effect_light=null,t.time=0,t.step=0,t.time_slider=0,t.candicatesLeft=0,t.finishedCount=0,t.currentProgress=0,t.recoverProgress=0,t.progressSpeed=0,t.isNewRecord=!1,t.ifPause=!0,t.revivedTime=2,t.streakNode=null,t.streakLabel=null,t.streakCount=0,t.currentStreakTime=0,t.maxStreakTime=5,t.currentScore=0,t.showScore=0,t.showRecord=0,t.LabelPool=new cc.NodePool,t.ifFirstSfx=!0,t.sfxIndex=0,t.warningNode=null,t.warningTween=null,t.referenceCount=0,t.addTimeBtnSprite=null,t}var o;return s(t,e),o=t,t.getInstance=function(){return o.instance?o.instance:null},t.prototype.update=function(e){this.ifPause||(this.updateProgress(e),this.updateSliderTimeUI(e)),this.updateScore()},t.prototype.onLoad=function(){g.default.instance.trackAdPlacementShow(m.RewardADEvent.ADD_TIME),console.log=function(){},console.warn=function(){},o.instance=this,cc.director.on(f.EventNames.LoadLevelFinish,this.init,this),cc.director.on(f.EventNames.OnClickPour,this.minusStep,this),cc.director.on(f.EventNames.GenerateCandidate,this.updateCandicatesLeftUI,this),cc.director.on(f.EventNames.LevelFinish,this.stopTimer,this),cc.director.on(f.EventNames.Pause,this.stopTimer,this),cc.director.on(f.EventNames.Resume,this.startTimer,this),cc.director.on(f.EventNames.GameLose,this.gameLose,this),cc.director.on(f.EventNames.OnClickCup,this.checkStep,this),cc.director.on(f.EventNames.OnVideoAdStart,this.pauseTimer,this),cc.director.on(f.EventNames.OnVideoAdEnd,this.resumeTimer,this),cc.director.on(f.EventNames.playFinishSFX,this.playFinishSFX,this),cc.director.on(f.EventNames.Explode,this.onExplode,this),cc.director.on(f.EventNames.BombTimeWarning,this.addRef,this),cc.director.on(f.EventNames.BombDefuse,this.decRef,this),cc.director.on(f.EventNames.Explode,this.decRef,this),u.default.instance.init(function(){u.default.instance.playBGM(u.AudioRef.LevelBGM,!0)})},t.prototype.onDestroy=function(){o.instance=null,cc.director.off(f.EventNames.LoadLevelFinish,this.init,this),cc.director.off(f.EventNames.OnClickPour,this.minusStep,this),cc.director.off(f.EventNames.GenerateCandidate,this.updateCandicatesLeftUI,this),cc.director.off(f.EventNames.LevelFinish,this.stopTimer,this),cc.director.off(f.EventNames.Pause,this.stopTimer,this),cc.director.off(f.EventNames.Resume,this.startTimer,this),cc.director.off(f.EventNames.GameLose,this.gameLose,this),cc.director.off(f.EventNames.OnClickCup,this.checkStep,this),cc.director.off(f.EventNames.OnVideoAdStart,this.pauseTimer,this),cc.director.off(f.EventNames.OnVideoAdEnd,this.resumeTimer,this),cc.director.off(f.EventNames.playFinishSFX,this.playFinishSFX,this),cc.director.off(f.EventNames.Explode,this.onExplode,this),cc.director.off(f.EventNames.BombTimeWarning,this.addRef,this),cc.director.off(f.EventNames.BombDefuse,this.decRef,this),cc.director.off(f.EventNames.Explode,this.decRef,this),h.default.updateChallengeRecord(p.default.ChallengeRecord),this.stopTimer();var e=o.challengeStartTime;e>0&&(y.default.platform.reportLevelTimeEvent("Challenge_LeaveTime",Math.floor((Date.now()-e)/1e3)),y.default.platform.reportLevelTimeEvent("Challenge_TimeLeft",Math.floor(this.time)))},t.prototype.start=function(){var e=this;this.scheduleOnce(function(){e.uiManager.showPanel("AddCupPanel")},.5)},t.prototype.init=function(){o.challengeStartTime=Date.now(),this.showRecord=p.default.ChallengeRecord,this.time=60,this.time_slider=this.time,this.step=d.default.getInstance().step,this.candicatesLeft=d.default.getInstance().getCandidateNum(),this.updateTimeUI(),this.updateStepUI(),this.updateCandicatesLeftUI()},t.prototype.startTimer=function(){cc.director.getScheduler().schedule(this.tick,this,1,cc.macro.REPEAT_FOREVER,0,!1),this.ifPause=!1},t.prototype.stopTimer=function(){cc.director.getScheduler().unschedule(this.tick,this),this.ifPause=!0},t.prototype.pauseTimer=function(){cc.director.getScheduler().pauseTarget(this),this.ifPause=!0},t.prototype.resumeTimer=function(){this.ifPause=!1,cc.director.getScheduler().resumeTarget(this),0==cc.director.getScheduler().isScheduled(this.tick,this)&&this.startTimer()},t.prototype.tick=function(){this.time--,this.time_slider=this.time,this.time<=5&&(5==this.time&&this.addRef(),y.default.platform.vibrateShort()),this.time<=0&&(this.time=0,this.time_slider=0,this.stopTimer(),this.revivedTime>0?(this.decRef(),this.uiManager.showPanel("AddTimePanel")):(this.decRef(),cc.director.emit(f.EventNames.GameLose))),this.updateTimeUI()},t.prototype.updateTimeUI=function(){var e=Math.floor(this.time/60),t=this.time%60;this.text_time.string=e.toString().padStart(2,"0")+":"+t.toString().padStart(2,"0")},t.prototype.updateSliderTimeUI=function(e){this.time_slider-=e;var t=this.time_slider/60;this.slider_time.fillRange=t},t.prototype.addStep=function(){this.step++,this.updateStepUI()},t.prototype.checkStep=function(){this.step<=0&&(this.stopTimer(),this.uiManager.showPanel("AddStepPanel"))},t.prototype.minusStep=function(){},t.prototype.updateStepUI=function(){},t.prototype.updateCandicatesLeftUI=function(){},t.prototype.gameLose=function(){cc.director.getScheduler().unschedule(this.tick,this),this.uiManager.showPanel("GameOverChallengePanel")},t.prototype.onFinishOneCup=function(e){this.addStreak(),this.addScore(e),this.addTime(0,e)},t.prototype.addScore=function(e){var t;void 0===e&&(e=null),this.ifPause||(t=this.streakCount<=1?10:this.streakCount<=2?15:this.streakCount<=3?20:this.streakCount<=5?25:this.streakCount<=8?30:35,this.currentScore+=t,this.currentScore>p.default.ChallengeRecord&&(this.isNewRecord=!0,!1===this.effect_light.node.active&&(this.effect_light.node.active=!0,this.effect_light.setAnimation(0,"idle",!0)),p.default.ChallengeRecord=this.currentScore),this.playAddScroeEffect(t,e))},t.prototype.updateScore=function(){this.showScore<this.currentScore&&(this.showScore++,this.text_score.string="\u5f53\u524d\u5206\u6570:"+this.showScore.toString())},t.prototype.addTime=function(e,t){var o;void 0===e&&(e=0),void 0===t&&(t=null),this.ifPause||(o=e>0?e:this.streakCount<=1?4:this.streakCount<=2?6:this.streakCount<=3?8:(this.streakCount<=5||this.streakCount,10),this.time<=5&&this.time+o>5&&this.decRef(),this.time+=o,this.time_slider=this.time,this.stopTimer(),this.startTimer(),this.playAddTimeEffect(o,t),this.updateTimeUI())},t.prototype.spawnEffectLabel=function(e){var t=e.get();return t||(t=cc.instantiate(this.text_score.node)),t.stopAllActions(),t.opacity=255,t.scale=1,t},t.prototype.recycleEffectLabel=function(e,t){t.stopAllActions(),t.removeFromParent(),e.put(t)},t.prototype.playAddTimeEffect=function(e,t){var o=this;void 0===t&&(t=null);var n=this.spawnEffectLabel(this.LabelPool),i=n.getComponent(cc.Label);n.opacity=0,i.fontSize=55,i.string="+"+e+"s",n.color=cc.Color.GREEN,n.parent=this.streakLabel.node.parent,n.position=this.streakLabel.node.position,n.x+=75,n.y+=15,t?(n.parent=t.parent,n.zIndex=99,n.position=t.position,n.y-=t.height/2-10,cc.tween(n).delay(1.5).call(function(){n.opacity=255}).by(1,{y:50,opacity:-255}).call(function(){return o.recycleEffectLabel(o.LabelPool,n)}).start()):cc.tween(n).by(2,{y:50,opacity:-255}).call(function(){return o.recycleEffectLabel(o.LabelPool,n)}).start()},t.prototype.playAddScroeEffect=function(e){var t=this,o=this.spawnEffectLabel(this.LabelPool),n=o.getComponent(cc.Label);o.color=cc.Color.WHITE,o.parent=this.text_score.node.parent,o.position=this.text_score.node.position,o.x+=125,o.y+=25,n.fontSize=35,n.string="+"+e+"\u5206",cc.tween(o).by(2,{y:50,opacity:-255}).call(function(){return t.recycleEffectLabel(t.LabelPool,o)}).start()},t.prototype.addStreak=function(){0===this.streakCount&&(this.streakNode.active=!0),this.streakCount++,this.currentStreakTime=this.maxStreakTime,this.streakLabel.string="\u8fde\u51fb x "+this.streakCount,this.streakLabel.node.stopAllActions(),cc.tween(this.streakLabel.node).to(.1,{scale:1.2}).to(.1,{scale:1}).start(),this.updateProgress(0)},t.prototype.playFinishSFX=function(){this.ifFirstSfx?this.ifFirstSfx=!1:(this.sfxIndex++,this.sfxIndex>=2&&(this.sfxIndex=0),0==this.sfxIndex?u.default.instance.playSFX(u.AudioRef.PigOut1):u.default.instance.playSFX(u.AudioRef.PigOut2))},t.prototype.updateProgress=function(e){if(!(this.streakCount<=0)){if(this.currentStreakTime-=e,this.currentStreakTime<0)return this.ifFirstSfx=!0,this.streakCount=0,this.currentStreakTime=0,void(this.streakNode.active=!1);this.currentProgress=this.currentStreakTime/this.maxStreakTime,this.slider.fillRange=this.currentProgress}},t.prototype.addProgress=function(e){this.currentProgress+=e,this.currentProgress>=1&&(this.currentProgress=1),this.slider.fillRange=this.currentProgress},t.prototype.addRecoverProgress=function(){this.currentProgress+=this.recoverProgress,this.currentProgress>=1&&(this.currentProgress=1),this.slider.fillRange=this.currentProgress},t.prototype.addRef=function(){this.referenceCount++,1===this.referenceCount&&this.startBlink()},t.prototype.decRef=function(){this.referenceCount<0?this.referenceCount=0:(this.referenceCount--,0===this.referenceCount&&this.stopBlink())},t.prototype.startBlink=function(){this.warningNode.opacity=0,this.warningTween=cc.tween(this.warningNode).repeatForever(cc.tween().to(.5,{opacity:255}).to(.5,{opacity:100})).start()},t.prototype.stopBlink=function(){var e=this;this.warningTween.stop(),cc.tween(this.warningNode).to(.2,{opacity:0}).call(function(){e.warningTween=null}).start()},t.prototype.onBtn_addTime=function(){var e=this;y.default.platform.reportVideoEvent("Challenge_addTimeBtn_video",1),g.default.instance.trackAdClick(m.RewardADEvent.ADD_TIME),y.default.platform.showRewardAD(function(){g.default.instance.trackAdVideoFinish(m.RewardADEvent.ADD_TIME),e.addTime(60),e.updateTimeUI(),y.default.platform.reportVideoEvent("Challenge_addTimeBtn_video",2)})},t.prototype.setAddTimeBtnMatrial=function(e){e?this.addTimeBtnSprite.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")):this.addTimeBtnSprite.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite"))},t.prototype.onExplode=function(){this.stopTimer(),this.revivedTime>0?this.uiManager.showPanel("AddTimePanel"):cc.director.emit(f.EventNames.GameLose)},t.challengeStartTime=0,t.instance=null,l([b(cc.Label)],t.prototype,"text_time",void 0),l([b(cc.Label)],t.prototype,"text_step",void 0),l([b(cc.Label)],t.prototype,"text_candicatesLeft",void 0),l([b(v.default)],t.prototype,"uiManager",void 0),l([b(cc.Sprite)],t.prototype,"slider",void 0),l([b(cc.Sprite)],t.prototype,"slider_time",void 0),l([b(cc.Label)],t.prototype,"text_score",void 0),l([b(sp.Skeleton)],t.prototype,"effect_light",void 0),l([b(cc.Node)],t.prototype,"streakNode",void 0),l([b(cc.Label)],t.prototype,"streakLabel",void 0),l([b(cc.Node)],t.prototype,"warningNode",void 0),l([b(cc.Sprite)],t.prototype,"addTimeBtnSprite",void 0),o=l([S],t)}(cc.Component);r.default=C,cc._RF.pop(),cc._RF.pop()},{}],GameManager_RF:[function(e,t,o){"use strict";cc._RF.push(t,"533e4MMMexP7b1DLlnyfj6O","GameManager_RF");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"533e4MMMexP7b1DLlnyfj6O","GameManager_RF");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("const"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.text_time=null,t.time=0,t.ifPause=!0,t.isChallenger=!1,t}var o;return s(t,e),o=t,Object.defineProperty(t,"instance",{get:function(){return o._instance},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){o._instance=this,cc.director.on(u.EventNames.LoadLevelFinish,this.init,this),cc.director.on(u.EventNames.Pause,this.stopTimer,this),cc.director.on(u.EventNames.Resume,this.startTimer,this),cc.director.on(u.EventNames.OnVideoAdStart,this.pauseTimer,this),cc.director.on(u.EventNames.OnVideoAdEnd,this.resumeTimer,this),cc.director.on("level_finish",this.onFinishOneLevel,this),this.init()},t.prototype.onDestroy=function(){o._instance=null,cc.director.off(u.EventNames.LoadLevelFinish,this.init,this),cc.director.off(u.EventNames.Pause,this.stopTimer,this),cc.director.off(u.EventNames.Resume,this.startTimer,this),cc.director.off(u.EventNames.OnVideoAdStart,this.pauseTimer,this),cc.director.off(u.EventNames.OnVideoAdEnd,this.resumeTimer,this),cc.director.off("level_finish",this.onFinishOneLevel,this),this.stopTimer()},t.prototype.init=function(){this.time=0,this.updateTimeUI()},t.prototype.onFinishOneLevel=function(){this.stopTimer()},t.prototype.startTimer=function(){cc.director.getScheduler().schedule(this.tick,this,1,cc.macro.REPEAT_FOREVER,0,!1),this.ifPause=!1},t.prototype.stopTimer=function(){cc.director.getScheduler().unschedule(this.tick,this),this.ifPause=!0},t.prototype.pauseTimer=function(){cc.director.getScheduler().pauseTarget(this),this.ifPause=!0},t.prototype.resumeTimer=function(){this.ifPause=!1,cc.director.getScheduler().resumeTarget(this),0==cc.director.getScheduler().isScheduled(this.tick,this)&&this.startTimer()},t.prototype.tick=function(){this.time++,this.updateTimeUI()},t.prototype.updateTimeUI=function(){var e=Math.floor(this.time/60),t=this.time%60;this.text_time&&(this.text_time.string=e.toString().padStart(2,"0")+":"+t.toString().padStart(2,"0"))},t._instance=null,l([f(cc.Label)],t.prototype,"text_time",void 0),o=l([d],t)}(cc.Component);r.default=h,cc._RF.pop(),cc._RF.pop()},{}],GameManager_SS:[function(e,t,o){"use strict";cc._RF.push(t,"dd39dlodT5GO70SVyQf74E6","GameManager_SS");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"dd39dlodT5GO70SVyQf74E6","GameManager_SS");var c=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var s=n("GameManager"),l=n("DataManager_SS"),u=cc._decorator,p=u.ccclass,d=(u.property,function(){function e(){}return e.playVibrateShort=function(){l.default.vibrateOn},e.platform=s.default.platform,c([p],e)}());r.default=d,cc._RF.pop(),cc._RF.pop()},{}],GameManager:[function(e,t,o){"use strict";cc._RF.push(t,"bd339GHpWhOh5bYy8/ndNv5","GameManager");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"bd339GHpWhOh5bYy8/ndNv5","GameManager");var c=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var s=n("NativeBridge"),l=n("config"),u=n("CommonData"),p=n("GoldDataManager"),d=n("CollectionManager"),f=n("ThemeDataManager"),h=cc._decorator,y=h.ccclass,m=(h.property,function(){function e(){}return e.showRewardPanel=function(e,t,o,n,i){void 0===t&&(t=0),void 0===o&&(o=0),void 0===n&&(n=!1),void 0===i&&(i=1);var r=cc.assetManager.getBundle("Panels");r?r.load("RewardPanel",cc.Prefab,function(r,a){if(r)return console.error("\u83b7\u53d6rewardpanel \u9884\u5236\u4f53\u5931\u8d25",r),null;var c=cc.instantiate(a);c.parent=cc.find("Canvas");var s=c.getComponent("RewardPanel");s.initReward(e,t,o,n,i),s.show()}):cc.assetManager.loadBundle("Panels",function(a){if(a)return console.error("\u52a0\u8f7dPanels\u5206\u5305\u5931\u8d25",a),null;r.load("RewardPanel",cc.Prefab,function(r,a){if(r)return console.error("\u83b7\u53d6rewardpanel \u9884\u5236\u4f53\u5931\u8d25",r),null;var c=cc.instantiate(a);c.parent=cc.find("Canvas");var s=c.getComponent("RewardPanel");s.initReward(e,t,o,n,i),s.show()})})},e.playVibrateShort=function(){u.default.VibrationOn&&this.platform.vibrateShort()},e.playVibrateSquence=function(){var e=this;u.default.VibrationOn&&(cc.director.getScheduler().enableForTarget(this),cc.director.getScheduler().schedule(function(){e.platform.vibrateShortHeavy()},this,.2,1,0,!1))},e.forceGC=function(){this.platform.forceGC()},e.createGameClubButton=function(e){if(l.currentPlatform===l.platformEnum.wechat&&!cc.sys.isBrowser){var t=wx.getWindowInfo(),o=(t.pixelRatio,t.windowWidth/750),n=t.windowHeight/1670,i=e.width*o,r=e.height*n,a=(e.x-e.width/2+375)*o,c=(1670-(e.y+e.height/2+835))*n;this.platform.createGameClubButton(a,c,i,r)}},e.showGameClubButton=function(){l.currentPlatform===l.platformEnum.wechat&&this.platform.showGameClubButton(!0)},e.hideGameClubButton=function(){l.currentPlatform===l.platformEnum.wechat&&this.platform.showGameClubButton(!1)},e.destroyGameClubButton=function(){l.currentPlatform===l.platformEnum.wechat&&this.platform.destroyGameClubButton()},e.DeleteGameClubRewardHistory=function(e){if(l.currentPlatform===l.platformEnum.wechat){for(var t=[],o=function(e){var o=new Promise(function(t,o){window.wx&&window.wx.request({url:"https://api.flysheeep.com/api/tapaway/del_gift",header:{"Content-Type":"application/json","x-appid":u.default.appId},data:{openid:u.default.openId,orderid:e},method:"POST",success:function(e){console.error("------------DeleteGameClubRewardHistory---------success-------",e),t()},fail:function(e){console.error("------------DeleteGameClubRewardHistory---------fail-------",e),o()}})});t.push(o)},n=0,i=e;n<i.length;n++)o(i[n]);Promise.all(t)}},e.onRewardAdClose=function(){this._lastRewardAdCloseTime=Date.now()},e.tryShowWxInterAd=function(){if(l.currentPlatform===l.platformEnum.wechat){var e=Date.now();e-this._firstLoginTime<3e5||e-this._lastInterAdTime<12e4||e-this._lastRewardAdCloseTime<6e4||(this._lastInterAdTime=e,this._interAdSettlementCount=0,this.platform.showInterstitialAdWx())}},e.claimRewardFromServer=function(e,t){if(l.currentPlatform===l.platformEnum.wechat)switch(e){case"1":u.default.PropUndo+=t;break;case"2":u.default.PropPump+=t;break;case"3":u.default.PropAddCup+=t;break;case"gold2":p.default.Gold+=t;break;case"cap43":d.default.setCapUnlockMap(43,!0)}},e.compareVersion=function(e,t){e=e.split("."),t=t.split(".");for(var o=Math.max(e.length,t.length);e.length<o;)e.push("0");for(;t.length<o;)t.push("0");for(var n=0;n<o;n++){var i=parseInt(e[n]),r=parseInt(t[n]);if(i>r)return 1;if(i<r)return-1}return 0},Object.defineProperty(e,"ifBeginnerTask",{get:function(){var e=u.default.Level-1;return!(u.default.CurrentLevel>=7&&0==f.default.ThemeUnlockMap["11_1"])&&e>=3&&e<=17},enumerable:!1,configurable:!0}),e.platform=s,e._interAdSettlementCount=0,e._lastInterAdTime=0,e._lastRewardAdCloseTime=0,e._firstLoginTime=0,c([y],e)}());r.default=m,cc._RF.pop(),cc._RF.pop()},{}],GameOverChallengePanel:[function(e,t,o){"use strict";cc._RF.push(t,"622d1iwgUFPEpRjBsqmHb/g","GameOverChallengePanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"622d1iwgUFPEpRjBsqmHb/g","GameOverChallengePanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("CommonData"),d=n("const"),f=n("DataManager"),h=n("GameManager"),y=n("GoldDataManager"),m=n("GameManager_Multi"),g=n("DataNexusEnum"),v=n("DataNexusSDK"),_=n("BasePanel"),S=cc._decorator,b=S.ccclass,C=S.property,P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.title=null,t.text_score=null,t.text_record=null,t.dialog_gold=null,t}return s(t,e),t.prototype.onEnable=function(){u.default.instance.playSFX(u.AudioRef.Victory),this.setTitle(),this.setText();var e=m.default.challengeStartTime;e>0&&(m.default.challengeStartTime=0,h.default.platform.reportLevelTimeEvent("Challenge_PassTime",Math.floor((Date.now()-e)/1e3))),p.default.isToday(p.default.LastShareChallengeDate)&&(this.dialog_gold.active=!1),p.default.FreeChallengeTimes<0&&v.default.instance.trackAdPlacementShow(g.RewardADEvent.REPLAY)},t.prototype.setTitle=function(){m.default.getInstance().isNewRecord?(f.default.updateChallengeRecord(p.default.ChallengeRecord),this.title.setAnimation(0,"xjl",!1)):this.title.setAnimation(0,"tzwc",!1)},t.prototype.setText=function(){this.text_score.string="\u672c\u6b21\u5f97\u5206:"+m.default.getInstance().currentScore.toString(),this.text_record.string="\u5386\u53f2\u6700\u4f73:"+p.default.ChallengeRecord.toString()},t.prototype.onBtn_Restart=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),p.default.FreeChallengeTimes>0?(p.default.FreeChallengeTimes--,cc.director.loadScene(d.SceneNames.Challenge)):0===p.default.FreeChallengeTimes?h.default.platform.showShare(function(){p.default.FreeChallengeTimes--,cc.director.loadScene(d.SceneNames.Challenge)}):(v.default.instance.trackAdClick(g.RewardADEvent.REPLAY),h.default.platform.showRewardAD(function(){v.default.instance.trackAdVideoFinish(g.RewardADEvent.REPLAY),p.default.FreeChallengeTimes--,cc.director.loadScene(d.SceneNames.Challenge),h.default.platform.reportVideoEvent("StartPage_challengeBtn_video",2)})),cc.director.loadScene(cc.director.getScene().name)},t.prototype.onBtn_Home=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),cc.director.loadScene("Main")},t.prototype.onBtn_Share=function(){var e=this;u.default.instance.playSFX(u.AudioRef.ClickButton),h.default.platform.showShare(function(){p.default.isToday(p.default.LastShareChallengeDate)||(y.default.Gold+=100,e.dialog_gold.active=!1),f.default.uploadGoldCoin(y.default.Gold)})},l([C(sp.Skeleton)],t.prototype,"title",void 0),l([C(cc.Label)],t.prototype,"text_score",void 0),l([C(cc.Label)],t.prototype,"text_record",void 0),l([C(cc.Node)],t.prototype,"dialog_gold",void 0),l([b],t)}(_.default);r.default=P,cc._RF.pop(),cc._RF.pop()},{}],GameOverMainPanel:[function(e,t,o){"use strict";cc._RF.push(t,"d86adXOCedLwYqD7HGYBjwy","GameOverMainPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"d86adXOCedLwYqD7HGYBjwy","GameOverMainPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("BasePanel"),p=n("UIManager"),d=n("AudioManager"),f=n("CommonData"),h=n("GameManager"),y=n("const"),m=n("CollectionManager"),g=n("DataManager"),v=n("LevelManager"),_=n("PackageManger"),S=n("GoldDataManager"),b=n("BundleManager"),C=n("config"),P=cc._decorator,k=P.ccclass,w=P.property,I=[[1,0,0,0],[0,1,0,0],[0,0,1,0]],T=[[1,1,0,0],[0,1,1,0],[1,0,1,0],[1,0,0,20],[0,1,0,20],[0,0,1,20]],A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btns=null,t.btns_ringFight=null,t.btn_NextLevel=null,t.btn_Home=null,t.sidebarBtn=null,t.sidebarBtnWx=null,t.uiManager=null,t.Animation_Title=null,t.text_Gold=null,t.node7=null,t.unlockNode=null,t.btn_NextLevelSprite=null,t.nextLevelFrames=[],t.Animation_Titleback=null,t.winStreakSlider=null,t.winStreakLabel=null,t.sliderNumbers=[],t.CheckMarks=[],t.iconFrames=[],t.icon3=null,t.icon71=null,t.icon72=null,t.text72=null,t.reward3=[0,0,0,0],t.reward7=[0,0,0,0],t.initCapMap={1:!1,2:!1,3:!1,4:!1,5:!1,6:!1,7:!1,8:!1,9:!1,10:!1,11:!1,12:!1,13:!1,14:!1,15:!1},t.initCharacterMap={1:!1,2:!1,3:!1,4:!1},t.capNode1=null,t.characterNode1=null,t.title_winStreak=null,t.title_toCap=null,t.title_toCharacter=null,t}return s(t,e),t.prototype.onEnable=function(){this.initTitle(),this.initMap(),this.initBtn(),f.default.UnlockWinCount++,f.default.ifTestingB&&h.default.tryShowWxInterAd(),this.uiManager=this.node.parent.getComponent(p.default),("GameModeLong"==cc.director.getScene().name&&f.default.LevelChallenge>3||"Game"==cc.director.getScene().name&&f.default.Level>3)&&h.default.platform.showInterstitialAd(),console.error("ifSub",f.default.subUpdateNotice,"time",f.default.inGameShowSubUpdateNoticeTimes),f.default.Level>=5&&!f.default.subUpdateNotice&&f.default.inGameShowSubUpdateNoticeTimes>0&&!f.default.isToday(f.default.LastShowSubUpdateDate)&&(f.default.LastShowSubUpdateDate=f.default.getTodayDate(),h.default.platform.showSubGameUpdate(),f.default.inGameShowSubUpdateNoticeTimes--),h.default.platform.reportPageEvent("WinPage"),this.btn_NextLevel.active=!0,this.checkRingFight(),this.checkSideMode(),this.checkWinStreak(),this.initUnlockText(),this.checkCollectionUnlock(),this.updateChallengeLevel(),g.default.tryUpdateUserData()},t.prototype.onDisable=function(){S.default.Gold+=_.default.instance.getLevelGoldNum(),g.default.uploadGoldCoin(S.default.Gold)},t.prototype.updateChallengeLevel=function(){if(f.default.ifRestart=!1,!(f.default.Level<=300||f.default.CurrentLevel<=300))switch(f.default.currentLevelDifficulty){case 0:f.default.removeChallengeLevel0();break;case 1:f.default.removeChallengeLevel1();break;case 2:f.default.removeChallengeLevel2();break;case 3:f.default.removeChallengeLevel3();break;default:return}},t.prototype.initTitle=function(){var e=this;this.Animation_Title&&(this.Animation_Title.setAnimation(0,"gxgg_start",!1),this.Animation_Title.setCompleteListener(function(){e.Animation_Title.setAnimation(0,"gxgg_idle",!0)})),this.Animation_Titleback&&(this.Animation_Titleback.setAnimation(0,"animation",!1),this.Animation_Titleback.setCompleteListener(function(){e.Animation_Titleback.setAnimation(0,"animation_loop",!0)}))},t.prototype.initBtn=function(){v.default.getInstance().isSuperHardLevel(f.default.Level)?f.default.Level>=30&&f.default.Level%10==0?this.btn_NextLevelSprite.spriteFrame=this.nextLevelFrames[2]:this.btn_NextLevelSprite.spriteFrame=this.nextLevelFrames[1]:this.btn_NextLevelSprite.spriteFrame=this.nextLevelFrames[0]},t.prototype.initUnlockText=function(){},t.prototype.setSpriteFrame=function(e,t,o){var n=cc.assetManager.getBundle(o);n?n.load(t+"d",cc.Texture2D,function(n,i){n?console.error("\u52a0\u8f7d\u56fe\u7247"+t+"\u5931\u8d25:",n):(e.spriteFrame=new cc.SpriteFrame(i),"Animals"===o&&(e.node.scale=.15,e.node.width))}):cc.assetManager.loadBundle(o,function(n,i){i.load(t+"d",cc.Texture2D,function(n,i){n?console.error("\u52a0\u8f7d\u56fe\u7247"+t+"\u5931\u8d25:",n):(e.spriteFrame=new cc.SpriteFrame(i),"Animals"===o&&(e.node.scale=.15))}),n&&console.error("\u52a0\u8f7dCaps\u8d44\u6e90\u5305\u5931\u8d25:",n)})},t.prototype.checkRingFight=function(){if(C.currentPlatform!==C.platformEnum.wechat||cc.sys.isBrowser)return this.btns_ringFight.active=!1,void(this.btns.active=!0);f.default.winCountThisLife++,3==f.default.winCountThisLife&&h.default.compareVersion(wx.getAppBaseInfo().SDKVersion,"3.13.1")>=0?(this.btns.active=!1,this.btns_ringFight.active=!0,"ios"===wx.getDeviceInfo().platform||"android"===wx.getDeviceInfo().platform||"ohos"===wx.getDeviceInfo().platform?(this.btns.active=!1,this.btns_ringFight.active=!0):(this.btns.active=!0,this.btns_ringFight.active=!1)):(this.btns_ringFight.active=!1,this.btns.active=!0)},t.prototype.checkSideMode=function(){cc.director.getScene().name===y.SceneNames.GameModeMultiple&&(this.btn_Home.active=!0,this.btn_NextLevel.active=!0,this.sidebarBtn.active=!1,this.sidebarBtnWx.active=!1)},t.prototype.initMap=function(){for(var e=1;e<=m.default.capCollectionList.length;e++)this.initCapMap[e]=m.default.CapUnlockMap[e];for(e=1;e<=m.default.capCollectionList.length;e++)this.initCharacterMap[e]=m.default.CharacterUnlockMap[e]},t.prototype.checkWinStreak=function(){var e=this;JSON.stringify(f.default.Reward7)===JSON.stringify([0,0,0,0])&&(f.default.Reward7=T[Math.floor(Math.random()*T.length)]),this.reward3=I[f.default.Reward3],this.reward7=f.default.Reward7;var t=f.default.WinStreak;this.winStreakLabel.string=t.toString(),this.checkRound(t-1);var o=t%7;0==o&&(o=7),this.winStreakSlider.fillRange=(o-1)/7,this.checkRewardMark(o-1),this.checkWinSteakReward(o-1),cc.tween(this.winStreakSlider).delay(.3).to(.25,{fillRange:o/7}).call(function(){e.checkWinSteakReward(o),7==o&&(o=0,e.winStreakSlider.fillRange=0),e.checkRound(t),e.checkRewardMark(o)}).start()},t.prototype.checkRound=function(e){if(f.default.WinStreak%7==0&&e%7==0){var t=Math.random();f.default.Reward7=t<5/24?T[0]:t<.25?T[1]:t<7/24?T[2]:t<.625?T[3]:t<23/24?T[4]:T[5],f.default.Reward3=t<.28?0:1,this.reward3=I[f.default.Reward3],this.reward7=f.default.Reward7}for(var o=Math.floor(e/7),n=0;n<this.sliderNumbers.length;n++)this.sliderNumbers[n].string=(7*o+n+1).toString();var i=7*(o+1);if(i==m.default.unlockCapByWinStreakArray[m.default.CurrentCapByWinStreakIndex-1]&&0==m.default.CapUnlockMap[m.default.unlockCapByWinStreakArrayIndex[m.default.CurrentCapByWinStreakIndex-1]]){this.node7.active=!1,this.unlockNode.active=!0,this.capNode1.active=!0,this.characterNode1.active=!1;var r=this.capNode1.getComponent(cc.Sprite),a=m.default.unlockCapByWinStreakArrayIndex[m.default.CurrentCapByWinStreakIndex-1];this.setSpriteFrame(r,a,"Caps")}else i==m.default.unlockCharacterByWinStreakArray[m.default.CurrentCharacterByWinStreakIndex-1]&&0==m.default.CharacterUnlockMap[m.default.unlockCharacterByWinStreakArrayIndex[m.default.CurrentCharacterByWinStreakIndex-1]]?(this.node7.active=!1,this.unlockNode.active=!0,this.capNode1.active=!1,this.characterNode1.active=!0,r=this.characterNode1.getComponent(cc.Sprite),a=m.default.unlockCharacterByWinStreakArrayIndex[m.default.CurrentCharacterByWinStreakIndex-1],this.setSpriteFrame(r,a,"Animals")):(this.node7.active=!0,this.unlockNode.active=!1)},t.prototype.checkRewardMark=function(e){1==this.reward3[0]&&(this.icon3.spriteFrame=this.iconFrames[0]),1==this.reward3[1]&&(this.icon3.spriteFrame=this.iconFrames[1]),1==this.reward3[2]&&(this.icon3.spriteFrame=this.iconFrames[2]);for(var t=!0,o=0;o<4;o++)1==this.reward7[o]&&(t?(this.icon71.spriteFrame=this.iconFrames[o+0],t=!1):this.icon72.spriteFrame=this.iconFrames[o+0],1==this.reward7[3]?(this.icon72.node.scale=.35,this.text72.string="x20"):(this.icon72.node.scale=.5,this.text72.string="x1"));e<3?(this.CheckMarks[0].active=!1,this.CheckMarks[1].active=!1):e<7?(this.CheckMarks[0].active=!0,this.CheckMarks[1].active=!1):(this.CheckMarks[0].active=!0,this.CheckMarks[1].active=!0)},t.prototype.checkWinSteakReward=function(e){var t=f.default.WinStreak%7;if(0==t&&(t=7),3==e&&f.default.WinStreak%7==3)h.default.showRewardPanel(this.reward3);else if(7==e&&f.default.WinStreak%7==0){if(m.default.unlockCapByWinStreakArray[m.default.CurrentCapByWinStreakIndex-2]==f.default.WinStreak){var o=m.default.unlockCapByWinStreakArray.indexOf(f.default.WinStreak);return o=m.default.unlockCapByWinStreakArrayIndex[o],1==this.initCapMap[o]?void h.default.showRewardPanel(this.reward7):void h.default.showRewardPanel([0,0,0,0],o,1)}if(m.default.unlockCharacterByWinStreakArray[m.default.CurrentCharacterByWinStreakIndex-2]==f.default.WinStreak)return o=m.default.unlockCharacterByWinStreakArray.indexOf(f.default.WinStreak),o=m.default.unlockCharacterByWinStreakArrayIndex[o],1==this.initCharacterMap[o]?void h.default.showRewardPanel(this.reward7):void h.default.showRewardPanel([0,0,0,0],o,2);h.default.showRewardPanel(this.reward7)}if(2==e&&3==t)1==this.reward3[0]&&f.default.PropUndo++,1==this.reward3[1]&&f.default.PropPump++,1==this.reward3[2]&&f.default.PropAddCup++;else if(6==e&&7==t){if(0==this.node7.active)return;1==this.reward7[0]&&f.default.PropUndo++,1==this.reward7[1]&&f.default.PropPump++,1==this.reward7[2]&&f.default.PropAddCup++,1==this.reward3[3]&&(S.default.Gold+=20)}},t.prototype.checkCollectionUnlock=function(){var e=f.default.WinStreak,t=9999,o=9999;m.default.CurrentCapByWinStreakIndex<=m.default.unlockCapByWinStreakArray.length&&(t=m.default.unlockCapByWinStreakArray[m.default.CurrentCapByWinStreakIndex-1]),m.default.CurrentCharacterByWinStreakIndex<=m.default.unlockCharacterByWinStreakArray.length&&(o=m.default.unlockCharacterByWinStreakArray[m.default.CurrentCharacterByWinStreakIndex-1]);var n=Math.min(t,o);if(9999!==n&&e!=n)n===t?(this.title_winStreak.active=!1,this.title_toCap.active=!0,this.title_toCharacter.active=!1,this.winStreakLabel.string=(t-e).toString()):n===o&&(this.title_winStreak.active=!1,this.title_toCap.active=!1,this.title_toCharacter.active=!0,this.winStreakLabel.string=(o-e).toString());else{if(this.title_winStreak.active=!0,this.title_toCap.active=!1,this.title_toCharacter.active=!1,this.winStreakLabel.string=f.default.WinStreak.toString(),m.default.unlockCapByWinStreakArray.includes(f.default.WinStreak)){var i=m.default.unlockCapByWinStreakArray.indexOf(f.default.WinStreak);if(i=m.default.unlockCapByWinStreakArrayIndex[i],1==m.default.CapUnlockMap[i])return;return m.default.setCapUnlockMap(i,!0),void m.default.CurrentCapByWinStreakIndex++}if(m.default.unlockCharacterByWinStreakArray.includes(f.default.WinStreak)){if(i=m.default.unlockCharacterByWinStreakArray.indexOf(f.default.WinStreak),i=m.default.unlockCharacterByWinStreakArrayIndex[i],1==m.default.CharacterUnlockMap[i])return;return m.default.setCharacterUnlockMap(i,!0),void m.default.CurrentCharacterByWinStreakIndex++}}},t.prototype.onBtnClickMake=function(){d.default.instance.playSFX(d.AudioRef.ClickButton),this.uiManager.showPanel("DrinkMakingPanel"),h.default.platform.reportButtonEvent("GameOverPage_addWaterBtn",0),this.hide()},t.prototype.onBtn_NextLevel=function(){d.default.instance.playSFX(d.AudioRef.ClickButton),h.default.platform.reportButtonEvent("GameOverPage_nextLevelBtn",0),cc.director.loadScene(cc.director.getScene().name)},t.prototype.onBtn_Sidebar=function(){var e=this;if(d.default.instance.playSFX(d.AudioRef.ClickButton),h.default.platform.reportButtonEvent("GameOverPage_giftBtn",0),f.default.isToday(f.default.LastGetRewardDate))return h.default.platform.showTips("\u4eca\u65e5\u5df2\u9886\u53d6\u8fc7\u5956\u52b1"),void cc.tween(this.sidebarBtn).to(.2,{opacity:0,scale:0},{easing:"smooth"}).call(function(){e.sidebarBtn.active=!1}).start();this.uiManager.showPanel("SidebarPanel")},t.prototype.onBtn_SidebarWX=function(){d.default.instance.playSFX(d.AudioRef.ClickButton),h.default.platform.reportButtonEvent("GameOverPage_giftBtn",0),this.uiManager.showPanel("WxSidebarPanel")},t.prototype.onBtn_Home=function(){d.default.instance.playSFX(d.AudioRef.ClickButton),h.default.platform.reportButtonEvent("GameOverPage_homeBtn",0),cc.director.loadScene("Main")},t.prototype.onBtn_Share=function(){d.default.instance.playSFX(d.AudioRef.ClickButton),h.default.platform.reportButtonEvent("GameOverPage_shareBtn",0),h.default.platform.showShare()},t.prototype.onBtn_RingFight=function(){d.default.instance.playSFX(d.AudioRef.ClickButton),h.default.platform.reportButtonEvent("GameOverPage_RingFightBtn",0),b.default.getInstance().loadBundle("RingFight",function(e){e||(d.default.instance.stopAll(),cc.director.loadScene(y.SceneNames.RingFight))})},l([w(cc.Node)],t.prototype,"btns",void 0),l([w(cc.Node)],t.prototype,"btns_ringFight",void 0),l([w(cc.Node)],t.prototype,"btn_NextLevel",void 0),l([w(cc.Node)],t.prototype,"btn_Home",void 0),l([w(cc.Node)],t.prototype,"sidebarBtn",void 0),l([w(cc.Node)],t.prototype,"sidebarBtnWx",void 0),l([w(p.default)],t.prototype,"uiManager",void 0),l([w(sp.Skeleton)],t.prototype,"Animation_Title",void 0),l([w(cc.Label)],t.prototype,"text_Gold",void 0),l([w(cc.Node)],t.prototype,"node7",void 0),l([w(cc.Node)],t.prototype,"unlockNode",void 0),l([w(cc.Sprite)],t.prototype,"btn_NextLevelSprite",void 0),l([w([cc.SpriteFrame])],t.prototype,"nextLevelFrames",void 0),l([w(sp.Skeleton)],t.prototype,"Animation_Titleback",void 0),l([w(cc.Sprite)],t.prototype,"winStreakSlider",void 0),l([w(cc.Label)],t.prototype,"winStreakLabel",void 0),l([w([cc.Label])],t.prototype,"sliderNumbers",void 0),l([w([cc.Node])],t.prototype,"CheckMarks",void 0),l([w([cc.SpriteFrame])],t.prototype,"iconFrames",void 0),l([w(cc.Sprite)],t.prototype,"icon3",void 0),l([w(cc.Sprite)],t.prototype,"icon71",void 0),l([w(cc.Sprite)],t.prototype,"icon72",void 0),l([w(cc.Label)],t.prototype,"text72",void 0),l([w(cc.Node)],t.prototype,"capNode1",void 0),l([w(cc.Node)],t.prototype,"characterNode1",void 0),l([w(cc.Node)],t.prototype,"title_winStreak",void 0),l([w(cc.Node)],t.prototype,"title_toCap",void 0),l([w(cc.Node)],t.prototype,"title_toCharacter",void 0),l([k],t)}(u.default);r.default=A,cc._RF.pop(),cc._RF.pop()},{}],GameOverPanel_BP:[function(e,t,o){"use strict";cc._RF.push(t,"efb02+zpwxLgZg73ZMvA/P5","GameOverPanel_BP");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"efb02+zpwxLgZg73ZMvA/P5","GameOverPanel_BP");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("LevelDataMgr_BP"),p=n("ExternalManager_BP"),d=n("GameManager_BP"),f=n("AudioManager_BP"),h=cc._decorator,y=h.ccclass,m=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.text_DropNum=null,t.btn_NextLevel=null,t.btn_Home=null,t.Animation_Title=null,t.Animation_Titleback=null,t.Animation_ribbon=[],t}return s(t,e),t.prototype.onLoad=function(){this.btn_NextLevel&&this.btn_NextLevel.on(cc.Node.EventType.TOUCH_END,this.onBtn_NextLevel,this),this.btn_Home&&this.btn_Home.on(cc.Node.EventType.TOUCH_END,this.onBtn_Home,this)},t.prototype.onEnable=function(){this.refreshText(),this.playShowAnim()},t.prototype.show=function(e){this.node.active=!0,this.setCompletedLevels(e),this.playShowAnim()},t.prototype.hide=function(){this.node.active=!1},t.prototype.refreshText=function(){var e,t,o=null!==(t=null===(e=d.default.instance)||void 0===e?void 0:e.getCompletedLevels())&&void 0!==t?t:0;this.setCompletedLevels(o)},t.prototype.setCompletedLevels=function(e){this.text_DropNum&&(this.text_DropNum.string="\u5df2\u5b8c\u6210 "+e+" \u4e2a\u5173\u5361\uff01")},t.prototype.playShowAnim=function(){var e=this;if(this.Animation_Title&&(this.Animation_Title.setAnimation(0,"gxgg_start",!1),this.Animation_Title.setCompleteListener(function(){e.Animation_Title.setAnimation(0,"gxgg_idle",!0)})),this.Animation_Titleback&&(this.Animation_Titleback.setAnimation(0,"animation",!1),this.Animation_Titleback.setCompleteListener(function(){e.Animation_Titleback.setAnimation(0,"animation_loop",!0)})),this.Animation_ribbon)for(var t=function(e){var t=o.Animation_ribbon[e];t.setAnimation(0,"animation",!1),t.setCompleteListener(function(){t.setAnimation(0,"animation_loop",!0)})},o=this,n=0;n<this.Animation_ribbon.length;n++)t(n);this.node.opacity=0,cc.tween(this.node).to(.5,{opacity:255}).start()},t.prototype.onBtn_NextLevel=function(){f.default.instance.playBtn();var e=d.default.instance;if(e){var t=e.getCurrentLevel()+1;u.LevelDataMgr_BP.getLevelData(t),this.hide(),e.startLevel(t)}},t.prototype.onBtn_Home=function(){p.default.backHome()},l([m(cc.Label)],t.prototype,"text_DropNum",void 0),l([m(cc.Node)],t.prototype,"btn_NextLevel",void 0),l([m(cc.Node)],t.prototype,"btn_Home",void 0),l([m(sp.Skeleton)],t.prototype,"Animation_Title",void 0),l([m(sp.Skeleton)],t.prototype,"Animation_Titleback",void 0),l([m(sp.Skeleton)],t.prototype,"Animation_ribbon",void 0),l([y],t)}(cc.Component);r.default=g,cc._RF.pop(),cc._RF.pop()},{}],GameOverPanel:[function(e,t,o){"use strict";cc._RF.push(t,"9a9f2Gy91pCzINWXuAbaq21","GameOverPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"9a9f2Gy91pCzINWXuAbaq21","GameOverPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("BasePanel"),p=n("UIManager"),d=n("GameScene"),f=n("AudioManager"),h=n("CommonData"),y=n("GameManager"),m=n("config"),g=n("const"),v=cc._decorator,_=v.ccclass,S=v.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.text_DropNum=null,t.btn_NextLevel=null,t.img_NextLevel=null,t.img_NextLevelSpriteFrames=[],t.btn_Make=null,t.btn_Home=null,t.sidebarBtn=null,t.sidebarBtnWx=null,t.text_newFeature=null,t.layout_Drop=null,t.uiManager=null,t.Animation_Title=null,t.Animation_Titleback=null,t}return s(t,e),t.prototype.onEnable=function(){var e;this.initTitle(),this.uiManager=this.node.parent.getComponent(p.default),("GameModeLong"==cc.director.getScene().name&&h.default.LevelChallenge>3||"Game"==cc.director.getScene().name&&h.default.Level>3)&&y.default.platform.showInterstitialAd(),y.default.platform.reportPageEvent("WinPage"),e="Game"==cc.director.getScene().name?d.default.instance.cupMgr.getDropNum():20,this.text_DropNum.string="+"+e,this.btn_NextLevel.active=!0,this.btn_Make.active=!1,this.CheckSidebar(),this.CheckSidebarWX(),this.popOutNewFeature(),this.checkSideMode(),this.initNextLevelButton()},t.prototype.initTitle=function(){var e=this;this.Animation_Title&&(this.Animation_Title.setAnimation(0,"gxgg_start",!1),this.Animation_Title.setCompleteListener(function(){e.Animation_Title.setAnimation(0,"gxgg_idle",!0)})),this.Animation_Titleback&&(this.Animation_Titleback.setAnimation(0,"animation",!1),this.Animation_Titleback.setCompleteListener(function(){e.Animation_Titleback.setAnimation(0,"animation_loop",!0)}))},t.prototype.initNextLevelButton=function(){this.btn_Make.active?this.img_NextLevel.spriteFrame=this.img_NextLevelSpriteFrames[0]:this.img_NextLevel.spriteFrame=this.img_NextLevelSpriteFrames[1]},t.prototype.checkSideMode=function(){var e=cc.director.getScene().name;(e===g.SceneNames.GameModeMultiple||e===g.SceneNames.GameModeFillLong)&&(this.layout_Drop.active=!1,this.btn_Home.active=!0,this.btn_NextLevel.active=!0,this.btn_Make.active=!1,this.sidebarBtn.active=!1,this.sidebarBtnWx.active=!1)},t.prototype.popOutNewFeature=function(){this.text_newFeature&&cc.director.getScene().name===g.SceneNames.Game&&7==h.default.Level&&(this.text_newFeature.active=!0,this.text_newFeature.opacity=0,this.text_newFeature.scale=0,cc.tween(this.text_newFeature).parallel(cc.tween().to(.5,{opacity:255,scale:1},{easing:"sineIn"}),cc.tween().by(.15,{rotation:20}).by(.15,{rotation:-20}).union().repeat(5)).start())},t.prototype.CheckSidebar=function(){if(h.default.Level<=5)this.sidebarBtn.active=!1;else if(m.currentPlatform===m.platformEnum.toutiao){var e=this,t=!1;h.default.SideBarRewardCount>7?this.sidebarBtn.active=!1:h.default.isToday(h.default.LastGetRewardDate)?this.sidebarBtnWx.active=!1:(h.default.ifOpenBySidebar&&!h.default.isToday(h.default.LastGetRewardDate)&&(t=!0),window.tt&&m.currentPlatform===m.platformEnum.toutiao&&tt.onShow(function(t){"homepage"===t.launch_from&&"sidebar_card"===t.location&&(h.default.ifOpenBySidebar=!0,h.default.isToday(h.default.LastGetRewardDate)||e.uiManager.showPanel("SidebarPanel"))}),m.currentPlatform===m.platformEnum.toutiao?y.default.platform.checkSidebarState().then(function(){e.sidebarBtn.active=!0,"021036"===y.default.platform.getLaunchOptions("scene")&&(h.default.ifOpenBySidebar=!0,h.default.isToday(h.default.LastGetRewardDate)||e.uiManager.showPanel("SidebarPanel"))}).catch(function(){e.sidebarBtn.active=!1}):e.sidebarBtn.active=!1,t&&e.uiManager.showPanel("SidebarPanel"))}else this.sidebarBtn.active=!1},t.prototype.CheckSidebarWX=function(){this.sidebarBtnWx.active=!1},t.prototype.onBtnClickMake=function(){var e=this;f.default.instance.playSFX(f.AudioRef.ClickButton),y.default.platform.reportButtonEvent("GameOverPage_addWaterBtn",0),this.hide(function(){e.uiManager.showPanel("DrinkMakingPanel")})},t.prototype.onBtn_NextLevel=function(){f.default.instance.playSFX(f.AudioRef.ClickButton),y.default.platform.reportButtonEvent("GameOverPage_nextLevelBtn",0),cc.director.loadScene(cc.director.getScene().name)},t.prototype.onBtn_Sidebar=function(){var e=this;if(f.default.instance.playSFX(f.AudioRef.ClickButton),y.default.platform.reportButtonEvent("GameOverPage_giftBtn",0),h.default.isToday(h.default.LastGetRewardDate))return y.default.platform.showTips("\u4eca\u65e5\u5df2\u9886\u53d6\u8fc7\u5956\u52b1"),void cc.tween(this.sidebarBtn).to(.2,{opacity:0,scale:0},{easing:"smooth"}).call(function(){e.sidebarBtn.active=!1}).start();this.uiManager.showPanel("SidebarPanel")},t.prototype.onBtn_SidebarWX=function(){f.default.instance.playSFX(f.AudioRef.ClickButton),y.default.platform.reportButtonEvent("GameOverPage_giftBtn",0),this.uiManager.showPanel("WxSidebarPanel")},t.prototype.onBtn_Home=function(){f.default.instance.playSFX(f.AudioRef.ClickButton),y.default.platform.reportButtonEvent("GameOverPage_homeBtn",0),y.default.forceGC(),cc.director.loadScene("Main")},l([S(cc.Label)],t.prototype,"text_DropNum",void 0),l([S(cc.Node)],t.prototype,"btn_NextLevel",void 0),l([S(cc.Sprite)],t.prototype,"img_NextLevel",void 0),l([S([cc.SpriteFrame])],t.prototype,"img_NextLevelSpriteFrames",void 0),l([S(cc.Node)],t.prototype,"btn_Make",void 0),l([S(cc.Node)],t.prototype,"btn_Home",void 0),l([S(cc.Node)],t.prototype,"sidebarBtn",void 0),l([S(cc.Node)],t.prototype,"sidebarBtnWx",void 0),l([S(cc.Node)],t.prototype,"text_newFeature",void 0),l([S(cc.Node)],t.prototype,"layout_Drop",void 0),l([S(p.default)],t.prototype,"uiManager",void 0),l([S(sp.Skeleton)],t.prototype,"Animation_Title",void 0),l([S(sp.Skeleton)],t.prototype,"Animation_Titleback",void 0),l([_],t)}(u.default);r.default=b,cc._RF.pop(),cc._RF.pop()},{}],GameOverPnl_ED:[function(e,t,o){"use strict";cc._RF.push(t,"eb8ebyIN9ZCtISrVBi2B3rc","GameOverPnl_ED");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"eb8ebyIN9ZCtISrVBi2B3rc","GameOverPnl_ED");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager_ED"),p=n("DataManager_ED"),d=n("ExternalManager_ED"),f=n("GameManager_ED"),h=n("UIManager_ED"),y=n("BasePanel_ED"),m=n("PropPnl_ED"),g=cc._decorator,v=g.ccclass,_=g.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scoreLabel=null,t.newRecord=null,t}return s(t,e),t.prototype.init=function(){var e=this;h.default.instance.PropPnl.active?h.default.instance.PropPnl.getComponent(m.default).hide(function(){e._onInit()}):this._onInit()},t.prototype._onInit=function(){this.scoreLabel.string=f.default.instance.completedAmounts+"",this.newRecord.active=f.default.instance.completedAmounts>p.default.bestScore,p.default.bestScore=Math.max(f.default.instance.completedAmounts,p.default.bestScore)},t.prototype.clickReplay=function(){u.default.instance.playBtn(),cc.director.loadScene("EndlessBottle")},t.prototype.clickHome=function(){u.default.instance.playBtn(),d.default.backHome()},t.prototype.clickShare=function(){u.default.instance.playBtn(),d.default.showShare()},l([_(cc.Label)],t.prototype,"scoreLabel",void 0),l([_(cc.Node)],t.prototype,"newRecord",void 0),l([v],t)}(y.default);r.default=S,cc._RF.pop(),cc._RF.pop()},{}],GameOverRankData:[function(e,t,o){"use strict";cc._RF.push(t,"2aa9b55P5tKSK5GkZUyks0O","GameOverRankData");var n=t,i=o;cc._RF.push(n,"2aa9b55P5tKSK5GkZUyks0O","GameOverRankData"),Object.defineProperty(i,"__esModule",{value:!0}),i.getPoolSizeByRank=void 0;var r=[100,100,100,100,100,100,100,100,100,100,100],a=[[],[1,5],[6,20],[21,35],[36,50],[51,70],[71,90],[91,140],[141,190],[191,240],[241,300],[301,400]];i.getPoolSizeByRank=function(e){var t;return null!==(t=r[e])&&void 0!==t?t:100};var c=function(){function e(){this.userData=null}return e.prototype.loadData=function(e){var t=this;if(null==this.userData){var o=cc.assetManager.getBundle("WaterSortConfig");o&&o.load("userData",cc.JsonAsset,function(o,n){o||(t.userData=n,e&&e())})}else e&&e()},e.prototype.getOneUserData=function(){var t=this;if(null!=this.userData){var o=this.userData.json.names,n=this.userData.json.avatars;e.userDataIndex>=o.length&&(e.userDataIndex=0);var i={name:o[e.userDataIndex],avatar:n[e.userDataIndex]};return e.userDataIndex++,i}this.loadData(function(){t.getOneUserData()})},e.prototype.createPool=function(){var t=this;if(null!=this.userData){e.currentUserPool=[];for(var o=r[e.currentRank],n=a[e.currentRank],i=[],c=n[0],s=n[1]-c+1,l=0;l<s;l++)i.push(c+l),i.push(c+l);for(l=i.length;l<o;l++)i.push(Math.floor(Math.random()*s)+c);for(l=0;l<o;l++){var u=this.getOneUserData(),p=i[l];e.currentUserPool.push({name:u.name,avatar:u.avatar,level:p})}}else this.loadData(function(){t.createPool()})},e.prototype.clearPool=function(){e.currentUserPool=[]},e.prototype.sortPool=function(){e.currentUserPool.sort(function(e,t){return t.level-e.level})},e.prototype.getPool=function(){return e.currentUserPool},e.currentRank=0,e.currentUserPool=[],e.userDataIndex=0,e}();i.default=c,cc._RF.pop(),cc._RF.pop()},{}],GameOverRankItem:[function(e,t,o){"use strict";cc._RF.push(t,"e7f3cUvhJ1K9bnKaP8feKVK","GameOverRankItem");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"e7f3cUvhJ1K9bnKaP8feKVK","GameOverRankItem");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("GameOverRankData"),p=n("config"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.avatarSprite=null,t.rankLabel=null,t.nameLabel=null,t.scoreLabel=null,t.baseSprite=null,t.playerBaseSpriteFrame=null,t}return s(t,e),t.prototype.updateItem=function(e){var t=this,o=u.default.currentUserPool[e].avatar,n=u.default.currentUserPool[e].name,i=u.default.currentUserPool[e].level;u.default.currentUserPool[e].isPlayer&&u.default.currentUserPool[e].isPlayer,""!==o&&this.getImg(o).then(function(e){t.avatarSprite.spriteFrame=e}),this.rankLabel.string=(e+1).toString(),this.nameLabel.string=n,this.scoreLabel.string=i.toString()},t.prototype.getImg=function(e){return new Promise(function(t){if(e){var o=null;p.currentPlatform===p.platformEnum.wechat?o=wx.createImage():p.currentPlatform===p.platformEnum.toutiao&&(o=tt.createImage()),o.src=e,o.onload=function(){var e=new cc.Texture2D;e.initWithElement(o),e.handleLoadedTexture(),t(new cc.SpriteFrame(e))}}else t(null)})},l([h(cc.Sprite)],t.prototype,"avatarSprite",void 0),l([h(cc.Label)],t.prototype,"rankLabel",void 0),l([h(cc.Label)],t.prototype,"nameLabel",void 0),l([h(cc.Label)],t.prototype,"scoreLabel",void 0),l([h(cc.Sprite)],t.prototype,"baseSprite",void 0),l([h(cc.SpriteFrame)],t.prototype,"playerBaseSpriteFrame",void 0),l([f],t)}(cc.Component);r.default=y,cc._RF.pop(),cc._RF.pop()},{}],GameOverRankPanel:[function(e,t,o){"use strict";cc._RF.push(t,"c796deZAbVJHasOu7DnzJ5D","GameOverRankPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"c796deZAbVJHasOu7DnzJ5D","GameOverRankPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("BasePanel"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.text="hello",t}return s(t,e),t.prototype.start=function(){},l([f(cc.Label)],t.prototype,"label",void 0),l([f],t.prototype,"text",void 0),l([d],t)}(u.default);r.default=h,cc._RF.pop(),cc._RF.pop()},{}],GameOverRankScroll:[function(e,t,o){"use strict";cc._RF.push(t,"16055dscHJGHIwFj8kOA9o8","GameOverRankScroll");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"16055dscHJGHIwFj8kOA9o8","GameOverRankScroll");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},p=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0});var d=n("GameOverRankItem"),f=cc._decorator,h=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.viewContent=null,t.maskNode=null,t.scroll=null,t.itemPrefab=null,t.startPos=null,t.cachePool=[],t.dataList=[],t.maxNum=6,t.itemHeight=300,t.initY=0,t.maxY=0,t.minY=0,t.needSize=0,t.visibleHeight=0,t.curOffset=0,t.miniIdx=0,t.showItemList=[],t.headList=[],t}return s(t,e),t.prototype.onLoad=function(){return u(this,void 0,void 0,function(){return p(this,function(){return this.startPos=cc.v2(this.viewContent.position.x,this.viewContent.position.y),this.visibleHeight=this.maskNode.getContentSize().height,this.scroll.node.on("scrolling",this.onScrolling.bind(this),this),[2]})})},t.prototype.onEnable=function(){this.cachePool=[],this.dataList=[],this.viewContent.height=0,this.initY=-this.itemHeight/2+0*this.itemHeight,this.curOffset=0,this.miniIdx=0,this.showItemList=[];for(var e=0;e<100;e++)this.dataList.push(e+1);this.loadList(),this.startPos&&(this.viewContent.position=this.startPos)},t.prototype.start=function(){},t.prototype.loadList=function(){this.viewContent.destroyAllChildren(),this.InitObjs(0),this.needSize=this.dataList.length*this.itemHeight,this.viewContent.setContentSize(new cc.Size(this.viewContent.getContentSize().width,this.needSize))},t.prototype.InitObjs=function(e){void 0===e&&(e=0);for(var t=0,o=e;o<e+this.maxNum&&this.dataList[o];o++){var n=cc.instantiate(this.itemPrefab);n.parent=this.viewContent,n.active=!0,t=this.initY-this.itemHeight*o,n.position=cc.v3(0,t),this.onRefresh(n,o+"",o),this.showItemList.push(n)}},t.prototype.countBorder=function(e){var t=this.visibleHeight;this.minY=e,this.maxY=e+t},t.prototype.refresh=function(){var e=this.curOffset,t=this.needSize;if(!(e<0||e+this.visibleHeight>=t)){var o=0;this.countBorder(e);var n=this.miniIdx,i=Math.floor(e/this.itemHeight);if(this.miniIdx!=i){var r=this.initY-this.itemHeight*i,a=this.initY-this.itemHeight*(i+this.maxNum),c=[],s=[];this.showItemList.forEach(function(e,t){e.position.y>r||e.position.y<=a?c.push(e.uuid):s.push(n+t)});for(var l=this.showItemList.length-1;l>=0;l--){var u=this.showItemList[l];c.indexOf(u.uuid)>=0&&(this.cachePool.push(u),this.showItemList.splice(l,1))}this.miniIdx=i;for(var p=0;p<this.maxNum;p++)o=this.miniIdx+p,s.indexOf(o)<0&&this.refreshItem(o,p)}}},t.prototype.refreshItem=function(e,t){if(!(e<0||e>=this.dataList.length)){var o,n=this.cachePool.pop();null!=n?(o=this.initY-this.itemHeight*e,n.position=cc.v3(0,o),n.active=!0,this.onRefresh(n,t,e),this.showItemList.push(n),this.showItemList.sort(function(e,t){return-e.position.y+t.position.y})):console.error("obj is null\uff01")}},t.prototype.onRefresh=function(e,t,o){e.getComponent(d.default).updateItem(this.dataList[o])},t.prototype.onScrolling=function(){var e=this.scroll.getScrollOffset();this.curOffset=e.y,this.refresh()},l([y(cc.Node)],t.prototype,"viewContent",void 0),l([y(cc.Node)],t.prototype,"maskNode",void 0),l([y(cc.ScrollView)],t.prototype,"scroll",void 0),l([y(cc.Prefab)],t.prototype,"itemPrefab",void 0),l([h],t)}(cc.Component);r.default=m,cc._RF.pop(),cc._RF.pop()},{}],GameOver_Gold:[function(e,t,o){"use strict";cc._RF.push(t,"b18a1T3he1NiKPtgQpOZl8Y","GameOver_Gold");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"b18a1T3he1NiKPtgQpOZl8Y","GameOver_Gold");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("PackageManger"),d=n("GoldDataManager"),f=cc._decorator,h=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.text_goldGet=null,t.text_goldTotal=null,t.coinPrefab=null,t.startPos=cc.v2(-45,-65),t.endPos=cc.v2(-215,700),t}return s(t,e),t.prototype.start=function(){this.text_goldGet.string="+"+p.default.instance.getLevelGoldNum().toString(),this.text_goldTotal.string=d.default.Gold.toString(),this.playCoinAnimation()},t.prototype.playCoinAnimation=function(){for(var e=this,t=function(t){o.scheduleOnce(function(){var o=cc.instantiate(e.coinPrefab);o.parent=e.node,o.setPosition(e.startPos.x+30*Math.random()-15,e.startPos.y+100+20*Math.random());var n=.9+.2*Math.random();o.scale*=n;var i=e.endPos,r=cc.v2(e.startPos.x+400*(Math.random()-.5),e.startPos.y-100*Math.random()),a=cc.v2(i.x+400*(Math.random()-.5),i.y+50*Math.random());cc.tween(o).parallel(cc.tween().bezierTo(.8,r,a,i),cc.tween().delay(.7).to(.1,{scale:0}),cc.tween().by(.8,{angle:1080})).call(function(){if(0==t){u.default.instance.playSFX(u.AudioRef.GoldCoinOver);var o=d.default.Gold,n=d.default.Gold+p.default.instance.getLevelGoldNum(),i=.4/p.default.instance.getLevelGoldNum();e.schedule(function(){o+=3,e.text_goldTotal.string=o.toString(),o>=n&&(e.text_goldTotal.string=n.toString(),e.unscheduleAllCallbacks())},i)}}).start()},.1*t)},o=this,n=0;n<5;n++)t(n)},l([y(cc.Label)],t.prototype,"text_goldGet",void 0),l([y(cc.Label)],t.prototype,"text_goldTotal",void 0),l([y(cc.Prefab)],t.prototype,"coinPrefab",void 0),l([h],t)}(cc.Component);r.default=m,cc._RF.pop(),cc._RF.pop()},{}],GamePnl_SS:[function(e,t,o){"use strict";cc._RF.push(t,"2539aNrmSlNPrZRqKP03fDp","GamePnl_SS");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"2539aNrmSlNPrZRqKP03fDp","GamePnl_SS");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=n("AutoPlay_SS"),d=n("CommonData_SS"),f=n("DataManager_SS"),h=n("GameManager_SS"),y=n("MusicManager_SS"),m=n("UIManager_SS"),g=cc._decorator,v=g.ccclass,_=g.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gameNode=null,t.testNode=null,t.autoOpenTip=null,t.tips=null,t.tipsBtn=null,t.levelLabelShadow=null,t.levelLabel=null,t.speed=null,t.speedSF=[],t.TipsLevel=[14,18,24,26,31,35,39,41,45,48,121,127,128,129,145,146,147,148,149,150,154,155,156,157,158,159,161,162,163,164,166,169,171,172,173,174,175,179,181,187,189,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207],t.screwSortGamePrefab=null,t}return s(t,e),t.prototype.onEnable=function(){d.default.curScene="game"},t.prototype.onDisable=function(){d.default.curScene="start"},t.prototype.start=function(){this.testNode.active=u.default.ifTest,this.speed.spriteFrame=this.speedSF[f.default.ifTwiceSpeed?1:0],d.default.mode=d.default.gameMode.normal,this.enterGame()},t.prototype.enterGame=function(){this.gameStart()},t.prototype.gameStart=function(){this.node.active=!0,this.levelLabelShadow.string=f.default.curLevel.toString(),this.levelLabel.string=f.default.curLevel.toString(),d.default.mode==d.default.gameMode.configured&&-1!=this.TipsLevel.indexOf(f.default.curLevel)?this.tipsBtn.active=!0:this.tipsBtn.active=!1,this.gameNode.removeAllChildren(!0);var e=cc.instantiate(this.screwSortGamePrefab);e.parent=this.gameNode,m.default.instance.topPnlCtrl.switchSetBtn(!0),d.default.ScrewSortGame=e,d.default.ScrewSortCtrl=e.getComponent("ScrewSortGame_SS")},t.prototype.gameClose=function(){y.default.instance.BGMStop(),cc.director.loadScene("Main")},t.prototype.clickSpeed=function(){h.default.playVibrateShort(),f.default.ifTwiceSpeed=!f.default.ifTwiceSpeed,this.speed.spriteFrame=this.speedSF[f.default.ifTwiceSpeed?1:0]},t.prototype.clickShowTips=function(){h.default.playVibrateShort(),this.tips.active=!0,cc.tween(this.tips).to(.2,{scale:1},{easing:"smooth"}).start()},t.prototype.clickCloseTips=function(){var e=this;h.default.playVibrateShort(),cc.tween(this.tips).to(.2,{scale:0},{easing:"smooth"}).call(function(){e.tips.active=!1}).start()},t.prototype.clickAutoPlay=function(){var e=this;if(u.default.ifTest&&d.default.mode===d.default.gameMode.normal){if(d.default.ScrewSortCtrl.ifDuringGenerate)return;d.default.ifOpenAuto=!d.default.ifOpenAuto,this.autoOpenTip.getChildByName("label").getComponent(cc.Label).string=d.default.ifOpenAuto?"Auto On":"Auto Off",this.autoOpenTip.stopAllActions(),this.autoOpenTip.opacity=255,cc.tween(this.autoOpenTip).delay(1).to(1,{opacity:0}).start(),d.default.ifOpenAuto&&(d.default.ScrewSortCtrl.canOperate=!1,d.default.ScrewSortCtrl.screwInOperation.length>0?d.default.ScrewSortCtrl.steelLayer.children[d.default.ScrewSortCtrl.lastSteelIndex].getComponent("ScrewSortSteel_SS").retreatScrew(function(){e.scheduleOnce(function(){p.default.startAutoPlay()},2.5)}):this.scheduleOnce(function(){p.default.startAutoPlay()},2.5))}},l([_(cc.Node)],t.prototype,"gameNode",void 0),l([_(cc.Node)],t.prototype,"testNode",void 0),l([_(cc.Node)],t.prototype,"autoOpenTip",void 0),l([_(cc.Node)],t.prototype,"tips",void 0),l([_(cc.Node)],t.prototype,"tipsBtn",void 0),l([_(cc.Label)],t.prototype,"levelLabelShadow",void 0),l([_(cc.Label)],t.prototype,"levelLabel",void 0),l([_(cc.Sprite)],t.prototype,"speed",void 0),l([_(cc.SpriteFrame)],t.prototype,"speedSF",void 0),l([_(cc.Prefab)],t.prototype,"screwSortGamePrefab",void 0),l([v],t)}(cc.Component);r.default=S,cc._RF.pop(),cc._RF.pop()},{}],GameScene_Long:[function(e,t,o){"use strict";cc._RF.push(t,"d90d3E6p95O1J4KMD23ERql","GameScene_Long");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"d90d3E6p95O1J4KMD23ERql","GameScene_Long");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0}),r.TUTORIAL_INDEX=void 0;var u=n("AudioManager"),p=n("CupMgr_Long"),d=n("CommonData"),f=n("PropPanel"),h=n("UIManager"),y=n("GameManager"),m=n("config"),g=n("toutiao"),v=n("const"),_=n("AutoPlayerFillLong"),S=cc._decorator,b=S.ccclass,C=S.property;r.TUTORIAL_INDEX=[3,6,7];var P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cupMgr=null,t.uiManager=null,t.autoPlayer=null,t.text_level=null,t.text_actionNum=null,t.text_propCount=[],t.propBtns=[],t.propEffects=[],t.root_Tips=null,t.root_Tips_finger=null,t.icon_Tips=null,t.text_Tips=null,t.bottom=null,t.top=null,t.testNode=null,t.text_infinity=null,t.fireWorkPrefab=null,t.btn_AutoPlay=null,t.btn_AutoPlayLevel=null,t.btn_Setting=null,t.startTime=0,t.tipsStay="",t.editBox=null,t.text_AutoPlay=null,t.clickTimeAutoPlay=0,t.propPanel=null,t}var o;return s(t,e),o=t,Object.defineProperty(t,"instance",{get:function(){return this._instance},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){var e=this,t=cc.find("Canvas").getComponent(cc.Canvas);d.default.CurrentLevel=d.default.Level,d.default.ratio<2?(t.fitHeight=!0,t.fitWidth=!1):(t.fitHeight=!1,t.fitWidth=!0),"windows"===d.default.platform&&(t.fitHeight=!0,t.fitWidth=!1),o._instance=this,cc.director.on("level_finish",this.onFinishOneLevel,this),cc.director.on("do_pour",this.onPourAction,this),cc.director.on("use_prop",function(t){e.useProp(t)},this),cc.director.on("load_level",this.updateUI,this),cc.director.on("load_level",this.opening,this),cc.director.on("color_changed",this.updateUI,this),u.default.instance.playBGM(u.AudioRef.LevelBGM,!0),cc.director.getScene().name===v.SceneNames.Game?d.default.mode="normal":cc.director.getScene().name===v.SceneNames.GameModeMultiple&&(d.default.mode="multiple")},t.prototype.onDestroy=function(){var e=this;cc.director.off("level_finish",this.onFinishOneLevel,this),cc.director.off("do_pour",this.onPourAction,this),cc.director.off("use_prop",function(t){e.useProp(t)},this),cc.director.off("load_level",this.updateUI,this),cc.director.off("load_level",this.opening,this),cc.director.off("color_changed",this.updateUI,this)},t.prototype.start=function(){y.default.platform.reportPageEvent("Startlevel"),this.bottom.active=!1,this.cupMgr=p.default.getInstance(),this.propPanel=this.node.parent.getChildByName("UIRoot").getComponentInChildren(f.default),this.testNode.active=d.default.ifTest,cc.director.getScene().name===v.SceneNames.Game?(this.text_level.string="\u7b2c "+d.default.Level+" \u5173",this.text_infinity.active=d.default.Level<=3&&d.default.Level>1):cc.director.getScene().name===v.SceneNames.GameModeMultiple?(this.text_level.string="\u7b2c "+d.default.LevelModeMultiple+" \u5173",this.text_infinity.active=!1):cc.director.getScene().name===v.SceneNames.GameModeFillLong&&(this.text_level.string="\u7b2c "+d.default.LevelModeFillLong+" \u5173",this.text_infinity.active=!1),this.startTime=Date.now(),m.currentPlatform===m.platformEnum.toutiao?(this.btn_AutoPlay.active=!1,this.btn_AutoPlayLevel.active=!0):m.currentPlatform===m.platformEnum.wechat&&(this.btn_AutoPlay.active=!0,this.btn_AutoPlayLevel.active=!0)},t.prototype.opening=function(){var e=this;cc.tween(this.bottom).to(.6,{y:-835},{easing:"sineIn"}).start(),cc.tween(this.top).to(.6,{y:835},{easing:"sineIn"}).start(),cc.tween(this.cupMgr.node).to(.4,{x:0},{easing:"sineIn"}).call(function(){for(var t=0,o=e.cupMgr.cups;t<o.length;t++)o[t].onSelectSurfaceAnimation();cc.director.emit("load_level_finish"),d.default.autoPlaying||cc.director.getScene().name!==v.SceneNames.Game||r.TUTORIAL_INDEX.includes(d.default.Level)&&e.uiManager.showPanel("TutorialPanel")}).start()},t.prototype.updateUI=function(){this.updateCoutnersUI(),this.updateButtonsUI(),this.updateTipsUI()},t.prototype.updateButtonsUI=function(){if(this.bottom.active=!0,1==d.default.Level&&cc.director.getScene().name==v.SceneNames.Game)for(var e=0;e<this.propBtns.length;e++)this.propBtns[e].node.active=!1;this.cupMgr.ifDeadLock()&&(this.cupMgr.hasLockedCups()||(this.propEffects[0].node.active=!0,this.propEffects[0].setAnimation(0,"huojian",!0),this.propEffects[1].node.active=!0,this.propEffects[1].setAnimation(0,"huojian",!0),this.propEffects[2].node.active=!0,this.propEffects[2].setAnimation(0,"huojian",!0),this.propEffects[3].node.active=!0,this.propEffects[3].setAnimation(0,"huojian",!0))),this.cupMgr.getActionNum()<1?(this.propBtns[0].node.opacity=254,this.propBtns[0].node.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.propEffects[0].node.active=!1):(this.propBtns[0].node.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")),this.propBtns[0].node.opacity=255),this.cupMgr.isOrgianizeAvailable()?(this.propBtns[1].node.opacity=255,this.propBtns[1].node.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite"))):(this.propBtns[1].node.opacity=254,this.propBtns[1].node.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.propEffects[1].node.active=!1),this.cupMgr.canPumpWater()?(this.propBtns[2].node.opacity=255,this.propBtns[2].node.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite"))):(this.propBtns[2].node.opacity=254,this.propBtns[2].node.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.propEffects[2].node.active=!1),this.cupMgr.canDyeWater()?(this.propBtns[3].node.opacity=255,this.propBtns[3].node.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite"))):(this.propBtns[3].node.opacity=254,this.propBtns[3].node.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.propEffects[3].node.active=!1)},t.prototype.onFinishOneLevel=function(){var e=this;cc.director.getScene().name===v.SceneNames.Game?(y.default.platform.reportPageEvent("Passlevel"),y.default.platform.reportLevelTimeEvent("LevelPassTime",this.getLevelTime()),d.default.Level++,d.default.removeChallengeLevel(),d.default.UnlockDrops+=this.cupMgr.getDropNum(),d.default.WinStreak++,m.currentPlatform===m.platformEnum.toutiao&&y.default.platform.setRank(d.default.Level)):cc.director.getScene().name===v.SceneNames.GameModeMultiple?(y.default.platform.reportPageEvent("PasslevelModeMultiple"),y.default.platform.reportLevelTimeEvent("LevelPassTimeModeMultiple",this.getLevelTime()),d.default.LevelModeMultiple++):cc.director.getScene().name===v.SceneNames.GameModeFillLong&&(y.default.platform.reportPageEvent("PasslevelModeFillLong"),y.default.platform.reportLevelTimeEvent("LevelPassTimeModeFillLong",this.getLevelTime()),d.default.LevelModeFillLong++),this.playFireWork(function(){cc.director.getScene().name===v.SceneNames.Game?e.uiManager.showPanel("GameOverMainPanel"):(e.uiManager.node.children.forEach(function(e){e.active=!1}),e.uiManager.showPanel("GameOverPanel"))})},t.prototype.playFireWork=function(e){var t=this;void 0===e&&(e=null);for(var o=[cc.v2(40*Math.random()-180,240+40*Math.random()),cc.v2(40*Math.random()-180,40*Math.random()-240),cc.v2(180+40*Math.random(),240+40*Math.random()),cc.v2(180+40*Math.random(),40*Math.random()-240)],n=function(e){i.scheduleOnce(function(){t.playSingleFireWork(o[e])},.9+.6*Math.random())},i=this,r=0;r<4;r++)n(r);this.scheduleOnce(function(){u.default.instance.playSFX(u.AudioRef.Victory)},1),this.scheduleOnce(function(){e&&e()},1.8)},t.prototype.playSingleFireWork=function(e,t){void 0===t&&(t=null);var o=cc.instantiate(this.fireWorkPrefab);o.parent=this.node.parent,o.scale=.4*Math.random()+.9,o.setPosition(e),o.getComponent(sp.Skeleton).setAnimation(0,"CG",!1),o.getComponent(sp.Skeleton).setCompleteListener(function(){o.destroy()})},t.prototype.onPourAction=function(){this.updateUI(),this.cupMgr.getProgress()>.95&&m.currentPlatform===m.platformEnum.toutiao&&g.preloadInterstitialAd()},t.prototype.useProp=function(e){switch(e){case 0:this.onBtn_undo();break;case 1:this.onBtn_organize();break;case 2:this.onBtn_pump();break;case 3:this.onBtn_dye()}},t.prototype.updateCoutnersUI=function(){this.text_propCount[0].string=d.default.PropUndo+"",d.default.PropUndo>99&&(this.text_propCount[0].string="99+"),this.text_propCount[1].string=d.default.PropOrganize+"",d.default.PropOrganize>99&&(this.text_propCount[1].string="99+"),this.text_propCount[2].string=d.default.PropPump+"",d.default.PropPump>99&&(this.text_propCount[2].string="99+"),this.text_propCount[3].string=d.default.PropDye+"",d.default.PropDye>99&&(this.text_propCount[3].string="99+"),this.text_propCount.length>4&&(this.text_propCount[4].string=d.default.PropAddCup+""),d.default.PropUndo<=0?(this.text_propCount[0].string="+",this.text_propCount[0].node.y=3,this.text_propCount[0].fontSize=40):(this.text_propCount[0].fontSize=30,this.text_propCount[0].node.y=0),d.default.Level<=3&&cc.director.getScene().name===v.SceneNames.Game&&(this.text_propCount[0].string="\u221e",this.text_propCount[0].node.y=3,this.text_propCount[0].fontSize=40),d.default.PropOrganize<=0?(this.text_propCount[1].string="+",this.text_propCount[1].node.y=3,this.text_propCount[1].fontSize=40):(this.text_propCount[1].fontSize=30,this.text_propCount[1].node.y=0),d.default.PropPump<=0?(this.text_propCount[2].string="+",this.text_propCount[2].node.y=3,this.text_propCount[2].fontSize=40):(this.text_propCount[2].fontSize=30,this.text_propCount[2].node.y=0),d.default.PropDye<=0?(this.text_propCount[3].string="+",this.text_propCount[3].node.y=3,this.text_propCount[3].fontSize=40):(this.text_propCount[3].fontSize=30,this.text_propCount[3].node.y=0),this.text_actionNum.string=this.cupMgr.getActionNum()+""},t.prototype.updateTipsUI=function(){if(this.cupMgr.ifDeadLock()){var e=this.cupMgr.getLockedCups();e?this.PopupTips("\u5361\u4f4f\u5566\uff0c\u5feb\u89e3\u9501\u4e00\u4e2a\u65b0\u676f\u5b50\u5427\uff01",8,5,e):this.PopupTips("\u5361\u4f4f\u5566\uff0c\u7528\u4e2a\u9053\u5177\u8bd5\u8bd5\u5427\uff01",8,5)}},t.prototype.PopupTips=function(e,t,o,n){var i=this;void 0===t&&(t=5),void 0===o&&(o=0),void 0===n&&(n=null),this.root_Tips.active=!0,this.text_Tips.string=e,this.root_Tips.stopAllActions(),this.root_Tips.opacity=0,this.root_Tips.runAction(cc.sequence(cc.delayTime(o),cc.callFunc(function(){i.root_Tips_finger.active=!!n,n&&i.root_Tips_finger.setPosition(i.root_Tips.convertToNodeSpaceAR(n.convertToWorldSpaceAR(cc.Vec2.ZERO)))}),cc.fadeIn(.2),cc.delayTime(t),cc.fadeOut(.2),cc.callFunc(function(){i.root_Tips.active=!1})))},t.prototype.ChangeTipsStay=function(e,t){var o=this;void 0===t&&(t=2),this.text_Tips.string=e,this.scheduleOnce(function(){o.text_Tips.string=o.tipsStay},t)},t.prototype.PopupTipsStay=function(e){this.root_Tips.active=!0,this.root_Tips_finger.active=!1,this.text_Tips.string=e,this.tipsStay=e,this.root_Tips.stopAllActions(),this.root_Tips.runAction(cc.fadeIn(.2))},t.prototype.PopoutTips=function(){var e=this;this.root_Tips.stopAllActions(),!0===this.root_Tips.active&&this.root_Tips.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){e.root_Tips.active=!1})))},t.prototype.onBtn_JumpLevel=function(){var e=parseInt(this.editBox.string);isNaN(e)||e<1||(d.default.Level=e,cc.director.loadScene("Game"))},t.prototype.onBtn_nextLevel=function(){d.default.Level++,d.default.removeChallengeLevel(),cc.director.loadScene("Game")},t.prototype.onBtn_AutoPlay=function(){d.default.autoPlaying?(this.autoPlayer.StopAutoPlay(),this.text_AutoPlay.string="\u81ea\u52a8\u73a9(\u5173)"):(this.autoPlayer.StartAutoPlay(),this.text_AutoPlay.string="\u81ea\u52a8\u73a9(\u5f00)")},t.prototype.onBtn_AutoPlayLevel=function(){d.default.ifTest&&(this.clickTimeAutoPlay++,this.clickTimeAutoPlay>=5&&(this.clickTimeAutoPlay=0,this.onBtn_AutoPlay()))},t.prototype.updateAutoPlayText=function(){d.default.autoPlaying?this.text_AutoPlay.string="\u81ea\u52a8\u73a9(\u5f00)":this.text_AutoPlay.string="\u81ea\u52a8\u73a9(\u5173)"},t.prototype.nextLevel=function(){cc.director.loadScene("Game")},t.prototype.unlockDrink=function(){this.uiManager.showPanel("DrinkPanel")},t.prototype.onBtn_undo=function(){(d.default.Level>3||cc.director.getScene().name!==v.SceneNames.Game)&&d.default.PropUndo>0&&d.default.PropUndo--,this.cupMgr.undoAction(),this.updateCoutnersUI()},t.prototype.onBtn_undoProp=function(){this.PopoutTips,y.default.platform.reportButtonEvent("GamePage_withdrawBtn",0),this.propBtns[0].node.opacity<255?this.PopupTips("\u6682\u65e0\u53ef\u64a4\u56de\u7684\u64cd\u4f5c",2):d.default.Level<=3&&cc.director.getScene().name===v.SceneNames.Game||d.default.PropUndo>0?this.onBtn_undo():this.propPanel.showPropPanel(0)},t.prototype.onBtn_dye=function(){u.default.instance.playSFX(u.AudioRef.SortItem),d.default.PropDye>0&&d.default.PropDye--,this.cupMgr.dyeWater(),this.updateCoutnersUI()},t.prototype.onBtn_dyeProp=function(){y.default.platform.reportButtonEvent("GamePage_dyedBtn",0),this.PopoutTips,this.propBtns[3].node.opacity<255?this.PopupTips("\u6682\u65e0\u53ef\u67d3\u8272\u7684\u6c34",2):d.default.PropDye>0?this.onBtn_dye():this.propPanel.showPropPanel(3)},t.prototype.onBtn_organize=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),d.default.PropOrganize>0&&d.default.PropOrganize--,this.cupMgr.organizeWater(),this.text_actionNum.string=this.cupMgr.getActionNum()+"",this.updateCoutnersUI()},t.prototype.onBtn_organizeProp=function(){y.default.platform.reportButtonEvent("GamePage_sortBtn",0),this.PopoutTips,this.propBtns[1].node.opacity<255?this.PopupTips("\u6682\u65e0\u53ef\u6574\u7406\u7684\u74f6\u5b50",2):d.default.PropOrganize>0?this.onBtn_organize():this.propPanel.showPropPanel(1)},t.prototype.onBtn_pump=function(){d.default.PropPump>0&&d.default.PropPump--,this.cupMgr.pumpWater(),this.text_actionNum.string=this.cupMgr.getActionNum()+"",this.updateCoutnersUI()},t.prototype.onBtn_pumpProp=function(){this.PopoutTips,y.default.platform.reportButtonEvent("GamePage_topUpBtn",0),this.propBtns[2].node.opacity<255?this.PopupTips("\u6682\u65e0\u53ef\u62bd\u53d6\u7684\u6c34",2):d.default.PropPump>0?this.onBtn_pump():this.propPanel.showPropPanel(2)},t.prototype.onBtn_Pause=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),cc.director.emit(v.EventNames.Pause),this.uiManager.showPanel("SettingPanel")},t.prototype.getLevelTime=function(){return Math.floor((Date.now()-this.startTime)/1e3)},t._instance=null,l([C(p.default)],t.prototype,"cupMgr",void 0),l([C(h.default)],t.prototype,"uiManager",void 0),l([C(_.default)],t.prototype,"autoPlayer",void 0),l([C(cc.Label)],t.prototype,"text_level",void 0),l([C(cc.Label)],t.prototype,"text_actionNum",void 0),l([C([cc.Label])],t.prototype,"text_propCount",void 0),l([C([cc.Button])],t.prototype,"propBtns",void 0),l([C([sp.Skeleton])],t.prototype,"propEffects",void 0),l([C(cc.Node)],t.prototype,"root_Tips",void 0),l([C(cc.Node)],t.prototype,"root_Tips_finger",void 0),l([C(cc.Node)],t.prototype,"icon_Tips",void 0),l([C(cc.Label)],t.prototype,"text_Tips",void 0),l([C(cc.Node)],t.prototype,"bottom",void 0),l([C(cc.Node)],t.prototype,"top",void 0),l([C(cc.Node)],t.prototype,"testNode",void 0),l([C(cc.Node)],t.prototype,"text_infinity",void 0),l([C(cc.Prefab)],t.prototype,"fireWorkPrefab",void 0),l([C(cc.Node)],t.prototype,"btn_AutoPlay",void 0),l([C(cc.Node)],t.prototype,"btn_AutoPlayLevel",void 0),l([C(cc.Node)],t.prototype,"btn_Setting",void 0),l([C(cc.EditBox)],t.prototype,"editBox",void 0),l([C(cc.Label)],t.prototype,"text_AutoPlay",void 0),l([C(f.default)],t.prototype,"propPanel",void 0),o=l([b],t)}(cc.Component);r.default=P,cc._RF.pop(),cc._RF.pop()},{}],GameScene_RF:[function(e,t,o){"use strict";cc._RF.push(t,"3405ap0gG5LV6Ggdooui6Tn","GameScene_RF");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"3405ap0gG5LV6Ggdooui6Tn","GameScene_RF");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("CupMgr"),d=n("CommonData"),f=n("PropPanel"),h=n("UIManager"),y=n("GameManager"),m=n("config"),g=n("const"),v=n("Cup"),_=n("PackageManger"),S=n("GoldDataManager"),b=n("DataNexusSDK"),C=n("DataNexusEnum"),P=cc._decorator,k=P.ccclass,w=P.property,I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cupMgr=null,t.uiManager=null,t.text_propCount=[],t.adIcons=[],t.propBtns=[],t.root_Tips=null,t.root_Tips_finger=null,t.text_Tips=null,t.bottom=null,t.top=null,t.fireWorkPrefab=null,t.packageNode=null,t.singleAddCupSprite=null,t.startTime=0,t.timeNode=null,t.lastProgress=0,t.canHideTips=!0,t.ifShowRider=!1,t.tipsStay="",t.propPanel=null,t.lastActionTime=0,t.fingerHintTimer=null,t.fingerShowCnt=0,t}var o;return s(t,e),o=t,Object.defineProperty(t,"instance",{get:function(){return this._instance},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){var e=this;b.default.instance.trackLoadFinish();var t=cc.find("Canvas").getComponent(cc.Canvas);d.default.CurrentLevel=d.default.Level,1==d.default.Level&&cc.director.getScene().name==g.SceneNames.Game&&b.default.instance.trackTutorialStart();var n={level_id:d.default.Level};n.coin_amount=S.default.Gold,n.enter_level_id=0,n.game_mode=cc.director.getScene().name,b.default.instance.trackLevelEnter(n),d.default.PropPump<=0&&b.default.instance.trackAdPlacementShow(C.RewardADEvent.SORT),d.default.PropAddCup<=0&&b.default.instance.trackAdPlacementShow(C.RewardADEvent.GENERATE_EMPTY_BOTTLE),d.default.PropUndo<=0&&b.default.instance.trackAdPlacementShow(C.RewardADEvent.UNDO),d.default.ratio<1670/750?(t.fitHeight=!0,t.fitWidth=!1):(t.fitHeight=!1,t.fitWidth=!0),"windows"===d.default.platform&&(t.fitHeight=!0,t.fitWidth=!1),o._instance=this,cc.director.on("level_finish",this.onFinishOneLevel,this),cc.director.on("do_pour",this.onPourAction,this),cc.director.on("use_prop",function(t){e.useProp(t)},this),cc.director.on("load_level",this.updateUI,this),cc.director.on("load_level",this.opening,this),cc.director.on("color_changed",this.updateUI,this),cc.director.on(g.EventNames.OnClickCup,this.onClickCup,this),cc.director.on(g.EventNames.Explode,this.onBombExplode,this),d.default.mode="RingFight"},t.prototype.onDestroy=function(){var e=this;cc.director.off(g.EventNames.Explode,this.onBombExplode,this),cc.director.off("level_finish",this.onFinishOneLevel,this),cc.director.off("do_pour",this.onPourAction,this),cc.director.off("use_prop",function(t){e.useProp(t)},this),cc.director.off("load_level",this.updateUI,this),cc.director.off("load_level",this.opening,this),cc.director.off("color_changed",this.updateUI,this),cc.director.off(g.EventNames.OnClickCup,this.onClickCup,this),this.clearFingerHintTimer(),this.unscheduleAllCallbacks()},t.prototype.start=function(){y.default.platform.reportPageEvent("Startlevel"),this.bottom&&(this.bottom.active=!1),this.cupMgr=p.default.getInstance(),this.propPanel&&(this.propPanel=this.node.getChildByName("UIRoot").getComponentInChildren(f.default)),this.startTime=Date.now(),d.default.finish_time=Date.now(),y.default.platform.reportScene(7001,d.default.finish_time-d.default.start_time)},t.prototype.opening=function(){for(var e=this,t=0,o=this.cupMgr.cups;t<o.length;t++)o[t].cupType===v.CupType.Temp1AD&&(this.propBtns[4].getComponent(cc.Sprite).spriteFrame=this.singleAddCupSprite);cc.tween(this.bottom).to(.6,{y:-835},{easing:"sineIn"}).start(),cc.tween(this.top).to(.6,{y:835},{easing:"sineIn"}).start(),cc.tween(this.packageNode).to(.5,{x:0},{easing:"sineIn"}).start(),cc.tween(this.timeNode).to(.6,{x:-230},{easing:"sineIn"}).start(),cc.tween(this.cupMgr.node).to(.6,{x:0},{easing:"sineIn"}).call(function(){for(var t=0,o=e.cupMgr.cups;t<o.length;t++)o[t].onSelectSurfaceAnimation();cc.director.emit("load_level_finish"),e.startFingerHintTimer()}).start()},t.prototype.updateUI=function(){this.updateCoutnersUI(),this.updateButtonsUI(),this.updateTipsUI()},t.prototype.updateButtonsUI=function(){if(this.bottom.active=!0,1==d.default.Level&&cc.director.getScene().name==g.SceneNames.Game)for(var e=0;e<this.propBtns.length;e++)this.propBtns[e].node.active=!1;this.cupMgr.getActionNum()<1?(this.propBtns[0].node.opacity=254,this.propBtns[0].node.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite"))):(this.propBtns[0].node.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")),this.propBtns[0].node.opacity=255),this.cupMgr.canPumpWater()?(this.propBtns[2].node.opacity=255,this.propBtns[2].node.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite"))):(this.propBtns[2].node.opacity=254,this.propBtns[2].node.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite"))),this.cupMgr.canDyeWater()?(this.propBtns[3].node.opacity=255,this.propBtns[3].node.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite"))):(this.propBtns[3].node.opacity=254,this.propBtns[3].node.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite"))),this.propBtns.length>4&&(this.cupMgr.canAddEmptyCup()?(this.propBtns[4].node.opacity=255,this.propBtns[4].node.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite"))):(this.propBtns[4].node.opacity=254,this.propBtns[4].node.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite"))))},t.prototype.onFinishOneLevel=function(){var e=this;m.currentPlatform===m.platformEnum.wechat&&d.default.CurrentLevel>=3&&0==d.default.isToday(d.default.LastFirstWinDate)&&(d.default.LastFirstWinDate=d.default.getTodayDate(),y.default.platform.showRecommend()),this.playFireWork(function(){e.uiManager.showPanel("WinPanel_RF")})},t.prototype.playFireWork=function(e){var t=this;void 0===e&&(e=null);for(var o=[cc.v2(40*Math.random()-180,240+40*Math.random()),cc.v2(40*Math.random()-180,40*Math.random()-240),cc.v2(180+40*Math.random(),240+40*Math.random()),cc.v2(180+40*Math.random(),40*Math.random()-240)],n=function(e){i.scheduleOnce(function(){t.playSingleFireWork(o[e])},.2+.3*Math.random())},i=this,r=0;r<4;r++)n(r);this.scheduleOnce(function(){u.default.instance.playSFX(u.AudioRef.Victory)},.3),this.scheduleOnce(function(){e&&e()},.6)},t.prototype.playSingleFireWork=function(e,t){void 0===t&&(t=null);var o=cc.instantiate(this.fireWorkPrefab);o.parent=this.node,o.scale=.4*Math.random()+.9,o.setPosition(e),o.getComponent(sp.Skeleton).setAnimation(0,"CG",!1),o.getComponent(sp.Skeleton).setCompleteListener(function(){o.destroy()})},t.prototype.onClickCup=function(){},t.prototype.onPourAction=function(){var e;this.updateUI(),(e=_.default.instance?_.default.instance.finishedPackageNum/_.default.instance.targetPackageNum:this.cupMgr.getProgress())!=this.lastProgress?this.resetFingerHintTimer():this.hideFingerHint(),this.lastProgress=e},t.prototype.useProp=function(e){switch(this.root_Tips.stopAllActions(),this.root_Tips.active=!1,e){case 0:this.onBtn_undo();break;case 1:this.onBtn_organize();break;case 2:this.onBtn_pump();break;case 3:this.onBtn_dye();break;case 4:this.onBtn_addCup()}},t.prototype.updateCoutnersUI=function(){this.text_propCount[0].string=d.default.PropUndo+"",d.default.PropUndo>99&&(this.text_propCount[0].string="99+"),this.text_propCount[2].string=d.default.PropPump+"",d.default.PropPump>99&&(this.text_propCount[2].string="99+"),this.text_propCount[3].string=d.default.PropDye+"",d.default.PropDye>99&&(this.text_propCount[3].string="99+"),this.text_propCount.length>4&&(this.text_propCount[4].string=d.default.PropAddCup+""),this.text_propCount.length>4&&d.default.PropAddCup>99&&(this.text_propCount[4].string="99+"),d.default.PropUndo<=0?(this.text_propCount[0].string="+",this.text_propCount[0].node.y=3,this.text_propCount[0].fontSize=40,this.text_propCount[0].node.active=!1,this.adIcons[0].active=!0,d.default.IfShowPropPanelUndo||(this.text_propCount[0].node.active=!0,this.adIcons[0].active=!1,cc.director.getScene().name===g.SceneNames.Challenge&&(this.adIcons[0].active=!0))):(this.text_propCount[0].fontSize=30,this.text_propCount[0].node.y=3,this.text_propCount[0].node.active=!0,this.adIcons[0].active=!1),d.default.PropPump<=0?(this.text_propCount[2].string="+",this.text_propCount[2].node.y=3,this.text_propCount[2].fontSize=40,this.text_propCount[2].node.active=!1,this.adIcons[2].active=!0,d.default.IfShowPropPanelPump||(this.text_propCount[2].node.active=!0,this.adIcons[2].active=!1,cc.director.getScene().name===g.SceneNames.Challenge&&(this.adIcons[2].active=!0))):(this.text_propCount[2].fontSize=30,this.text_propCount[2].node.y=3,this.text_propCount[2].node.active=!0,this.adIcons[2].active=!1),d.default.PropDye<=0?(this.text_propCount[3].string="+",this.text_propCount[3].node.y=3,this.text_propCount[3].fontSize=40,this.text_propCount[3].node.active=!1,this.adIcons[3].active=!0):(this.text_propCount[3].fontSize=30,this.text_propCount[3].node.y=3,this.text_propCount[3].node.active=!0,this.adIcons[3].active=!1),this.text_propCount.length>4&&(d.default.PropAddCup<=0?(this.text_propCount[4].string="+",this.text_propCount[4].node.y=3,this.text_propCount[4].fontSize=40,this.text_propCount[4].node.active=!1,this.adIcons[4].active=!0,d.default.IfShowPropPanelAddCup||(this.text_propCount[4].node.active=!0,this.adIcons[4].active=!1,cc.director.getScene().name===g.SceneNames.Challenge&&(this.adIcons[4].active=!0))):(this.text_propCount[4].fontSize=30,this.text_propCount[4].node.y=3,this.text_propCount[4].node.active=!0,this.adIcons[4].active=!1)),d.default.Level<=2&&cc.director.getScene().name===g.SceneNames.Game&&(this.text_propCount[0].string="\u221e",this.text_propCount[0].node.y=3,this.text_propCount[0].fontSize=40,this.text_propCount[1].string="\u221e",this.text_propCount[1].node.y=3,this.text_propCount[1].fontSize=40,this.text_propCount[2].string="\u221e",this.text_propCount[2].node.y=3,this.text_propCount[2].fontSize=40,this.text_propCount[3].string="\u221e",this.text_propCount[3].node.y=3,this.text_propCount[3].fontSize=40,this.text_propCount[0].node.active=!0,this.adIcons[0].active=!1,this.text_propCount[1].node.active=!0,this.adIcons[1].active=!1,this.text_propCount[2].node.active=!0,this.adIcons[2].active=!1,this.text_propCount[3].node.active=!0,this.adIcons[3].active=!1,this.text_propCount.length>4&&(this.text_propCount[4].string="\u221e",this.text_propCount[4].node.y=3,this.text_propCount[4].fontSize=40,this.text_propCount[4].node.active=!0,this.adIcons[4].active=!1))},t.prototype.updateTipsUI=function(){if(p.default.getInstance().ifDeadLock()){var e=p.default.getInstance().getLockedCups();if(!this.canHideTips)return;e?this.PopupTips("\u5361\u4f4f\u5566\uff0c\u5feb\u89e3\u9501\u4e00\u4e2a\u65b0\u676f\u5b50\u5427\uff01",8,5,e,3):this.PopupTips("\u5361\u4f4f\u5566\uff0c\u7528\u4e2a\u9053\u5177\u8bd5\u8bd5\u5427\uff01",8,5,null,3)}else{var t=this.text_Tips.string;"\u5361\u4f4f\u5566\uff0c\u5feb\u89e3\u9501\u4e00\u4e2a\u65b0\u676f\u5b50\u5427\uff01"!=t&&"\u5361\u4f4f\u5566\uff0c\u7528\u4e2a\u9053\u5177\u8bd5\u8bd5\u5427\uff01"!=t||this.PopoutTips()}},t.prototype.PopupTips=function(e,t,o,n,i){var r=this;void 0===t&&(t=5),void 0===o&&(o=0),void 0===n&&(n=null),void 0===i&&(i=0),this.canHideTips&&(this.root_Tips.active=!0,this.text_Tips.string=e,this.root_Tips.stopAllActions(),this.root_Tips.opacity>0&&cc.tween(this.root_Tips).to(.2,{opacity:0}).start(),this.scheduleOnce(function(){r.canHideTips=!0},o+i),this.root_Tips.runAction(cc.sequence(cc.delayTime(o),cc.callFunc(function(){r.canHideTips&&(r.canHideTips=!1),r.resetFingerHintTimer(),n&&n.isValid?r.root_Tips_finger.active=!0:r.root_Tips_finger.active=!1,r.root_Tips_finger.opacity=255,n&&n.isValid&&r.root_Tips_finger.setPosition(cc.Canvas.instance.node.convertToNodeSpaceAR(n.convertToWorldSpaceAR(cc.Vec2.ZERO)))}),cc.fadeIn(.2),cc.delayTime(t),cc.callFunc(function(){r.root_Tips_finger.runAction(cc.fadeOut(.2))}),cc.fadeOut(.2),cc.callFunc(function(){r.resetFingerHintTimer(),r.root_Tips.opacity=0,r.root_Tips.active=!1,r.root_Tips_finger.active=!1}))))},t.prototype.ChangeTipsStay=function(e,t){var o=this;void 0===t&&(t=2),this.text_Tips.string=e,this.scheduleOnce(function(){o.text_Tips.string=o.tipsStay},t)},t.prototype.PopupTipsStay=function(e){this.root_Tips.active=!0,this.root_Tips_finger.active=!1,this.text_Tips.string=e,this.tipsStay=e,this.root_Tips.stopAllActions(),this.root_Tips.runAction(cc.fadeIn(.2))},t.prototype.PopoutTips=function(){var e=this;this.canHideTips?(this.root_Tips.stopAllActions(),!0===this.root_Tips.active&&this.root_Tips.runAction(cc.sequence(cc.callFunc(function(){e.root_Tips_finger.runAction(cc.fadeOut(.2))}),cc.fadeOut(.2),cc.callFunc(function(){e.root_Tips.active=!1,e.root_Tips_finger.active=!1})))):this.scheduleOnce(function(){e.PopoutTips()},2)},t.prototype.unlockDrink=function(){this.uiManager.showPanel("DrinkPanel")},t.prototype.onBtn_undo=function(){this.root_Tips.stopAllActions(),this.root_Tips_finger.stopAllActions(),this.root_Tips.active=!1,this.root_Tips.opacity=0,p.default.getInstance().checkIfCanUndo()?(this.canHideTips=!0,this.root_Tips_finger.active=!1,(d.default.Level>=3||cc.director.getScene().name!==g.SceneNames.Game)&&d.default.PropUndo>0&&d.default.PropUndo--,this.cupMgr.undoAction(),this.updateCoutnersUI()):this.PopupTips("\u6709\u64cd\u4f5c\u6b63\u5728\u8fdb\u884c\u4e2d\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5",2)},t.prototype.onBtn_undoProp=function(){var e=this;if(this.PopoutTips,y.default.platform.reportButtonEvent("GamePage_withdrawBtn",0),!(this.propBtns[0].node.opacity<255))return d.default.Level<3&&cc.director.getScene().name===g.SceneNames.Game?d.default.IfShowPropPanelUndo||cc.director.getScene().name!==g.SceneNames.Game?(d.default.IfShowPropPanelUndo=!0,this.onBtn_undo(),void y.default.platform.reportButtonEvent("GamePage_withdrawBtn",7)):(this.propPanel.showPropPanel(0),d.default.IfShowPropPanelUndo=!0,void this.updateCoutnersUI()):void(d.default.PropUndo>0?(this.onBtn_undo(),y.default.platform.reportButtonEvent("GamePage_withdrawBtn",7)):d.default.IfShowPropPanelUndo||cc.director.getScene().name!==g.SceneNames.Game?(cc.director.getScene().name===g.SceneNames.Game?y.default.platform.reportVideoEvent("GamePage_withdrawBtn_video",1):cc.director.getScene().name===g.SceneNames.Challenge&&y.default.platform.reportVideoEvent("Challenge_withdrawBtn_video",1),d.default.IfShowPropPanelUndo=!0,b.default.instance.trackAdClick(C.RewardADEvent.UNDO),y.default.platform.showRewardAD(function(){b.default.instance.trackAdVideoFinish(C.RewardADEvent.UNDO),e.useProp(0),"Game"===cc.director.getScene().name&&y.default.platform.reportAdPointEvent("AdPoint",p.default.getInstance().getProgress()),cc.director.getScene().name===g.SceneNames.Game?y.default.platform.reportVideoEvent("GamePage_withdrawBtn_video",2):cc.director.getScene().name===g.SceneNames.Challenge&&y.default.platform.reportVideoEvent("Challenge_withdrawBtn_video",2),u.default.instance.playSFX(u.AudioRef.ClickButton)})):(this.propPanel.showPropPanel(0),d.default.IfShowPropPanelUndo=!0,this.updateCoutnersUI()));this.PopupTips("\u6682\u65e0\u53ef\u64a4\u56de\u7684\u64cd\u4f5c",2)},t.prototype.onBtn_dye=function(){this.root_Tips.stopAllActions(),this.root_Tips.active=!1,u.default.instance.playSFX(u.AudioRef.SortItem),d.default.PropDye>0&&d.default.PropDye--,this.cupMgr.dyeWater(),this.updateCoutnersUI()},t.prototype.onBtn_dyeProp=function(){y.default.platform.reportButtonEvent("GamePage_dyedBtn",0),this.PopoutTips,this.propBtns[3].node.opacity<255?this.PopupTips("\u6682\u65e0\u53ef\u67d3\u8272\u7684\u6c34",2):d.default.PropDye>0?this.onBtn_dye():this.propPanel.showPropPanel(3)},t.prototype.onBtn_organize=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),d.default.PropOrganize>0&&d.default.PropOrganize--,this.cupMgr.organizeWater(),this.updateCoutnersUI()},t.prototype.onBtn_organizeProp=function(){y.default.platform.reportButtonEvent("GamePage_sortBtn",0),this.PopoutTips,this.propBtns[1].node.opacity<255?this.PopupTips("\u6682\u65e0\u53ef\u6574\u7406\u7684\u74f6\u5b50",2):d.default.PropOrganize>0?this.onBtn_organize():this.propPanel.showPropPanel(1)},t.prototype.onBtn_addCup=function(){this.root_Tips.stopAllActions(),this.root_Tips_finger.stopAllActions(),this.root_Tips.active=!1,this.root_Tips.opacity=0,this.canHideTips=!0,this.root_Tips_finger.active=!1,u.default.instance.playSFX(u.AudioRef.ClickButton),(d.default.Level>=3||cc.director.getScene().name!==g.SceneNames.Game)&&d.default.PropAddCup>0&&d.default.PropAddCup--,this.cupMgr.addEmptyCup(),this.updateCoutnersUI()},t.prototype.onBtn_addCupProp=function(){var e=this;if(y.default.platform.reportButtonEvent("GamePage_addCupBtn",0),this.PopoutTips(),!(this.propBtns[4].node.opacity<255))return d.default.Level<3&&cc.director.getScene().name===g.SceneNames.Game?d.default.IfShowPropPanelAddCup||cc.director.getScene().name!==g.SceneNames.Game?(y.default.platform.reportButtonEvent("GamePage_addCupBtn",7),d.default.IfShowPropPanelAddCup=!0,void this.onBtn_addCup()):(this.propPanel.showPropPanel(4),d.default.IfShowPropPanelAddCup=!0,y.default.platform.reportButtonEvent("GamePage_addCupBtn",7),void this.updateCoutnersUI()):void(d.default.PropAddCup>0?(this.onBtn_addCup(),y.default.platform.reportButtonEvent("GamePage_addCupBtn",7)):d.default.IfShowPropPanelAddCup||cc.director.getScene().name!==g.SceneNames.Game?(d.default.IfShowPropPanelAddCup=!0,y.default.platform.reportVideoEvent("GamePage_addCupBtn_video",1),b.default.instance.trackAdClick(C.RewardADEvent.GENERATE_EMPTY_BOTTLE),y.default.platform.showRewardAD(function(){b.default.instance.trackAdVideoFinish(C.RewardADEvent.GENERATE_EMPTY_BOTTLE),e.useProp(4),"Game"===cc.director.getScene().name&&y.default.platform.reportAdPointEvent("AdPoint",p.default.getInstance().getProgress()),y.default.platform.reportVideoEvent("GamePage_addCupBtn_video",2),u.default.instance.playSFX(u.AudioRef.ClickButton)})):(this.propPanel.showPropPanel(4),d.default.IfShowPropPanelAddCup=!0,this.updateCoutnersUI()));this.PopupTips("\u6682\u65e0\u7a7a\u4f4d",2)},t.prototype.onBtn_pump=function(){this.root_Tips.stopAllActions(),this.root_Tips_finger.stopAllActions(),this.root_Tips.active=!1,this.root_Tips_finger.active=!1,this.root_Tips.opacity=0,this.canHideTips=!0,u.default.instance.playSFX(u.AudioRef.ClickButton),(d.default.Level>=3||cc.director.getScene().name!==g.SceneNames.Game)&&d.default.PropPump>0&&d.default.PropPump--,this.cupMgr.pumpWater(),this.updateCoutnersUI()},t.prototype.onBtn_pumpProp=function(){var e=this;if(this.PopoutTips,y.default.platform.reportButtonEvent("GamePage_topUpBtn",0),!(this.propBtns[2].node.opacity<255))return d.default.Level<3&&cc.director.getScene().name===g.SceneNames.Game?d.default.IfShowPropPanelPump||cc.director.getScene().name!==g.SceneNames.Game?(d.default.IfShowPropPanelPump=!0,y.default.platform.reportButtonEvent("GamePage_topUpBtn",7),void this.onBtn_pump()):(this.propPanel.showPropPanel(2),d.default.IfShowPropPanelPump=!0,y.default.platform.reportButtonEvent("GamePage_topUpBtn",7),void this.updateCoutnersUI()):void(d.default.PropPump>0?(this.onBtn_pump(),y.default.platform.reportButtonEvent("GamePage_topUpBtn",7)):d.default.IfShowPropPanelPump||cc.director.getScene().name!==g.SceneNames.Game?(d.default.IfShowPropPanelPump=!0,cc.director.getScene().name===g.SceneNames.Game?y.default.platform.reportVideoEvent("GamePage_topUpBtn_video",1):cc.director.getScene().name===g.SceneNames.Challenge&&y.default.platform.reportVideoEvent("Challenge_topUpBtn_video",1),b.default.instance.trackAdClick(C.RewardADEvent.SORT),y.default.platform.showRewardAD(function(){b.default.instance.trackAdVideoFinish(C.RewardADEvent.SORT),e.useProp(2),"Game"===cc.director.getScene().name&&y.default.platform.reportAdPointEvent("AdPoint",p.default.getInstance().getProgress()),cc.director.getScene().name===g.SceneNames.Game?y.default.platform.reportVideoEvent("GamePage_topUpBtn_video",2):cc.director.getScene().name===g.SceneNames.Challenge&&y.default.platform.reportVideoEvent("Challenge_topUpBtn_video",2),u.default.instance.playSFX(u.AudioRef.ClickButton)})):(this.propPanel.showPropPanel(2),d.default.IfShowPropPanelPump=!0,this.updateCoutnersUI()));this.PopupTips("\u6682\u65e0\u53ef\u62bd\u53d6\u7684\u6c34",2)},t.prototype.ifNearlyOutOfRider=function(){return!!p.default.getInstance().isMultiLevel()&&p.default.getInstance().cups.filter(function(e){return e.currentState===v.CupState.Finished||e.currentState===v.CupState.ReadyToBeCollected}).length/p.default.getInstance().cups.length>=.4},t.prototype.showFingerHint=function(){this.ifNearlyOutOfRider()&&!_.default.instance.ifThirdUnlock&&this.showFingerHintRider(),this.showFingerHintCup()},t.prototype.showFingerHintRider=function(){var e=this;if(!(d.default.Level<6&&m.currentPlatform===m.platformEnum.toutiao)){var t=_.default.instance.currentPackages[2].node.getChildByName("PackageAd");if(t&&t.isValid){this.root_Tips_finger.active=!0,this.root_Tips_finger.opacity=255,this.fingerHintTimer++,this.fingerShowCnt++;var o=t.convertToWorldSpaceAR(cc.Vec2.ZERO);o=cc.Canvas.instance.node.convertToNodeSpaceAR(o),this.root_Tips_finger.setPosition(o),this.scheduleOnce(function(){e.hideFingerHint(),e.resetFingerHintTimer()},3)}}},t.prototype.showFingerHintCup=function(){var e=this;if(!(d.default.Level<6||this.fingerShowCnt>1)){var t=p.default.getInstance().getLockedCups();if(t){this.root_Tips_finger.active=!0,this.root_Tips_finger.opacity=255,this.fingerHintTimer++,this.fingerShowCnt++;var o=t.convertToWorldSpaceAR(cc.Vec2.ZERO);o=cc.Canvas.instance.node.convertToNodeSpaceAR(o),this.root_Tips_finger.setPosition(o),this.scheduleOnce(function(){e.hideFingerHint(),e.resetFingerHintTimer()},3)}}},t.prototype.hideFingerHint=function(){var e=this;this.canHideTips&&(d.default.Level<6||(this.root_Tips_finger.stopAllActions(),!0===this.root_Tips_finger.active&&this.root_Tips_finger.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){e.root_Tips_finger.active=!1})))))},t.prototype.startFingerHintTimer=function(){var e=this;d.default.Level<6||(this.lastActionTime=Date.now(),this.fingerHintTimer&&clearTimeout(this.fingerHintTimer),this.fingerHintTimer=setTimeout(function(){e.showFingerHint()},1e4))},t.prototype.resetFingerHintTimer=function(){d.default.Level<6||(this.lastActionTime=Date.now(),this.fingerHintTimer&&clearTimeout(this.fingerHintTimer),this.startFingerHintTimer())},t.prototype.clearFingerHintTimer=function(){this.fingerHintTimer&&(clearTimeout(this.fingerHintTimer),this.fingerHintTimer=null)},t.prototype.onBombExplode=function(){cc.director.getScene().name!==g.SceneNames.Game||d.default.autoPlaying||this.uiManager.showPanel("GameLosePanel").then(function(e){e.getComponent("GameLosePanel").initPanel(2)})},t.prototype.ifShowTutorial=function(){if(d.default.TUTORIAL_INDEX.includes(d.default.Level)&&-1!=d.default.TUTORIAL_INDEX[d.default.TUTORIAL_INDEX.indexOf(d.default.Level)])return!0;var e=p.default.getInstance().cups;if(!1===d.default.ifPlayedAbsorbCup)for(var t=0,o=e;t<o.length;t++)if((l=o[t]).cupType===v.CupType.Absorb)return!0;if(!1===d.default.ifPlayedBombCup)for(var n=0,i=e;n<i.length;n++)if((l=i[n]).cupType===v.CupType.Bomb||l.cupType===v.CupType.BombFixed||l.cupType===v.CupType.BombMasked||l.cupType===v.CupType.BombFrozen)return!0;if(!1===d.default.ifPlayedChangeColorCup)for(var r=0,a=e;r<a.length;r++)if((l=a[r]).cupType===v.CupType.ChangeColor)return!0;if(!1===d.default.ifPlayedLockCup)for(var c=0,s=e;c<s.length;c++){var l;if((l=s[c]).cupType===v.CupType.Lock)return!0}},t.prototype.showCupTutorial=function(e){this.uiManager.showPanel("TutorialPanel").then(function(t){t.getComponent("TutorialPanel").setShowCaseIndex(e)})},t.prototype.onBtn_Pause=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),cc.director.getScene().name===g.SceneNames.GameModeMultiple&&cc.director.emit(g.EventNames.Pause),this.uiManager.showPanel("SettingPanel")},t.prototype.getLevelTime=function(){return Math.floor((Date.now()-this.startTime)/1e3)},t._instance=null,l([w(p.default)],t.prototype,"cupMgr",void 0),l([w(h.default)],t.prototype,"uiManager",void 0),l([w([cc.Label])],t.prototype,"text_propCount",void 0),l([w([cc.Node])],t.prototype,"adIcons",void 0),l([w([cc.Button])],t.prototype,"propBtns",void 0),l([w(cc.Node)],t.prototype,"root_Tips",void 0),l([w(cc.Node)],t.prototype,"root_Tips_finger",void 0),l([w(cc.Label)],t.prototype,"text_Tips",void 0),l([w(cc.Node)],t.prototype,"bottom",void 0),l([w(cc.Node)],t.prototype,"top",void 0),l([w(cc.Prefab)],t.prototype,"fireWorkPrefab",void 0),l([w(cc.Node)],t.prototype,"packageNode",void 0),l([w(cc.SpriteFrame)],t.prototype,"singleAddCupSprite",void 0),l([w(cc.Node)],t.prototype,"timeNode",void 0),l([w(f.default)],t.prototype,"propPanel",void 0),o=l([k],t)}(cc.Component);r.default=I,cc._RF.pop(),cc._RF.pop()},{}],GameScene:[function(e,t,o){"use strict";cc._RF.push(t,"8452dLrMeRAWarjX+9DOpsz","GameScene");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"8452dLrMeRAWarjX+9DOpsz","GameScene");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("CupMgr"),d=n("CommonData"),f=n("PropPanel"),h=n("UIManager"),y=n("GameManager"),m=n("config"),g=n("toutiao"),v=n("AutoPlayer"),_=n("const"),S=n("AutoPlayerMulti"),b=n("StaminaManager"),C=n("Cup"),P=n("PackageManger"),k=n("GoldDataManager"),w=n("UnlockData"),I=n("DataNexusSDK"),T=n("DataNexusEnum"),A=n("SignInManager"),O=n("BeginnerTaskPanel"),R=n("ThemeDataManager"),N=cc._decorator,M=N.ccclass,L=N.property,E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cupMgr=null,t.uiManager=null,t.autoPlayer=null,t.autoPlayerMulti=null,t.btn_skipLevel=null,t.text_level=null,t.text_propCount=[],t.adIcons=[],t.propBtns=[],t.root_Tips=null,t.root_Tips_finger=null,t.text_Tips=null,t.bottom=null,t.top=null,t.testNode=null,t.text_infinity=null,t.fireWorkPrefab=null,t.packageNode=null,t.btn_AutoPlay=null,t.btn_AutoPlayLevel=null,t.feedNode=null,t.gameTitle=null,t.singleAddCupSprite=null,t.packMask=null,t.cupMask=null,t.btn_Setting=null,t.startTime=0,t.unlockItem=null,t.progressNode=null,t.defaultMaterial=null,t.grayMaterial=null,t.text_undo=null,t.lastProgress=0,t.canHideTips=!0,t.addPackageNode=null,t.ifShowRider=!1,t.tipsStay="",t.editBox=null,t.text_AutoPlay=null,t.clickTimeAutoPlay=0,t.propPanel=null,t.lastActionTime=0,t.fingerHintTimer=null,t.fingerShowCnt=0,t}var o;return s(t,e),o=t,Object.defineProperty(t,"instance",{get:function(){var e=cc.find("Canvas");return cc.director.getScene().name===_.SceneNames.RingFight?e.getComponent("GameScene_RF"):this._instance},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){var e=this;I.default.instance.trackLoadFinish();var t=cc.find("Canvas").getComponent(cc.Canvas);d.default.CurrentLevel=d.default.Level,1==d.default.Level&&cc.director.getScene().name==_.SceneNames.Game&&I.default.instance.trackTutorialStart();var n={level_id:d.default.Level};n.coin_amount=k.default.Gold,n.enter_level_id=0,n.stamina_value=b.default.instance.energy,n.game_mode=cc.director.getScene().name,I.default.instance.trackLevelEnter(n),d.default.PropPump<=0&&I.default.instance.trackAdPlacementShow(T.RewardADEvent.SORT),d.default.PropAddCup<=0&&I.default.instance.trackAdPlacementShow(T.RewardADEvent.GENERATE_EMPTY_BOTTLE),d.default.PropUndo<=0&&I.default.instance.trackAdPlacementShow(T.RewardADEvent.UNDO),d.default.ratio<1670/750?(t.fitHeight=!0,t.fitWidth=!1):(t.fitHeight=!1,t.fitWidth=!0),"windows"===d.default.platform&&(t.fitHeight=!0,t.fitWidth=!1),o._instance=this,cc.director.on("level_finish",this.onFinishOneLevel,this),cc.director.on("do_pour",this.onPourAction,this),cc.director.on("use_prop",function(t){e.useProp(t)},this),cc.director.on("load_level",this.updateUI,this),cc.director.on("load_level",this.opening,this),cc.director.on("color_changed",this.updateUI,this),cc.director.on(_.EventNames.OnClickCup,this.onClickCup,this),cc.director.on(_.EventNames.Explode,this.onBombExplode,this),cc.director.on(_.EventNames.PackageUnlock,this.onBtn_AddPackage,this),cc.director.on(_.EventNames.PlayCupTutorial,this.showCupTutorial,this),cc.director.on(_.EventNames.NextLevel,this.onNextLevel,this),cc.director.getScene().name===_.SceneNames.Game?d.default.mode="normal":cc.director.getScene().name===_.SceneNames.GameModeMultiple?d.default.mode="multiple":cc.director.getScene().name===_.SceneNames.Challenge&&(d.default.mode="challenge")},t.prototype.onDestroy=function(){var e=this;cc.director.off(_.EventNames.Explode,this.onBombExplode,this),cc.director.off("level_finish",this.onFinishOneLevel,this),cc.director.off("do_pour",this.onPourAction,this),cc.director.off("use_prop",function(t){e.useProp(t)},this),cc.director.off("load_level",this.updateUI,this),cc.director.off("load_level",this.opening,this),cc.director.off("color_changed",this.updateUI,this),cc.director.off(_.EventNames.OnClickCup,this.onClickCup,this),cc.director.off(_.EventNames.PackageUnlock,this.onBtn_AddPackage,this),cc.director.off(_.EventNames.PlayCupTutorial,this.showCupTutorial,this),cc.director.off(_.EventNames.NextLevel,this.onNextLevel,this),this.clearFingerHintTimer(),this.unscheduleAllCallbacks()},t.prototype.start=function(){y.default.platform.reportPageEvent("Startlevel"),this.gameTitle&&m.currentPlatform===m.platformEnum.wechat&&(this.gameTitle.active=d.default.ifTest),this.bottom&&(this.bottom.active=!1),this.cupMgr=p.default.getInstance(),this.propPanel&&(this.propPanel=this.node.getChildByName("UIRoot").getComponentInChildren(f.default)),this.testNode.active=d.default.ifTest,cc.director.getScene().name===_.SceneNames.Game?(this.text_level.string="\u7b2c "+d.default.Level+" \u5173",0==d.default.ifFed&&this.initFeed(),cc.director.getScene().name===_.SceneNames.Game&&d.default.Level<=2&&(this.text_infinity.active=!0,cc.tween(this.text_infinity),this.text_infinity.active=!0,this.text_infinity.opacity=0,this.text_infinity.scale=0,cc.tween(this.text_infinity).parallel(cc.tween().to(.5,{opacity:255,scale:1},{easing:"sineIn"}),cc.tween().to(.15,{rotation:-10}).to(.15,{rotation:10}).union().repeat(3).to(.15,{rotation:0})).delay(10).to(.5,{opacity:0,scale:0},{easing:"sineOut"}).start()),this.text_infinity.active=d.default.Level<=2&&d.default.Level>1):cc.director.getScene().name===_.SceneNames.GameModeMultiple&&(this.text_level.string="\u7b2c "+d.default.LevelModeMultiple+" \u5173",this.text_infinity.active=!1),this.startTime=Date.now(),d.default.finish_time=Date.now(),y.default.platform.reportScene(7001,d.default.finish_time-d.default.start_time),m.currentPlatform===m.platformEnum.toutiao?(this.btn_AutoPlay&&(this.btn_AutoPlay.active=!1),this.btn_AutoPlayLevel&&(this.btn_AutoPlayLevel.active=!0)):m.currentPlatform===m.platformEnum.wechat&&(this.btn_AutoPlay&&(this.btn_AutoPlay.active=!0),this.btn_AutoPlayLevel&&(this.btn_AutoPlayLevel.active=!0))},t.prototype.initFeed=function(){d.default.isToday(d.default.LastGetFeedRewardDate)&&d.default.ifFed||1==d.default.feedType&&(cc.instantiate(this.feedNode).parent=this.node,d.default.ifFed=!0,d.default.LastGetFeedRewardDate=d.default.getTodayDate())},t.prototype.opening=function(){for(var e=this,t=0,o=this.cupMgr.cups;t<o.length;t++)o[t].cupType===C.CupType.Temp1AD&&(this.propBtns[4].getComponent(cc.Sprite).spriteFrame=this.singleAddCupSprite);cc.tween(this.bottom).to(.6,{y:-835},{easing:"sineIn"}).start(),cc.tween(this.top).to(.6,{y:835},{easing:"sineIn"}).start(),cc.tween(this.packageNode).to(.5,{x:0},{easing:"sineIn"}).start(),this.unlockItem&&(d.default.CurrentLevel%5==0&&null!=w.default.CurrentUnlockItem&&w.default.CurrentUnlockItem.type==w.UnlockType.RIDER?(cc.tween(this.unlockItem).to(.5,{x:270},{easing:"sineIn"}).start(),cc.tween(this.progressNode).to(.5,{x:270},{easing:"sineIn"}).start()):(cc.tween(this.unlockItem).to(.5,{x:260},{easing:"sineIn"}).start(),cc.tween(this.progressNode).to(.5,{x:260},{easing:"sineIn"}).start())),cc.tween(this.cupMgr.node).to(.6,{x:0},{easing:"sineIn"}).call(function(){for(var t=0,o=e.cupMgr.cups;t<o.length;t++)o[t].onSelectSurfaceAnimation();cc.director.emit("load_level_finish"),e.startFingerHintTimer(),console.error("check show tutorial or event",A.default.instance.ifNotified),d.default.autoPlaying||cc.director.getScene().name!==_.SceneNames.Game||(e.ifShowTutorial()?e.uiManager.showPanel("TutorialPanel").then(function(e){e.getComponent("TutorialPanel").defualtInGameSetUp()}):!A.default.instance.ifNotified&&A.default.instance.ifShowNotify()&&d.default.Level>4&&e.scheduleOnce(function(){console.error("show EventNotifyPanel"),e.uiManager.showEventPanel("EventNotifyPanel"),A.default.instance.ifNotified=!0},.4)),cc.director.getScene().name!==_.SceneNames.Game||d.default.isToday(d.default.LastGetDailyEnergyDate)||b.default.instance.isInfinite||(d.default.LastGetDailyEnergyDate=d.default.getTodayDate())}).start()},t.prototype.updateUI=function(){this.updateCoutnersUI(),this.updateButtonsUI(),this.updateTipsUI(),this.updateUndoText()},t.prototype.updateUndoText=function(){this.text_undo&&(this.text_undo.string=this.cupMgr.getActionNum().toString())},t.prototype.updateButtonsUI=function(){if(this.bottom.active=!0,1==d.default.Level&&cc.director.getScene().name==_.SceneNames.Game)for(var e=0;e<this.propBtns.length;e++)this.propBtns[e].node.active=!1;this.cupMgr.getActionNum()<1?(this.propBtns[0].node.opacity=254,this.propBtns[0].node.getComponent(cc.Sprite).setMaterial(0,this.grayMaterial)):(this.propBtns[0].node.getComponent(cc.Sprite).setMaterial(0,this.defaultMaterial),this.propBtns[0].node.opacity=255),this.cupMgr.canPumpWater()?(this.propBtns[2].node.opacity=255,this.propBtns[2].node.getComponent(cc.Sprite).setMaterial(0,this.defaultMaterial)):(this.propBtns[2].node.opacity=254,this.propBtns[2].node.getComponent(cc.Sprite).setMaterial(0,this.grayMaterial)),this.cupMgr.canDyeWater()?(this.propBtns[3].node.opacity=255,this.propBtns[3].node.getComponent(cc.Sprite).setMaterial(0,this.defaultMaterial)):(this.propBtns[3].node.opacity=254,this.propBtns[3].node.getComponent(cc.Sprite).setMaterial(0,this.grayMaterial)),this.propBtns.length>4&&(this.cupMgr.canAddEmptyCup()?(this.propBtns[4].node.opacity=255,this.propBtns[4].node.getComponent(cc.Sprite).setMaterial(0,this.defaultMaterial)):(this.propBtns[4].node.opacity=254,this.propBtns[4].node.getComponent(cc.Sprite).setMaterial(0,this.grayMaterial)))},t.prototype.onFinishOneLevel=function(){if(cc.director.getScene().name===_.SceneNames.Game?(1==d.default.Level&&I.default.instance.trackTutorialFinish(),d.default.currentLevelReplayedTime=0,y.default.platform.reportPageEvent("Passlevel"),y.default.platform.reportLevelTimeEvent("LevelPassTime",this.getLevelTime()),d.default.Level++,d.default.WinStreak++,A.default.instance.dailyWinCount++,d.default.UnlockDrops+=this.cupMgr.getDropNum(),m.currentPlatform===m.platformEnum.toutiao?y.default.platform.setRank(d.default.Level):(m.currentPlatform,m.platformEnum.wechat)):cc.director.getScene().name===_.SceneNames.GameModeMultiple&&(y.default.platform.reportPageEvent("PasslevelModeMultiple"),y.default.platform.reportLevelTimeEvent("LevelPassTimeModeMultiple",this.getLevelTime()),d.default.LevelModeMultiple++),m.currentPlatform===m.platformEnum.wechat&&d.default.CurrentLevel>=3&&0==d.default.isToday(d.default.LastFirstWinDate)&&(d.default.LastFirstWinDate=d.default.getTodayDate(),y.default.platform.showRecommend()),cc.director.getScene().name==_.SceneNames.Game){var e={level_id:d.default.CurrentLevel,ad_cnt:p.default.getInstance().currentLevelAdWatchedCount};e.duration=Math.round((Date.now()-this.startTime)/1e3),e.game_mode=cc.director.getScene().name,e.stamina_value=b.default.instance.energy,e.coin_amount=k.default.Gold,I.default.instance.trackLevelPass(e)}var t=this;t.playFireWork(function(){if(cc.director.getScene().name===_.SceneNames.Game){if(t.uiManager.node.children.forEach(function(e){e.active=!1}),y.default.ifBeginnerTask){if(3==d.default.CurrentLevel)return void h.default.getInstance().showPanel("BeginnerTaskPanel");for(var e=0,o=O.taskInfo;e<o.length;e++){var n=o[e];if(n.level==d.default.CurrentLevel)return R.default.setThemeUnlockMap(n.reward,!0),void y.default.showRewardPanel([0,0,0,0],parseInt(n.reward.split("_")[0]),3,!0,parseInt(n.reward.split("_")[1]))}}d.default.CurrentUnlockIndex<=d.default.collectionList.length&&d.default.CurrentLevel%5!=0?t.uiManager.showPanel("DrinkPanel"):d.default.CurrentLevel%5==0&&null!=w.default.CurrentUnlockItem?t.uiManager.showPanel("JourneyPanel"):t.uiManager.showPanel("GameOverMainPanel")}else t.uiManager.node.children.forEach(function(e){e.active=!1}),t.uiManager.showPanel("GameOverPanel")})},t.prototype.playFireWork=function(e){var t=this;void 0===e&&(e=null);for(var o=[cc.v2(40*Math.random()-180,240+40*Math.random()),cc.v2(40*Math.random()-180,40*Math.random()-240),cc.v2(180+40*Math.random(),240+40*Math.random()),cc.v2(180+40*Math.random(),40*Math.random()-240)],n=function(e){i.scheduleOnce(function(){t.playSingleFireWork(o[e])},.2+.3*Math.random())},i=this,r=0;r<4;r++)n(r);this.scheduleOnce(function(){u.default.instance.playSFX(u.AudioRef.Victory)},.3),this.scheduleOnce(function(){e&&e()},.6)},t.prototype.playSingleFireWork=function(e,t){void 0===t&&(t=null);var o=cc.instantiate(this.fireWorkPrefab);o.parent=this.node,o.scale=.4*Math.random()+.9,o.setPosition(e),o.getComponent(sp.Skeleton).setAnimation(0,"CG",!1),o.getComponent(sp.Skeleton).setCompleteListener(function(){o.destroy()})},t.prototype.onClickCup=function(){},t.prototype.onPourAction=function(){var e;this.updateUI(),(e=P.default.instance?P.default.instance.finishedPackageNum/P.default.instance.targetPackageNum:this.cupMgr.getProgress())>.7&&this.lastProgress<=.7&&m.currentPlatform===m.platformEnum.toutiao&&g.preloadInterstitialAd(),e>.5&&this.lastProgress<=.5&&m.currentPlatform===m.platformEnum.toutiao&&cc.director.getScene().name===_.SceneNames.Game&&y.default.platform.checkFeedSubscribeStatus(function(e){e.status||d.default.Level>=4&&d.default.ShowFeedTime<=2&&y.default.platform.requestFeedSubscribe(function(){d.default.ShowFeedTime++})},function(){}),e!=this.lastProgress?this.resetFingerHintTimer():this.hideFingerHint(),this.lastProgress=e},t.prototype.useProp=function(e){switch(this.root_Tips.stopAllActions(),this.root_Tips.active=!1,e){case 0:this.onBtn_undo();break;case 1:this.onBtn_organize();break;case 2:this.onBtn_pump();break;case 3:this.onBtn_dye();break;case 4:this.onBtn_addCup()}},t.prototype.updateCoutnersUI=function(){this.text_propCount[0].string=d.default.PropUndo+"",d.default.PropUndo>99&&(this.text_propCount[0].string="99+"),this.text_propCount[2].string=d.default.PropPump+"",d.default.PropPump>99&&(this.text_propCount[2].string="99+"),this.text_propCount[3].string=d.default.PropDye+"",d.default.PropDye>99&&(this.text_propCount[3].string="99+"),this.text_propCount.length>4&&(this.text_propCount[4].string=d.default.PropAddCup+""),this.text_propCount.length>4&&d.default.PropAddCup>99&&(this.text_propCount[4].string="99+"),d.default.PropUndo<=0?(this.text_propCount[0].string="+",this.text_propCount[0].node.y=3,this.text_propCount[0].fontSize=40,this.text_propCount[0].node.active=!1,this.adIcons[0].active=!0,d.default.IfShowPropPanelUndo||(this.text_propCount[0].node.active=!0,this.adIcons[0].active=!1,cc.director.getScene().name===_.SceneNames.Challenge&&(this.adIcons[0].active=!0))):(this.text_propCount[0].fontSize=30,this.text_propCount[0].node.y=3,this.text_propCount[0].node.active=!0,this.adIcons[0].active=!1),d.default.PropPump<=0?(this.text_propCount[2].string="+",this.text_propCount[2].node.y=3,this.text_propCount[2].fontSize=40,this.text_propCount[2].node.active=!1,this.adIcons[2].active=!0,d.default.IfShowPropPanelPump||(this.text_propCount[2].node.active=!0,this.adIcons[2].active=!1,cc.director.getScene().name===_.SceneNames.Challenge&&(this.adIcons[2].active=!0))):(this.text_propCount[2].fontSize=30,this.text_propCount[2].node.y=3,this.text_propCount[2].node.active=!0,this.adIcons[2].active=!1),d.default.PropDye<=0?(this.text_propCount[3].string="+",this.text_propCount[3].node.y=3,this.text_propCount[3].fontSize=40,this.text_propCount[3].node.active=!1,this.adIcons[3].active=!0):(this.text_propCount[3].fontSize=30,this.text_propCount[3].node.y=3,this.text_propCount[3].node.active=!0,this.adIcons[3].active=!1),this.text_propCount.length>4&&(d.default.PropAddCup<=0?(this.text_propCount[4].string="+",this.text_propCount[4].node.y=3,this.text_propCount[4].fontSize=40,this.text_propCount[4].node.active=!1,this.adIcons[4].active=!0,d.default.IfShowPropPanelAddCup||(this.text_propCount[4].node.active=!0,this.adIcons[4].active=!1,cc.director.getScene().name===_.SceneNames.Challenge&&(this.adIcons[4].active=!0))):(this.text_propCount[4].fontSize=30,this.text_propCount[4].node.y=3,this.text_propCount[4].node.active=!0,this.adIcons[4].active=!1)),d.default.Level<=2&&cc.director.getScene().name===_.SceneNames.Game&&(this.text_propCount[0].string="\u221e",this.text_propCount[0].node.y=3,this.text_propCount[0].fontSize=40,this.text_propCount[1].string="\u221e",this.text_propCount[1].node.y=3,this.text_propCount[1].fontSize=40,this.text_propCount[2].string="\u221e",this.text_propCount[2].node.y=3,this.text_propCount[2].fontSize=40,this.text_propCount[3].string="\u221e",this.text_propCount[3].node.y=3,this.text_propCount[3].fontSize=40,this.text_propCount[0].node.active=!0,this.adIcons[0].active=!1,this.text_propCount[1].node.active=!0,this.adIcons[1].active=!1,this.text_propCount[2].node.active=!0,this.adIcons[2].active=!1,this.text_propCount[3].node.active=!0,this.adIcons[3].active=!1,this.text_propCount.length>4&&(this.text_propCount[4].string="\u221e",this.text_propCount[4].node.y=3,this.text_propCount[4].fontSize=40,this.text_propCount[4].node.active=!0,this.adIcons[4].active=!1))},t.prototype.updateTipsUI=function(){if(cc.director.getScene().name===_.SceneNames.Game&&p.default.getInstance().ifDeadLockAllFinished()){if(!this.canHideTips)return;this.showRiderTips()}else if(p.default.getInstance().ifDeadLock()){var e=p.default.getInstance().getLockedCups();if(!this.canHideTips)return;return void(e?this.PopupTips("\u5361\u4f4f\u5566\uff0c\u5feb\u89e3\u9501\u4e00\u4e2a\u65b0\u676f\u5b50\u5427\uff01",8,5,e,3):this.PopupTips("\u5361\u4f4f\u5566\uff0c\u7528\u4e2a\u9053\u5177\u8bd5\u8bd5\u5427\uff01",8,5,null,3))}var t=this.text_Tips.string;"\u5361\u4f4f\u5566\uff0c\u5feb\u89e3\u9501\u4e00\u4e2a\u65b0\u676f\u5b50\u5427\uff01"!=t&&"\u5361\u4f4f\u5566\uff0c\u7528\u4e2a\u9053\u5177\u8bd5\u8bd5\u5427\uff01"!=t||this.PopoutTips()},t.prototype.showRiderTips=function(){var e=this;this.addPackageNode.active||this.ifShowRider||(this.ifShowRider=!0,P.default.instance.ifThirdUnlock?this.scheduleOnce(function(){e.bottom.getChildByName("Btns").active=!1,e.root_Tips.y-=150,e.PopupTips("\u9a91\u624b\u989c\u8272\u4e0d\u5339\u914d\uff0c\u5237\u65b0\u4e00\u6279\u9a91\u624b\u5427\uff01",20,0,null,5),cc.tween(e.root_Tips).to(.5,{y:e.root_Tips.y+150},{easing:"sineOut"}).call(function(){e.addPackageNode.active=!0}).start()},3):this.scheduleOnce(function(){e.bottom.getChildByName("Btns").active=!1,e.root_Tips.y-=150,e.PopupTips("\u9a91\u624b\u989c\u8272\u4e0d\u5339\u914d\uff0c\u518d\u558a\u4e00\u4f4d\u9a91\u624b\u5427\uff01",20,0,P.default.instance.currentPackages[2].node.getChildByName("PackageAd"),5),cc.tween(e.root_Tips).to(.5,{y:e.root_Tips.y+150},{easing:"sineOut"}).call(function(){e.addPackageNode.active=!0}).start()},3))},t.prototype.onBtn_AddPackage=function(){this.addPackageNode.active=!1,this.canHideTips=!0,this.bottom.getChildByName("Btns").active=!0,this.PopoutTips(),d.default.ifFirstAddPackage=!1,this.ifShowRider=!1},t.prototype.onBtn_RefreshPackage=function(){P.default.instance.refreshPackage(),this.addPackageNode.active=!1,this.canHideTips=!0,this.bottom.getChildByName("Btns").active=!0,this.PopoutTips(),this.ifShowRider=!1,cc.director.emit(_.EventNames.DoPour)},t.prototype.onBtn_Quit=function(){this.addPackageNode.active=!1,this.canHideTips=!0,this.bottom.getChildByName("Btns").active=!0,this.PopoutTips(),this.ifShowRider=!1},t.prototype.PopupTips=function(e,t,o,n,i){var r=this;void 0===t&&(t=5),void 0===o&&(o=0),void 0===n&&(n=null),void 0===i&&(i=0),this.canHideTips&&(this.root_Tips.active=!0,this.text_Tips.string=e,this.root_Tips.stopAllActions(),this.root_Tips.opacity>0&&cc.tween(this.root_Tips).to(.2,{opacity:0}).start(),this.scheduleOnce(function(){r.canHideTips=!0},o+i),this.root_Tips.runAction(cc.sequence(cc.delayTime(o),cc.callFunc(function(){r.canHideTips&&(r.canHideTips=!1),r.resetFingerHintTimer(),n&&n.isValid?r.root_Tips_finger.active=!0:r.root_Tips_finger.active=!1,r.root_Tips_finger.opacity=255,n&&n.isValid&&r.root_Tips_finger.setPosition(cc.Canvas.instance.node.convertToNodeSpaceAR(n.convertToWorldSpaceAR(cc.Vec2.ZERO)))}),cc.fadeIn(.2),cc.delayTime(t),cc.callFunc(function(){r.root_Tips_finger.runAction(cc.fadeOut(.2))}),cc.fadeOut(.2),cc.callFunc(function(){r.resetFingerHintTimer(),r.root_Tips.opacity=0,r.root_Tips.active=!1,r.root_Tips_finger.active=!1}))))},t.prototype.ChangeTipsStay=function(e,t){var o=this;void 0===t&&(t=2),this.text_Tips.string=e,this.scheduleOnce(function(){o.text_Tips.string=o.tipsStay},t)},t.prototype.PopupTipsStay=function(e){this.root_Tips.active=!0,this.root_Tips_finger.active=!1,this.text_Tips.string=e,this.tipsStay=e,this.root_Tips.stopAllActions(),this.root_Tips.runAction(cc.fadeIn(.2))},t.prototype.PopoutTips=function(){var e=this;this.canHideTips?(this.root_Tips.stopAllActions(),!0===this.root_Tips.active&&this.root_Tips.runAction(cc.sequence(cc.callFunc(function(){e.root_Tips_finger.runAction(cc.fadeOut(.2))}),cc.fadeOut(.2),cc.callFunc(function(){e.root_Tips.active=!1,e.root_Tips_finger.active=!1})))):this.scheduleOnce(function(){e.PopoutTips()},2)},t.prototype.onBtn_JumpLevel=function(){var e=parseInt(this.editBox.string);isNaN(e)||e<1||(d.default.Level=e,cc.director.loadScene("Game"))},t.prototype.onBtn_nextLevel=function(){if(d.default.Level++,"Game"==cc.director.getScene().name&&(d.default.ifRestart=!1,d.default.Level>300&&d.default.CurrentLevel>300))switch(d.default.currentLevelDifficulty){case 0:d.default.removeChallengeLevel0();break;case 1:d.default.removeChallengeLevel1();break;case 2:d.default.removeChallengeLevel2();break;case 3:d.default.removeChallengeLevel3()}cc.director.loadScene("Game")},t.prototype.onBtn_AutoPlay=function(){d.default.autoPlaying?(null!=this.autoPlayer?this.autoPlayer.StopAutoPlay():null!=this.autoPlayerMulti&&this.autoPlayerMulti.StopAutoPlay(),this.text_AutoPlay.string="\u81ea\u52a8\u73a9(\u5173)"):(null!=this.autoPlayer?this.autoPlayer.StartAutoPlay():null!=this.autoPlayerMulti&&this.autoPlayerMulti.StartAutoPlay(),this.text_AutoPlay.string="\u81ea\u52a8\u73a9(\u5f00)")},t.prototype.onBtn_AutoPlayLevel=function(){d.default.ifTest&&(this.clickTimeAutoPlay++,this.clickTimeAutoPlay>=5&&(this.clickTimeAutoPlay=0,this.onBtn_AutoPlay()))},t.prototype.updateAutoPlayText=function(){d.default.autoPlaying?this.text_AutoPlay.string="\u81ea\u52a8\u73a9(\u5f00)":this.text_AutoPlay.string="\u81ea\u52a8\u73a9(\u5173)"},t.prototype.onNextLevel=function(){if("Game"==cc.director.getScene().name){if(d.default.Level++,d.default.ifRestart=!1,d.default.Level>300&&d.default.CurrentLevel>300)switch(d.default.currentLevelDifficulty){case 0:d.default.removeChallengeLevel0();break;case 1:d.default.removeChallengeLevel1();break;case 2:d.default.removeChallengeLevel2();break;case 3:d.default.removeChallengeLevel3()}}else"GameModeLong"==cc.director.getScene().name?d.default.LevelChallenge++:cc.director.getScene().name==_.SceneNames.GameModeMultiple?d.default.LevelModeMultiple++:cc.director.getScene().name==_.SceneNames.GameModeFillLong&&d.default.LevelModeFillLong++;cc.director.loadScene(cc.director.getScene().name)},t.prototype.unlockDrink=function(){this.uiManager.showPanel("DrinkPanel")},t.prototype.onBtn_undo=function(){this.root_Tips.stopAllActions(),this.root_Tips_finger.stopAllActions(),this.root_Tips.active=!1,this.root_Tips.opacity=0,p.default.getInstance().checkIfCanUndo()?(this.canHideTips=!0,this.root_Tips_finger.active=!1,(d.default.Level>=3||cc.director.getScene().name!==_.SceneNames.Game)&&d.default.PropUndo>0&&d.default.PropUndo--,this.cupMgr.undoAction(),this.updateCoutnersUI()):this.PopupTips("\u6709\u64cd\u4f5c\u6b63\u5728\u8fdb\u884c\u4e2d\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5",2)},t.prototype.onBtn_undoProp=function(){var e=this;if(this.PopoutTips,y.default.platform.reportButtonEvent("GamePage_withdrawBtn",0),!(this.propBtns[0].node.opacity<255))return d.default.Level<3&&cc.director.getScene().name===_.SceneNames.Game?d.default.IfShowPropPanelUndo||cc.director.getScene().name!==_.SceneNames.Game?(d.default.IfShowPropPanelUndo=!0,this.onBtn_undo(),void y.default.platform.reportButtonEvent("GamePage_withdrawBtn",7)):(this.propPanel.showPropPanel(0),d.default.IfShowPropPanelUndo=!0,void this.updateCoutnersUI()):void(d.default.PropUndo>0?(this.onBtn_undo(),y.default.platform.reportButtonEvent("GamePage_withdrawBtn",7)):d.default.IfShowPropPanelUndo||cc.director.getScene().name!==_.SceneNames.Game?(cc.director.getScene().name===_.SceneNames.Game?y.default.platform.reportVideoEvent("GamePage_withdrawBtn_video",1):cc.director.getScene().name===_.SceneNames.Challenge&&y.default.platform.reportVideoEvent("Challenge_withdrawBtn_video",1),d.default.IfShowPropPanelUndo=!0,I.default.instance.trackAdClick(T.RewardADEvent.UNDO),y.default.platform.showRewardAD(function(){I.default.instance.trackAdVideoFinish(T.RewardADEvent.UNDO),e.useProp(0),"Game"===cc.director.getScene().name&&y.default.platform.reportAdPointEvent("AdPoint",p.default.getInstance().getProgress()),cc.director.getScene().name===_.SceneNames.Game?y.default.platform.reportVideoEvent("GamePage_withdrawBtn_video",2):cc.director.getScene().name===_.SceneNames.Challenge&&y.default.platform.reportVideoEvent("Challenge_withdrawBtn_video",2),u.default.instance.playSFX(u.AudioRef.ClickButton)})):(this.propPanel.showPropPanel(0),d.default.IfShowPropPanelUndo=!0,this.updateCoutnersUI()));this.PopupTips("\u6682\u65e0\u53ef\u64a4\u56de\u7684\u64cd\u4f5c",2)},t.prototype.onBtn_dye=function(){this.root_Tips.stopAllActions(),this.root_Tips.active=!1,u.default.instance.playSFX(u.AudioRef.SortItem),d.default.PropDye>0&&d.default.PropDye--,this.cupMgr.dyeWater(),this.updateCoutnersUI()},t.prototype.onBtn_dyeProp=function(){y.default.platform.reportButtonEvent("GamePage_dyedBtn",0),this.PopoutTips,this.propBtns[3].node.opacity<255?this.PopupTips("\u6682\u65e0\u53ef\u67d3\u8272\u7684\u6c34",2):d.default.PropDye>0?this.onBtn_dye():this.propPanel.showPropPanel(3)},t.prototype.onBtn_organize=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),d.default.PropOrganize>0&&d.default.PropOrganize--,this.cupMgr.organizeWater(),this.updateCoutnersUI()},t.prototype.onBtn_organizeProp=function(){y.default.platform.reportButtonEvent("GamePage_sortBtn",0),this.PopoutTips,this.propBtns[1].node.opacity<255?this.PopupTips("\u6682\u65e0\u53ef\u6574\u7406\u7684\u74f6\u5b50",2):d.default.PropOrganize>0?this.onBtn_organize():this.propPanel.showPropPanel(1)},t.prototype.onBtn_addCup=function(){this.root_Tips.stopAllActions(),this.root_Tips_finger.stopAllActions(),this.root_Tips.active=!1,this.root_Tips.opacity=0,this.canHideTips=!0,this.root_Tips_finger.active=!1,u.default.instance.playSFX(u.AudioRef.ClickButton),(d.default.Level>=3||cc.director.getScene().name!==_.SceneNames.Game)&&d.default.PropAddCup>0&&d.default.PropAddCup--,this.cupMgr.addEmptyCup(),this.updateCoutnersUI()},t.prototype.onBtn_addCupProp=function(){var e=this;if(y.default.platform.reportButtonEvent("GamePage_addCupBtn",0),this.PopoutTips(),!(this.propBtns[4].node.opacity<255))return d.default.Level<3&&cc.director.getScene().name===_.SceneNames.Game?d.default.IfShowPropPanelAddCup||cc.director.getScene().name!==_.SceneNames.Game?(y.default.platform.reportButtonEvent("GamePage_addCupBtn",7),d.default.IfShowPropPanelAddCup=!0,void this.onBtn_addCup()):(this.propPanel.showPropPanel(4),d.default.IfShowPropPanelAddCup=!0,y.default.platform.reportButtonEvent("GamePage_addCupBtn",7),void this.updateCoutnersUI()):void(d.default.PropAddCup>0?(this.onBtn_addCup(),y.default.platform.reportButtonEvent("GamePage_addCupBtn",7)):d.default.IfShowPropPanelAddCup||cc.director.getScene().name!==_.SceneNames.Game?(d.default.IfShowPropPanelAddCup=!0,y.default.platform.reportVideoEvent("GamePage_addCupBtn_video",1),I.default.instance.trackAdClick(T.RewardADEvent.GENERATE_EMPTY_BOTTLE),y.default.platform.showRewardAD(function(){I.default.instance.trackAdVideoFinish(T.RewardADEvent.GENERATE_EMPTY_BOTTLE),e.useProp(4),"Game"===cc.director.getScene().name&&y.default.platform.reportAdPointEvent("AdPoint",p.default.getInstance().getProgress()),y.default.platform.reportVideoEvent("GamePage_addCupBtn_video",2),u.default.instance.playSFX(u.AudioRef.ClickButton)})):(this.propPanel.showPropPanel(4),d.default.IfShowPropPanelAddCup=!0,this.updateCoutnersUI()));this.PopupTips("\u6682\u65e0\u7a7a\u4f4d",2)},t.prototype.onBtn_pump=function(){this.root_Tips.stopAllActions(),this.root_Tips_finger.stopAllActions(),this.root_Tips.active=!1,this.root_Tips_finger.active=!1,this.root_Tips.opacity=0,this.canHideTips=!0,u.default.instance.playSFX(u.AudioRef.ClickButton),(d.default.Level>=3||cc.director.getScene().name!==_.SceneNames.Game)&&d.default.PropPump>0&&d.default.PropPump--,this.cupMgr.pumpWater(),this.updateCoutnersUI()},t.prototype.onBtn_pumpProp=function(){var e=this;if(this.PopoutTips,y.default.platform.reportButtonEvent("GamePage_topUpBtn",0),!(this.propBtns[2].node.opacity<255))return d.default.Level<3&&cc.director.getScene().name===_.SceneNames.Game?d.default.IfShowPropPanelPump||cc.director.getScene().name!==_.SceneNames.Game?(d.default.IfShowPropPanelPump=!0,y.default.platform.reportButtonEvent("GamePage_topUpBtn",7),void this.onBtn_pump()):(this.propPanel.showPropPanel(2),d.default.IfShowPropPanelPump=!0,y.default.platform.reportButtonEvent("GamePage_topUpBtn",7),void this.updateCoutnersUI()):void(d.default.PropPump>0?(this.onBtn_pump(),y.default.platform.reportButtonEvent("GamePage_topUpBtn",7)):d.default.IfShowPropPanelPump||cc.director.getScene().name!==_.SceneNames.Game?(d.default.IfShowPropPanelPump=!0,cc.director.getScene().name===_.SceneNames.Game?y.default.platform.reportVideoEvent("GamePage_topUpBtn_video",1):cc.director.getScene().name===_.SceneNames.Challenge&&y.default.platform.reportVideoEvent("Challenge_topUpBtn_video",1),I.default.instance.trackAdClick(T.RewardADEvent.SORT),y.default.platform.showRewardAD(function(){I.default.instance.trackAdVideoFinish(T.RewardADEvent.SORT),e.useProp(2),"Game"===cc.director.getScene().name&&y.default.platform.reportAdPointEvent("AdPoint",p.default.getInstance().getProgress()),cc.director.getScene().name===_.SceneNames.Game?y.default.platform.reportVideoEvent("GamePage_topUpBtn_video",2):cc.director.getScene().name===_.SceneNames.Challenge&&y.default.platform.reportVideoEvent("Challenge_topUpBtn_video",2),u.default.instance.playSFX(u.AudioRef.ClickButton)})):(this.propPanel.showPropPanel(2),d.default.IfShowPropPanelPump=!0,this.updateCoutnersUI()));this.PopupTips("\u6682\u65e0\u53ef\u62bd\u53d6\u7684\u6c34",2)},t.prototype.ifNearlyOutOfRider=function(){return!!p.default.getInstance().isMultiLevel()&&p.default.getInstance().cups.filter(function(e){return e.currentState===C.CupState.Finished||e.currentState===C.CupState.ReadyToBeCollected}).length/p.default.getInstance().cups.length>=.4},t.prototype.showFingerHint=function(){this.ifNearlyOutOfRider()&&!P.default.instance.ifThirdUnlock&&this.showFingerHintRider(),this.showFingerHintCup()},t.prototype.showFingerHintRider=function(){var e=this;if(!(d.default.Level<6&&m.currentPlatform===m.platformEnum.toutiao)){var t=P.default.instance.currentPackages[2].node.getChildByName("PackageAd");if(t&&t.isValid){this.root_Tips_finger.active=!0,this.root_Tips_finger.opacity=255,this.fingerHintTimer++,this.fingerShowCnt++;var o=t.convertToWorldSpaceAR(cc.Vec2.ZERO);o=cc.Canvas.instance.node.convertToNodeSpaceAR(o),this.root_Tips_finger.setPosition(o),this.scheduleOnce(function(){e.hideFingerHint(),e.resetFingerHintTimer()},3)}}},t.prototype.showFingerHintCup=function(){var e=this;if(!(d.default.Level<6||this.fingerShowCnt>1)){var t=p.default.getInstance().getLockedCups();if(t){this.root_Tips_finger.active=!0,this.root_Tips_finger.opacity=255,this.fingerHintTimer++,this.fingerShowCnt++;var o=t.convertToWorldSpaceAR(cc.Vec2.ZERO);o=cc.Canvas.instance.node.convertToNodeSpaceAR(o),this.root_Tips_finger.setPosition(o),this.scheduleOnce(function(){e.hideFingerHint(),e.resetFingerHintTimer()},3)}}},t.prototype.hideFingerHint=function(){var e=this;this.canHideTips&&(d.default.Level<6||(this.root_Tips_finger.stopAllActions(),!0===this.root_Tips_finger.active&&this.root_Tips_finger.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){e.root_Tips_finger.active=!1})))))},t.prototype.startFingerHintTimer=function(){var e=this;d.default.Level<6||(this.lastActionTime=Date.now(),this.fingerHintTimer&&clearTimeout(this.fingerHintTimer),this.fingerHintTimer=setTimeout(function(){e.showFingerHint()},1e4))},t.prototype.resetFingerHintTimer=function(){d.default.Level<6||(this.lastActionTime=Date.now(),this.fingerHintTimer&&clearTimeout(this.fingerHintTimer),this.startFingerHintTimer())},t.prototype.clearFingerHintTimer=function(){this.fingerHintTimer&&(clearTimeout(this.fingerHintTimer),this.fingerHintTimer=null)},t.prototype.onBombExplode=function(){cc.director.getScene().name!==_.SceneNames.Game||d.default.autoPlaying||this.uiManager.showPanel("GameLosePanel").then(function(e){e.getComponent("GameLosePanel").initPanel(2)})},t.prototype.ifShowTutorial=function(){if(d.default.TUTORIAL_INDEX.includes(d.default.Level)&&-1!=d.default.TUTORIAL_INDEX[d.default.TUTORIAL_INDEX.indexOf(d.default.Level)])return!0;var e=p.default.getInstance().cups;if(!1===d.default.ifPlayedAbsorbCup)for(var t=0,o=e;t<o.length;t++)if((l=o[t]).cupType===C.CupType.Absorb)return!0;if(!1===d.default.ifPlayedBombCup)for(var n=0,i=e;n<i.length;n++)if((l=i[n]).cupType===C.CupType.Bomb||l.cupType===C.CupType.BombFixed||l.cupType===C.CupType.BombMasked||l.cupType===C.CupType.BombFrozen)return!0;if(!1===d.default.ifPlayedChangeColorCup)for(var r=0,a=e;r<a.length;r++)if((l=a[r]).cupType===C.CupType.ChangeColor)return!0;if(!1===d.default.ifPlayedLockCup)for(var c=0,s=e;c<s.length;c++){var l;if((l=s[c]).cupType===C.CupType.Lock)return!0}},t.prototype.showCupTutorial=function(e){this.uiManager.showPanel("TutorialPanel").then(function(t){t.getComponent("TutorialPanel").setShowCaseIndex(e)})},t.prototype.onBtn_Pause=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),cc.director.getScene().name===_.SceneNames.GameModeMultiple&&cc.director.emit(_.EventNames.Pause),this.uiManager.showPanel("SettingPanel")},t.prototype.getLevelTime=function(){return Math.floor((Date.now()-this.startTime)/1e3)},t._instance=null,l([L(p.default)],t.prototype,"cupMgr",void 0),l([L(h.default)],t.prototype,"uiManager",void 0),l([L(v.default)],t.prototype,"autoPlayer",void 0),l([L(S.default)],t.prototype,"autoPlayerMulti",void 0),l([L(cc.Node)],t.prototype,"btn_skipLevel",void 0),l([L(cc.Label)],t.prototype,"text_level",void 0),l([L([cc.Label])],t.prototype,"text_propCount",void 0),l([L([cc.Node])],t.prototype,"adIcons",void 0),l([L([cc.Button])],t.prototype,"propBtns",void 0),l([L(cc.Node)],t.prototype,"root_Tips",void 0),l([L(cc.Node)],t.prototype,"root_Tips_finger",void 0),l([L(cc.Label)],t.prototype,"text_Tips",void 0),l([L(cc.Node)],t.prototype,"bottom",void 0),l([L(cc.Node)],t.prototype,"top",void 0),l([L(cc.Node)],t.prototype,"testNode",void 0),l([L(cc.Node)],t.prototype,"text_infinity",void 0),l([L(cc.Prefab)],t.prototype,"fireWorkPrefab",void 0),l([L(cc.Node)],t.prototype,"packageNode",void 0),l([L(cc.Node)],t.prototype,"btn_AutoPlay",void 0),l([L(cc.Node)],t.prototype,"btn_AutoPlayLevel",void 0),l([L(cc.Prefab)],t.prototype,"feedNode",void 0),l([L(cc.Node)],t.prototype,"gameTitle",void 0),l([L(cc.SpriteFrame)],t.prototype,"singleAddCupSprite",void 0),l([L(cc.Node)],t.prototype,"packMask",void 0),l([L(cc.Node)],t.prototype,"cupMask",void 0),l([L(cc.Node)],t.prototype,"btn_Setting",void 0),l([L(cc.Node)],t.prototype,"unlockItem",void 0),l([L(cc.Node)],t.prototype,"progressNode",void 0),l([L(cc.Material)],t.prototype,"defaultMaterial",void 0),l([L(cc.Material)],t.prototype,"grayMaterial",void 0),l([L(cc.Label)],t.prototype,"text_undo",void 0),l([L(cc.Node)],t.prototype,"addPackageNode",void 0),l([L(cc.EditBox)],t.prototype,"editBox",void 0),l([L(cc.Label)],t.prototype,"text_AutoPlay",void 0),l([L(f.default)],t.prototype,"propPanel",void 0),o=l([M],t)}(cc.Component);r.default=E,cc._RF.pop(),cc._RF.pop()},{}],GoldDataManager:[function(e,t,o){"use strict";cc._RF.push(t,"58fc1taU6lDIq6RNEdhj7Gz","GoldDataManager");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"58fc1taU6lDIq6RNEdhj7Gz","GoldDataManager");var c=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var s=n("CommonData"),l=n("const"),u=cc._decorator,p=u.ccclass,d=(u.property,function(){function e(){}var t;return t=e,Object.defineProperty(e,"Gold",{get:function(){var e=s.default.getStorage("Gold");return null==e||""===e||isNaN(parseInt(e))?0:(t._gold=parseInt(e),t._gold)},set:function(e){s.default.setStorage("Gold",e),t._gold=e,cc.director.emit(l.EventNames.UpdateGold,e)},enumerable:!1,configurable:!0}),e._gold=0,t=c([p],e)}());r.default=d,cc._RF.pop(),cc._RF.pop()},{}],GroupPanel:[function(e,t,o){"use strict";cc._RF.push(t,"0fab66wX3ZDP4VInsy9VCLv","GroupPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"0fab66wX3ZDP4VInsy9VCLv","GroupPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("BasePanel"),d=cc._decorator,f=d.ccclass,h=d.property,y=d.menu,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.root=null,t}return s(t,e),t.prototype.show=function(e){var t=this.root;cc.director.emit("UpdateOpenPanelCount"),t&&(cc.Tween.stopAllByTarget(t),t.scale=.5,t.opacity=220,cc.tween(t).to(.3,{scale:1,opacity:255},{easing:"backOut"}).call(function(){e&&e()}).start())},t.prototype.hide=function(e){var t=this,o=this.root;o&&(cc.Tween.stopAllByTarget(o),o.scale=1,o.opacity=255,cc.tween(o).to(.4,{scale:0,opacity:0},{easing:"backIn"}).call(function(){t.node.active=!1,e&&"function"==typeof e&&e(),cc.director.emit("UpdateOpenPanelCount")}).start())},t.prototype.onBtn_close=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),this.hide()},l([h(cc.Node)],t.prototype,"root",void 0),l([f,y("Event/EventDescPanel")],t)}(p.default);r.default=m,cc._RF.pop(),cc._RF.pop()},{}],IAAAnalys:[function(e,t,o){"use strict";cc._RF.push(t,"4514e2C6wtG9JuI5wseEKha","IAAAnalys");var n=e,i=t,r=o;cc._RF.push(i,"4514e2C6wtG9JuI5wseEKha","IAAAnalys"),Object.defineProperty(r,"__esModule",{value:!0}),r.ecpm_wx_add=r.reportIAA=r.ecpm_wx_active=r.init=void 0;var a=n("CommonData"),c="",s="",l="",u="",p="",d="",f="";function h(){console.error("====>>>> openId",s),wx.request({url:"https://api.flysheeep.com/api/expro/ecpm_wx_active_new",header:{"Content-Type":"application/json;charset=utf-8","x-appid":a.default.appId},data:{appid:c,openid:s,advertiser_id:l,click_id:u,project_id:p,promotion_id:d,game:"pour_water",req_id:f},method:"POST",success:function(e){console.error("==>>> \u4e0a\u62a5\u6fc0\u6d3b\u6210\u529f",e)},fail:function(e){console.error("==>>> \u4e0a\u62a5\u6fc0\u6d3b\u5931\u8d25",e)}})}function y(e,t){void 0===e&&(e=""),void 0===t&&(t=""),wx.request({url:"https://api.flysheeep.com/api/expro/ecpm_wx_add_new",header:{"Content-Type":"application/json;charset=utf-8","x-appid":a.default.appId},data:{appid:c,openid:s,advertiser_id:l,click_id:u,encrypted_data:e,iv:t,game:"pour_water",req_id:f},method:"POST",success:function(e){console.error("==>>> \u4e0a\u62a5\u5173\u952e\u884c\u4e3a\u6210\u529f",e)},fail:function(e){console.error("==>>> \u4e0a\u62a5\u5173\u952e\u884c\u4e3a\u5931\u8d25",e)}})}r.init=function(e,t,o){c=o,s=t,u=e.clickid?e.clickid:"",l=e.advertiser_id?e.advertiser_id:"",p=e.project_id?e.project_id:"",d=e.promotion_id?e.promotion_id:"",f=e.req_id?e.req_id:"",h()},r.ecpm_wx_active=h,r.reportIAA=function(e,t,o,n){void 0===e&&(e=""),void 0===t&&(t=""),void 0===o&&(o=1),void 0===n&&(n=0),setTimeout(function(){GameGlobal&&GameGlobal.miniGameCommon&&GameGlobal.miniGameCommon.getUserLabel({reportData:'{"gift_scene": '+e+',"gift_name": '+t+',\n         "gift_value":'+o+', "gift_value_success": '+n+"}",labelId:"iaa_feature_v2"}).then(function(e){console.error("getUserLabel success:",e),y(e.encryptedData,e.iv)}).catch(function(e){console.error("getUserLabel fail:",e)})},3e4)},r.ecpm_wx_add=y,cc._RF.pop(),cc._RF.pop()},{}],InGameLevelText:[function(e,t,o){"use strict";cc._RF.push(t,"3d8801cbptJ0K2FJLAmTV9k","InGameLevelText");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"3d8801cbptJ0K2FJLAmTV9k","InGameLevelText");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("CommonData"),d=n("ThemeDataManager"),f=cc._decorator,h=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.labelOutline=null,t.sprite=null,t.spriteFrames=[],t}return s(t,e),t.prototype.start=function(){p.default.Level>=30&&p.default.Level%10==0?this.setHell():p.default.Level%5==0?this.setHard():this.setNormal()},t.prototype.setNormal=function(){2==d.default.CurrentSelectedThemeIndex||5==d.default.CurrentSelectedThemeIndex?(this.sprite.spriteFrame=this.spriteFrames[1],this.label.node.y=30,this.labelOutline.enabled=!1,this.labelOutline.node.x=0):(this.sprite.spriteFrame=this.spriteFrames[0],this.labelOutline.color=(new cc.Color).fromHEX("#6C442C"),this.labelOutline.node.x=0)},t.prototype.setHard=function(){u.default.instance.playSFX(u.AudioRef.HardLevel),this.sprite.spriteFrame=this.spriteFrames[2],this.labelOutline.color=(new cc.Color).fromHEX("#0d001e"),this.labelOutline.node.x=0},t.prototype.setHell=function(){u.default.instance.playSFX(u.AudioRef.HellLevel),this.sprite.spriteFrame=this.spriteFrames[3],this.labelOutline.color=(new cc.Color).fromHEX("#240202"),this.labelOutline.node.x=-5},l([y(cc.Label)],t.prototype,"label",void 0),l([y(cc.LabelOutline)],t.prototype,"labelOutline",void 0),l([y(cc.Sprite)],t.prototype,"sprite",void 0),l([y([cc.SpriteFrame])],t.prototype,"spriteFrames",void 0),l([h],t)}(cc.Component);r.default=m,cc._RF.pop(),cc._RF.pop()},{}],InGameUnlockItem:[function(e,t,o){"use strict";cc._RF.push(t,"34aaf+/5MxN/J7rqTCvew8k","InGameUnlockItem");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"34aaf+/5MxN/J7rqTCvew8k","InGameUnlockItem");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=n("const"),d=n("UnlockData"),f=cc._decorator,h=f.ccclass,y=f.property,m=(cc.v2(365,-500),cc.v2(-400,0),cc.v2(60,-80)),g=cc.v2(-60,0),v=cc.v2(100,-120),_=cc.v2(-100,0),S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.collectionNode=null,t.maskNode=null,t.drinkIcon=null,t.drinkIconMask=null,t.progressLabel=null,t.icon_goldBig=null,t.icon_goldSmall=null,t.icon_goldTiny=null,t.icon_puzzlePiece=null,t.tween=null,t.isMoving=!1,t.startPosition=cc.v2(365,-380),t.targetPosition=cc.v2(-400,0),t.speed=60,t.isPressing=!1,t.currentType=0,t}return s(t,e),t.prototype.onLoad=function(){if(u.default.CurrentLevel%5==0){if(null==d.default.CurrentUnlockItem)return this.node.active=!1,void(this.progressLabel.node.active=!1);d.default.CurrentUnlockItem.type==d.UnlockType.RIDER&&(this.progressLabel.node.active=!0,this.node.active=!0,this.node.scale=0)}else if(u.default.CurrentUnlockIndex>u.default.collectionList.length)return this.node.active=!1,void(this.progressLabel.node.active=!1)},t.prototype.start=function(){},t.prototype.onEnable=function(){this.setInfo(),cc.director.on(p.EventNames.Rise,this.setProgress,this)},t.prototype.onDisable=function(){cc.director.off(p.EventNames.Rise,this.setProgress,this)},t.prototype.update=function(e){this.maskNode.x-=2*this.speed*e,this.maskNode.x<=this.startPosition.x-this.maskNode.width/2&&(this.maskNode.x=this.startPosition.x)},t.prototype.setInfo=function(){var e=this,t="";t=u.default.CurrentUnlockIndex<=30?"Drink1":u.default.CurrentUnlockIndex<=60?"Drink2":"Drink3";var o=u.default.CurrentUnlockIndex;if(u.default.CurrentLevel%5==0){var n=d.default.CurrentUnlockItem;if(null==n)return;switch(n.type){case d.UnlockType.CAP:t="Caps",o=d.default.CurrentUnlockItem.id,this.node.scale=1.5,this.startPosition=m,this.targetPosition=g,this.maskNode.width=205,this.maskNode.height=90,this.speed=20;break;case d.UnlockType.GOLD:return 1==d.default.CurrentUnlockItem.id?(this.drinkIcon.spriteFrame=this.icon_goldSmall,this.drinkIconMask.spriteFrame=this.icon_goldSmall,this.node.scale=.7):2==d.default.CurrentUnlockItem.id?(this.drinkIcon.spriteFrame=this.icon_goldBig,this.drinkIconMask.spriteFrame=this.icon_goldBig,this.node.scale=.8):3==d.default.CurrentUnlockItem.id&&(this.drinkIcon.spriteFrame=this.icon_goldTiny,this.drinkIconMask.spriteFrame=this.icon_goldTiny,this.node.scale=1),this.startPosition=v,this.targetPosition=_,this.maskNode.width=400,this.maskNode.height=130,this.speed=20,void this.align();case d.UnlockType.THEME:return this.drinkIcon.spriteFrame=this.icon_puzzlePiece,this.drinkIconMask.spriteFrame=this.icon_puzzlePiece,this.node.scale=1.3,this.startPosition=m,this.targetPosition=g,this.maskNode.width=205,this.maskNode.height=90,this.speed=20,void this.align()}}var i=cc.assetManager.getBundle(t);i?i.load(""+o,cc.Texture2D,function(t,n){t?console.error("\u52a0\u8f7d\u56fe\u7247"+o+"\u5931\u8d25:",t):(e.drinkIcon.spriteFrame=new cc.SpriteFrame(n),e.drinkIconMask.spriteFrame=new cc.SpriteFrame(n))}):cc.assetManager.loadBundle(t,function(n,i){n?console.error("\u52a0\u8f7d"+t+"\u8d44\u6e90\u5305\u5931\u8d25:",n):i.load(""+o,cc.Texture2D,function(t,n){t?console.error("\u52a0\u8f7d\u56fe\u7247"+o+"\u5931\u8d25:",t):(e.drinkIcon.spriteFrame=new cc.SpriteFrame(n),e.drinkIconMask.spriteFrame=new cc.SpriteFrame(n))})}),this.align()},t.prototype.lateUpdate=function(){this.align()},t.prototype.setProgress=function(e){var t=this,o=this.startPosition.y+e*(this.targetPosition.y-this.startPosition.y),n=parseFloat(this.progressLabel.string.replace("%",""))/100,i=Math.floor(100*e);this.tween&&this.tween.stop(),this.tween=cc.tween(this.maskNode).to(.1,{y:o},{onUpdate:function(e,o){var r=Math.floor(100*n+(i-100*n)*o);t.progressLabel.string=r+"%"}}).call(function(){t.tween=null}).start()},t.prototype.align=function(){if(this.collectionNode&&this.maskNode){var e=cc.v2(-this.maskNode.x,-this.maskNode.y);this.collectionNode.setPosition(e)}},l([y(cc.Node)],t.prototype,"collectionNode",void 0),l([y(cc.Node)],t.prototype,"maskNode",void 0),l([y(cc.Sprite)],t.prototype,"drinkIcon",void 0),l([y(cc.Sprite)],t.prototype,"drinkIconMask",void 0),l([y(cc.Label)],t.prototype,"progressLabel",void 0),l([y(cc.SpriteFrame)],t.prototype,"icon_goldBig",void 0),l([y(cc.SpriteFrame)],t.prototype,"icon_goldSmall",void 0),l([y(cc.SpriteFrame)],t.prototype,"icon_goldTiny",void 0),l([y(cc.SpriteFrame)],t.prototype,"icon_puzzlePiece",void 0),l([h],t)}(cc.Component);r.default=S,cc._RF.pop(),cc._RF.pop()},{}],InputSimulator_ED:[function(e,t,o){"use strict";cc._RF.push(t,"19a5fV8xndE26zET++e/DUm","InputSimulator_ED");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"19a5fV8xndE26zET++e/DUm","InputSimulator_ED");var a,c=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c},l=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},u=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var p=cc._decorator,d=p.ccclass,f=(p.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o;return c(t,e),o=t,Object.defineProperty(t,"instance",{get:function(){return o._instance},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){o._instance?cc.error("InputSimulator already exists!"):o._instance=this},t.prototype.clickCup=function(e){e.onBtn_click()},t.prototype.clickNode=function(e,t){return void 0===t&&(t=.2),l(this,void 0,void 0,function(){var t,o;return u(this,function(n){switch(n.label){case 0:return t=this,e.getComponent(cc.Button)?(o=new cc.Event.EventTouch([],!1),e.emit(cc.Node.EventType.TOUCH_START,o),console.log("\u6a21\u62df\u70b9\u51fb\u6309\u94ae\u5f00\u59cb: "+e.name),t.scheduleOnce(function(){e.emit(cc.Node.EventType.TOUCH_END,o),console.log("\u6a21\u62df\u70b9\u51fb\u6309\u94ae\u7ed3\u675f: "+e.name)},.5),[4,new Promise(function(e){return setTimeout(e,1200)})]):[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},t.prototype.clickNodeStart=function(e){if(e.getComponent(cc.Button)){var t=new cc.Event.EventTouch([],!1);e.emit(cc.Node.EventType.TOUCH_START,t)}},t.prototype.clickNodeEnd=function(e){if(e.getComponent(cc.Button)){var t=new cc.Event.EventTouch([],!1);e.emit(cc.Node.EventType.TOUCH_END,t)}},t._instance=null,o=s([d],t)}(cc.Component));i.default=f,cc._RF.pop(),cc._RF.pop()},{}],InputSimulator:[function(e,t,o){"use strict";cc._RF.push(t,"cc5caroNypD9bk2XO/309X9","InputSimulator");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"cc5caroNypD9bk2XO/309X9","InputSimulator");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},p=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0});var d=n("CommonData"),f=n("const"),h=n("GameScene_Long"),y=n("GameScene"),m=cc._decorator,g=m.ccclass,v=(m.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o;return s(t,e),o=t,Object.defineProperty(t,"instance",{get:function(){return o._instance},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){o._instance||(o._instance=this)},t.prototype.clickCup=function(e){e.onBtn_click()},t.prototype.clickCup_Challenge=function(e){e.onBtn_click()},t.prototype.clickNode=function(e,t){return void 0===t&&(t=.2),u(this,void 0,void 0,function(){var t,o;return p(this,function(n){switch(n.label){case 0:return t=this,e.getComponent(cc.Button)?(o=new cc.Event.EventTouch([],!1),e.emit(cc.Node.EventType.TOUCH_START,o),t.scheduleOnce(function(){e.emit(cc.Node.EventType.TOUCH_END,o)},.5),[4,new Promise(function(e){return setTimeout(e,1200)})]):[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},t.prototype.clickNodeStart=function(e){if(e.getComponent(cc.Button)){var t=new cc.Event.EventTouch([],!1);e.emit(cc.Node.EventType.TOUCH_START,t)}},t.prototype.clickNodeEnd=function(e){if(e.getComponent(cc.Button)){var t=new cc.Event.EventTouch([],!1);e.emit(cc.Node.EventType.TOUCH_END,t)}},t.prototype.simulateClickDyeProp=function(){return u(this,void 0,void 0,function(){var e,t;return p(this,function(o){switch(o.label){case 0:return e=y.default.instance.uiManager.node.getChildByName("PropPanel"),t=y.default.instance.uiManager.node.getChildByName("PropPanel").getChildByName("Btn_Base"),y.default.instance.onBtn_dyeProp(),[4,new Promise(function(e){return setTimeout(e,1500)})];case 1:return o.sent(),!0!==e.active?[3,3]:[4,this.clickNode(t)];case 2:o.sent(),o.label=3;case 3:return[4,new Promise(function(e){return setTimeout(e,1e3)})];case 4:return o.sent(),[2]}})})},t.prototype.simulateClickAddProp=function(){return u(this,void 0,void 0,function(){var e,t;return p(this,function(o){switch(o.label){case 0:return e=y.default.instance.uiManager.node.getChildByName("PropPanel"),t=y.default.instance.uiManager.node.getChildByName("PropPanel").getChildByName("Btn_Base"),y.default.instance.onBtn_addCupProp(),[4,new Promise(function(e){return setTimeout(e,1500)})];case 1:return o.sent(),!0!==e.active?[3,3]:[4,this.clickNode(t)];case 2:o.sent(),o.label=3;case 3:return[4,new Promise(function(e){return setTimeout(e,1e3)})];case 4:return o.sent(),[2]}})})},t.prototype.simulateDrinkMaking=function(){return u(this,void 0,void 0,function(){var e,t,o,n;return p(this,function(i){switch(i.label){case 0:return t=null,o=null,n=null,e=y.default.instance.uiManager.node.getChildByName("GameOverPanel").getChildByName("Btns").getChildByName("Btn_Make"),[4,this.clickNode(e)];case 1:return i.sent(),t=y.default.instance.uiManager.node.getChildByName("DrinkMakingPanel").getChildByName("Btn_Make"),o=t.children[0],[4,new Promise(function(e){return setTimeout(e,1e3)})];case 2:i.sent(),i.label=3;case 3:if(!(d.default.UnlockDrops>0))return[3,9];this.clickNodeStart(t),i.label=4;case 4:return y.default.instance.uiManager.node.getChildByName("DrinkPanel")&&y.default.instance.uiManager.node.getChildByName("DrinkPanel").active||d.default.UnlockDrops<=0?[3,6]:[4,new Promise(function(e){return setTimeout(e,200)})];case 5:return i.sent(),[3,4];case 6:return this.clickNodeEnd(t),[4,new Promise(function(e){return setTimeout(e,500)})];case 7:return i.sent(),d.default.UnlockDrops<=0?[3,9]:(null==n&&y.default.instance.uiManager.node.getChildByName("DrinkPanel")&&(n=y.default.instance.uiManager.node.getChildByName("DrinkPanel").getChildByName("PanelMask")),this.clickNodeStart(n),this.clickNodeEnd(n),[4,new Promise(function(e){return setTimeout(e,1200)})]);case 8:return i.sent(),[3,3];case 9:return this.clickNodeEnd(t),[4,new Promise(function(e){return setTimeout(e,500)})];case 10:return i.sent(),this.clickNode(o),[2]}})})},t.prototype.ClickAddTime=function(){return u(this,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:return[4,new Promise(function(e){return setTimeout(e,1e3)})];case 1:return t.sent(),(e=cc.director.getScene().name!==f.SceneNames.GameModeFillLong?y.default.instance.uiManager.node.getChildByName("AddTimePanel").getChildByName("Btn_Base"):h.default.instance.uiManager.node.getChildByName("AddTimePanel").getChildByName("Btn_Base"))?[4,this.clickNode(e)]:[3,4];case 2:return t.sent(),[4,new Promise(function(e){return setTimeout(e,1e3)})];case 3:return t.sent(),[3,4];case 4:return[2]}})})},t.prototype.ClickAddStep=function(){return u(this,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:return[4,new Promise(function(e){return setTimeout(e,1e3)})];case 1:return t.sent(),(e=cc.director.getScene().name!==f.SceneNames.GameModeFillLong?y.default.instance.uiManager.node.getChildByName("AddStepPanel").getChildByName("Btn_Base"):h.default.instance.uiManager.node.getChildByName("AddStepPanel").getChildByName("Btn_Base"))?[4,this.clickNode(e)]:[3,4];case 2:return t.sent(),[4,new Promise(function(e){return setTimeout(e,1e3)})];case 3:return t.sent(),[3,4];case 4:return[2]}})})},t._instance=null,o=l([g],t)}(cc.Component));r.default=v,cc._RF.pop(),cc._RF.pop()},{}],InvitePanel:[function(e,t,o){"use strict";cc._RF.push(t,"df853+eQDlFzIUTItp8wwQt","InvitePanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"df853+eQDlFzIUTItp8wwQt","InvitePanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=n("GameManager"),d=n("BasePanel"),f=cc._decorator,h=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.texts_rewardNums=[],t.text_stage=null,t.text_progress=null,t.text_leftAmount=null,t.btn_reward=null,t.progressBar=null,t.iconFrames=[],t.iconDarkFrames=[],t}return s(t,e),t.prototype.onEnable=function(){this.setUpPanel()},t.prototype.hide=function(){1===this.node.scale&&e.prototype.hide.call(this)},t.prototype.setUpPanel=function(){var e=1;u.default.InviteRewardCount>=2?e=3:1==u.default.InviteRewardCount?e=2:0==u.default.InviteRewardCount&&(e=1),this.text_stage.string=e.toString()+"\u9636\u5956\u52b1";for(var t=0,o=this.texts_rewardNums;t<o.length;t++)o[t].string="x"+e.toString();var n=2*e-1,i=0;0==u.default.InviteCount&&(i=0);var r=0;1==e?r=u.default.InviteCount:2==e?r=u.default.InviteCount-1:3==e&&(r=u.default.InviteCount-4-(5*u.default.InviteRewardCount-10));var a=n-(i=r>n?n:r);this.text_progress.string=i.toString()+"/"+n.toString(),this.text_leftAmount.string=a.toString(),i/n!=this.progressBar.fillRange&&cc.tween(this.progressBar).to(.5,{fillRange:i/n},{easing:"sineOut"}).start(),this.btn_reward.active=0==a},t.prototype.onBtn_Invite=function(){p.default.platform.inviteShowShare()},t.prototype.onBtn_refresh=function(){var e=this;p.default.platform.inviter(function(){e.setUpPanel()})},t.prototype.onBtn_Reward=function(){0==u.default.InviteRewardCount?(u.default.PropAddCup+=1,u.default.PropPump+=1,u.default.PropUndo+=1,p.default.showRewardPanel([1,1,1,0]),p.default.platform.reportButtonEvent("RewardBtn_Invite01",0)):1==u.default.InviteRewardCount?(u.default.PropAddCup+=2,u.default.PropPump+=2,u.default.PropUndo+=2,p.default.showRewardPanel([2,2,2,0]),p.default.platform.reportButtonEvent("RewardBtn_Invite02",0)):u.default.InviteRewardCount>=2&&(u.default.PropAddCup+=3,u.default.PropPump+=3,u.default.PropUndo+=3,p.default.showRewardPanel([3,3,3,0]),p.default.platform.reportButtonEvent("RewardBtn_Invite03",0)),u.default.InviteRewardCount++,this.setUpPanel()},t.prototype.onBtn_Close=function(){this.hide()},l([y([cc.Label])],t.prototype,"texts_rewardNums",void 0),l([y(cc.Label)],t.prototype,"text_stage",void 0),l([y(cc.Label)],t.prototype,"text_progress",void 0),l([y(cc.Label)],t.prototype,"text_leftAmount",void 0),l([y(cc.Node)],t.prototype,"btn_reward",void 0),l([y(cc.Sprite)],t.prototype,"progressBar",void 0),l([y([cc.Sprite])],t.prototype,"iconFrames",void 0),l([y([cc.SpriteFrame])],t.prototype,"iconDarkFrames",void 0),l([h],t)}(d.default);r.default=m,cc._RF.pop(),cc._RF.pop()},{}],JourneyMainPanel:[function(e,t,o){"use strict";cc._RF.push(t,"8aaaf8n++JCsaeeQzB5cAFs","JourneyMainPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"8aaaf8n++JCsaeeQzB5cAFs","JourneyMainPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=n("const"),d=n("UnlockData"),f=n("Journey_OtherPlayer"),h=n("Rankdata"),y=n("UIManager"),m=n("BasePanel"),g=n("JourneyPanel"),v=[-150,0,150,300,450],_=[280,-320,320,-360],S=cc._decorator,b=S.ccclass,C=S.property,P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stopNodes=[],t.stopsArray=[],t.btn_close=null,t.icon_goldBig=null,t.icon_goldSmall=null,t.icon_goldTiny=null,t.icon_puzzlePiece=null,t.slider_road=null,t.node_player=null,t.stop_green=null,t.stop_purple=null,t.checkMark=null,t.title_node=null,t.contend_node=null,t.text_rank=null,t.op=null,t.op2=null,t.op3=null,t.op4=null,t}return s(t,e),t.prototype.onLoad=function(){},t.prototype.show=function(e){this.init();var t=this.node.children[1];cc.director.emit("UpdateOpenPanelCount"),t&&(cc.Tween.stopAllByTarget(t),t.scale=.5,t.opacity=220,cc.director.getScene().name===p.SceneNames.Game?cc.tween(t).to(.2,{scale:1.2,opacity:255},{easing:"backOut"}).delay(.3).to(.5,{scale:1},{easing:"smooth"}).call(function(){e&&e()}).start():cc.tween(t).to(.2,{scale:1,opacity:255},{easing:"smooth"}).call(function(){e&&e()}).start())},t.prototype.hide=function(e){var t=this,o=this.node.children[1];o&&(cc.Tween.stopAllByTarget(o),o.scale=1,o.opacity=255,cc.tween(o).to(.3,{scale:.8,opacity:0},{easing:"smooth"}).call(function(){t.node.destroy(),e&&"function"==typeof e&&e(),cc.director.emit("UpdateOpenPanelCount")}).start())},t.prototype.onEnable=function(){this.updateRankLabel();for(var e=[],t=0,o=d.default.stopOrder;t<o.length;t++){var n=o[t],i=this.stopNodes[n-1],r=this.stopNodes[n+3];0==d.default.stopOrder.indexOf(n)&&(g.default.rewardPosY=_[n-1]),i.x=v[d.default.stopOrder.indexOf(n)],r.x=v[d.default.stopOrder.indexOf(n)]+600;var a=u.default.CurrentLevel-u.default.CurrentLevel%5+5*d.default.stopOrder.indexOf(n);if(u.default.CurrentLevel<5&&(a=5+5*d.default.stopOrder.indexOf(n)),a-=5,cc.director.getScene().name===p.SceneNames.Main){var c=u.default.Level%5;0==c&&(c=5),a=u.default.Level+5-c+5*d.default.stopOrder.indexOf(n),u.default.Level<=5&&(a=5+5*d.default.stopOrder.indexOf(n))}i.children[0].getChildByName("text_level").getComponent(cc.Label).string=a.toString(),r.children[0].getChildByName("text_level").getComponent(cc.Label).string=(a+20).toString(),this.stopsArray.push(i),e.push(r)}for(var s=0,l=e;s<l.length;s++)i=l[s],this.stopsArray.push(i);this.initLights(),this.initRewards(),cc.director.getScene().name===p.SceneNames.Game?(this.btn_close.active=!1,this.playRankAnimation()):cc.director.getScene().name===p.SceneNames.Main&&(this.btn_close.active=!0,this.playReachAnimationInstantly())},t.prototype.onDisable=function(){cc.director.getScene().name===p.SceneNames.Game&&d.default.stopOrder.push(d.default.stopOrder.shift())},t.prototype.initLights=function(){var e=0;cc.director.getScene().name===p.SceneNames.Game&&(e=1);for(var t=e;t<this.stopsArray.length;t++){var o=this.stopsArray[t].getChildByName("light");cc.tween(o).by(5,{angle:-360}).union().repeatForever().start()}},t.prototype.initRewards=function(){var e=d.default.getJourneyUnlockInfo(),t=0;cc.director.getScene().name===p.SceneNames.Game&&(t=1);for(var o=t;o<this.stopsArray.length;o++){var n=this.stopsArray[o];if(null!=e[o-t]){var i=n.getChildByName("icon_reward").getComponent(cc.Sprite);switch(e[o-t].type){case d.UnlockType.CAP:i.node.scale=1.2,this.loadTexture(i,"Caps",e[o-t].id);break;case d.UnlockType.THEME:i.node.scale=1,i.spriteFrame=this.icon_puzzlePiece;break;case d.UnlockType.RIDER:i.node.scale=.2,this.loadTexture(i,"Animals",e[o-t].id);break;case d.UnlockType.GOLD:2==e[o-t].id?(i.node.scale=.75,i.spriteFrame=this.icon_goldBig):1==e[o-t].id?(i.node.scale=.6,i.spriteFrame=this.icon_goldSmall):3==e[o-t].id&&(i.node.scale=1,i.spriteFrame=this.icon_goldTiny)}}else{var r=this.stopsArray[o].getChildByName("light"),a=this.stopsArray[o].getChildByName("icon_reward");r.active=!1,a.active=!1}}},t.prototype.loadTexture=function(e,t,o){var n=cc.assetManager.getBundle(t);n?n.load(""+o,cc.Texture2D,function(t,o){t||(e.spriteFrame=new cc.SpriteFrame(o))}):cc.assetManager.loadBundle(t,function(t,n){t||n.load(""+o,cc.Texture2D,function(t,o){t||(e.spriteFrame=new cc.SpriteFrame(o))})})},t.prototype.playReachAnimation=function(){var e=this;if(this.slider_road&&this.node_player){this.stop_green=this.stopsArray[1].getChildByName("stop_green"),this.stop_green.active=!0,this.stop_purple=this.stopsArray[1].getChildByName("stop_purple"),this.checkMark=this.stop_green.getChildByName("checkMark");var t=this.stopsArray[1].getChildByName("light"),o=this.stopsArray[1].getChildByName("icon_reward");this.slider_road.fillRange=.25;var n=this.slider_road.node;this.node_player.x=n.x-.5*n.width+this.slider_road.fillRange*n.width-40;var i=this.stop_green.scaleY;i=1/i,cc.tween({range:.25}).to(.5,{range:.4},{progress:function(t,o,n,i){var r=t+(o-t)*i;e.slider_road.fillRange=r;var a=e.slider_road.node,c=a.x-.5*a.width+e.slider_road.fillRange*a.width-40;return e.node_player.x=c,r}}).delay(.5).call(function(){for(var t=0,o=e.contend_node.children;t<o.length;t++){var n=o[t];cc.tween(n).by(.3,{x:-150},{easing:"smooth"}).start()}}).start(),cc.tween(this.stop_purple).delay(.35).to(.3,{scaleY:0},{easing:"sineIn"}).call(function(){cc.tween(e.checkMark).delay(.15).to(.3,{scaleX:1,scaleY:i},{easing:"backOut"}).start(),cc.tween(e.stop_green).to(.3,{rotation:0},{easing:"backOut"}).start(),cc.tween(t).delay(1).to(.3,{scaleX:0,scaleY:0,opacity:0}).start(),cc.tween(o).delay(.5).call(function(){y.default.getInstance().showPanel("DrinkPanel")}).to(.3,{scaleX:0,scaleY:0,opacity:0}).start()}).start()}},t.prototype.playReachAnimationInstantly=function(){if(this.slider_road&&this.node_player){this.stop_green=this.stopsArray[0].getChildByName("stop_green"),this.stop_purple=this.stopsArray[0].getChildByName("stop_purple"),this.checkMark=this.stop_green.getChildByName("checkMark"),this.stopsArray[0].getChildByName("light"),this.stopsArray[0].getChildByName("icon_reward");var e=this.stop_green.scaleY;e=1/e,this.slider_road.fillRange=.15,this.node_player.x=this.slider_road.node.x-.5*this.slider_road.node.width+this.slider_road.fillRange*this.slider_road.node.width-40}},t.prototype.playHitAwayAnimation=function(){for(var e=1;e<this.op2.node.children.length;e++)this.op2.node.children[e].active=!1;var t=cc.bezierBy(1,[cc.v2(200,150),cc.v2(750,400),cc.v2(1500,600)]);cc.tween(this.op2.node).parallel(cc.tween().then(t),cc.tween().by(1,{angle:1080},{easing:"sineIn"}),cc.tween().to(1,{opacity:0,scale:0},{easing:"smooth"})).start()},t.prototype.playRankAnimation=function(){var e=this;this.title_node.y=0,this.contend_node.opacity=0,this.slider_road.fillRange=.25;var t=this.slider_road.node;this.node_player.x=t.x-.5*t.width+this.slider_road.fillRange*t.width-40,this.stop_green=this.stopsArray[0].getChildByName("stop_green"),this.stop_purple=this.stopsArray[0].getChildByName("stop_purple"),this.checkMark=this.stop_green.getChildByName("checkMark");var o=this.stopsArray[0].getChildByName("light"),n=this.stopsArray[0].getChildByName("icon_reward"),i=this.stop_green.scaleY;i=1/i,o.active=!1,n.active=!1,this.stop_purple.active=!1,this.stop_green.active=!0,this.stop_green.rotation=0,this.checkMark.scaleX=1,this.checkMark.scaleY=i,cc.tween(this.title_node).delay(.5).to(.5,{y:550},{easing:"smooth"}).start(),cc.tween(this.contend_node).delay(1).to(.5,{opacity:255},{easing:"smooth"}).call(function(){e.playReachAnimation()}).start()},t.prototype.updateRankLabel=function(){var e=this,t=0,o=0;h.default.getRankData().then(function(){if(e.setUpOtherPlayer(),0!=(t=cc.director.getScene().name==p.SceneNames.Main?h.default.getCurFakeRank():h.default.getPrevFakeRank()))if((o=h.default.getCurFakeRank())>=t)e.text_rank.string="\u7b2c "+o.toString()+" \u540d";else{for(var n=0,i=t;i>o;){var r=i-o;if(i-=r>1111111||r>111111?111111:r>11111?11111:r>1111?1111:r>111?111:r>11?11:1,++n>1e6)break}var a=Math.max(.5/Math.max(n,1),.02);e.animateRankNumber(t,o,a)}else e.text_rank.string="\u7b2c "+h.default.playerRankData.rank.toString()+" \u540d"})},t.prototype.animateRankNumber=function(e,t,o){var n=this;this.schedule(function(){e-=e-t>111111||e-t>11111?11111:e-t>1111?1111:e-t>111?111:e-t>11?11:1,n.text_rank.string="\u7b2c "+e.toString()+" \u540d",e<=t&&(n.text_rank.string="\u7b2c "+t.toString()+" \u540d",n.unscheduleAllCallbacks())},o)},t.prototype.setUpOtherPlayer=function(){var e=this;if(Math.random()>.7?(this.op.node.active=!1,this.op2.node.active=!0):(this.op.node.active=!0,this.op2.node.active=!0),cc.sys.isBrowser)return this.op.setOtherPlayerInfo("",""),this.op2.setOtherPlayerInfo("",""),this.op3.setOtherPlayerInfo("",""),void this.op4.setOtherPlayerInfo("","");if(null==h.default.playerRankData||1==h.default.playerRankData.rank)console.error("\u6ca1\u6709\u4e0a\u4e00\u540d\u73a9\u5bb6\u4fe1\u606f"),this.op.node.active=!1,this.op2.node.active=!1,this.op3.node.active=!1,this.op4.node.active=!1;else if(2==h.default.playerRankData.rank){var t=h.default.rankDataList[h.default.playerRankData.rank-2];this.op.setOtherPlayerInfo(t.nick_name,t.head_url),this.op2.node.active=!1,this.op3.node.active=!1,this.op4.node.active=!1}else if(3==h.default.playerRankData.rank){t=h.default.rankDataList[h.default.playerRankData.rank-2],this.op.setOtherPlayerInfo(t.nick_name,t.head_url);var o=h.default.rankDataList[h.default.playerRankData.rank-3];this.op2.setOtherPlayerInfo(o.nick_name,o.head_url),this.op3.node.active=!1,this.op4.node.active=!1}else if(4==h.default.playerRankData.rank){t=h.default.rankDataList[h.default.playerRankData.rank-2],this.op.setOtherPlayerInfo(t.nick_name,t.head_url),o=h.default.rankDataList[h.default.playerRankData.rank-3],this.op2.setOtherPlayerInfo(o.nick_name,o.head_url);var n=h.default.rankDataList[h.default.playerRankData.rank-4];this.op3.setOtherPlayerInfo(n.nick_name,n.head_url),this.op4.node.active=!1}else if(h.default.playerRankData.rank<=100&&0!=h.default.playerRankData.rank){t=h.default.rankDataList[h.default.playerRankData.rank-2],this.op.setOtherPlayerInfo(t.nick_name,t.head_url),o=h.default.rankDataList[h.default.playerRankData.rank-3],this.op2.setOtherPlayerInfo(o.nick_name,o.head_url),n=h.default.rankDataList[h.default.playerRankData.rank-4],this.op3.setOtherPlayerInfo(n.nick_name,n.head_url);var i=h.default.rankDataList[h.default.playerRankData.rank-5];this.op4.setOtherPlayerInfo(i.nick_name,i.head_url)}else{if(console.error("\u83b7\u53d6\u968f\u673a\u73a9\u5bb6\u4fe1\u606f"),cc.director.getScene().name!==p.SceneNames.Game&&null!=h.default.randomPlayerData){var r=h.default.randomPlayerData;this.op.setOtherPlayerInfo(r.nick_name,r.head_url);var a=h.default.randomPlayerData2;this.op2.setOtherPlayerInfo(a.nick_name,a.head_url);var c=h.default.randomPlayerData3;this.op3.setOtherPlayerInfo(c.nick_name,c.head_url);var s=h.default.randomPlayerData4;return void this.op4.setOtherPlayerInfo(s.nick_name,s.head_url)}h.default.getRandomPlayerInfo().then(function(){var t=h.default.randomPlayerData;e.op.setOtherPlayerInfo(t.nick_name,t.head_url);var o=h.default.randomPlayerData2;e.op2.setOtherPlayerInfo(o.nick_name,o.head_url);var n=h.default.randomPlayerData3;e.op3.setOtherPlayerInfo(n.nick_name,n.head_url);var i=h.default.randomPlayerData4;e.op4.setOtherPlayerInfo(i.nick_name,i.head_url)})}},t.rewardPosY=0,t.hitArray=[],l([C([cc.Node])],t.prototype,"stopNodes",void 0),l([C(cc.Node)],t.prototype,"btn_close",void 0),l([C(cc.SpriteFrame)],t.prototype,"icon_goldBig",void 0),l([C(cc.SpriteFrame)],t.prototype,"icon_goldSmall",void 0),l([C(cc.SpriteFrame)],t.prototype,"icon_goldTiny",void 0),l([C(cc.SpriteFrame)],t.prototype,"icon_puzzlePiece",void 0),l([C(cc.Sprite)],t.prototype,"slider_road",void 0),l([C(cc.Node)],t.prototype,"node_player",void 0),l([C(cc.Node)],t.prototype,"stop_green",void 0),l([C(cc.Node)],t.prototype,"stop_purple",void 0),l([C(cc.Node)],t.prototype,"checkMark",void 0),l([C(cc.Node)],t.prototype,"title_node",void 0),l([C(cc.Node)],t.prototype,"contend_node",void 0),l([C(cc.Label)],t.prototype,"text_rank",void 0),l([C(f.default)],t.prototype,"op",void 0),l([C(f.default)],t.prototype,"op2",void 0),l([C(f.default)],t.prototype,"op3",void 0),l([C(f.default)],t.prototype,"op4",void 0),l([b],t)}(m.default);r.default=P,cc._RF.pop(),cc._RF.pop()},{}],JourneyPanel:[function(e,t,o){"use strict";cc._RF.push(t,"1aa6fVrvhNEjIOzgMt0De5+","JourneyPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"1aa6fVrvhNEjIOzgMt0De5+","JourneyPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=n("const"),d=n("UnlockData"),f=n("Journey_OtherPlayer"),h=n("Rankdata"),y=n("UIManager"),m=n("BasePanel"),g=[-150,0,150,300,450],v=[280,-320,320,-360],_=cc._decorator,S=_.ccclass,b=_.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stopNodes=[],t.stopsArray=[],t.btn_close=null,t.icon_goldBig=null,t.icon_goldSmall=null,t.icon_goldTiny=null,t.icon_puzzlePiece=null,t.slider_road=null,t.node_player=null,t.stop_green=null,t.stop_purple=null,t.checkMark=null,t.title_node=null,t.contend_node=null,t.text_rank=null,t.op=null,t.op2=null,t}var o;return s(t,e),o=t,t.prototype.initHitArray=function(){var e=u.default.getStorage("JourneyHitArray");if(e&&(e=JSON.parse(e)),null!=e&&e.length>0)o.hitArray=e;else{o.hitArray=[];var t=u.default.CurrentLevel,n=[],i=5*Math.ceil((t+1)/5)+5;for(n.push(i);n.length<100;)i+=i%10==5?15:5*Math.floor(3*Math.random())+5,n.push(i);o.hitArray=n,u.default.setStorage("JourneyHitArray",JSON.stringify(n))}},t.prototype.onLoad=function(){this.initHitArray()},t.prototype.show=function(e){this.init();var t=this.node.children[1];cc.director.emit("UpdateOpenPanelCount"),t&&(cc.Tween.stopAllByTarget(t),t.scale=.5,t.opacity=220,cc.director.getScene().name===p.SceneNames.Game?cc.tween(t).to(.2,{scale:1.2,opacity:255},{easing:"backOut"}).delay(.3).to(.5,{scale:1},{easing:"smooth"}).call(function(){e&&e()}).start():cc.tween(t).to(.2,{scale:1,opacity:255},{easing:"smooth"}).call(function(){e&&e()}).start())},t.prototype.hide=function(e){var t=this,o=this.node.children[1];o&&(cc.Tween.stopAllByTarget(o),o.scale=1,o.opacity=255,cc.tween(o).to(.3,{scale:.8,opacity:0},{easing:"smooth"}).call(function(){t.node.destroy(),e&&"function"==typeof e&&e(),cc.director.emit("UpdateOpenPanelCount")}).start())},t.prototype.onEnable=function(){this.updateRankLabel();for(var e=0,t=d.default.stopOrder;e<t.length;e++){var n=t[e],i=this.stopNodes[n-1];0==d.default.stopOrder.indexOf(n)&&(o.rewardPosY=v[n-1]),i.x=g[d.default.stopOrder.indexOf(n)];var r=u.default.CurrentLevel-u.default.CurrentLevel%5+5*d.default.stopOrder.indexOf(n);if(u.default.CurrentLevel<5&&(r=5+5*d.default.stopOrder.indexOf(n)),r-=5,cc.director.getScene().name===p.SceneNames.Main){var a=u.default.Level%5;0==a&&(a=5),r=u.default.Level+5-a+5*d.default.stopOrder.indexOf(n),u.default.Level<=5&&(r=5+5*d.default.stopOrder.indexOf(n))}i.children[0].getChildByName("text_level").getComponent(cc.Label).string=r.toString(),this.stopsArray.push(i)}if(cc.director.getScene().name===p.SceneNames.Game){var c=cc.instantiate(this.stopsArray[0]);c.parent=this.stopsArray[0].parent,c.x=g[this.stopsArray.length],r=u.default.CurrentLevel-u.default.CurrentLevel%5+5*(this.stopsArray.length-1),u.default.CurrentLevel<5&&(r=5+5*(this.stopsArray.length-1)),c.children[0].getChildByName("text_level").getComponent(cc.Label).string=r.toString(),this.stopsArray.push(c),5==u.default.CurrentLevel&&(this.stopsArray[0].active=!1)}this.initLights(),this.initRewards(),cc.director.getScene().name===p.SceneNames.Game?(this.btn_close.active=!1,this.playRankAnimation()):cc.director.getScene().name===p.SceneNames.Main&&(this.btn_close.active=!0,this.playReachAnimationInstantly())},t.prototype.onDisable=function(){cc.director.getScene().name===p.SceneNames.Game&&d.default.stopOrder.push(d.default.stopOrder.shift())},t.prototype.initLights=function(){var e=0;cc.director.getScene().name===p.SceneNames.Game&&(e=1);for(var t=e;t<this.stopsArray.length;t++){var o=this.stopsArray[t].getChildByName("light");cc.tween(o).by(5,{angle:-360}).union().repeatForever().start()}},t.prototype.initRewards=function(){var e=d.default.getJourneyUnlockInfo(),t=0;cc.director.getScene().name===p.SceneNames.Game&&(t=1);for(var o=t;o<this.stopsArray.length;o++){var n=this.stopsArray[o];if(null!=e[o-t]){var i=n.getChildByName("icon_reward").getComponent(cc.Sprite);switch(e[o-t].type){case d.UnlockType.CAP:i.node.scale=1.2,this.loadTexture(i,"Caps",e[o-t].id);break;case d.UnlockType.THEME:i.node.scale=1,i.spriteFrame=this.icon_puzzlePiece;break;case d.UnlockType.RIDER:i.node.scale=.2,this.loadTexture(i,"Animals",e[o-t].id);break;case d.UnlockType.GOLD:2==e[o-t].id?(i.node.scale=.75,i.spriteFrame=this.icon_goldBig):1==e[o-t].id?(i.node.scale=.6,i.spriteFrame=this.icon_goldSmall):3==e[o-t].id&&(i.node.scale=1,i.spriteFrame=this.icon_goldTiny)}}else{var r=this.stopsArray[o].getChildByName("light"),a=this.stopsArray[o].getChildByName("icon_reward");r.active=!1,a.active=!1}}},t.prototype.loadTexture=function(e,t,o){var n=cc.assetManager.getBundle(t);n?n.load(""+o,cc.Texture2D,function(t,o){t||(e.spriteFrame=new cc.SpriteFrame(o))}):cc.assetManager.loadBundle(t,function(t,n){t||n.load(""+o,cc.Texture2D,function(t,o){t||(e.spriteFrame=new cc.SpriteFrame(o))})})},t.prototype.playReachAnimation=function(){var e=this;if(this.slider_road&&this.node_player){this.stop_green=this.stopsArray[1].getChildByName("stop_green"),this.stop_green.active=!0,this.stop_purple=this.stopsArray[1].getChildByName("stop_purple"),this.checkMark=this.stop_green.getChildByName("checkMark");var t=this.stopsArray[1].getChildByName("light"),n=this.stopsArray[1].getChildByName("icon_reward");this.slider_road.fillRange=.25;var i=this.slider_road.node;this.node_player.x=i.x-.5*i.width+this.slider_road.fillRange*i.width-40;var r=this.stop_green.scaleY;r=1/r,cc.tween({range:.25}).to(.5,{range:.4},{progress:function(t,n,i,r){var a=t+(n-t)*r;e.slider_road.fillRange=a;var c=e.slider_road.node,s=c.x-.5*c.width+e.slider_road.fillRange*c.width-40;return o.hitArray.includes(u.default.CurrentLevel)&&e.op2.node.active&&e.node_player.x<-120&&s>=-120&&e.playHitAwayAnimation(),e.node_player.x=s,a}}).delay(.5).call(function(){for(var t=0,o=e.contend_node.children;t<o.length;t++){var n=o[t];cc.tween(n).by(.3,{x:-150},{easing:"smooth"}).start()}}).start(),cc.tween(this.stop_purple).delay(.35).to(.3,{scaleY:0},{easing:"sineIn"}).call(function(){cc.tween(e.checkMark).delay(.15).to(.3,{scaleX:1,scaleY:r},{easing:"backOut"}).start(),cc.tween(e.stop_green).to(.3,{rotation:0},{easing:"backOut"}).start(),cc.tween(t).delay(1).to(.3,{scaleX:0,scaleY:0,opacity:0}).start(),cc.tween(n).delay(.5).call(function(){y.default.getInstance().showPanel("DrinkPanel")}).to(.3,{scaleX:0,scaleY:0,opacity:0}).start()}).start()}},t.prototype.playReachAnimationInstantly=function(){if(this.slider_road&&this.node_player){this.stop_green=this.stopsArray[0].getChildByName("stop_green"),this.stop_purple=this.stopsArray[0].getChildByName("stop_purple"),this.checkMark=this.stop_green.getChildByName("checkMark"),this.stopsArray[0].getChildByName("light"),this.stopsArray[0].getChildByName("icon_reward");var e=this.stop_green.scaleY;e=1/e,this.slider_road.fillRange=.15,this.node_player.x=this.slider_road.node.x-.5*this.slider_road.node.width+this.slider_road.fillRange*this.slider_road.node.width-40}},t.prototype.playHitAwayAnimation=function(){for(var e=1;e<this.op2.node.children.length;e++)this.op2.node.children[e].active=!1;var t=cc.bezierBy(1,[cc.v2(200,150),cc.v2(750,400),cc.v2(1500,600)]);cc.tween(this.op2.node).parallel(cc.tween().then(t),cc.tween().by(1,{angle:1080},{easing:"sineIn"}),cc.tween().to(1,{opacity:0,scale:0},{easing:"smooth"})).start()},t.prototype.playRankAnimation=function(){var e=this;this.title_node.y=0,this.contend_node.opacity=0,o.hitArray.includes(u.default.CurrentLevel)?this.op2.node.x=-75:this.op2.node.x=45,this.slider_road.fillRange=.25;var t=this.slider_road.node;this.node_player.x=t.x-.5*t.width+this.slider_road.fillRange*t.width-40,this.stop_green=this.stopsArray[0].getChildByName("stop_green"),this.stop_purple=this.stopsArray[0].getChildByName("stop_purple"),this.checkMark=this.stop_green.getChildByName("checkMark");var n=this.stopsArray[0].getChildByName("light"),i=this.stopsArray[0].getChildByName("icon_reward"),r=this.stop_green.scaleY;r=1/r,n.active=!1,i.active=!1,this.stop_purple.active=!1,this.stop_green.active=!0,this.stop_green.rotation=0,this.checkMark.scaleX=1,this.checkMark.scaleY=r,cc.tween(this.title_node).delay(.5).to(.5,{y:550},{easing:"smooth"}).start(),cc.tween(this.contend_node).delay(1).to(.5,{opacity:255},{easing:"smooth"}).call(function(){e.playReachAnimation()}).start()},t.prototype.updateRankLabel=function(){var e=this,t=0,o=0;h.default.getRankData().then(function(){if(e.setUpOtherPlayer(),0!=(t=cc.director.getScene().name==p.SceneNames.Main?h.default.getCurFakeRank():h.default.getPrevFakeRank()))if((o=h.default.getCurFakeRank())>=t)e.text_rank.string="\u7b2c "+o.toString()+" \u540d";else{for(var n=0,i=t;i>o;){var r=i-o;if(i-=r>1111111||r>111111?111111:r>11111?11111:r>1111?1111:r>111?111:r>11?11:1,++n>1e6)break}var a=Math.max(.5/Math.max(n,1),.02);e.animateRankNumber(t,o,a)}else e.text_rank.string="\u7b2c "+h.default.playerRankData.rank.toString()+" \u540d"})},t.prototype.animateRankNumber=function(e,t,o){var n=this;this.schedule(function(){e-=e-t>111111||e-t>11111?11111:e-t>1111?1111:e-t>111?111:e-t>11?11:1,n.text_rank.string="\u7b2c "+e.toString()+" \u540d",e<=t&&(n.text_rank.string="\u7b2c "+t.toString()+" \u540d",n.unscheduleAllCallbacks())},o)},t.prototype.setUpOtherPlayer=function(){var e=this;if(Math.random()>.7?(this.op.node.active=!1,this.op2.node.active=!0):(this.op.node.active=!0,this.op2.node.active=!0),cc.sys.isBrowser)return this.op.setOtherPlayerInfo("",""),void this.op2.setOtherPlayerInfo("","");if(null==h.default.playerRankData||1==h.default.playerRankData.rank)console.error("\u6ca1\u6709\u4e0a\u4e00\u540d\u73a9\u5bb6\u4fe1\u606f"),this.op.node.active=!1,this.op2.node.active=!1;else if(2==h.default.playerRankData.rank){var t=h.default.rankDataList[h.default.playerRankData.rank-2];this.op.setOtherPlayerInfo(t.nick_name,t.head_url),this.op2.node.active=!1}else if(h.default.playerRankData.rank<=100&&0!=h.default.playerRankData.rank)console.error("\u83b7\u53d6\u4e0a\u4e00\u540d\u73a9\u5bb6\u4fe1\u606f"),t=h.default.rankDataList[h.default.playerRankData.rank-2],this.op.setOtherPlayerInfo(t.nick_name,t.head_url),this.op2.node.active=!1;else{if(console.error("\u83b7\u53d6\u968f\u673a\u73a9\u5bb6\u4fe1\u606f"),cc.director.getScene().name!==p.SceneNames.Game&&null!=h.default.randomPlayerData){var o=h.default.randomPlayerData;this.op.setOtherPlayerInfo(o.nick_name,o.head_url);var n=h.default.randomPlayerData2;return void this.op2.setOtherPlayerInfo(n.nick_name,n.head_url)}h.default.getRandomPlayerInfo().then(function(){var t=h.default.randomPlayerData;e.op.setOtherPlayerInfo(t.nick_name,t.head_url);var o=h.default.randomPlayerData2;e.op2.setOtherPlayerInfo(o.nick_name,o.head_url)})}},t.rewardPosY=0,t.hitArray=[],l([b([cc.Node])],t.prototype,"stopNodes",void 0),l([b(cc.Node)],t.prototype,"btn_close",void 0),l([b(cc.SpriteFrame)],t.prototype,"icon_goldBig",void 0),l([b(cc.SpriteFrame)],t.prototype,"icon_goldSmall",void 0),l([b(cc.SpriteFrame)],t.prototype,"icon_goldTiny",void 0),l([b(cc.SpriteFrame)],t.prototype,"icon_puzzlePiece",void 0),l([b(cc.Sprite)],t.prototype,"slider_road",void 0),l([b(cc.Node)],t.prototype,"node_player",void 0),l([b(cc.Node)],t.prototype,"stop_green",void 0),l([b(cc.Node)],t.prototype,"stop_purple",void 0),l([b(cc.Node)],t.prototype,"checkMark",void 0),l([b(cc.Node)],t.prototype,"title_node",void 0),l([b(cc.Node)],t.prototype,"contend_node",void 0),l([b(cc.Label)],t.prototype,"text_rank",void 0),l([b(f.default)],t.prototype,"op",void 0),l([b(f.default)],t.prototype,"op2",void 0),o=l([S],t)}(m.default);r.default=C,cc._RF.pop(),cc._RF.pop()},{}],JourneyUnlockManager:[function(e,t,o){"use strict";cc._RF.push(t,"9263aWBofBK8KrYxFIXNi1/","JourneyUnlockManager");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"9263aWBofBK8KrYxFIXNi1/","JourneyUnlockManager");var a,c=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(i,"__esModule",{value:!0});var l=cc._decorator,u=l.ccclass,p=l.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.text="hello",t}return c(t,e),t.prototype.start=function(){},s([p(cc.Label)],t.prototype,"label",void 0),s([p],t.prototype,"text",void 0),s([u],t)}(cc.Component);i.default=d,cc._RF.pop(),cc._RF.pop()},{}],Journey_OtherPlayer:[function(e,t,o){"use strict";cc._RF.push(t,"a52a82TxyJG2axoUv58pyR7","Journey_OtherPlayer");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"a52a82TxyJG2axoUv58pyR7","Journey_OtherPlayer");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("const"),p=cc._decorator,d=p.ccclass,f=p.property,h=["\u54c7! \u6709\u4eba\u8ffd!","\u563f! \u8ffd\u4e0d\u4e0a!","\u6765\u8ffd\u6211\u5440~"],y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.text_name=null,t.sprite_avatar=null,t.text_dialogue=null,t}return s(t,e),t.prototype.onEnable=function(){this.text_dialogue.node.parent.scale=0},t.prototype.setOtherPlayerInfo=function(e,t){var o=this;this.text_name.string=e,this.text_dialogue.string=h[Math.floor(Math.random()*h.length)];var n=0;cc.director.getScene().name===u.SceneNames.Game&&(n=1),cc.tween(this.text_dialogue.node.parent).delay(n).delay(.2*Math.random()).to(.2,{scale:.8}).to(.1,{rotation:5}).to(.1,{rotation:-5}).to(.1,{rotation:5}).to(.1,{rotation:-5}).to(.1,{rotation:5}).to(.1,{rotation:0}).delay(.8+.5*Math.random()).to(.2,{scale:0}).start(),this.getAvatar(t).then(function(e){o.sprite_avatar.spriteFrame=e}).catch(function(e){cc.error("\u52a0\u8f7d\u5934\u50cf\u5931\u8d25:",e)})},t.prototype.getAvatar=function(e){return new Promise(function(t){if(e){var o=wx.createImage();o.src=e,o.onload=function(){var e=new cc.Texture2D;e.initWithElement(o),e.handleLoadedTexture(),t(new cc.SpriteFrame(e))}}else t(null)})},l([f(cc.Label)],t.prototype,"text_name",void 0),l([f(cc.Sprite)],t.prototype,"sprite_avatar",void 0),l([f(cc.Label)],t.prototype,"text_dialogue",void 0),l([d],t)}(cc.Component);r.default=y,cc._RF.pop(),cc._RF.pop()},{}],Key:[function(e,t,o){"use strict";cc._RF.push(t,"b08aa/1HyBM2YXzs0b+9/Pk","Key");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"b08aa/1HyBM2YXzs0b+9/Pk","Key");var a,c=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(i,"__esModule",{value:!0});var l=cc._decorator,u=l.ccclass,p=l.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.keyImg=null,t.keyFrames=[],t}return c(t,e),t.prototype.setKeyType=function(e){this.keyImg.spriteFrame=this.keyFrames[e-1]},s([p(cc.Sprite)],t.prototype,"keyImg",void 0),s([p([cc.SpriteFrame])],t.prototype,"keyFrames",void 0),s([u],t)}(cc.Component);i.default=d,cc._RF.pop(),cc._RF.pop()},{}],LevelConfig_BP:[function(e,t,o){"use strict";cc._RF.push(t,"048f2Pt5PZLv4H8l10eezDP","LevelConfig_BP");var n=e,i=t,r=o;cc._RF.push(i,"048f2Pt5PZLv4H8l10eezDP","LevelConfig_BP"),Object.defineProperty(r,"__esModule",{value:!0}),r.LevelConfig_BP=void 0;var a=n("LevelDataMgr_BP"),c=function(){function e(){}return e.init=function(){this.initialized||(this.initialized=!0,a.LevelDataMgr_BP.clearCache())},e.getLevelConfigAsync=function(e,t){var o=this;this.init(),a.LevelDataMgr_BP.getLevelDataAsync(e,function(n){if(n){var i=o.convertToLevelConfig(n);t(i)}else cc.warn("\u65e0\u6cd5\u52a0\u8f7d\u5173\u5361 "+e+"\uff0c\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e"),t(o.getDefaultLevelConfig(e))})},e.getLevelConfig=function(e){this.init();var t=a.LevelDataMgr_BP.getLevelData(e);return t?this.convertToLevelConfig(t):this.getDefaultLevelConfig(e)},e.convertToLevelConfig=function(e){return{levelId:e.levelId,bottleConfigs:e.bottleConfigs,question:e.question,difficulty:e.difficulty,difficultyType:e.difficultyType,solutionSteps:e.solutionSteps}},e.getDefaultLevelConfig=function(e){if(1===e)return{levelId:1,bottleConfigs:[{capacity:5,target:2,initial:3},{capacity:4,target:3,initial:4},{capacity:3,target:2,initial:0},{capacity:2,target:1,initial:0},{capacity:1,target:1,initial:1}],question:"test",difficulty:1,difficultyType:"simple",solutionSteps:5};var t=e<=3?"simple":e<=7?"medium":e<=15?"hard":"extreme";return{levelId:e,bottleConfigs:[{capacity:10,target:3,initial:4},{capacity:10,target:4,initial:5},{capacity:10,target:5,initial:3}],question:"test",difficulty:Math.min(e-1,10),difficultyType:t,solutionSteps:8}},e.getBottleCount=function(e){return this.getLevelConfig(e).bottleConfigs.length},e.getDifficulty=function(e){return this.getLevelConfig(e).difficulty},e.getDifficultyType=function(e){return this.getLevelConfig(e).difficultyType},e.getSolutionSteps=function(e){return this.getLevelConfig(e).solutionSteps},e.initialized=!1,e}();r.LevelConfig_BP=c,cc._RF.pop(),cc._RF.pop()},{}],LevelDataMgr_BP:[function(e,t,o){"use strict";cc._RF.push(t,"de042N4Nl9JSalP5T5IbONb","LevelDataMgr_BP");var n=t,i=o;cc._RF.push(n,"de042N4Nl9JSalP5T5IbONb","LevelDataMgr_BP");var r=function(){return(r=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},a=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},c=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0}),i.LevelDataMgr_BP=void 0;var s=function(){function e(){}return e.setLevelsData=function(e){Array.isArray(e)?(this.allLevelsData=e,cc.log("\u5df2\u8bbe\u7f6e\u5173\u5361\u6570\u636e\uff0c\u5171 "+e.length+" \u4e2a")):(cc.error("setLevelsData: \u53c2\u6570\u5fc5\u987b\u662f\u6570\u7ec4"),this.allLevelsData=[])},e.getLevelData=function(e){if(!this.allLevelsData)return cc.warn("\u5173\u5361\u6570\u636e\u672a\u52a0\u8f7d\uff0c\u8bf7\u5148\u8c03\u7528initAsync()"),null;if(this.levelCache.has(e))return this.levelCache.get(e);var t=(this.allLevelsData||[]).find(function(t){return t.levelId===e});if(t)return this.levelCache.set(e,t),t;var o=this.getTotalLevels();if(o>0){var n=((e-1)%o+o)%o,i=this.allLevelsData[n];if(i){var a=Object.assign({},i);return a.bottleConfigs=(i.bottleConfigs||[]).map(function(e){return r({},e)}),a.levelId=e,a}}return cc.warn("\u5173\u5361 "+e+" \u7684\u6570\u636e\u4e0d\u5b58\u5728"),null},e.getLevelDataAsync=function(e,t){return a(this,void 0,void 0,function(){var o;return c(this,function(){return o=this.getLevelData(e),t(o),[2]})})},e.initAsync=function(){return a(this,void 0,void 0,function(){return c(this,function(){return this.allLevelsData||cc.warn("initAsync: \u8bf7\u5148\u8c03\u7528 setLevelsData() \u8bbe\u7f6e\u5173\u5361\u6570\u636e"),[2]})})},e.clearCache=function(){this.levelCache.clear()},e.clearLevelCache=function(e){this.levelCache.delete(e)},e.cacheLevelData=function(e,t){if(t)try{var o=JSON.parse(JSON.stringify(t));o.levelId=e,this.levelCache.set(e,o)}catch(e){cc.error("cacheLevelData: \u514b\u9686\u5173\u5361\u6570\u636e\u5931\u8d25",e)}},e.getTotalLevels=function(){return this.allLevelsData&&this.allLevelsData.length||0},e.getCachedLevelCount=function(){return this.levelCache.size},e.levelCache=new Map,e.allLevelsData=null,e}();i.LevelDataMgr_BP=s,cc._RF.pop(),cc._RF.pop()},{}],LevelData:[function(e,t,o){"use strict";cc._RF.push(t,"f3ba20lIzNLdKEedO2ILB5l","LevelData");var n=t,i=o;cc._RF.push(n,"f3ba20lIzNLdKEedO2ILB5l","LevelData"),Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(){}return e.loadLevelData=function(t){var o=t.json;e.MAX_LEVEL=o.level.length,e.JSON_MAP=o.json,e.LEVEL_EASY=o.difficulty0,e.LEVEL_MEDIUM=o.difficulty1,e.LEVEL_HARD=o.difficulty2,e.LEVEL_MULTI=o.difficulty3;for(var n=5;n<=e.MAX_LEVEL;n+=5)e.LEVEL_SUPERHARD.push(n);e.FIRST_TYPE=o.firstType},e.MAX_LEVEL=1,e.JSON_MAP=[],e.LEVEL_EASY=[],e.LEVEL_MEDIUM=[],e.LEVEL_HARD=[],e.LEVEL_MULTI=[],e.LEVEL_SUPERHARD=[],e.FIRST_TYPE=[],e}();i.default=r,cc._RF.pop(),cc._RF.pop()},{}],LevelEditor_ED:[function(e,t,o){"use strict";cc._RF.push(t,"335efVeZ3FO0I/ejZCSlL0x","LevelEditor_ED");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"335efVeZ3FO0I/ejZCSlL0x","LevelEditor_ED");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("Cup_ED"),p=n("CupInfoUI_ED"),d=n("FileManager_ED"),f=cc._decorator,h=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cupPrefab=null,t.cupPrefab_AD=null,t.cupPrefab_Fixed=null,t.cupPrefab_Frozen=null,t.cupPrefab_Masked=null,t.cups=[],t}var o;return s(t,e),o=t,t.getInstance=function(){return o.instance?o.instance:null},t.prototype.onLoad=function(){o.instance=this},t.prototype.addCup=function(){var e=cc.instantiate(this.cupPrefab);e.parent=this.node;var t=e.getComponent(u.default);t&&(t.initDefault_Editor(),this.cups.push(t))},t.prototype.addCup_AD=function(){var e=cc.instantiate(this.cupPrefab_AD);e.parent=this.node;var t=e.getComponent(u.default);t&&(t.initDefault_Editor(),t.setCupType(u.CupType.Locked),this.cups.push(t))},t.prototype.addCup_Fixed=function(){var e=cc.instantiate(this.cupPrefab_Fixed);e.parent=this.node;var t=e.getComponent(u.default);t&&(t.initDefault_Editor(),t.setCupType(u.CupType.Fixed),this.cups.push(t))},t.prototype.addCup_Frozen=function(){var e=cc.instantiate(this.cupPrefab_Frozen);e.parent=this.node;var t=e.getComponent(u.default);t&&(t.initDefault_Editor(),t.setCupType(u.CupType.Frozen),t.setFrozenUnlockCount(1),this.cups.push(t))},t.prototype.addCup_Masked=function(){var e=cc.instantiate(this.cupPrefab_Masked);e.parent=this.node;var t=e.getComponent(u.default);t&&(t.initDefault_Editor(),t.setCupType(u.CupType.Masked),t.setMaskUnlockColor(1),t.setMaskUnlockCount(1),this.cups.push(t))},t.prototype.getLevelConfig=function(){return this.cups.map(function(e){var t={type:e.getCupType(),pos:{x:e.node.x,y:e.node.y},colorIds:e.getColorIds()};return e.getCupType()===u.CupType.Frozen?t.frozenUnlockCount=e.getFrozenUnlockCount():e.getCupType()===u.CupType.Masked&&(t.maskUnlockColorId=e.getMaskUnlockColorId(),t.maskUnlockCount=e.getMaskUnlockCount()),t})},t.prototype.updateCups=function(){this.cups=this.cups.filter(function(e){return null!==e&&null!==e.node}),console.log(this.cups)},t.prototype.loadLevelConfig=function(e){this.clearAllCups();for(var t=0,o=e;t<o.length;t++){var n=o[t],i=void 0;switch(n.type){case u.CupType.Locked:i=this.cupPrefab_AD;break;case u.CupType.Fixed:i=this.cupPrefab_Fixed;break;case u.CupType.Frozen:i=this.cupPrefab_Frozen;break;case u.CupType.Masked:i=this.cupPrefab_Masked;break;default:i=this.cupPrefab}var r=cc.instantiate(i);r.parent=this.node,r.setPosition(n.pos.x,n.pos.y);var a=r.getComponent(u.default);a&&(a.initDefault_Editor(),a.setCupType(n.type),n.colorIds&&n.colorIds.length>0&&a.setColorIds(n.colorIds),n.type===u.CupType.Frozen&&void 0!==n.frozenUnlockCount?a.setFrozenUnlockCount(n.frozenUnlockCount):n.type===u.CupType.Masked&&void 0!==n.maskUnlockColorId&&void 0!==n.maskUnlockCount&&(a.setMaskUnlockColor(n.maskUnlockColorId),a.setMaskUnlockCount(n.maskUnlockCount)),void 0!==n.capacity&&a.setCapacity(n.capacity),this.cups.push(a))}},t.prototype.openLocalFile=function(){var e=this;d.default.getInstance().openLocalFile(null,function(t){console.log("file",t),d.default.getInstance().readLocalFile(t,1,function(t){console.log("file result",t),t?e.loadFromJSON(t):console.log("\u8bfb\u53d6\u6587\u4ef6\u5931\u8d25")})})},t.prototype.clearAllCups=function(){this.updateCups();for(var e=0,t=this.cups;e<t.length;e++)t[e].node.destroy();this.cups=[]},t.prototype.saveToJSON=function(){this.updateCups();var e=this.getLevelConfig(),t=JSON.stringify(e,null,2),o=p.default.getInstance().getFileName();this.saveForBrowser(t,o)},t.prototype.saveForBrowser=function(e,t){if(cc.sys.isBrowser){console.log("\u6d4f\u89c8\u5668");var o=new Blob([e],{type:"application/json"}),n=document.createElement("a");n.download=t,n.innerHTML="Download File",null!=window.webkitURL&&(n.href=window.webkitURL.createObjectURL(o)),n.click()}},t.prototype.unhightlightAllCups=function(){for(var e=0,t=this.cups;e<t.length;e++)t[e].node.scale=1},t.prototype.loadFromJSON=function(e){var t=JSON.parse(e);this.loadLevelConfig(t)},t.instance=null,l([y(cc.Prefab)],t.prototype,"cupPrefab",void 0),l([y(cc.Prefab)],t.prototype,"cupPrefab_AD",void 0),l([y(cc.Prefab)],t.prototype,"cupPrefab_Fixed",void 0),l([y(cc.Prefab)],t.prototype,"cupPrefab_Frozen",void 0),l([y(cc.Prefab)],t.prototype,"cupPrefab_Masked",void 0),o=l([h],t)}(cc.Component);r.default=m,cc._RF.pop(),cc._RF.pop()},{}],LevelEditor:[function(e,t,o){"use strict";cc._RF.push(t,"56dc9rnySVK6LPoUsMEXt43","LevelEditor");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"56dc9rnySVK6LPoUsMEXt43","LevelEditor");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("Cup"),p=n("CupInfoUI"),d=n("FileManager"),f=cc._decorator,h=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cupPrefab=null,t.cupPrefab_AD=null,t.cupPrefab_Fixed=null,t.cupPrefab_Frozen=null,t.cupPrefab_Masked=null,t.cups=[],t}var o;return s(t,e),o=t,t.getInstance=function(){return o.instance?o.instance:null},t.prototype.onLoad=function(){o.instance=this},t.prototype.addCup=function(){var e=cc.instantiate(this.cupPrefab);e.parent=this.node;var t=e.getComponent(u.default);t&&(t.initDefault_Editor(),this.cups.push(t))},t.prototype.addCup_AD=function(){var e=cc.instantiate(this.cupPrefab_AD);e.parent=this.node;var t=e.getComponent(u.default);t&&(t.initDefault_Editor(),t.setCupType(u.CupType.Locked),this.cups.push(t))},t.prototype.addCup_Fixed=function(){var e=cc.instantiate(this.cupPrefab_Fixed);e.parent=this.node;var t=e.getComponent(u.default);t&&(t.initDefault_Editor(),t.setCupType(u.CupType.Fixed),this.cups.push(t))},t.prototype.addCup_Frozen=function(){var e=cc.instantiate(this.cupPrefab_Frozen);e.parent=this.node;var t=e.getComponent(u.default);t&&(t.initDefault_Editor(),t.setCupType(u.CupType.Frozen),t.setFrozenUnlockCount(1),this.cups.push(t))},t.prototype.addCup_Masked=function(){var e=cc.instantiate(this.cupPrefab_Masked);e.parent=this.node;var t=e.getComponent(u.default);t&&(t.initDefault_Editor(),t.setCupType(u.CupType.Masked),t.setMaskUnlockColor(1),t.setMaskUnlockCount(1),this.cups.push(t))},t.prototype.getLevelConfig=function(){return this.cups.map(function(e){var t={type:e.getCupType(),pos:{x:e.node.x,y:e.node.y},colorIds:e.getColorIds()};return e.getCupType()===u.CupType.Frozen?t.frozenUnlockCount=e.getFrozenUnlockCount():e.getCupType()===u.CupType.Masked&&(t.maskUnlockColorId=e.getMaskUnlockColorId(),t.maskUnlockCount=e.getMaskUnlockCount()),t})},t.prototype.updateCups=function(){this.cups=this.cups.filter(function(e){return null!==e&&null!==e.node})},t.prototype.loadLevelConfig=function(e){this.clearAllCups();for(var t=0,o=e;t<o.length;t++){var n=o[t],i=void 0;switch(n.type){case u.CupType.Locked:i=this.cupPrefab_AD;break;case u.CupType.Fixed:i=this.cupPrefab_Fixed;break;case u.CupType.Frozen:i=this.cupPrefab_Frozen;break;case u.CupType.Masked:i=this.cupPrefab_Masked;break;default:i=this.cupPrefab}var r=cc.instantiate(i);r.parent=this.node,r.setPosition(n.pos.x,n.pos.y);var a=r.getComponent(u.default);a&&(a.initDefault_Editor(),a.setCupType(n.type),n.colorIds&&n.colorIds.length>0&&a.setColorIds(n.colorIds),n.type===u.CupType.Frozen&&void 0!==n.frozenUnlockCount?a.setFrozenUnlockCount(n.frozenUnlockCount):n.type===u.CupType.Masked&&void 0!==n.maskUnlockColorId&&void 0!==n.maskUnlockCount&&(a.setMaskUnlockColor(n.maskUnlockColorId),a.setMaskUnlockCount(n.maskUnlockCount)),void 0!==n.capacity&&a.setCapacity(n.capacity),this.cups.push(a))}},t.prototype.openLocalFile=function(){var e=this;d.default.getInstance().openLocalFile(null,function(t){d.default.getInstance().readLocalFile(t,1,function(t){t?e.loadFromJSON(t):cc.log("\u8bfb\u53d6\u6587\u4ef6\u5931\u8d25")})})},t.prototype.clearAllCups=function(){this.updateCups();for(var e=0,t=this.cups;e<t.length;e++)t[e].node.destroy();this.cups=[]},t.prototype.saveToJSON=function(){this.updateCups();var e=this.getLevelConfig(),t=JSON.stringify(e,null,2),o=p.default.getInstance().getFileName();this.saveForBrowser(t,o)},t.prototype.saveForBrowser=function(e,t){if(cc.sys.isBrowser){cc.log("\u6d4f\u89c8\u5668");var o=new Blob([e],{type:"application/json"}),n=document.createElement("a");n.download=t,n.innerHTML="Download File",null!=window.webkitURL&&(n.href=window.webkitURL.createObjectURL(o)),n.click()}},t.prototype.unhightlightAllCups=function(){for(var e=0,t=this.cups;e<t.length;e++)t[e].node.scale=1},t.prototype.loadFromJSON=function(e){var t=JSON.parse(e);this.loadLevelConfig(t)},t.instance=null,l([y(cc.Prefab)],t.prototype,"cupPrefab",void 0),l([y(cc.Prefab)],t.prototype,"cupPrefab_AD",void 0),l([y(cc.Prefab)],t.prototype,"cupPrefab_Fixed",void 0),l([y(cc.Prefab)],t.prototype,"cupPrefab_Frozen",void 0),l([y(cc.Prefab)],t.prototype,"cupPrefab_Masked",void 0),o=l([h],t)}(cc.Component);r.default=m,cc._RF.pop(),cc._RF.pop()},{}],LevelGenRunner:[function(e,t,o){"use strict";cc._RF.push(t,"5c01ckOEUhGr6Xs/fGxaGP5","LevelGenRunner");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"5c01ckOEUhGr6Xs/fGxaGP5","LevelGenRunner");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("LevelGeneratorTool"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startLevel=1,t.endLevel=20,t.autoGenerate=!0,t}return s(t,e),t.prototype.start=function(){this.autoGenerate&&this.generateLevels()},t.prototype.generateLevels=function(){cc.log("======================================"),cc.log("\u5f00\u59cb\u751f\u6210\u5173\u5361 "+this.startLevel+"-"+this.endLevel+"..."),cc.log("======================================");try{u.LevelGeneratorTool.generateAndSaveLevels(this.startLevel,this.endLevel),cc.log("======================================"),cc.log("\u5173\u5361\u751f\u6210\u5b8c\u6210\uff01\u8bf7\u67e5\u770b\u63a7\u5236\u53f0\u8f93\u51fa"),cc.log("\u6587\u4ef6\u4f4d\u7f6e: assets/SideMode/BottlePuzzle/data/levels.json"),cc.log("======================================")}catch(e){cc.error("\u751f\u6210\u5173\u5361\u65f6\u51fa\u9519:",e)}},t.prototype.generateSingleLevel=function(e){cc.log("\u751f\u6210\u5355\u4e2a\u5173\u5361: "+e),u.LevelGeneratorTool.generateSingleLevel(e)},l([f({tooltip:"\u8d77\u59cb\u5173\u5361\u53f7"})],t.prototype,"startLevel",void 0),l([f({tooltip:"\u7ed3\u675f\u5173\u5361\u53f7"})],t.prototype,"endLevel",void 0),l([f({tooltip:"\u662f\u5426\u81ea\u52a8\u5f00\u59cb\u751f\u6210\uff08\u52fe\u9009\u540e\u8fd0\u884c\u573a\u666f\u65f6\u81ea\u52a8\u751f\u6210\uff09"})],t.prototype,"autoGenerate",void 0),l([d],t)}(cc.Component);r.default=h,cc._RF.pop(),cc._RF.pop()},{}],LevelGeneratorTool:[function(e,t,o){"use strict";cc._RF.push(t,"abecfk3fUFPHI4SHLl/z8Zb","LevelGeneratorTool");var n=e,i=t,r=o;cc._RF.push(i,"abecfk3fUFPHI4SHLl/z8Zb","LevelGeneratorTool"),Object.defineProperty(r,"__esModule",{value:!0}),r.LevelGeneratorTool=void 0;var a=n("LevelGenerator_BP"),c=function(){function e(){}return e.generateAndSaveLevels=function(e,t){var o=Date.now(),n=0,i=0;console.log("\u5f00\u59cb\u751f\u6210\u5173\u5361 "+e+"-"+t+"..."),console.log("\u6b63\u5728\u751f\u6210\u5173\u5361\u6570\u636e\uff08\u9700\u8981\u9a8c\u8bc1\u6709\u89e3\uff09...");for(var r={},c=e;c<=t;c++){var s=this.getDifficultyType(c),l=1===c?5:3,u=a.LevelGenerator_BP.generateLevel(c,s,l);u?(r[c]=u,n++,console.log("\u2713 \u5173\u5361 "+c+" \u751f\u6210\u6210\u529f ("+u.solutionSteps+" \u6b65)")):(i++,console.warn("\u2717 \u5173\u5361 "+c+" \u751f\u6210\u5931\u8d25\uff08\u8d85\u8fc7\u91cd\u8bd5\u6b21\u6570\uff09"))}if(this.saveLevelsToProjectFile(r)){var p=Date.now()-o;console.log("\n\u751f\u6210\u5b8c\u6210\uff01"),console.log("\u6210\u529f: "+n+", \u5931\u8d25: "+i),console.log("\u8017\u65f6: "+p+"ms"),console.log("\n\u5173\u5361\u6587\u4ef6\u5df2\u4fdd\u5b58\u5230: assets/SideMode/BottlePuzzle/data/levels.json")}else console.error("\u5173\u5361\u6587\u4ef6\u4fdd\u5b58\u5931\u8d25\uff01")},e.saveLevelsToProjectFile=function(e){try{if("undefined"!=typeof window&&"undefined"==typeof Editor)return console.error("\u6587\u4ef6\u4fdd\u5b58\u4ec5\u5728\u7f16\u8f91\u5668\u73af\u5883\u53ef\u7528\uff0c\u8fd0\u884c\u65f6\u65e0\u6cd5\u4fdd\u5b58\u6587\u4ef6"),console.log("\u751f\u6210\u7684\u5173\u5361\u6570\u636e\uff1a",JSON.stringify(e,null,2)),!1;var t=Editor.Project.path+"/assets/SideMode/BottlePuzzle/data",o=t+"/levels.json",n=JSON.stringify(e,null,2),i=window.require("fs");return i.existsSync(t)||i.mkdirSync(t,{recursive:!0}),i.writeFileSync(o,n,"utf-8"),console.log("\u6587\u4ef6\u5df2\u4fdd\u5b58: "+o),!0}catch(e){return console.error("\u4fdd\u5b58\u5173\u5361\u6587\u4ef6\u5931\u8d25",e),!1}},e.generateSingleLevel=function(e){console.log("\u6b63\u5728\u751f\u6210\u5173\u5361 "+e+"...");var t=this.getDifficultyType(e),o=1===e?5:3,n=a.LevelGenerator_BP.generateLevel(e,t,o);n?(console.log("\u2713 \u5173\u5361 "+e+" \u751f\u6210\u6210\u529f ("+n.solutionSteps+" \u6b65)"),console.log("\u9700\u8981\u91cd\u65b0\u6267\u884c generateAndSaveLevels() \u6765\u66f4\u65b0\u6587\u4ef6")):console.warn("\u2717 \u5173\u5361 "+e+" \u751f\u6210\u5931\u8d25")},e.getDifficultyType=function(e){return e<=1||e<=3?"simple":e<=7?"medium":e<=15?"hard":"extreme"},e.LEVELS_FILE_PATH="BottlePuzzle/data/levels",e.LEVELS_FILE_NAME="levels.json",e}();r.LevelGeneratorTool=c,cc._RF.pop(),cc._RF.pop()},{}],LevelGenerator_BP:[function(e,o,n){"use strict";cc._RF.push(o,"4efa8uwGqlD2JTyFCGPbXFE","LevelGenerator_BP");var i=e,r=o,a=n;cc._RF.push(r,"4efa8uwGqlD2JTyFCGPbXFE","LevelGenerator_BP"),Object.defineProperty(a,"__esModule",{value:!0}),a.LevelGenerator_BP=void 0;var c=i("LevelSolver_BP"),s=function(){function e(){}return e.generateLevel=function(e,o,n,i){void 0===n&&(n=3),void 0===i&&(i=!1);for(var r=0,a=1===e,s=a?[1,50]:{simple:[1,3],medium:[4,6],hard:[7,10],extreme:[11,50]}[o],l=s[0],u=s[1],p=function(){console.log("\n[GenDebug] L"+e+" ===== \u7b2c "+(r+1)+"/"+d.MAX_RETRIES+" \u6b21\u5c1d\u8bd5\u5f00\u59cb ====="),i&&cc.log("[GenDebug] L"+e+" Attempt "+(r+1)+"/"+d.MAX_RETRIES+" diff="+o);var t=1===e?[5,4,3,2,1]:d.generateRandomCapacities(n,o),s=a?d.createLevel1Config(t):d.createBottleConfig(t,o);if(!s)return console.log("[GenDebug] L"+e+" \u7b2c "+(r+1)+" \u6b21\uff1aconfig invalid"),i&&cc.log("[GenDebug] reject: config invalid"),r++,"continue";var p=s.map(function(e){return e.targetAmount}),f=p.reduce(function(e,t){return e+t},0);console.log("[GenDebug] L"+e+" \u7b2c "+(r+1)+" \u6b21\uff1acapacities="+JSON.stringify(t)+" targets="+JSON.stringify(p)+" totalWater="+f),i&&cc.log("[GenDebug] capacities="+JSON.stringify(t)+" targets="+JSON.stringify(p)+" totalWater="+f);var h=new Array(t.length).fill(0),y=f,m=0,g=10*f;for(console.log("[GenDebug] L"+e+" \u7b2c "+(r+1)+" \u6b21\uff1a\u5f00\u59cb\u5206\u914d\u6db2\u4f53\uff0c\u6700\u591a"+g+"\u6b21...");y>0&&m<g;){m++;var v=Math.floor(Math.random()*t.length),_=t[v]-h[v];if(_>0){var S=Math.min(1,y,_);h[v]+=S,y-=S}else if(y>0){for(var b=!1,C=0;C<t.length;C++){var P=t[C]-h[C];if(P>0){var k=Math.min(1,y,P);h[C]+=k,y-=k,b=!0;break}}if(!b)break}}if(y>0&&m>=g)return console.log("[GenDebug] L"+e+" \u7b2c "+(r+1)+" \u6b21\uff1a\u5206\u914d\u8d85\u65f6\uff01\u5faa\u73af"+m+"\u6b21\u672a\u5b8c\u6210\uff0cremaining="+y),i&&cc.log("[GenDebug] reject: allocation timeout"),r++,"continue";if(y>0)return console.log("[GenDebug] L"+e+" \u7b2c "+(r+1)+" \u6b21\uff1a\u5206\u914d\u5931\u8d25 remaining="+y+" attempts="+m),i&&cc.log("[GenDebug] reject: failed to distribute all Water"),r++,"continue";if(console.log("[GenDebug] L"+e+" \u7b2c "+(r+1)+" \u6b21\uff1ainitial="+JSON.stringify(h)),i&&cc.log("[GenDebug] initial="+JSON.stringify(h)),h.join(",")===p.join(","))return console.log("[GenDebug] L"+e+" \u7b2c "+(r+1)+" \u6b21\uff1a\u521d\u59cb\u5df2\u7b49\u4e8e\u76ee\u6807\uff0c\u65e0\u610f\u4e49"),i&&cc.log("[GenDebug] reject: initial state equals target state"),r++,"continue";console.log("[GenDebug] L"+e+" \u7b2c "+(r+1)+" \u6b21\uff1a\u51c6\u5907\u8c03\u7528BFS..."),i&&cc.log("[GenDebug] *** \u5373\u5c06\u8c03\u7528BFS\u6c42\u89e3\u5668 ***"),console.log("[GenDebug] L"+e+" \u7b2c "+(r+1)+" \u6b21\uff1a\u8c03\u7528solve()...");var w=c.LevelSolver_BP.solve(h,t,p);if(console.log("[GenDebug] L"+e+" \u7b2c "+(r+1)+" \u6b21\uff1asolve()\u8fd4\u56de "+(w?"result(steps="+w.length+")":"null")),!w)return console.log("[GenDebug] L"+e+" \u7b2c "+(r+1)+" \u6b21\uff1a\u62d2\u7edd - solver\u8fd4\u56denull"),i&&cc.log("[GenDebug] reject: solver returned null (possible timeout or unsolvable)"),r++,"continue";if(0===w.length)return console.log("[GenDebug] L"+e+" \u7b2c "+(r+1)+" \u6b21\uff1a\u62d2\u7edd - \u89e3\u6cd50\u6b65"),i&&cc.log("[GenDebug] reject: solution has 0 steps"),r++,"continue";if(!d.validateAllBottlesUsed(w,t.length)){for(var I=new Set,T=0,A=w;T<A.length;T++){var O=A[T];I.add(O.from),I.add(O.to)}return console.log("[GenDebug] L"+e+" \u7b2c "+(r+1)+" \u6b21\uff1a\u62d2\u7edd - \u672a\u4f7f\u7528\u6240\u6709\u74f6\u5b50("+I.size+"/"+t.length+")"),i&&cc.log("[GenDebug] reject: not-all-bottles-used usedCount="+I.size),r++,"continue"}if(!a&&(w.length<l||w.length>u))return console.log("[GenDebug] L"+e+" \u7b2c "+(r+1)+" \u6b21\uff1a\u62d2\u7edd - \u6b65\u6570"+w.length+"\u4e0d\u5728["+l+","+u+"]\u8303\u56f4"),i&&cc.log("[GenDebug] reject: steps "+w.length+" not in ["+l+","+u+"]"),r++,"continue";console.log("[GenDebug] L"+e+" \u7b2c "+(r+1)+" \u6b21\uff1a\u2713 \u63a5\u53d7 - \u6b65\u6570="+w.length);var R=s.map(function(e,t){return{capacity:e.capacity,target:e.targetAmount,initial:h[t]}});return{value:{levelId:e,bottleConfigs:R,solution:d.convertSolutionToLetters(w),initialBottles:h,capacities:t,targets:p,difficulty:Math.min(e,10),difficultyType:o,solutionSteps:w.length,generatedTime:Date.now()}}},d=this;r<this.MAX_RETRIES;){var f=p();if("object"==t(f))return f.value}return cc.warn("\u5173\u5361 "+e+" \u751f\u6210\u5931\u8d25\uff0c\u8d85\u8fc7 "+this.MAX_RETRIES+" \u6b21\u91cd\u8bd5"+(a?"":"\uff08\u76ee\u6807\u6b65\u6570: "+l+"-"+u+"\uff09")),null},e.validateAllBottlesUsed=function(e,t){for(var o=new Set,n=0,i=e;n<i.length;n++){var r=i[n];o.add(r.from),o.add(r.to)}return o.size===t},e.convertSolutionToLetters=function(e){var t=this;return e.map(function(e){return{from:t.indexToLetter(e.from),to:t.indexToLetter(e.to)}})},e.indexToLetter=function(e){return String.fromCharCode(65+e)},e.generateRandomCapacities=function(e){for(var t=[],o=0;o<e;o++)t.push(Math.floor(9*Math.random())+2);return t},e.createLevel1Config=function(e){for(var t=[],o=0;o<e.length;o++)t.push({capacity:e[o],targetAmount:0});var n=Math.max.apply(Math,e),i=e.reduce(function(e,t){return e+t},0);console.log("[createLevel1Config] capacities="+JSON.stringify(e)+" max="+n+" total="+i);var r=n,a=i-1,c=Math.floor(r+Math.random()*(a-r+1)),s=Math.max(c,e.length);for(console.log("[createLevel1Config] totalTarget="+s+" (\u8303\u56f4: "+r+"-"+a+")"),o=0;o<t.length;o++)t[o].targetAmount=1;var l=s-e.length,u=0,p=10*l+100;for(console.log("[createLevel1Config] \u5f00\u59cb\u5206\u914dremaining="+l+"\uff0c\u6700\u591a"+p+"\u6b21");l>0&&u<p;){u++;var d=Math.floor(Math.random()*e.length),f=e[d]-t[d].targetAmount;if(f>0){var h=Math.min(1,f,l);t[d].targetAmount+=h,l-=h}}return l>0?(console.error("[createLevel1Config] \u5206\u914d\u8d85\u65f6\uff01\u5faa\u73af"+u+"\u6b21\uff0cremaining="+l),null):t},e.createBottleConfig=function(e){for(var t=[],o=0;o<e.length;o++)t.push({capacity:e[o],targetAmount:0});var n=Math.max.apply(Math,e),i=e.reduce(function(e,t){return e+t},0);console.log("[createBottleConfig] capacities="+JSON.stringify(e)+" max="+n+" total="+i);var r=n,a=i-1,c=r+Math.floor(Math.random()*(a-r+1));return console.log("[createBottleConfig] totalTarget="+c+" (\u8303\u56f4: "+r+"-"+a+"), \u8c03\u7528assignRandomTargets..."),this.assignRandomTargets(t,c),t},e.assignRandomTargets=function(e,t){console.log("[assignRandomTargets] totalTarget="+t+", config.length="+e.length);for(var o=t,n=1;n<e.length;n++)if(n===e.length-1)e[n].targetAmount=Math.min(o,e[n].capacity);else{var i=Math.min(e[n].capacity,o),r=Math.floor(Math.random()*(i+1));e[n].targetAmount=r,o-=r}console.log("[assignRandomTargets] \u521d\u59cb\u5206\u914d\u540eremaining="+o);for(var a=0,c=10*o+100;o>0&&a<c;){a++;var s=Math.floor(Math.random()*e.length),l=e[s].capacity-e[s].targetAmount;l>0&&(r=Math.min(1,l,o),e[s].targetAmount+=r,o-=r)}o>0?(console.error("[assignRandomTargets] \u5206\u914d\u8d85\u65f6\uff01\u5faa\u73af"+a+"\u6b21\uff0cremaining="+o),console.error("[assignRandomTargets] config: "+JSON.stringify(e.map(function(e){return e.targetAmount+"/"+e.capacity})))):console.log("[assignRandomTargets] \u5206\u914d\u5b8c\u6210\uff0c\u5faa\u73af"+a+"\u6b21")},e.shuffleArray=function(e){for(var t,o=e.length-1;o>0;o--){var n=Math.floor(Math.random()*(o+1));t=[e[n],e[o]],e[o]=t[0],e[n]=t[1]}},e.MAX_RETRIES=50,e}();a.LevelGenerator_BP=s,cc._RF.pop(),cc._RF.pop()},{}],LevelManager_ED:[function(e,t,o){"use strict";cc._RF.push(t,"89c47RCjUxFMZf5dDy7j1Y3","LevelManager_ED");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"89c47RCjUxFMZf5dDy7j1Y3","LevelManager_ED");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("Row_ED"),p=n("CupMgr_ED"),d=n("GameManager_ED"),f=n("WaterArrGenerate_ED"),h=cc._decorator,y=h.ccclass,m=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cupPrefab=null,t.cupPrefab_AD=null,t.cupPrefab_Fixed=null,t.cupPrefab_Frozen=null,t.cupPrefab_Masked=null,t.levelConfig=null,t.cupManager=null,t.param_PosY=-275,t.row_x3=null,t.row_x4=null,t.row_latest=null,t}var o;return s(t,e),o=t,t.getInstance=function(){return o.instance?o.instance:null},t.prototype.onLoad=function(){o.instance=this,this.cupManager=this.node.getComponent(p.default),d.default.instance.completedAmounts=0,f.default.initSortTypeConfig()},t.prototype.start=function(){this.loadLevel(30)},t.prototype.loadLevel=function(e){this.createRowContents();for(var t=0;t<e+1;t++){var o=cc.instantiate(t%2==0?this.row_x4:this.row_x3);o.setParent(this.node),o.active=!0,o.scale=Math.pow(.96,t);var n=t>10?-.15*t:0,i=0===t?0:425*Math.sqrt(Math.pow(.96,t-1))+32*Math.sqrt(Math.pow(.96,t))-425*Math.sqrt(Math.pow(.96,t))+(0*Math.pow(.9,t)-6)+n;this.param_PosY+=i,o.setPosition(0,this.param_PosY),o.setSiblingIndex(0),t===e&&(o.opacity=0),d.default.instance.rowsCreated++,d.default.instance.PosYList.push(this.param_PosY),o.getComponent(u.default).row_uid=d.default.instance.rowsCreated,0===t||(this.row_latest.rowRear=o.getComponent(u.default),this.row_latest.bindBottleRear()),this.row_latest=o.getComponent(u.default),d.default.instance.rowLists.push(o.getComponent(u.default))}this.cupManager.foremostRowUid=1,this.revealIntialBottles()},t.prototype.createRowContents=function(){for(var e=0;e<7;e++){var t=cc.instantiate(this.cupPrefab),o=0;switch(e){case 0:o=-210;break;case 1:o=0;break;case 2:o=220;break;case 3:o=-315;break;case 4:o=-110;break;case 5:o=110;break;case 6:o=315}t.setParent(e<3?this.row_x3.getComponent(u.default).cupsArea:this.row_x4.getComponent(u.default).cupsArea),t.name=e<3?e+"":e-3+"",t.setPosition(o,0),t.active=!0}},t.prototype.revealIntialBottles=function(){var e=this.cupManager.node.children[this.cupManager.node.children.length-1].getComponent(u.default);e.initBottle(0,f.default.createColorIds(1)),e.initBottle(1,[0,0,0,0]),e.initBottle(2,f.default.createColorIds(1)),e.initBottle(3,f.default.createColorIds(1))},t.prototype.createNewRow=function(){var e=cc.instantiate(d.default.instance.rowsCreated%2==0?this.row_x4:this.row_x3);e.setParent(this.node),e.active=!0,e.scale=Math.pow(.96,30),e.setPosition(0,d.default.instance.PosYList[30]),e.setSiblingIndex(0),e.opacity=0,d.default.instance.rowsCreated++,e.getComponent(u.default).row_uid=d.default.instance.rowsCreated,this.row_latest.rowRear=e.getComponent(u.default),this.row_latest.bindBottleRear(),this.row_latest=e.getComponent(u.default),d.default.instance.rowLists.push(e.getComponent(u.default))},t.prototype.clearAllCups=function(){this.node.removeAllChildren()},t.instance=null,l([m(cc.Prefab)],t.prototype,"cupPrefab",void 0),l([m(cc.Prefab)],t.prototype,"cupPrefab_AD",void 0),l([m(cc.Prefab)],t.prototype,"cupPrefab_Fixed",void 0),l([m(cc.Prefab)],t.prototype,"cupPrefab_Frozen",void 0),l([m(cc.Prefab)],t.prototype,"cupPrefab_Masked",void 0),l([m(cc.Node)],t.prototype,"row_x3",void 0),l([m(cc.Node)],t.prototype,"row_x4",void 0),o=l([y],t)}(cc.Component);r.default=g,cc._RF.pop(),cc._RF.pop()},{}],LevelManager_Long:[function(e,t,o){"use strict";cc._RF.push(t,"f1189AV1/FEha5HUgxyfgn+","LevelManager_Long");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"f1189AV1/FEha5HUgxyfgn+","LevelManager_Long");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0}),r.MAX_LEVEL_Long=void 0;var u=n("CommonData"),p=n("const"),d=n("Cup"),f=n("Cup_Long"),h=n("CupMgr_Long"),y=cc._decorator,m=y.ccclass,g=y.property;r.MAX_LEVEL_Long=3;var v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.levelConfig=null,t.cupManager=null,t.cupPrefab=null,t.cupPrefab_AD=null,t.cupPrefab_Fixed=null,t.scale=1,t.time=1,t.step=1,t.candidates=[],t.emit=0,t}var o;return s(t,e),o=t,t.getInstance=function(){return o.instance?o.instance:null},t.prototype.onLoad=function(){o.instance=this,this.cupManager=this.node.getComponent("CupMgr_Long")},t.prototype.loadLevel=function(){switch(cc.director.getScene().name){case p.SceneNames.Game:this.loadLevel_Default();break;case p.SceneNames.GameModeFillLong:this.loadLevel_Long();break;default:this.loadLevel_Default()}},t.prototype.loadLevel_Default=function(){var e=this,t=u.default.Level;this.loadLevelData(t,function(t){e.levelConfig=t.json,e.scale=e.levelConfig.scale||1;var o=e.levelConfig.cups||e.levelConfig,n=JSON.stringify(o);e.loadFromJSON_Default(n)})},t.prototype.loadLevelData=function(e,t){var o="level/"+e,n=cc.assetManager.getBundle("WaterSortConfig");n?n.load(o,cc.JsonAsset,function(e,o){e?console.error("load levelConfig err",e):t&&t(o)}):cc.assetManager.loadBundle("WaterSortConfig",function(e,n){e?console.error("load ScrewSortConfig bundle err",e):n.load(o,cc.JsonAsset,function(e,o){e?console.error("load levelConfig err",e):t&&t(o)})})},t.prototype.loadFromJSON_Default=function(e){var t=JSON.parse(e);this.loadLevelConfigAsync(t)},t.prototype.loadLevel_Long=function(){var e=this,t=1;t>r.MAX_LEVEL_Long&&(t=Math.floor(Math.random()*r.MAX_LEVEL_Long)+1,console.error(t)),this.loadLevelData_Long(t,function(t){e.levelConfig=JSON.parse(JSON.stringify(t.json)),e.scale=e.levelConfig.scale,e.time=e.levelConfig.time||1,e.step=e.levelConfig.step||1;var o=e.levelConfig.cups,n=e.levelConfig.longcups;console.error("\u52a0\u8f7d\u957f\u74f6\u5b50\u5173\u5361\u6570\u636e",o,n);var i=JSON.stringify(o),r=JSON.stringify(n);console.error("\u52a0\u8f7d\u957f\u74f6\u5b50\u5173\u5361\u6570\u636e",i,r),e.loadFromJSON_Long(i),e.loadFromJSON_Long(r)})},t.prototype.loadLevelData_Long=function(e,t){var o="level_long/"+e,n=cc.assetManager.getBundle("WaterSortConfig");n?n.load(o,cc.JsonAsset,function(e,o){e?console.error("load levelConfig err",e):t&&t(o)}):cc.assetManager.loadBundle("WaterSortConfig",function(e,n){e?console.error("load ScrewSortConfig bundle err",e):n.load(o,cc.JsonAsset,function(e,o){e?console.error("load levelConfig err",e):t&&t(o)})})},t.prototype.loadFromJSON_Long=function(e){var t=JSON.parse(e);this.loadLevelConfigAsync(t)},t.prototype.loadLevelConfig=function(e){this.clearAllCups();for(var t=0,n=e;t<n.length;t++){var i=n[t],r=void 0;switch(i.type){case f.CupType.Locked:r=this.cupPrefab_AD;break;case f.CupType.Fixed:r=this.cupPrefab_Fixed;break;default:r=this.cupPrefab}var a=cc.instantiate(r);a.parent=o.getInstance().node,a.setPosition(i.pos.x,i.pos.y);var c=a.getComponent(d.default);if(c){if(c.initDefault(),c.setCupType(i.type),i.colorIds&&i.colorIds.length>0){var s=i.colorIds.filter(function(e){return 0!==e}).length;h.default.getInstance().totalWater+=s,c.setColorIds(i.colorIds)}this.cupManager.cups.push(c),this.cupManager.setUpCup(i,c)}this.node.scale=this.scale}cc.director.emit("load_level")},t.prototype.clearAllCups=function(){this.node.removeAllChildren()},t.prototype.loadLevelConfigAsync=function(e){this.createCupsAsync(e,0)},t.prototype.createCupsAsync=function(e,t){for(var o=this,n=cc.director.getDeltaTime(),i=n<1/80?15:n<.02?10:5,r=Math.min(t+i,e.length),a=t;a<r;a++){var c=e[a];this.createSingleCup(c)}if(r<e.length)this.scheduleOnce(function(){o.createCupsAsync(e,r)},0);else{if(this.node.scale=this.scale,1!==this.emit)return void this.emit++;cc.director.emit("load_level")}},t.prototype.createSingleCup=function(e){var t,o,n;switch(e.type){case f.CupType.Locked:t=this.cupPrefab_AD;break;case f.CupType.Fixed:t=this.cupPrefab_Fixed;break;default:t=this.cupPrefab}if(e.type!==f.CupType.Fixed){if((o=cc.instantiate(t)).parent=this.node,o.setPosition(e.pos.x,e.pos.y),n=o.getComponent(d.default)){if(n.initDefault(),n.setCupType(e.type),e.colorIds&&e.colorIds.length>0){var i=e.colorIds.filter(function(e){return 0!==e}).length;h.default.getInstance().totalWater+=i,n.setColorIds(e.colorIds)}this.cupManager.cups.push(n),this.cupManager.setUpCup(e,n)}}else(o=cc.instantiate(t)).parent=this.node,o.setPosition(e.pos.x,e.pos.y),(n=o.getComponent(f.default))&&(n.initLong(),i=e.type,n.setCupType(e.type),e.colorIds&&e.colorIds.length>0&&n.setColorIds(e.colorIds),this.cupManager.longCups.push(n),this.cupManager.setUpLongCup(e,n))},t.prototype.createOneCup=function(e,t){var o;switch(e.type){case f.CupType.Locked:o=this.cupPrefab_AD;break;case f.CupType.Fixed:o=this.cupPrefab_Fixed;break;default:o=this.cupPrefab}var n=cc.instantiate(o);n.parent=t,n.setPosition(e.pos.x,e.pos.y);var i=n.getComponent(d.default);return i&&(i.initDefault(),i.setCupType(e.type),e.colorIds&&e.colorIds.length>0&&(e.colorIds.filter(function(e){return 0!==e}).length,i.setColorIds(e.colorIds)),this.cupManager.setUpCup(e,i)),i},t.prototype.resetCup=function(e,t){e.initDefault(),e.setCupType(t.type),t.colorIds&&t.colorIds.length>0&&(t.colorIds.filter(function(e){return 0!==e}).length,e.setColorIds(t.colorIds)),this.cupManager.setUpCup(t,e)},t.instance=null,l([g(h.default)],t.prototype,"cupManager",void 0),l([g(cc.Prefab)],t.prototype,"cupPrefab",void 0),l([g(cc.Prefab)],t.prototype,"cupPrefab_AD",void 0),l([g(cc.Prefab)],t.prototype,"cupPrefab_Fixed",void 0),o=l([m],t)}(cc.Component);r.default=v,cc._RF.pop(),cc._RF.pop()},{}],LevelManager:[function(e,t,o){"use strict";cc._RF.push(t,"24586M0kUlDSrMcvH4i+XBM","LevelManager");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"24586M0kUlDSrMcvH4i+XBM","LevelManager");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<o;t++)for(var r=arguments[t],a=0,c=r.length;a<c;a++,i++)n[i]=r[a];return n};Object.defineProperty(r,"__esModule",{value:!0}),r.MAX_LEVEL_MULTI=void 0;var p=n("CommonData"),d=n("const"),f=n("Cup"),h=n("CupMgr"),y=n("LevelData"),m=cc._decorator,g=m.ccclass,v=m.property;r.MAX_LEVEL_MULTI=3;var _=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.levelConfig=null,t.cupManager=null,t.cupPrefab=null,t.cupPrefab_AD=null,t.cupPrefab_Fixed=null,t.cupPrefab_Frozen=null,t.cupPrefab_Masked=null,t.cupPrefab_SingleColor=null,t.cupPrefab_Bomb=null,t.cupPrefab_Temp1=null,t.cupPrefab_Temp1AD=null,t.cupPrefab_Absorb=null,t.cupPrefab_BombFixed=null,t.cupPrefab_BombFrozen=null,t.cupPrefab_BombMasked=null,t.cupPrefab_Temp1Frozen=null,t.cupPrefab_ChangeColor=null,t.cupPrefab_Lock=null,t.scale=1,t.time=1,t.step=1,t.candidates=[],t.colorIds=new Array(11).fill(0),t}var o;return s(t,e),o=t,t.getInstance=function(){return o.instance?o.instance:null},t.prototype.onLoad=function(){o.instance=this,this.cupManager=this.node.getComponent("CupMgr")},t.prototype.loadLevel=function(){switch(cc.director.getScene().name){case d.SceneNames.Game:this.loadLevel_Default();break;case d.SceneNames.GameModeMultiple:this.loadLevel_Multi();break;case d.SceneNames.Main:break;default:this.loadLevel_Default()}},t.prototype.loadLevel_Default=function(){var e=this,t=p.default.Level;if(t>y.default.MAX_LEVEL)for(t=this.getChallengeLevel();!y.default.JSON_MAP.includes(t);)t=this.getChallengeLevel();else t=y.default.JSON_MAP[t-1];this.loadLevelData(t,function(t){e.levelConfig=t.json,e.scale=e.levelConfig.scale||1;var o=e.levelConfig.cups||e.levelConfig;e.candidates=e.levelConfig.candidates||[];var n=JSON.stringify(o),i=JSON.stringify(e.candidates);h.default.getInstance().candidateMaskFrozenWeight=e.levelConfig.weight||[4,3,3],e.loadFromJSON_Default(n,i)})},t.prototype.loadLevelData=function(e,t){console.error("load level json:",e);var o="level/"+e;p.default.ifTestingD&&e<=20&&(o="level/b"+e);var n=cc.assetManager.getBundle("WaterSortConfig");cc.director.getScene().name==d.SceneNames.RingFight&&(n=cc.assetManager.getBundle("RingFight"),o="Level/"+e),n?n.load(o,cc.JsonAsset,function(e,o){e?console.error("load levelConfig err",e):t&&t(o)}):cc.assetManager.loadBundle("WaterSortConfig",function(e,n){e?console.error("load WaterSortConfig bundle err",e):n.load(o,cc.JsonAsset,function(e,o){e?console.error("load WaterSortConfig levelConfig err",e):t&&t(o)})})},t.prototype.loadFromJSON_Default=function(e,t){void 0===t&&(t="");var o,n=JSON.parse(e);t&&t.length>0&&(o=JSON.parse(t));for(var i=!0,r=0,a=n;r<a.length;r++)if(a[r].type===f.CupType.SingleColor){i=!1;break}cc.director.getScene().name!=d.SceneNames.Main&&cc.director.getScene().name!=d.SceneNames.RingFight||(i=!1),i?h.default.getInstance().shuffleColors():h.default.getInstance().resetCupColors(),this.calculateColorIds(n,o),this.loadLevelConfigAsync(n)},t.prototype.calculateColorIds=function(e,t){void 0===t&&(t=[]);for(var o=[],n=0,i=0,r=e;i<r.length;i++)if((g=r[i]).type!==f.CupType.Temp1&&g.type!==f.CupType.Temp1AD&&g.type!==f.CupType.Temp1Frozen&&(g.type,f.CupType.Absorb),0==g.pos.x&&0==g.pos.y&&++n>=2&&cc.director.emit(d.EventNames.NextLevel),!p.default.autoPlaying||g.type!==f.CupType.Absorb&&g.type!==f.CupType.Temp1&&g.type!==f.CupType.Temp1AD&&g.type!==f.CupType.Temp1Frozen&&g.type!==f.CupType.ChangeColor||cc.director.emit(d.EventNames.AutoPlayJumpToNextLevel),g.colorIds&&g.colorIds.length>0){for(var a=0;a<g.colorIds.length;a++){var c=g.colorIds[a];if(a>0&&g.colorIds[a-1]>0&&0==c&&cc.director.emit(d.EventNames.NextLevel),0!==c)if(c%1e3>100)this.colorIds[c%100]+=1,this.colorIds[c%100]%4==0&&o.push(c%100);else if(this.colorIds[c%100]+=1,this.colorIds[c%100]%4==0&&o.push(c%100),g.type===f.CupType.Temp1||g.type===f.CupType.Absorb||g.type===f.CupType.Temp1Frozen)break}if(g.type===f.CupType.Absorb)for(var s=0,l=g.absorbArray;s<l.length;s++)0!==(c=l[s])&&(this.colorIds[c%100]+=1,this.colorIds[c%100]%4==0&&o.push(c%100))}for(var u=!1,y=0,m=t;y<m.length;y++){var g;if((g=m[y]).colorIds&&h.default.getInstance().candidateCupCfgs.push(g),g.colorIds&&g.colorIds.length>0)for(a=0;a<g.colorIds.length;a++)c=g.colorIds[a],a>0&&g.colorIds[a-1]>0&&0==c&&cc.director.emit(d.EventNames.NextLevel),0!=c&&(u=!0,p.default.autoPlaying&&cc.director.emit(d.EventNames.AutoPlayJumpToNextLevel),this.colorIds[c%100]+=1,this.colorIds[c%100]%4==0&&o.push(c%100))}for(a=1;a<=10;a++)this.colorIds[a]>0&&(this.colorIds[a]/=4);u?cc.director.emit(d.EventNames.LoadColorIds,o):cc.director.emit(d.EventNames.LoadColorIds,this.colorIds)},t.prototype.loadLevel_Multi=function(){var e=this,t=p.default.LevelModeMultiple;t>r.MAX_LEVEL_MULTI&&(t=Math.floor(Math.random()*r.MAX_LEVEL_MULTI)+1,console.error(t)),this.loadLevelData_Multi(t,function(t){e.levelConfig=JSON.parse(JSON.stringify(t.json)),e.scale=e.levelConfig.scale,e.time=e.levelConfig.time||1,e.step=e.levelConfig.step||1;var o=e.levelConfig.cups;e.candidates=e.levelConfig.candidates;var n=JSON.stringify(o);e.loadFromJSON_Multi(n)})},t.prototype.loadLevelData_Multi=function(e,t){var o="level_multi/"+e,n=cc.assetManager.getBundle("WaterSortConfig");n?n.load(o,cc.JsonAsset,function(e,o){e?console.error("load levelConfig err",e):t&&t(o)}):cc.assetManager.loadBundle("WaterSortConfig",function(e,n){e?console.error("load ScrewSortConfig bundle err",e):n.load(o,cc.JsonAsset,function(e,o){e?console.error("load levelConfig err",e):t&&t(o)})})},t.prototype.loadFromJSON_Multi=function(e){var t=JSON.parse(e);h.default.getInstance().totalWater+=this.getCandidateWaterCount(),this.loadLevelConfigAsync(t)},t.prototype.getCandidateWaterCount=function(){for(var e=0,t=0,o=this.candidates;t<o.length;t++){var n=o[t];n.colorIds&&n.colorIds.length>0&&(e+=n.colorIds.filter(function(e){return 0!==e}).length)}return e},t.prototype.getFirstCandidateCupCfg=function(){if(this.candidates.length>0){var e=this.candidates[0];return this.candidates.shift(),e}return null},t.prototype.getCandidateNum=function(){return this.candidates.length},t.getRandomLevel_RingFight=function(){return o.level_ringFight=Math.floor(116*Math.random())+1,o.level_ringFight},t.prototype.loadLevel_RingFight=function(e){var t=this;void 0===e&&(e=-1);var o=this.getRingFightLevel();this.loadLevelData(o,function(e){t.levelConfig=e.json,t.scale=t.levelConfig.scale||1;var o=t.levelConfig.cups||t.levelConfig;t.candidates=t.levelConfig.candidates||[];var n=JSON.stringify(o),i=JSON.stringify(t.candidates);h.default.getInstance().candidateMaskFrozenWeight=t.levelConfig.weight||[4,3,3],t.loadFromJSON_Default(n,i)})},t.prototype.getChallengeLevel=function(){var e=[3,1,1.2,2,1,2,1,1,.2,1][p.default.Level%10],t=15;if(0==p.default.challengeList0.length&&(p.default.challengeList0=u(y.default.LEVEL_EASY),p.default.challengeList0=p.default.challengeList0.filter(function(e){return e>4}),p.default.challengeList0.sort(function(){return Math.random()-.5})),0==p.default.challengeList1.length&&(p.default.challengeList1=u(y.default.LEVEL_MEDIUM),p.default.challengeList1.sort(function(){return Math.random()-.5})),0==p.default.challengeList2.length&&(p.default.challengeList2=u(y.default.LEVEL_HARD),p.default.challengeList2.sort(function(){return Math.random()-.5})),0==p.default.challengeList3.length&&(p.default.challengeList3=u(y.default.LEVEL_MULTI),p.default.challengeList3.sort(function(){return Math.random()-.5})),0==e)for(t=p.default.challengeList0[0],p.default.currentLevelDifficulty=0;t<=4;)p.default.removeChallengeLevel0(),t=p.default.challengeList0[0],0==p.default.challengeList0.length&&(p.default.challengeList0=u(y.default.LEVEL_EASY),p.default.challengeList0=p.default.challengeList0.filter(function(e){return e>4}),p.default.challengeList0.sort(function(){return Math.random()-.5}));else if(1==e)t=p.default.challengeList1[0],p.default.currentLevelDifficulty=1;else if(1.2==e){if(p.default.ifRestart)return 1==p.default.currentLevelDifficulty?t=p.default.challengeList1[0]:2==p.default.currentLevelDifficulty&&(t=p.default.challengeList2[0]),t;Math.random()<.5?(t=p.default.challengeList1[0],p.default.currentLevelDifficulty=1):(t=p.default.challengeList2[0],p.default.currentLevelDifficulty=2),p.default.ifRestart=!0}else if(2==e)t=p.default.challengeList2[0],p.default.currentLevelDifficulty=2;else if(.2==e){if(p.default.ifRestart)return 0==p.default.currentLevelDifficulty?t=p.default.challengeList0[0]:1==p.default.currentLevelDifficulty&&(t=p.default.challengeList1[0]),t;Math.random()<.5?(t=p.default.challengeList0[0],p.default.currentLevelDifficulty=0):(t=p.default.challengeList2[0],p.default.currentLevelDifficulty=2),p.default.ifRestart=!0}else 3==e&&(t=p.default.challengeList3[0],p.default.currentLevelDifficulty=3);return t},t.prototype.isSuperHardLevel=function(e){if(e>y.default.MAX_LEVEL)return e%5==0;if(e<=y.default.MAX_LEVEL)return y.default.LEVEL_SUPERHARD.includes(e);var t=this.getChallengeLevel();return y.default.LEVEL_SUPERHARD.includes(t)},t.prototype.clearAllCups=function(){this.node.removeAllChildren()},t.prototype.loadLevelConfigAsync=function(e){this.clearAllCups(),this.createCupsAsync(e,0)},t.prototype.createCupsAsync=function(e,t){for(var o=this,n=cc.director.getDeltaTime(),i=n<1/80?20:n<.02?15:10,r=Math.min(t+i,e.length),a=t;a<r;a++){var c=e[a];this.createSingleCup(c)}r<e.length?this.scheduleOnce(function(){o.createCupsAsync(e,r)},0):(this.node.scale=this.scale,cc.director.emit(d.EventNames.UpdateCandidateText,h.default.getInstance().candidateCupCfgs.length),cc.director.emit("load_level"))},t.prototype.createSingleCup=function(e){var t;switch(e.type){case f.CupType.Locked:t=this.cupPrefab_AD;break;case f.CupType.Fixed:t=this.cupPrefab_Fixed;break;case f.CupType.Frozen:t=this.cupPrefab_Frozen;break;case f.CupType.Masked:t=this.cupPrefab_Masked;break;case f.CupType.SingleColor:t=this.cupPrefab_SingleColor;break;case f.CupType.Bomb:t=this.cupPrefab_Bomb;break;case f.CupType.Temp1:t=this.cupPrefab_Temp1;break;case f.CupType.Temp1AD:t=this.cupPrefab_Temp1AD;break;case f.CupType.Absorb:if(p.default.autoPlaying){t=this.cupPrefab,e.type=f.CupType.Normal;break}t=this.cupPrefab_Absorb;break;case f.CupType.BombFixed:if(p.default.autoPlaying){t=this.cupPrefab,e.type=f.CupType.Normal;break}t=this.cupPrefab_BombFixed;break;case f.CupType.BombFrozen:if(p.default.autoPlaying){t=this.cupPrefab,e.type=f.CupType.Normal;break}t=this.cupPrefab_BombFrozen;break;case f.CupType.BombMasked:if(p.default.autoPlaying){t=this.cupPrefab,e.type=f.CupType.Normal;break}if(p.default.autoPlaying){t=this.cupPrefab,e.type=f.CupType.Normal;break}t=this.cupPrefab_BombMasked;break;case f.CupType.Temp1Frozen:if(p.default.autoPlaying){t=this.cupPrefab_Temp1,e.type=f.CupType.Temp1;break}t=this.cupPrefab_Temp1Frozen;break;case f.CupType.ChangeColor:t=this.cupPrefab_ChangeColor;break;case f.CupType.Lock:t=this.cupPrefab_Lock;break;default:t=this.cupPrefab}var o,n=cc.instantiate(t);if(n.parent=this.node,n.setPosition(e.pos.x,e.pos.y),o=e.type===f.CupType.SingleColor?n.getComponent("SingleColorCup"):n.getComponent(f.default)){if(o.initDefault(),o.setCupType(e.type),e.colorIds&&e.colorIds.length>0){var i=e.colorIds.filter(function(e){return 0!==e}).length;cc.director.getScene().name===d.SceneNames.GameModeMultiple&&(h.default.getInstance().totalWater+=i),o.setUpKey(e.colorIds),o.setColorIds(e.colorIds)}void 0!==e.maskUnlockColorId&&e.maskUnlockColorId>0&&void 0!==e.maskUnlockCount&&e.maskUnlockCount>0&&o.setMask(e.maskUnlockColorId,e.maskUnlockCount),e.type!==f.CupType.Frozen&&e.type!==f.CupType.BombFrozen&&e.type!==f.CupType.Temp1Frozen||void 0===e.frozenUnlockCount||o.setFrozenUnlockCount(e.frozenUnlockCount),e.type===f.CupType.Lock&&void 0!==e.lockType&&o.setUpLock(e.lockType),e.type===f.CupType.SingleColor&&void 0!==e.singleColorId&&(o.singleColorId=e.singleColorId),e.type!==f.CupType.Bomb&&e.type!==f.CupType.BombFixed&&e.type!==f.CupType.BombFrozen&&e.type!==f.CupType.BombMasked||void 0===e.bombTime||o.setBombTime(e.bombTime),e.type===f.CupType.Absorb&&o.setAbsorbArray(e.absorbArray||[]),void 0!==e.capacity&&o.setCapacity(e.capacity),this.cupManager.cups.push(o),this.cupManager.setUpCup(e,o)}},t.prototype.createOneCup=function(e,t){var o;switch(e.type){case f.CupType.Locked:o=this.cupPrefab_AD;break;case f.CupType.Fixed:o=this.cupPrefab_Fixed;break;case f.CupType.Frozen:o=this.cupPrefab_Frozen;break;case f.CupType.Masked:o=this.cupPrefab_Masked;break;case f.CupType.SingleColor:o=this.cupPrefab_SingleColor;break;case f.CupType.Bomb:o=this.cupPrefab_Bomb;break;case f.CupType.Temp1:o=this.cupPrefab_Temp1;break;case f.CupType.Temp1AD:o=this.cupPrefab_Temp1AD;break;case f.CupType.Absorb:o=this.cupPrefab_Absorb;break;case f.CupType.BombFixed:o=this.cupPrefab_BombFixed;break;case f.CupType.BombFrozen:o=this.cupPrefab_BombFrozen;break;case f.CupType.BombMasked:o=this.cupPrefab_BombMasked;break;case f.CupType.Temp1Frozen:o=this.cupPrefab_Temp1Frozen;break;case f.CupType.ChangeColor:o=this.cupPrefab_ChangeColor;break;case f.CupType.Lock:o=this.cupPrefab_Lock;break;default:o=this.cupPrefab}var n=cc.instantiate(o);n.parent=t,n.setPosition(e.pos.x,e.pos.y);var i=n.getComponent(f.default);return i&&(i.initDefault(),i.setCupType(e.type),e.colorIds&&e.colorIds.length>0&&(e.colorIds.filter(function(e){return 0!==e}).length,i.setUpKey(e.colorIds),i.setColorIds(e.colorIds)),e.type===f.CupType.Lock&&void 0!==e.lockType&&i.setUpLock(e.lockType),e.type!==f.CupType.Frozen&&e.type!==f.CupType.BombFrozen&&e.type!==f.CupType.Temp1Frozen||void 0===e.frozenUnlockCount||i.setFrozenUnlockCount(e.frozenUnlockCount),e.type===f.CupType.Masked&&void 0!==e.maskUnlockColorId&&void 0!==e.maskUnlockCount&&(i.setMaskUnlockColor(e.maskUnlockColorId),i.setMaskUnlockCount(e.maskUnlockCount)),e.type===f.CupType.SingleColor&&void 0!==e.singleColorId&&(i.singleColorId=e.singleColorId),e.type!==f.CupType.Bomb&&e.type!==f.CupType.BombFixed&&e.type!==f.CupType.BombFrozen&&e.type!==f.CupType.BombMasked||void 0===e.bombTime||i.setBombTime(e.bombTime),e.type===f.CupType.Absorb&&i.setAbsorbArray(e.absorbArray||[]),this.cupManager.setUpCup(e,i)),i},t.prototype.resetCup=function(e,t){e.initDefault(),e.setCupType(t.type),t.colorIds&&t.colorIds.length>0&&(t.colorIds.filter(function(e){return 0!==e}).length,e.setColorIds(t.colorIds)),t.type===f.CupType.Frozen&&void 0!==t.frozenUnlockCount?e.setFrozenUnlockCount(t.frozenUnlockCount):t.type===f.CupType.Masked&&void 0!==t.maskUnlockColorId&&void 0!==t.maskUnlockCount&&(e.setMaskUnlockColor(t.maskUnlockColorId),e.setMaskUnlockCount(t.maskUnlockCount)),this.cupManager.setUpCup(t,e)},t.prototype.getRingFightLevel=function(){for(var e=new Date,t=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate(),o=0,n=0;n<t.length;n++)o=(o<<5)-o+t.charCodeAt(n),o&=o;return(o=Math.abs(o))%105+1},t.instance=null,t.level_ringFight=1,t.isRestartRingFight=!1,l([v(h.default)],t.prototype,"cupManager",void 0),l([v(cc.Prefab)],t.prototype,"cupPrefab",void 0),l([v(cc.Prefab)],t.prototype,"cupPrefab_AD",void 0),l([v(cc.Prefab)],t.prototype,"cupPrefab_Fixed",void 0),l([v(cc.Prefab)],t.prototype,"cupPrefab_Frozen",void 0),l([v(cc.Prefab)],t.prototype,"cupPrefab_Masked",void 0),l([v(cc.Prefab)],t.prototype,"cupPrefab_SingleColor",void 0),l([v(cc.Prefab)],t.prototype,"cupPrefab_Bomb",void 0),l([v(cc.Prefab)],t.prototype,"cupPrefab_Temp1",void 0),l([v(cc.Prefab)],t.prototype,"cupPrefab_Temp1AD",void 0),l([v(cc.Prefab)],t.prototype,"cupPrefab_Absorb",void 0),l([v(cc.Prefab)],t.prototype,"cupPrefab_BombFixed",void 0),l([v(cc.Prefab)],t.prototype,"cupPrefab_BombFrozen",void 0),l([v(cc.Prefab)],t.prototype,"cupPrefab_BombMasked",void 0),l([v(cc.Prefab)],t.prototype,"cupPrefab_Temp1Frozen",void 0),l([v(cc.Prefab)],t.prototype,"cupPrefab_ChangeColor",void 0),l([v(cc.Prefab)],t.prototype,"cupPrefab_Lock",void 0),o=l([g],t)}(cc.Component);r.default=_,cc._RF.pop(),cc._RF.pop()},{}],LevelPreGenerator_BP:[function(e,t,o){"use strict";cc._RF.push(t,"ac0fb4LNwpC7axkdFxuLcs4","LevelPreGenerator_BP");var n=e,i=t,r=o;cc._RF.push(i,"ac0fb4LNwpC7axkdFxuLcs4","LevelPreGenerator_BP"),Object.defineProperty(r,"__esModule",{value:!0}),r.LevelPreGenerator_BP=void 0;var a=n("LevelDataMgr_BP"),c=function(){function e(){}return e.preGenerateLevels=function(e,t){var o=Date.now(),n=0,i=0;cc.log("\u5f00\u59cb\u9884\u751f\u6210\u5173\u5361 "+e+"-"+t+"...");for(var r=e;r<=t;r++){var c=a.LevelDataMgr_BP.getLevelData(r);c?(n++,cc.log("\u2713 \u5173\u5361 "+r+" \u9884\u751f\u6210\u5b8c\u6210 ("+c.solutionSteps+" \u6b65)")):(i++,cc.warn("\u2717 \u5173\u5361 "+r+" \u9884\u751f\u6210\u5931\u8d25"))}var s=Date.now()-o;cc.log("\u9884\u751f\u6210\u5b8c\u6210\uff01\u6210\u529f: "+n+", \u5931\u8d25: "+i+", \u8017\u65f6: "+s+"ms")},e.regenerateLevel=function(e){cc.log("\u91cd\u65b0\u751f\u6210\u5173\u5361 "+e+"..."),a.LevelDataMgr_BP.clearLevelCache(e);var t=a.LevelDataMgr_BP.getLevelData(e);t?cc.log("\u2713 \u5173\u5361 "+e+" \u91cd\u65b0\u751f\u6210\u5b8c\u6210 ("+t.solutionSteps+" \u6b65)"):cc.warn("\u2717 \u5173\u5361 "+e+" \u91cd\u65b0\u751f\u6210\u5931\u8d25")},e.getGenerationStats=function(){return{cachedLevels:a.LevelDataMgr_BP.getCachedLevelCount()}},e}();r.LevelPreGenerator_BP=c,window.LevelPreGenerator=c,cc._RF.pop(),cc._RF.pop()},{}],LevelSelectPanel_BP:[function(e,t,o){"use strict";cc._RF.push(t,"849bfZcubdKza+RdWiPX1k2","LevelSelectPanel_BP");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"849bfZcubdKza+RdWiPX1k2","LevelSelectPanel_BP");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("GameManager_BP"),p=n("LevelDataMgr_BP"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.levelInput=null,t.btn_Jump=null,t.btn_Close=null,t.tips_Label=null,t}return s(t,e),t.prototype.onLoad=function(){this.btn_Jump&&this.btn_Jump.on(cc.Node.EventType.TOUCH_END,this.onJumpClick,this),this.btn_Close&&this.btn_Close.on(cc.Node.EventType.TOUCH_END,this.onCloseClick,this),this.levelInput&&this.levelInput.node.on("editing-return",this.onJumpClick,this)},t.prototype.onEnable=function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},t.prototype.onDisable=function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},t.prototype.onKeyDown=function(e){e.keyCode===cc.macro.KEY.enter&&this.onJumpClick()},t.prototype.show=function(){this.node.active=!0,this.levelInput&&(this.levelInput.string=""),this.updateTips("")},t.prototype.hide=function(){this.node.active=!1},t.prototype.onJumpClick=function(){if(this.levelInput){var e=this.levelInput.string.trim();if(e){var t=parseInt(e,10);if(isNaN(t)||t<=0)this.updateTips("\u8bf7\u8f93\u5165\u6709\u6548\u7684\u5173\u5361\u53f7");else if(p.LevelDataMgr_BP.getLevelData(t)){var o=u.default.instance;o?(o.jumpToLevel(t),this.updateTips("\u5df2\u8df3\u8f6c\u5230\u7b2c "+t+" \u5173")):this.updateTips("GameManager \u672a\u521d\u59cb\u5316")}else this.updateTips("\u5173\u5361 "+t+" \u4e0d\u5b58\u5728")}else this.updateTips("\u8bf7\u8f93\u5165\u5173\u5361\u53f7")}else this.updateTips("\u8f93\u5165\u6846\u672a\u7ed1\u5b9a")},t.prototype.onCloseClick=function(){this.hide()},t.prototype.updateTips=function(e){this.tips_Label&&(this.tips_Label.string=e)},t.prototype.onLevelCompleteClick=function(){var e=u.default.instance;e?(e.notifyLevelComplete(),this.updateTips("\u5df2\u89e6\u53d1\u5173\u5361\u5b8c\u6210\uff08\u6d4b\u8bd5\u7528\uff09")):this.updateTips("GameManager \u672a\u521d\u59cb\u5316")},l([h(cc.EditBox)],t.prototype,"levelInput",void 0),l([h(cc.Node)],t.prototype,"btn_Jump",void 0),l([h(cc.Node)],t.prototype,"btn_Close",void 0),l([h(cc.Label)],t.prototype,"tips_Label",void 0),l([f],t)}(cc.Component);r.default=y,cc._RF.pop(),cc._RF.pop()},{}],LevelSolver_BP:[function(e,t,o){"use strict";cc._RF.push(t,"e45eb0HaZlAdpuuWmyA862p","LevelSolver_BP");var n=t,i=o;cc._RF.push(n,"e45eb0HaZlAdpuuWmyA862p","LevelSolver_BP");var r=function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<o;t++)for(var r=arguments[t],a=0,c=r.length;a<c;a++,i++)n[i]=r[a];return n};Object.defineProperty(i,"__esModule",{value:!0}),i.LevelSolver_BP=void 0;var a=function(){function e(){}return e.solve=function(e,t,o,n){void 0===n&&(n=5e3);var i=o.join(","),a=[{state:e.slice(),path:[]}],c=new Set;c.add(e.join(","));for(var s=performance.now(),l=0;a.length>0;){if(l%100==0&&performance.now()-s>n)return cc.warn("[Solver] \u8d85\u65f6\uff1a\u521d\u59cb="+JSON.stringify(e)+", \u76ee\u6807="+JSON.stringify(o)+", \u5df2\u63a2\u7d22"+l+"\u4e2a\u72b6\u6001, \u961f\u5217\u957f\u5ea6"+a.length),null;var u=a.shift(),p=u.state,d=u.path;if(l++,p.join(",")===i)return d;for(var f=0;f<p.length;f++)if(0!==p[f])for(var h=0;h<p.length;h++)if(f!==h&&p[h]!==t[h]){var y=p[f],m=t[h]-p[h],g=Math.min(y,m),v=p.slice();v[f]-=g,v[h]+=g;var _=v.join(",");if(!c.has(_)){c.add(_);var S=r(d,[{from:f,to:h,amount:g}]);S.length<=50&&a.push({state:v,path:S})}}}return null},e.isSolvable=function(e,t,o){return null!==this.solve(e,t,o)},e.getSolutionSteps=function(e,t,o){var n=this.solve(e,t,o);return n?n.length:-1},e}();i.LevelSolver_BP=a,cc._RF.pop(),cc._RF.pop()},{}],LoadScene:[function(e,t,o){"use strict";cc._RF.push(t,"bdde6dOXGdFO4ABFZmW8+RO","LoadScene");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"bdde6dOXGdFO4ABFZmW8+RO","LoadScene");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=n("const"),d=n("GameManager"),f=n("StaminaManager"),h=n("config"),y=n("CollectionManager"),m=n("LevelData"),g=n("UnlockData"),v=n("GoldDataManager"),_=n("DataNexusSDK"),S=n("ThemeDataManager"),b=n("FinishEffectDataManager"),C=n("RingFightManager"),P=cc._decorator,k=P.ccclass,w=P.property,I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.progressBar=null,t.Slider=null,t.label=null,t.sliderBar=null,t.slider=null,t.sliders=null,t.sliderLabelOutline=null,t.barLength=585,t.startX=0,t.ifSubpackageLoaded=!1,t.ifLoadPause=!0,t.subPackageName=["Texture","TextureMain","TextureSideMode","ThemeInGame","Animation","Audio","SpineEffectPrefab","Effect","Font","Panels","Prefabs","Scene","WaterSortConfig","Theme","RingFight"],t.targetProgress=0,t.currentPhase="subpackage",t}return s(t,e),t.prototype.ABTest=function(){if(h.currentPlatform===h.platformEnum.wechat&&!cc.sys.isBrowser){var e=wx.getExptInfoSync(["expt_1770370055","expt_1770370239","expt_1770349402"]);void 0===e.expt_1770370055||"0"==e.expt_1770370055?u.default.ifTestingB=!1:"1"==e.expt_1770370055?u.default.ifTestingB=!0:u.default.ifTestingB=!1,void 0===e.expt_1770370239||"0"==e.expt_1770370239?u.default.ifTestingC=!1:"1"==e.expt_1770370239?u.default.ifTestingC=!0:u.default.ifTestingC=!1,void 0===e.expt_1770349402||"0"==e.expt_1770349402?u.default.ifTestingD=!1:"1"==e.expt_1770349402?u.default.ifTestingD=!0:u.default.ifTestingD=!1}},t.prototype.onLoad=function(){console.log=function(){},console.warn=function(){};var e=cc.find("Canvas").getComponent(cc.Canvas),t=cc.view.getVisibleSize().height,o=cc.view.getVisibleSize().width;cc.sys.isBrowser||(h.currentPlatform===h.platformEnum.wechat?(t=wx.getWindowInfo().windowHeight,o=wx.getWindowInfo().windowWidth):h.currentPlatform===h.platformEnum.toutiao&&(t=tt.getSystemInfoSync().windowHeight,o=tt.getSystemInfoSync().windowWidth)),u.default.start_time=Date.now(),u.default.ratio=t/o,cc.sys.isBrowser&&(u.default.ratio=1),u.default.ratio<1670/750?(e.fitHeight=!0,e.fitWidth=!1):(e.fitHeight=!1,e.fitWidth=!0),"windows"===u.default.platform&&(e.fitHeight=!0,e.fitWidth=!1),u.default.mode="normal",this.calculateWinStreak(),this.ABTest(),this.initDNSDK(),cc.sys.isBrowser&&g.default.initUnlockArray(),u.default.isToday(u.default.LastChallengeDate)||(u.default.LastChallengeDate=u.default.getTodayDate(),u.default.FreeChallengeTimes=2),u.default.Level<=3&&(d.default._firstLoginTime=Date.now()),d.default.platform.init()},t.prototype.initDNSDK=function(){h.currentPlatform!=h.platformEnum.wechat||cc.sys.isBrowser||_.default.instance.init()},t.prototype.calculateWinStreak=function(){for(var e=0;e<y.default.unlockCapByWinStreakArray.length;e++)if(u.default.WinStreak>=y.default.unlockCapByWinStreakArray[e]){var t=y.default.unlockCapByWinStreakArrayIndex[e];y.default.CurrentCapByWinStreakIndex=e+2,y.default.setCapUnlockMap(t,!0)}for(e=0;e<y.default.unlockCharacterByWinStreakArray.length;e++)u.default.WinStreak>=y.default.unlockCharacterByWinStreakArray[e]&&(t=y.default.unlockCharacterByWinStreakArrayIndex[e],y.default.CurrentCharacterByWinStreakIndex=e+2,y.default.setCharacterUnlockMap(t,!0))},t.prototype.calculateDrops=function(){if(0!=u.default.UnlockDrops){var e=u.default.UnlockDrops/500;u.default.CurrentUnlockIndex+=e,u.default.UnlockDrops=0}},t.prototype.start=function(){this.startX=this.Slider.position.x,this.loadStart(),d.default.platform.reportPageEvent("LoadPage"),d.default.platform.reportCollectionEvent("CapCurrent",y.default.SelectedCapIndex.toString(),"",""),d.default.platform.reportCollectionEvent("CharacterCurrent",y.default.SelectedCharacterIndex.toString(),"",""),d.default.platform.reportCollectionEvent("ThemeCurrent",S.default.CurrentSelectedThemeIndex.toString(),"",""),d.default.platform.reportCollectionEvent("EffectCurrent",b.default.CurrentFinishEffectIndex.toString(),"",""),u.default.isToday(u.default.LastWinStreakDate)||(d.default.platform.reportAdPointEvent("WinProgress_Day",u.default.WinStreak),d.default.platform.reportCollectionEvent("GoldNum",v.default.Gold.toString(),"",""),u.default.LastWinStreakDate=u.default.getTodayDate()),y.default.reportUnlockProgress(),this.targetProgress=0},t.prototype.loadStart=function(){this.ifLoadPause=!1,this.loadData(),f.default.instance.init();var e=this;this.loadSubPackages(function(){console.error("\u5206\u5305\u52a0\u8f7d\u5b8c\u6210,\u8017\u65f6",Date.now()-u.default.start_time,"ms"),e.targetProgress=.9,e.ifSubpackageLoaded=!0})},t.prototype.loadData=function(){u.default.loadChallengeLevel()},t.prototype.loadSubPackages=function(e){for(var t=[],o=this,n=0;n<this.subPackageName.length;n++){if(u.default.CurrentUnlockIndex<=48){if("Drink2"===this.subPackageName[n])continue;if("Drink3"===this.subPackageName[n])continue}else if(u.default.CurrentUnlockIndex<=99&&"Drink3"===this.subPackageName[n])continue;t.push(this.loadModeBundle(this.subPackageName[n],function(){o.targetProgress+=.04}))}Promise.all(t).then(function(){e()})},t.prototype.loadModeBundle=function(e,t){return new Promise(function(o,n){cc.assetManager.loadBundle(e,function(i,r){if("WaterSortConfig"===e&&r.load("level/config",cc.JsonAsset,function(e,t){e||m.default.loadLevelData(t)}),"ThemeInGame"===e){var a=S.default.CurrentSelectedThemeIndex;r.load(a.toString(),cc.SpriteFrame)}i&&(console.error(e,"loadFailed",i),n(i)),t&&(t(),o(null))})})},t.prototype.loadScene=function(){var e=this,t=p.SceneNames.Game;u.default.sceneId&&"3041"===u.default.sceneId.toString().slice(-4)?t=p.SceneNames.Game:u.default.isNewPlayer&&h.currentPlatform!=h.platformEnum.wechat&&(t=p.SceneNames.Game,u.default.LastGetDailyEnergyDate=u.default.getTodayDate(),u.default.isNewPlayer=!1),u.default.ifTestingC&&u.default.Level>3&&!u.default.isToday(u.default.LastLoadSceneDate)&&(u.default.LastLoadSceneDate=u.default.getTodayDate(),t=p.SceneNames.Main),h.currentPlatform==h.platformEnum.wechat&&C.default.instance.isChallenger&&(t=p.SceneNames.RingFight),cc.director.preloadScene(t,function(t,o){var n=.9+t/o*.1;n>1&&(n=1),e.targetProgress=n},function(){e.targetProgress=1,h.currentPlatform===h.platformEnum.toutiao&&(u.default.finish_time=Date.now()),e.scheduleOnce(function(){h.currentPlatform==h.platformEnum.wechat&&C.default.instance.isChallenger?cc.director.loadScene(p.SceneNames.RingFight):cc.director.loadScene(t)},0)})},t.prototype.update=function(e){var t=.1;this.targetProgress>.95&&(t=2+1*(this.targetProgress-this.progressBar.progress)),this.progressBar.progress=cc.misc.lerp(this.progressBar.progress,this.targetProgress,e*t),Math.abs(this.progressBar.progress-this.targetProgress)<.001&&(this.progressBar.progress=this.targetProgress),this.progressBar.progress>.99&&(this.progressBar.progress=1),this.label.string=Math.floor(100*this.progressBar.progress)+"%";var o=this.startX+this.progressBar.progress*this.barLength;o<this.startX+10&&(o=this.startX+10),this.Slider.setPosition(cc.v2(o,this.Slider.position.y)),"subpackage"===this.currentPhase&&this.ifSubpackageLoaded&&(this.currentPhase="scene",this.loadScene())},l([w(cc.ProgressBar)],t.prototype,"progressBar",void 0),l([w(cc.Node)],t.prototype,"Slider",void 0),l([w(cc.Label)],t.prototype,"label",void 0),l([w(cc.Sprite)],t.prototype,"sliderBar",void 0),l([w(cc.Sprite)],t.prototype,"slider",void 0),l([w(cc.SpriteFrame)],t.prototype,"sliders",void 0),l([w(cc.LabelOutline)],t.prototype,"sliderLabelOutline",void 0),l([k],t)}(cc.Component);r.default=I,cc._RF.pop(),cc._RF.pop()},{}],LockCup:[function(e,t,o){"use strict";cc._RF.push(t,"f90fbHj8mBO/rk2NaSbBAgr","LockCup");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"f90fbHj8mBO/rk2NaSbBAgr","LockCup");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("const"),p=n("Cup"),d=cc._decorator,f=d.ccclass,h=d.property,y=["tong","yin","jin"],m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lockAnimation=null,t.lockCap=null,t.lockCapFrames=[],t.blockInputNode=null,t.lockType=0,t}return s(t,e),t.prototype.onEnable=function(){cc.director.on(u.EventNames.RevealKey,this.unlockLockCup,this)},t.prototype.onDisable=function(){cc.director.off(u.EventNames.RevealKey,this.unlockLockCup,this)},t.prototype.setUpLock=function(e){this.cupType=p.CupType.Lock,this.lockType=e,this.lockAnimation.setSkin(y[this.lockType-1]),this.lockCap.spriteFrame=this.lockCapFrames[this.lockType-1]},t.prototype.unlockLockCup=function(e,t){var o=this;this.node.parent===t&&this.lockType===e&&(this.lockAnimation.setAnimation(0,"acition",!1),cc.tween(this.node).delay(.55).by(.05,{x:5}).by(.1,{x:-10}).by(.1,{x:10}).by(.05,{x:-5}).start(),cc.tween(this.lockCap.node).delay(.55).to(.3,{y:this.lockCap.node.y+100,opacity:0},{easing:"sineIn"}).call(function(){o.lockCap.node.active=!1}).start(),this.lockAnimation.setCompleteListener(function(){o.blockInputNode.active=!1,o.cupType=p.CupType.Normal,cc.director.emit(u.EventNames.DoPour)}))},l([h(sp.Skeleton)],t.prototype,"lockAnimation",void 0),l([h(cc.Sprite)],t.prototype,"lockCap",void 0),l([h([cc.SpriteFrame])],t.prototype,"lockCapFrames",void 0),l([h(cc.Node)],t.prototype,"blockInputNode",void 0),l([f],t)}(p.default);r.default=m,cc._RF.pop(),cc._RF.pop()},{}],LosePanel_RF:[function(e,t,o){"use strict";cc._RF.push(t,"690c0yaMT1J2YA7jZqewzys","LosePanel_RF");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"690c0yaMT1J2YA7jZqewzys","LosePanel_RF");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("LevelManager"),d=n("const"),f=n("BasePanel"),h=n("GameManager_RF"),y=n("RingFightManager"),m=cc._decorator,g=m.ccclass,v=m.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label_time=null,t}return s(t,e),t.prototype.onEnable=function(){y.default.instance.fullUpdate(h.default.instance.time),this.label_time.string="\u672c\u6b21\u8017\u65f6\uff1a"+h.default.instance.text_time.string},t.prototype.onBtn_Home=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),cc.director.loadScene(d.SceneNames.Main)},t.prototype.onBtn_Create=function(){u.default.instance.playSFX(u.AudioRef.ClickButton)},t.prototype.onBtn_MoreGame=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),cc.director.loadScene(d.SceneNames.Game)},t.prototype.onBtn_Restart=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),p.default.isRestartRingFight=!0,cc.director.loadScene(d.SceneNames.RingFight)},l([v(cc.Label)],t.prototype,"label_time",void 0),l([g],t)}(f.default);r.default=_,cc._RF.pop(),cc._RF.pop()},{}],LosePanel:[function(e,t,o){"use strict";cc._RF.push(t,"bd658XhPwhMGoia6Fce3s+G","LosePanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"bd658XhPwhMGoia6Fce3s+G","LosePanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("BasePanel"),d=cc._decorator,f=d.ccclass,h=(d.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.onBtn_Restart=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),cc.director.loadScene(cc.director.getScene().name)},t.prototype.onBtn_Home=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),cc.director.loadScene("Main")},l([f],t)}(p.default));r.default=h,cc._RF.pop(),cc._RF.pop()},{}],MainDialogue:[function(e,t,o){"use strict";cc._RF.push(t,"64fd88eqvVLKZU6aHbl3f8z","MainDialogue");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"64fd88eqvVLKZU6aHbl3f8z","MainDialogue");var a,c=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(i,"__esModule",{value:!0});var l=cc._decorator,u=l.ccclass,p=l.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delayTime=.5,t.isTweening=!1,t}return c(t,e),t.prototype.onEnable=function(){var e=this;this.isTweening=!0,this.node.scale=0,cc.tween(this.node).delay(this.delayTime).call(function(){e.setAnchorPoint(0,0)}).to(.5,{scale:1},{easing:"backOut"}).call(function(){e.setAnchorPoint(.5,.5)}).to(.1,{rotation:5}).to(.1,{rotation:-5}).to(.1,{rotation:5}).to(.1,{rotation:-5}).to(.1,{rotation:0}).delay(.8).call(function(){e.setAnchorPoint(0,0)}).to(.3,{scale:0}).call(function(){e.isTweening=!1,e.node.active=!1}).start()},t.prototype.setAnchorPoint=function(e,t){var o=this.node.width,n=this.node.height,i=this.node.getAnchorPoint(),r=(e-i.x)*o,a=(t-i.y)*n;this.node.setAnchorPoint(e,t),this.node.x+=r,this.node.y+=a,this.node.children.forEach(function(e){e.x-=r,e.y-=a})},s([p({type:cc.Float})],t.prototype,"delayTime",void 0),s([u],t)}(cc.Component);i.default=d,cc._RF.pop(),cc._RF.pop()},{}],MainLevelText:[function(e,t,o){"use strict";cc._RF.push(t,"959003KZK9MgoE59cCmyLKP","MainLevelText");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"959003KZK9MgoE59cCmyLKP","MainLevelText");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.labelOutline=null,t.sprite=null,t.spriteFrames=[],t}return s(t,e),t.prototype.start=function(){u.default.Level>=30&&u.default.Level%10==0?this.setHell():u.default.Level%5==0?this.setHard():this.setNormal()},t.prototype.setNormal=function(){this.sprite.spriteFrame=this.spriteFrames[0],this.labelOutline.color=(new cc.Color).fromHEX("#9B5700"),this.label.node.color=(new cc.Color).fromHEX("#FFE659"),this.label.node.y=-25},t.prototype.setHard=function(){this.sprite.spriteFrame=this.spriteFrames[1],this.labelOutline.color=(new cc.Color).fromHEX("#2e0654"),this.label.node.color=cc.Color.WHITE,this.label.node.y=-30},t.prototype.setHell=function(){this.sprite.spriteFrame=this.spriteFrames[2],this.labelOutline.color=(new cc.Color).fromHEX("#670404"),this.label.node.color=cc.Color.WHITE,this.label.node.y=-25},l([f(cc.Label)],t.prototype,"label",void 0),l([f(cc.LabelOutline)],t.prototype,"labelOutline",void 0),l([f(cc.Sprite)],t.prototype,"sprite",void 0),l([f([cc.SpriteFrame])],t.prototype,"spriteFrames",void 0),l([d],t)}(cc.Component);r.default=h,cc._RF.pop(),cc._RF.pop()},{}],MainScene:[function(e,t,o){"use strict";cc._RF.push(t,"e2f4bOGFQVPoI3XESicR8Mi","MainScene");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"e2f4bOGFQVPoI3XESicR8Mi","MainScene");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=n("UIManager"),d=n("GameManager"),f=n("config"),h=n("AudioManager"),y=n("toutiao"),m=n("StaminaManager"),g=n("const"),v=n("BundleManager"),_=n("DataManager"),S=n("Rankdata"),b=n("DataNexusSDK"),C=n("DataNexusEnum"),P=n("CollectionManager"),k=n("ThemeDataManager"),w=cc._decorator,I=w.ccclass,T=w.property,A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.text_level=null,t.text_level_chanllenge=null,t.uiManager=null,t.sidebarBtn=null,t.sidebarBtnWx=null,t.addDesktopBtn=null,t.addDesktopRewardDialog=null,t.gameClubBtn=null,t.groupChatBtn=null,t.ringFightBtn=null,t.beginnerTaskBtn=null,t.tips=null,t}return s(t,e),t.prototype.onLoad=function(){u.default.FreeChallengeTimes<=0&&b.default.instance.trackAdPlacementShow(C.RewardADEvent.UNLOCK_LEVEL);var e=cc.find("Canvas").getComponent(cc.Canvas);cc.director.on(g.EventNames.GetSidebarReward,this.hideSidebarButton,this),cc.director.on(g.EventNames.GetAddDesktopReward,this.hideAddDesktopButton,this),cc.director.on(g.EventNames.ShowMainGameClubButton,this.showGameClubButton,this),cc.director.on(g.EventNames.CreateMainGameClubButton,this.createGameClubButton,this),cc.director.on(g.EventNames.PlayCupTutorial,this.showCupTutorial,this),u.default.ratio<1670/750?(e.fitHeight=!0,e.fitWidth=!1):(e.fitHeight=!1,e.fitWidth=!0),"windows"===u.default.platform&&(e.fitHeight=!0,e.fitWidth=!1),b.default.instance.trackHomepageView()},t.prototype.onDestroy=function(){cc.director.off(g.EventNames.GetSidebarReward,this.hideSidebarButton,this),cc.director.off(g.EventNames.GetAddDesktopReward,this.hideAddDesktopButton,this),cc.director.off(g.EventNames.ShowMainGameClubButton,this.showGameClubButton,this),cc.director.off(g.EventNames.PlayCupTutorial,this.showCupTutorial,this),window.wx&&window.wx.offShow(this.GetGameClubReward)},t.prototype.start=function(){var e=this;_.default.tryUpdateUserData(),S.default.syncChallengeRecord(),d.default.platform.reportPageEvent("HomePage"),h.default.instance.init(function(){h.default.instance.playBGM(h.AudioRef.HomeBGM,!0),e.initBGMListener()}),cc.director.preloadScene("Game"),this.CheckSidebar(),this.CheckSidebarWX(),this.CheckAddDesktop(),this.CheckGameClub(),this.CheckGameClubDailyReward(),this.CheckShowUpdate(),this.CheckGroupChatBtn(),this.checkRingFightButton(),this.checkBeginnerTask(),this.text_level.string="\u7b2c "+u.default.Level+" \u5173";var t=Math.max(u.default.FreeChallengeTimes,0);this.text_level_chanllenge.string="\u514d\u8d39\u6b21\u6570"+t+"/2",this.releaseSideModes()},t.prototype.CheckGroupChatBtn=function(){"wxeb3a3f764474c346"===u.default.appId||"tt4323359edc288b3202"===u.default.appId?this.groupChatBtn.active=!0:this.groupChatBtn.active=!1},t.prototype.CheckShowUpdate=function(){u.default.Level>=5&&!u.default.subUpdateNotice&&u.default.inGameShowSubUpdateNoticeTimes<=0&&!u.default.isToday(u.default.LastShowSubUpdateDate)&&(u.default.LastShowSubUpdateDate=u.default.getTodayDate(),d.default.platform.showSubGameUpdate(),u.default.inGameShowSubUpdateNoticeTimes--)},t.prototype.CheckGameClubDailyReward=function(){f.currentPlatform===f.platformEnum.wechat&&window.wx&&window.wx.onShow(this.GetGameClubReward)},t.prototype.GetGameClubReward=function(){if(f.currentPlatform===f.platformEnum.wechat&&window.wx){var e=[];new Promise(function(t,o){window.wx.request({url:"https://api.flysheeep.com/api/tapaway/get_gift",header:{"Content-Type":"application/json;charset=utf-8","x-appid":u.default.appId},data:{openid:u.default.openId},method:"POST",success:function(o){var n=o.data.data;if(n.gifts)for(var i=0,r=n.gifts;i<r.length;i++){var a=r[i];e.push(a.OrderId);for(var c=0,s=a.GoodsList;c<s.length;c++){var l=s[c];d.default.claimRewardFromServer(l.Id,l.Num)}}t()},fail:function(e){console.error("------------get openid---------fail-------",e),o()}})}).then(function(){e.length>0&&d.default.DeleteGameClubRewardHistory(e)})}},t.prototype.CheckGameClub=function(){"wxeb3a3f764474c346"===u.default.appId&&f.currentPlatform===f.platformEnum.wechat?(this.gameClubBtn.active=!0,this.createGameClubButton()):this.gameClubBtn.active=!1},t.prototype.showGameClubButton=function(e){f.currentPlatform!==f.platformEnum.wechat||cc.sys.isBrowser||(u.default.IfGetGameClubReward&&e?d.default.showGameClubButton():d.default.hideGameClubButton())},t.prototype.checkRingFightButton=function(){f.currentPlatform===f.platformEnum.wechat?cc.sys.isBrowser?this.ringFightBtn.active=!0:(this.ringFightBtn.active=d.default.compareVersion(wx.getAppBaseInfo().SDKVersion,"3.10.1")>=0,"ios"===wx.getDeviceInfo().platform||"android"===wx.getDeviceInfo().platform||"ohos"===wx.getDeviceInfo().platform?this.ringFightBtn.active=!0:this.ringFightBtn.active=!1):this.ringFightBtn.active=!1},t.prototype.checkBeginnerTask=function(){u.default.Level>=7&&0==k.default.ThemeUnlockMap["11_1"]?this.beginnerTaskBtn.active=!1:u.default.Level-1>=3&&u.default.Level-1<17?this.beginnerTaskBtn.active=!0:this.beginnerTaskBtn.active=!1},t.prototype.createGameClubButton=function(){f.currentPlatform!==f.platformEnum.wechat||cc.sys.isBrowser||u.default.IfGetGameClubReward&&d.default.createGameClubButton(this.gameClubBtn)},t.prototype.CheckAddDesktop=function(){f.currentPlatform===f.platformEnum.toutiao?(y.checkShortcut(),u.default.ifAddDesktop?this.addDesktopBtn.active=!1:this.addDesktopBtn.active=!0,u.default.ifAddDesktopReward):this.addDesktopBtn.active=!1},t.prototype.CheckSidebarWX=function(){if("wxeb3a3f764474c346"===u.default.appId)if(f.currentPlatform===f.platformEnum.wechat){var e=this,t=!1;if(u.default.SideBarRewardCount>7)this.sidebarBtnWx.active=!1;else if(u.default.ifOpenBySidebar&&!u.default.isToday(u.default.LastGetRewardDate)&&(t=!0),u.default.isToday(u.default.LastGetRewardDate))this.sidebarBtnWx.active=!1;else{if(window.wx&&f.currentPlatform===f.platformEnum.wechat&&window.wx.onShow(function(t){console.error(t),1103!=t.scene&&1104!=t.scene&&1001!=t.scene&&1089!=t.scene&&1257!=t.scene&&1271!=t.scene||(u.default.ifOpenBySidebar=!0,console.error("\u6765\u81ea\u5fae\u4fe1\u4fa7\u8fb9\u680f"),u.default.isToday(u.default.LastGetRewardDate))||e.uiManager.showPanel("WxSidebarPanel")}),f.currentPlatform===f.platformEnum.wechat){e.sidebarBtnWx.active=!0;var o=d.default.platform.getLaunchOptions();if((1103==o||1104==o||1001==o||1089==o||1257==o||1271==o)&&(u.default.ifOpenBySidebar=!0,!u.default.isToday(u.default.LastGetRewardDate)))return void e.uiManager.showPanel("WxSidebarPanel")}else e.sidebarBtnWx.active=!1;t&&e.uiManager.showPanel("WxSidebarPanel")}}else this.sidebarBtnWx.active=!1;else this.sidebarBtnWx.active=!1},t.prototype.CheckSidebar=function(){if(f.currentPlatform===f.platformEnum.toutiao){var e=this,t=!1;u.default.SideBarRewardCount>7||u.default.isToday(u.default.LastGetRewardDate)?this.sidebarBtn.active=!1:(u.default.ifOpenBySidebar&&!u.default.isToday(u.default.LastGetRewardDate)&&(t=!0),u.default.isFirstTimeReturnToMain&&u.default.isReturnToMain&&(u.default.isFirstTimeReturnToMain=!1,t=!0,u.default.isReturnToMain=!1),u.default.isToday(u.default.LastGetRewardDate)&&(t=!1),window.tt&&f.currentPlatform===f.platformEnum.toutiao&&window.tt.onShow(function(t){"homepage"===t.launch_from&&"sidebar_card"===t.location&&(u.default.ifOpenBySidebar=!0,u.default.isToday(u.default.LastGetRewardDate)||e.uiManager.showPanel("SidebarPanel"))}),f.currentPlatform===f.platformEnum.toutiao?d.default.platform.checkSidebarState().then(function(){e.sidebarBtn.active=!0,"021036"===d.default.platform.getLaunchOptions("scene")&&(u.default.ifOpenBySidebar=!0,u.default.isToday(u.default.LastGetRewardDate)||e.uiManager.showPanel("SidebarPanel"))}).catch(function(){e.sidebarBtn.active=!1}):e.sidebarBtn.active=!1,t&&e.uiManager.showPanel("SidebarPanel"))}else this.sidebarBtn.active=!1},t.prototype.hideSidebarButton=function(){this.sidebarBtn.active=!1,this.sidebarBtnWx.active=!1},t.prototype.hideAddDesktopButton=function(){this.addDesktopBtn.active=!1},t.prototype.initBGMListener=function(){d.default.platform.onShow(function(){h.default.instance.resumeBGM()}),d.default.platform.onHide(function(){h.default.instance.pauseBGM()})},t.prototype.releaseSideModes=function(){v.default.getInstance().releaseBundle("EndlessBottle"),v.default.getInstance().releaseBundle("ScrewSort")},t.prototype.onBtn_start=function(){h.default.instance.playSFX(h.AudioRef.ClickButton),d.default.hideGameClubButton(),d.default.platform.reportButtonEvent("StartPage_startBtn",0),u.default.ifTest?cc.director.loadScene("Game"):m.default.instance.energy<=0?this.uiManager.showPanel("EnergyPanel"):(d.default.forceGC(),cc.director.loadScene("Game"))},t.prototype.onBtn_BeginnerTask=function(){h.default.instance.playSFX(h.AudioRef.ClickButton),d.default.platform.reportButtonEvent("StartPage_beginnerTaskBtn",0),this.uiManager.showPanel("BeginnerTaskPanel")},t.prototype.onBtn_Collection=function(){h.default.instance.playSFX(h.AudioRef.ClickButton),d.default.platform.reportButtonEvent("StartPage_collectionBtn",0),this.uiManager.showPanel("CollectionPanel")},t.prototype.onBtn_Journey=function(){h.default.instance.playSFX(h.AudioRef.ClickButton),d.default.platform.reportButtonEvent("StartPage_journeyBtn",0),this.uiManager.showPanel("JourneyMainPanel")},t.prototype.onBtn_DrinkCollection=function(){h.default.instance.playSFX(h.AudioRef.ClickButton),d.default.platform.reportButtonEvent("StartPage_drinkCollectionBtn",0),this.uiManager.showPanel("DrinkCollectionPanel")},t.prototype.onBtn_Rank=function(){b.default.instance.trackRanklistEnter(),h.default.instance.playSFX(h.AudioRef.ClickButton),d.default.platform.reportButtonEvent("StartPage_rankBtn",0),f.currentPlatform===f.platformEnum.toutiao?d.default.platform.getRank():f.currentPlatform===f.platformEnum.wechat&&this.uiManager.showPanel("RankPanel")},t.prototype.onBtn_RingFight=function(){h.default.instance.playSFX(h.AudioRef.ClickButton),d.default.hideGameClubButton(),d.default.platform.reportButtonEvent("StartPage_ringFightBtn",0),v.default.getInstance().loadBundle("RingFight",function(e){e||(h.default.instance.stopAll(),cc.director.loadScene(g.SceneNames.RingFight))})},t.prototype.onBtn_ScrewSort=function(){cc.director.loadScene("ScrewSort")},t.prototype.onBtn_CupShowCase=function(){h.default.instance.playSFX(h.AudioRef.ClickButton),d.default.platform.reportButtonEvent("StartPage_cupShowCaseBtn",0),this.uiManager.showPanel("CupShowCasePanel")},t.prototype.onBtn_Setting=function(){h.default.instance.playSFX(h.AudioRef.ClickButton),d.default.platform.reportButtonEvent("StartPage_setBtn",0),this.uiManager.showPanel("SettingPanel")},t.prototype.onBtn_Sidebar=function(){var e=this;if(h.default.instance.playSFX(h.AudioRef.ClickButton),d.default.platform.reportButtonEvent("StartPage_giftBtn",0),f.currentPlatform===f.platformEnum.toutiao){if(u.default.isToday(u.default.LastGetRewardDate))return d.default.platform.showTips("\u4eca\u65e5\u5df2\u9886\u53d6\u8fc7\u5956\u52b1"),void cc.tween(this.sidebarBtn).to(.2,{opacity:0,scale:0},{easing:"smooth"}).call(function(){e.sidebarBtn.active=!1}).start();this.uiManager.showPanel("SidebarPanel")}else f.currentPlatform===f.platformEnum.wechat&&this.uiManager.showPanel("WxSidebarPanel")},t.prototype.onBtn_AddDesktop=function(){var e=this;if(h.default.instance.playSFX(h.AudioRef.ClickButton),d.default.platform.reportButtonEvent("StartPage_addDeskBtn",0),this.uiManager.showPanel("AddDesktopPanel"),u.default.ifAddDesktop)return d.default.platform.showTips("\u5df2\u7ecf\u9886\u53d6\u8fc7\u5956\u52b1\u4e86"),void cc.tween(this.addDesktopBtn).to(.2,{opacity:0,scale:0},{easing:"smooth"}).call(function(){e.addDesktopBtn.active=!1}).start()},t.prototype.onBtn_GameClubButton=function(){h.default.instance.playSFX(h.AudioRef.ClickButton),d.default.platform.reportButtonEvent("StartPage_GameClubBtn",0),1!=P.default.CapUnlockMap[15]?this.uiManager.showPanel("GameClubPanel"):d.default.platform.showTips("\u8df3\u8f6c\u6e38\u620f\u5708\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5")},t.prototype.onBtn_SideMode=function(){h.default.instance.playSFX(h.AudioRef.ClickButton),this.uiManager.showPanel("SideModePanel")},t.prototype.onBtn_Event=function(){h.default.instance.playSFX(h.AudioRef.ClickButton),this.uiManager.showEventPanel("EventPanel")},t.prototype.onBtn_Chanllenge=function(){b.default.instance.trackEnterChallengeMode(),h.default.instance.playSFX(h.AudioRef.ClickButton),d.default.hideGameClubButton(),d.default.platform.reportButtonEvent("StartPage_challengeBtn",0),d.default.platform.reportVideoEvent("StartPage_challengeBtn_video",1),cc.director.preloadScene(g.SceneNames.Challenge),u.default.FreeChallengeTimes>0?(u.default.FreeChallengeTimes--,cc.director.loadScene(g.SceneNames.Challenge)):0===u.default.FreeChallengeTimes?d.default.platform.showShare(function(){u.default.FreeChallengeTimes--,cc.director.loadScene(g.SceneNames.Challenge)}):(b.default.instance.trackAdClick(C.RewardADEvent.UNLOCK_LEVEL),d.default.platform.showRewardAD(function(){b.default.instance.trackAdVideoFinish(C.RewardADEvent.UNLOCK_LEVEL),u.default.FreeChallengeTimes--,cc.director.loadScene(g.SceneNames.Challenge),d.default.platform.reportVideoEvent("StartPage_challengeBtn_video",2)}))},t.prototype.onBtn_Invite=function(){h.default.instance.playSFX(h.AudioRef.ClickButton),d.default.platform.reportButtonEvent("StartPage_inviteBtn",0),this.uiManager.showPanel("InvitePanel")},t.prototype.onBtn_GroupChat=function(){h.default.instance.playSFX(h.AudioRef.ClickButton),d.default.platform.reportButtonEvent("StartPage_groupChatBtn",0),f.currentPlatform===f.platformEnum.wechat?this.uiManager.showPanel("GroupPanel"):f.currentPlatform===f.platformEnum.toutiao&&y.joinGroup()},t.prototype.showCupTutorial=function(e){this.uiManager.showPanel("TutorialPanel").then(function(t){t.getComponent("TutorialPanel").setShowCaseIndex(e)})},l([T(cc.Label)],t.prototype,"text_level",void 0),l([T(cc.Label)],t.prototype,"text_level_chanllenge",void 0),l([T(p.default)],t.prototype,"uiManager",void 0),l([T(cc.Node)],t.prototype,"sidebarBtn",void 0),l([T(cc.Node)],t.prototype,"sidebarBtnWx",void 0),l([T(cc.Node)],t.prototype,"addDesktopBtn",void 0),l([T(cc.Node)],t.prototype,"addDesktopRewardDialog",void 0),l([T(cc.Node)],t.prototype,"gameClubBtn",void 0),l([T(cc.Node)],t.prototype,"groupChatBtn",void 0),l([T(cc.Node)],t.prototype,"ringFightBtn",void 0),l([T(cc.Node)],t.prototype,"beginnerTaskBtn",void 0),l([T(cc.Node)],t.prototype,"tips",void 0),l([I],t)}(cc.Component);r.default=A,cc._RF.pop(),cc._RF.pop()},{}],MainUserInfoBtn:[function(e,t,o){"use strict";cc._RF.push(t,"291da1z1WhAy6fcd1/FTOxM","MainUserInfoBtn");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"291da1z1WhAy6fcd1/FTOxM","MainUserInfoBtn");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=n("const"),d=n("config"),f=cc._decorator,h=f.ccclass,y=(f.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.userInfoBtn=null,t}return s(t,e),t.prototype.onLoad=function(){cc.director.on(p.EventNames.NoActivePanel,this.showUserInfoBtn,this),cc.director.on(p.EventNames.ActivePanel,this.hideUserInfoBtn,this)},t.prototype.onDisable=function(){cc.director.off(p.EventNames.NoActivePanel,this.showUserInfoBtn,this),cc.director.off(p.EventNames.ActivePanel,this.hideUserInfoBtn,this),this.userInfoBtn&&(this.userInfoBtn.destroy(),this.userInfoBtn=null)},t.prototype.start=function(){d.currentPlatform!==d.platformEnum.wechat||cc.sys.isBrowser||u.default.userInfoAuthorized||this.showUserInfoBtn()},t.prototype.showUserInfoBtn=function(){if(d.currentPlatform===d.platformEnum.wechat&&!cc.sys.isBrowser)if(!0!==u.default.userInfoAuthorized)if(this.userInfoBtn)this.userInfoBtn.show();else{var e=wx.getWindowInfo(),t=e.windowWidth/750,o=e.windowHeight/1670,n=this.node.width*t,i=this.node.height*o,r=this,a=(this.node.x-this.node.width/2+375)*t,c=(1670-(this.node.y+this.node.height/2+835))*o;console.error("left:"+a,"top:"+c,"width:"+n,"height:"+i),r.userInfoBtn=wx.createUserInfoButton({type:"image",style:{left:a,top:c,width:n,height:i}}),r.userInfoBtn.onTap(function(e){if(e){u.default.nickName=e.userInfo.nickName,u.default.avatarUrl=e.userInfo.avatarUrl,console.error("\u7528\u6237\u6388\u6743\u4e86\u4fe1\u606f");var t=new cc.Event.EventTouch([],!1);r.node.emit(cc.Node.EventType.TOUCH_START,t),r.scheduleOnce(function(){r.node.emit(cc.Node.EventType.TOUCH_END,t)},0)}})}else this.userInfoBtn&&(this.userInfoBtn.destroy(),this.userInfoBtn=null)},t.prototype.hideUserInfoBtn=function(){d.currentPlatform!==d.platformEnum.wechat||cc.sys.isBrowser||(this.userInfoBtn&&!u.default.userInfoAuthorized?(this.userInfoBtn.hide(),this.userInfoBtn=null):this.userInfoBtn&&u.default.userInfoAuthorized&&(this.userInfoBtn.destroy(),this.userInfoBtn=null))},l([h],t)}(cc.Component));r.default=y,cc._RF.pop(),cc._RF.pop()},{}],Main_ChallengeBtn:[function(e,t,o){"use strict";cc._RF.push(t,"a0798x+j6dKuZKgleoTEvJz","Main_ChallengeBtn");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"a0798x+j6dKuZKgleoTEvJz","Main_ChallengeBtn");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bg=null,t.withAd=null,t.withoutAd=null,t.withShare=null,t}return s(t,e),t.prototype.onEnable=function(){u.default.FreeChallengeTimes>0?this.bg.spriteFrame=this.withoutAd:0===u.default.FreeChallengeTimes?this.bg.spriteFrame=this.withShare:this.bg.spriteFrame=this.withAd},l([f(cc.Sprite)],t.prototype,"bg",void 0),l([f(cc.SpriteFrame)],t.prototype,"withAd",void 0),l([f(cc.SpriteFrame)],t.prototype,"withoutAd",void 0),l([f(cc.SpriteFrame)],t.prototype,"withShare",void 0),l([d],t)}(cc.Component);r.default=h,cc._RF.pop(),cc._RF.pop()},{}],Main_CharacterAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"7d88dRmsAVBsrel5bY/M7HN","Main_CharacterAnimation");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"7d88dRmsAVBsrel5bY/M7HN","Main_CharacterAnimation");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=n("CollectionData"),d=n("const"),f=cc._decorator,h=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.originalScale=1,t.skeleton=null,t}return s(t,e),t.prototype.onLoad=function(){cc.director.on(d.EventNames.OnSelectCharacterSkin,this.setCharacterSkin,this)},t.prototype.onDestroy=function(){cc.director.off(d.EventNames.OnSelectCharacterSkin,this.setCharacterSkin,this)},t.prototype.start=function(){this.originalScale=this.skeleton.node.scale,this.setCharacterSkin()},t.prototype.setCharacterSkin=function(){var e=this,t=u.default.SelectedCharacterIndex,o=p.animalSpineRoot+p.animalSpine[t-1],n=p.animationName[t-1],i=this.originalScale;5!==t&&8!==t||(i=.9*this.originalScale),this.skeleton.node.scale=i;var r=function(t,i){t?console.error("\u52a0\u8f7d\u9aa8\u9abc\u52a8\u753b"+o+"\u5931\u8d25:",t):e.isValid&&(e.skeleton.skeletonData=i,e.skeleton.setAnimation(0,n,!0))},a=cc.assetManager.getBundle("AnimalSpines");a?a.load(o,sp.SkeletonData,r):cc.assetManager.loadBundle("AnimalSpines",function(e,t){e?cc.error("\u52a0\u8f7dAnimalSpines\u8d44\u6e90\u5305\u5931\u8d25:",e):t.load(o,sp.SkeletonData,r)})},l([y(sp.Skeleton)],t.prototype,"skeleton",void 0),l([h],t)}(cc.Component);r.default=m,cc._RF.pop(),cc._RF.pop()},{}],Main_Conveyor:[function(e,t,o){"use strict";cc._RF.push(t,"1d440Iz/fROgo3lXOQmn5kZ","Main_Conveyor");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"1d440Iz/fROgo3lXOQmn5kZ","Main_Conveyor");var a,c=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(i,"__esModule",{value:!0});var l=cc._decorator,u=l.ccclass,p=l.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemPrefabs=[],t.itemContainer=null,t.belt1=null,t.belt2=null,t.spawnInterval=1.5,t.moveSpeed=100,t.itemQueue=[],t.beltWidth=0,t.objectPools=new Map,t}return c(t,e),t.prototype.onLoad=function(){this.shuffleItems(),this.spawnItem(),this.beltWidth=this.belt1.width,this.belt1.setPosition(0,this.belt1.y),this.belt2.setPosition(-this.beltWidth,this.belt2.y)},t.prototype.update=function(){this.updateItems(),this.updateBelt()},t.prototype.updateItems=function(){for(var e=0,t=this.itemContainer.children;e<t.length;e++){var o=t[e];!1!==o.active&&(o.x+=.016*this.moveSpeed,o.x>500&&(this.recycleItemToPool(o),this.spawnItem()))}},t.prototype.updateBelt=function(){this.belt1.x+=.016*this.moveSpeed,this.belt2.x+=.016*this.moveSpeed,this.belt1.x>=this.beltWidth&&(this.belt1.x=this.belt2.x-this.beltWidth),this.belt2.x>=this.beltWidth&&(this.belt2.x=this.belt1.x-this.beltWidth)},t.prototype.shuffleItems=function(){var e;this.itemQueue=this.itemPrefabs.slice();for(var t=this.itemQueue.length-1;t>0;t--){var o=Math.floor(Math.random()*(t+1));e=[this.itemQueue[o],this.itemQueue[t]],this.itemQueue[t]=e[0],this.itemQueue[o]=e[1]}},t.prototype.getItemFromPool=function(e){var t=e.name;this.objectPools.has(t)||this.objectPools.set(t,[]);var o=this.objectPools.get(t);if(o.length>0){var n=o.pop();return n.active=!0,n}var i=cc.instantiate(e);return i.parent=this.itemContainer,i},t.prototype.recycleItemToPool=function(e){var t=e.name.replace("(Clone)","");this.objectPools.has(t)||this.objectPools.set(t,[]),e.active=!1,this.objectPools.get(t).push(e)},t.prototype.onDestroy=function(){this.objectPools.forEach(function(e){e.forEach(function(e){e.destroy()})}),this.objectPools.clear()},t.prototype.spawnItem=function(){0===this.itemQueue.length&&this.shuffleItems();var e=this.itemQueue.pop();this.getItemFromPool(e).setPosition(-500,-50)},s([p([cc.Prefab])],t.prototype,"itemPrefabs",void 0),s([p(cc.Node)],t.prototype,"itemContainer",void 0),s([p(cc.Node)],t.prototype,"belt1",void 0),s([p(cc.Node)],t.prototype,"belt2",void 0),s([p],t.prototype,"spawnInterval",void 0),s([p],t.prototype,"moveSpeed",void 0),s([u],t)}(cc.Component);i.default=d,cc._RF.pop(),cc._RF.pop()},{}],Main_DialogueControl:[function(e,t,o){"use strict";cc._RF.push(t,"6932fPImYZBA6tqgvBuWWwy","Main_DialogueControl");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"6932fPImYZBA6tqgvBuWWwy","Main_DialogueControl");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dialogueNodes=[],t}return s(t,e),t.prototype.start=function(){var e=this;if(u.default.ChallengeRecord>0)for(var t=0,o=this.dialogueNodes;t<o.length;t++)o[t].active=!1;else this.schedule(function(){var t=Math.floor(Math.random()*e.dialogueNodes.length);e.showDialogue(t)},.5)},t.prototype.showDialogue=function(e){var t=this.dialogueNodes[e].getComponent("MainDialogue");t&&!t.isTweening&&(this.dialogueNodes[e].active=!0)},l([f([cc.Node])],t.prototype,"dialogueNodes",void 0),l([d],t)}(cc.Component);r.default=h,cc._RF.pop(),cc._RF.pop()},{}],Main_Energy:[function(e,t,o){"use strict";cc._RF.push(t,"547d3BLPK1KTKXbb1M7nbeD","Main_Energy");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"547d3BLPK1KTKXbb1M7nbeD","Main_Energy");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("StaminaManager"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.text_EnergyNum=null,t.text_RecoverTime=null,t}return s(t,e),t.prototype.onLoad=function(){this.schedule(this._refresh,.5),this._refresh()},t.prototype._refresh=function(){var e=u.default.instance,t=e.energy;if(this.text_EnergyNum.string=t.toString(),e.isInfinite)this.text_RecoverTime.string="\u221e";else if(t>=e.maxEnergy)this.text_RecoverTime.string="\u6ee1";else{var o=e.getSecondsToNextRecover(),n=o/60|0,i=o%60;this.text_RecoverTime.string=this._pad(n)+":"+this._pad(i)}},t.prototype._pad=function(e){return e<10?"0"+e:""+e},l([f(cc.Label)],t.prototype,"text_EnergyNum",void 0),l([f(cc.Label)],t.prototype,"text_RecoverTime",void 0),l([d],t)}(cc.Component);r.default=h,cc._RF.pop(),cc._RF.pop()},{}],Main_Gold:[function(e,t,o){"use strict";cc._RF.push(t,"bbdce858MtEu62y5Z8NEFuZ","Main_Gold");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"bbdce858MtEu62y5Z8NEFuZ","Main_Gold");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("const"),p=n("GoldDataManager"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.text_gold=null,t}return s(t,e),t.prototype.start=function(){this.text_gold.string=p.default.Gold.toString(),cc.director.on(u.EventNames.UpdateGold,this.updateGoldDisplay,this)},t.prototype.onDestroy=function(){cc.director.off(u.EventNames.UpdateGold,this.updateGoldDisplay,this)},t.prototype.updateGoldDisplay=function(e){this.text_gold.string=e.toString()},l([h(cc.Label)],t.prototype,"text_gold",void 0),l([f],t)}(cc.Component);r.default=y,cc._RF.pop(),cc._RF.pop()},{}],Main_Order:[function(e,t,o){"use strict";cc._RF.push(t,"7143fn0uENDHpkIXtpuIF23","Main_Order");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"7143fn0uENDHpkIXtpuIF23","Main_Order");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t}return s(t,e),t.prototype.start=function(){this.label.string=u.default.OrderNum.toString()},l([f(cc.Label)],t.prototype,"label",void 0),l([d],t)}(cc.Component);r.default=h,cc._RF.pop(),cc._RF.pop()},{}],MiniDialoguePopOut:[function(e,t,o){"use strict";cc._RF.push(t,"c1113cXbpJEoY2E5qdyrLB9","MiniDialoguePopOut");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"c1113cXbpJEoY2E5qdyrLB9","MiniDialoguePopOut");var a,c=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(i,"__esModule",{value:!0});var l=cc._decorator,u=l.ccclass,p=l.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delayTime=.5,t}return c(t,e),t.prototype.onEnable=function(){this.node.scale=0,cc.tween(this.node).delay(this.delayTime).parallel(cc.tween().to(.5,{scale:1},{easing:"backOut"}),cc.tween().delay(.4).to(.1,{rotation:5}).to(.1,{rotation:-5}).to(.1,{rotation:5}).to(.1,{rotation:-5}).to(.1,{rotation:0})).start()},s([p({type:cc.Float})],t.prototype,"delayTime",void 0),s([u],t)}(cc.Component);i.default=d,cc._RF.pop(),cc._RF.pop()},{}],MusicManager_SS:[function(e,t,o){"use strict";cc._RF.push(t,"d48d0BNHCtHx5ROUueHepjp","MusicManager_SS");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"d48d0BNHCtHx5ROUueHepjp","MusicManager_SS");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("DataManager_SS"),p=cc._decorator,d=p.ccclass,f=p.property,h=p.menu,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.BGM=null,t.Win=null,t.button=null,t.bgmIndex=null,t}var o;return s(t,e),o=t,t.prototype.onLoad=function(){o.instance=this},t.prototype.start=function(){this.BGMPlay()},t.prototype.BGMPlay=function(){u.default.musicOn&&(console.log("\u64ad\u653e\u80cc\u666f\u97f3\u4e50"),this.bgmIndex=cc.audioEngine.play(this.BGM,!0,.75))},t.prototype.BGMStop=function(){cc.audioEngine.stop(this.bgmIndex)},t.prototype.BGMPause=function(){cc.audioEngine.pause(this.bgmIndex)},t.prototype.BGMResume=function(){u.default.musicOn&&cc.audioEngine.resume(this.bgmIndex)},t.prototype.playWinAudio=function(){u.default.soundOn&&cc.audioEngine.playEffect(this.Win,!1)},t.prototype.playButtonAudio=function(){u.default.soundOn&&cc.audioEngine.playEffect(this.button,!1)},t.instance=null,l([f(cc.AudioClip)],t.prototype,"BGM",void 0),l([f(cc.AudioClip)],t.prototype,"Win",void 0),l([f(cc.AudioClip)],t.prototype,"button",void 0),o=l([d,h("ScrewSortGame/MusicManager")],t)}(cc.Component);r.default=y,cc._RF.pop(),cc._RF.pop()},{}],MyItem:[function(e,t,o){"use strict";cc._RF.push(t,"e2bbakRK3xJ/K63837K9evn","MyItem");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"e2bbakRK3xJ/K63837K9evn","MyItem");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.myRank=null,t.myName=null,t.myScore=null,t.myMedal=null,t.myAvatar=null,t.medalFrames=[],t}return s(t,e),t.prototype.setData=function(e){var t=this;0==e.rank?(this.myRank.string="9999+",this.myRank.fontSize=30):(this.myRank.fontSize=40,this.myRank.string=e.rank.toString()),this.myName.string=u.default.nickName,this.myScore.string=e.score.toString(),e.rank>0&&e.rank<=3?(this.myMedal.spriteFrame=this.medalFrames[e.rank-1],this.myMedal.node.active=!0):this.myMedal.node.active=!1,this.getAvatar(u.default.avatarUrl).then(function(e){t.myAvatar.spriteFrame=e}).catch(function(e){cc.error("\u52a0\u8f7d\u5934\u50cf\u5931\u8d25:",e)})},t.prototype.getAvatar=function(e){return new Promise(function(t){if(e){var o=wx.createImage();o.src=e,o.onload=function(){var e=new cc.Texture2D;e.initWithElement(o),e.handleLoadedTexture(),t(new cc.SpriteFrame(e))}}else t(null)})},t.prototype.hideMyItem=function(){this.node.active=!1},t.prototype.start=function(){},l([f(cc.Label)],t.prototype,"myRank",void 0),l([f(cc.Label)],t.prototype,"myName",void 0),l([f(cc.Label)],t.prototype,"myScore",void 0),l([f(cc.Sprite)],t.prototype,"myMedal",void 0),l([f(cc.Sprite)],t.prototype,"myAvatar",void 0),l([f([cc.SpriteFrame])],t.prototype,"medalFrames",void 0),l([d],t)}(cc.Component);r.default=h,cc._RF.pop(),cc._RF.pop()},{}],NativeBridge:[function(e,t,o){"use strict";cc._RF.push(t,"4531aEgzjVMMJO6rGE961lI","NativeBridge");var n=e,i=t,r=o;cc._RF.push(i,"4531aEgzjVMMJO6rGE961lI","NativeBridge"),Object.defineProperty(r,"__esModule",{value:!0}),r.forceGC=r.copyToClipboard=r.showCustomGridAd=r.showCustomBannerAd=r.inviteShowShare=r.getImg=r.getUserData=r.navigateToScene=r.checkSidebarState=r.addshortCut=r.getLaunchOptions=r.wxPostMessage=r.setImRankData=r.setRank=r.getRank=r.reportCollectionEvent=r.reportScene=r.reportShareEvent=r.reportAdPointEvent=r.reportLevelTimeEvent=r.reportVideoEvent=r.reportPageEvent=r.reportButtonEvent=r.installShortcut=r.hasShortcutInstalled=r.exitGame=r.onShow=r.onHide=r.shareLp=r.stopLp=r.resumeLp=r.pauseLp=r.startLp=r.getSystemInfo=r.getSystemInfoSync=r.showShare=r.vibrateShortHeavy=r.vibrateShortMid=r.vibrateShort=r.vibrateLong=r.showTips=r.openShare=r.showRewardAD=r.showGridAD=r.showInterstitialAdWx=r.showInterstitialAd=r.showBannerAD=r.initAds=r.init=r.isAd=void 0,r.showSubFriendRank=r.showSubGameUpdate=r.showRecommend=r.showGameCenter=r.getGameClubData=r.destroyGameClubButton=r.showGameClubButton=r.createGameClubButton=r.inviter=r.getGameTitle=r.onFeedStatusChange=r.checkFeedSubscribeStatus=r.requestFeedSubscribe=void 0;var a,c,s,l,u,p,d=n("config"),f=n("toutiao"),h=n("wechat"),y=n("CommonData"),m=n("CupMgr");function g(){if(!cc.sys.isBrowser&&r.isAd)switch(d.currentPlatform){case d.platformEnum.wechat:h.initAds();break;case d.platformEnum.toutiao:f.initAds();break;case d.platformEnum.qq:c.initAds();break;case d.platformEnum.oppo:a.initAds();break;case d.platformEnum.android:u.initAds();break;case d.platformEnum.ios:p.initAds();break;case d.platformEnum.ks:l.initAds();break;case d.platformEnum.vivo:s.initAds();break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1ainitAds")}}r.isAd=d.adState,r.init=function(){if(cc.sys.isBrowser)return y.default.ifTest=!0,void(y.default.ifSkipAd=!0);switch(d.currentPlatform){case d.platformEnum.web:break;case d.platformEnum.wechat:h.init();break;case d.platformEnum.toutiao:f.init();break;case d.platformEnum.qq:c.init();break;case d.platformEnum.ks:l.init();break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1ainit")}r.isAd&&g()},r.initAds=g,r.showBannerAD=function(e){if(void 0===e&&(e=!0),console.log(e?"====>> showBanner":"====>> hideBanner"),!cc.sys.isBrowser&&r.isAd)switch(d.currentPlatform){case d.platformEnum.wechat:h.showBannerAD(e);break;case d.platformEnum.toutiao:f.showBannerAD(e);break;case d.platformEnum.qq:c.showBannerAD(e);break;case d.platformEnum.oppo:a.showBannerAD(e);break;case d.platformEnum.android:u.showBannerAD(e);break;case d.platformEnum.ios:p.showBannerAD(e);break;case d.platformEnum.vivo:s.showBannerAD(e);break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1ashowBannerAD")}},r.showInterstitialAd=function(e){if(console.log("====>> showInterstitialAd"),cc.sys.isBrowser||!r.isAd||y.default.ifSkipAd)e&&e();else switch(d.currentPlatform){case d.platformEnum.wechat:return;case d.platformEnum.toutiao:f.showInterstitialAd();break;case d.platformEnum.qq:e&&e(),c.showInterstitialAd();break;case d.platformEnum.android:e&&e(),u.showInterstitialAd();break;case d.platformEnum.oppo:e&&e(),a.showInterstitialAd();break;case d.platformEnum.ios:e&&e(),p.showInterstitialAd();break;case d.platformEnum.vivo:e&&e(),s.showInterstitialAd();break;case d.platformEnum.ks:e&&e(),l.showInterstitialAd();break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1ashowInterstitialAd")}},r.showInterstitialAdWx=function(e){if(console.log("====>> showInterstitialAd"),cc.sys.isBrowser||!r.isAd||y.default.ifSkipAd)e&&e();else switch(d.currentPlatform){case d.platformEnum.wechat:e&&e(),h.showInterstitialAd();break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1ashowInterstitialAdWx")}},r.showGridAD=function(e){if(console.log("====>> showGridAD"),!cc.sys.isBrowser&&r.isAd)switch(d.currentPlatform){case d.platformEnum.wechat:h.showGridAD(e);break;case d.platformEnum.qq:c.showGridAD(e);break;case d.platformEnum.oppo:break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1ashowGridAD")}};var v=!1;function _(e,t,o,n){if(!cc.sys.isBrowser)switch(d.currentPlatform){case d.platformEnum.toutiao:f.setRankData(e,t,o,n);break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1asetImRankData")}}function S(e){if(!cc.sys.isBrowser)switch(d.currentPlatform){case d.platformEnum.wechat:h.getOpendataContext().postMessage(e)}}r.showRewardAD=function(e,t){if(void 0===e&&(e=function(){}),void 0===t&&(t=null),console.log("====>> showRewardAD"),v)return console.log("====>> \u8fde\u70b9\u63a7\u5236\uff0c\u53d6\u6d88\u5c55\u793a"),Promise.reject();if(v=!0,setTimeout(function(){v=!1},800),cc.sys.isBrowser||!r.isAd||y.default.ifSkipAd)return new Promise(function(t){null!=m.default.getInstance()&&m.default.getInstance().currentLevelAdWatchedCount++,e&&e(),t()});switch(d.currentPlatform){case d.platformEnum.wechat:return h.showRewardAD(e);case d.platformEnum.toutiao:return f.showRewardAD(e);case d.platformEnum.qq:return c.showRewardAD();case d.platformEnum.oppo:return a.showRewardAD(e);case d.platformEnum.ks:return l.showRewardAD(e);case d.platformEnum.web:return(void 0).showRewardAd();case d.platformEnum.android:return u.showRewardAD(e,t);case d.platformEnum.vivo:return s.showRewardAD(e,t);default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1ashowRewardAD")}},r.openShare=function(){if(!cc.sys.isBrowser)switch(d.currentPlatform){case d.platformEnum.wechat:h.openShare();break;case d.platformEnum.toutiao:f.openShare();break;case d.platformEnum.qq:c.openShare();break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1aopenShare")}},r.showTips=function(e){if(cc.sys.isBrowser)console.log("showTips : ",e);else switch(d.currentPlatform){case d.platformEnum.wechat:h.showTips(e);break;case d.platformEnum.toutiao:f.showTips(e);break;case d.platformEnum.qq:c.showTips(e);break;case d.platformEnum.oppo:a.showTips(e);break;case d.platformEnum.android:u.showTips(e);break;case d.platformEnum.ios:p.showTips(e);break;case d.platformEnum.ks:l.showTips(e);break;case d.platformEnum.vivo:return s.showTips(e);default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1ashowTips")}},r.vibrateLong=function(){if(!cc.sys.isBrowser&&y.default.VibrationOn)switch(d.currentPlatform){case d.platformEnum.wechat:h.vibrateLong();break;case d.platformEnum.toutiao:f.vibrateLong();break;case d.platformEnum.qq:c.vibrateLong();break;case d.platformEnum.vivo:s.vibrateLong();break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1avibrateLong")}},r.vibrateShort=function(){if(!cc.sys.isBrowser&&y.default.VibrationOn)switch(d.currentPlatform){case d.platformEnum.wechat:h.vibrateShortLight();break;case d.platformEnum.toutiao:f.vibrateShort();break;case d.platformEnum.qq:c.vibrateShort();break;case d.platformEnum.vivo:s.vibrateShort();break;case d.platformEnum.ks:l.vibrateShort();break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1avibrateShort")}},r.vibrateShortMid=function(){if(!cc.sys.isBrowser&&y.default.VibrationOn)switch(d.currentPlatform){case d.platformEnum.wechat:h.vibrateShortMedium();break;case d.platformEnum.toutiao:f.vibrateShort();break;case d.platformEnum.qq:c.vibrateShort();break;case d.platformEnum.vivo:s.vibrateShort();break;case d.platformEnum.ks:l.vibrateShort();break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1avibrateShort")}},r.vibrateShortHeavy=function(){if(!cc.sys.isBrowser&&y.default.VibrationOn)switch(d.currentPlatform){case d.platformEnum.wechat:h.vibrateShortHeavy();break;case d.platformEnum.toutiao:f.vibrateShort();break;case d.platformEnum.qq:c.vibrateShort();break;case d.platformEnum.vivo:s.vibrateShort();break;case d.platformEnum.ks:l.vibrateShort();break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1avibrateShort")}},r.showShare=function(e,t){if(cc.sys.isBrowser)return console.log("\u4e3b\u52a8\u62c9\u8d77\u5206\u4eab"),void(e&&e());switch(d.currentPlatform){case d.platformEnum.wechat:h.showShare(e,t);break;case d.platformEnum.toutiao:f.showShare(e,t);break;case d.platformEnum.qq:c.showShare(e,t);break;case d.platformEnum.ks:l.showShare(e,t);break;case d.platformEnum.web:(void 0).showShare();break;case d.platformEnum.android:u.showShare();break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1ashowShare")}},r.getSystemInfoSync=function(){var e=null;switch(d.currentPlatform){case d.platformEnum.wechat:e=h.getSystemInfoSync();break;case d.platformEnum.toutiao:e=f.getSystemInfoSync();break;case d.platformEnum.qq:e=c.getSystemInfoSync();break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1agetSystemInfoSync")}return e},r.getSystemInfo=function(e){switch(d.currentPlatform){case d.platformEnum.wechat:h.getSystemInfo(e);break;case d.platformEnum.toutiao:f.getSystemInfo(e);break;case d.platformEnum.qq:c.getSystemInfo(e);break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1agetSystemInfo")}},r.startLp=function(){switch(console.log("====>> \u5f00\u59cb\u5f55\u5c4f"),d.currentPlatform){case d.platformEnum.toutiao:f.startLp();break;case d.platformEnum.ks:l.startLp();break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1astartLp")}},r.pauseLp=function(){switch(d.currentPlatform){case d.platformEnum.toutiao:f.pauseLp();break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1apauseLp")}},r.resumeLp=function(){switch(d.currentPlatform){case d.platformEnum.toutiao:f.resumeLp();break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1aresumeLp")}},r.stopLp=function(){switch(console.log("====>> \u7ed3\u675f\u5f55\u5c4f"),d.currentPlatform){case d.platformEnum.toutiao:f.stopLp();break;case d.platformEnum.ks:l.stopLp();break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1astopLp")}},r.shareLp=function(e,t){if(void 0===t&&(t=null),console.log("====>> \u5206\u4eab\u5f55\u5c4f"),cc.sys.isBrowser)e();else switch(d.currentPlatform){case d.platformEnum.toutiao:f.shareLp(e,t);break;case d.platformEnum.ks:l.shareLp(e,t);break;case d.platformEnum.web:(void 0).showRewardAd(e,t);break;case d.platformEnum.android:u.showRewardAD(e,t);case d.platformEnum.oppo:a.showRewardAD(e);default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1ashareLp")}},r.onHide=function(e){if(!cc.sys.isBrowser)switch(d.currentPlatform){case d.platformEnum.wechat:h.onHide(e);break;case d.platformEnum.toutiao:f.onHide(e);break;case d.platformEnum.qq:c.onHide(e);break;case d.platformEnum.ks:l.onHide(e);break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1aonHide")}},r.onShow=function(e){if(!cc.sys.isBrowser)switch(d.currentPlatform){case d.platformEnum.wechat:h.onShow(e);break;case d.platformEnum.toutiao:f.onShow(e);break;case d.platformEnum.qq:c.onShow(e);break;case d.platformEnum.ks:l.onShow(e);break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1aonShow")}},r.exitGame=function(){switch(d.currentPlatform){case d.platformEnum.android:u.exitGame();break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1aexitGame")}},r.hasShortcutInstalled=function(e){if(cc.sys.isBrowser)e.success();else switch(d.currentPlatform){case d.platformEnum.wechat:case d.platformEnum.toutiao:case d.platformEnum.qq:e.success();break;case d.platformEnum.oppo:a.hasShortcutInstalled(e);break;case d.platformEnum.vivo:s.hasShortcutInstalled(e);break;case d.platformEnum.ks:l.checkTable(e.success,e.fail);break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1ahasShortcutInstalled")}},r.installShortcut=function(e){if(cc.sys.isBrowser)e.success();else switch(d.currentPlatform){case d.platformEnum.wechat:case d.platformEnum.toutiao:case d.platformEnum.qq:e.success();break;case d.platformEnum.oppo:a.installShortcut(e);break;case d.platformEnum.vivo:s.installShortcut(e);break;case d.platformEnum.ks:l.addshortCut(e.success);break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1ainstallShortcut")}},r.reportButtonEvent=function(e,t,o,n,i){if(void 0===o&&(o="normal"),i=i||y.default.sceneId,console.log("reportButtonEvent ====>>",e,o,n,t,i),!cc.sys.isBrowser)switch(d.currentPlatform){case d.platformEnum.toutiao:f.reportButtonEvent(e,t,o);break;case d.platformEnum.wechat:h.reportButtonEvent(e,t,o);break;case d.platformEnum.ks:break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1areportButtonEvent")}},r.reportPageEvent=function(e,t,o,n){if(void 0===t&&(t="normal"),n=n||y.default.sceneId,console.log("reportPageEvent ====>>",e,t,y.default.Level,n),!cc.sys.isBrowser)switch(d.currentPlatform){case d.platformEnum.toutiao:f.reportPageEvent(e,t,o,n);break;case d.platformEnum.wechat:h.reportPageEvent(e,t,y.default.Level,y.default.sceneId);break;case d.platformEnum.ks:break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1areportPageEvent")}},r.reportVideoEvent=function(e,t,o,n,i){if(void 0===o&&(o="normal"),i=i||y.default.sceneId,console.log("reportVideoEvent ====>>",e,o,n,t,i),!cc.sys.isBrowser)switch(d.currentPlatform){case d.platformEnum.toutiao:f.reportVideoEvent(e,o,t,n,i);break;case d.platformEnum.wechat:h.reportVideoEvent(e,o,t,n,i);break;case d.platformEnum.ks:break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1areportVideoEvent")}},r.reportLevelTimeEvent=function(e,t,o,n,i){if(void 0===o&&(o="normal"),i=i||y.default.sceneId,console.log("reportLevelTimeEvent ====>>",e,t,o,n,i),!cc.sys.isBrowser)switch(d.currentPlatform){case d.platformEnum.toutiao:f.reportLevelTimeEvent(e,t,o,n,i);break;case d.platformEnum.wechat:h.reportLevelTimeEvent(e,t,o,n,i);break;case d.platformEnum.ks:break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1areportLevelTimeEvent")}},r.reportAdPointEvent=function(e,t,o,n,i){if(void 0===o&&(o="normal"),i=i||y.default.sceneId,console.log("reportAdPointEvent ====>>",e,t,o,n,i),!cc.sys.isBrowser)switch(d.currentPlatform){case d.platformEnum.toutiao:f.reportAdPointEvent(e,t,o,n,i);break;case d.platformEnum.wechat:h.reportAdPointEvent(e,t,o,n,i);break;case d.platformEnum.ks:break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1areportAdPointEvent")}},r.reportShareEvent=function(e,t,o,n){if(!cc.sys.isBrowser)switch(d.currentPlatform){case d.platformEnum.toutiao:f.reportShareEvent(e,t,o,n);break;case d.platformEnum.wechat:h.reportShareEvent(e,t,o,n);break;case d.platformEnum.ks:break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1areportShareEvent")}},r.reportScene=function(e,t){if(!cc.sys.isBrowser)switch(d.currentPlatform){case d.platformEnum.toutiao:f.reportScene(e,t);break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1areportVideoEvent")}},r.reportCollectionEvent=function(e,t,o,n){if(!cc.sys.isBrowser)switch(d.currentPlatform){case d.platformEnum.toutiao:break;case d.platformEnum.wechat:h.reportCollectionEvent(e,t,o,n);break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1areportCollectionEvent")}},r.getRank=function(){if(console.log("====>> getRank"),!cc.sys.isBrowser)switch(d.currentPlatform){case d.platformEnum.toutiao:f.getRankList();break;case d.platformEnum.wechat:S({message:y.default.Level-1,type:1});break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1agetRank")}},r.setRank=function(e){if(cc.sys.isBrowser)console.log("\u4e0a\u62a5\u6392\u884c\u699c\u6570\u636e",e);else switch(d.currentPlatform){case d.platformEnum.toutiao:_(0,e.toString());break;case d.platformEnum.wechat:break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1asetRank")}},r.setImRankData=_,r.wxPostMessage=S,r.getLaunchOptions=function(e){if(!cc.sys.isBrowser)switch(d.currentPlatform){case d.platformEnum.wechat:return h.getLaunchOptions();case d.platformEnum.toutiao:return f.getLaunchOptions(e);default:return console.error("getLaunchOptions no info"),null}},r.addshortCut=function(e,t){if(void 0===e&&(e=null),void 0===t&&(t=null),cc.sys.isBrowser)console.log("\u6dfb\u52a0\u5230\u684c\u9762");else switch(d.currentPlatform){case d.platformEnum.wechat:break;case d.platformEnum.toutiao:f.addshortCut(e);break;case d.platformEnum.ks:l.addshortCut(e);break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1aaddshortCut")}},r.checkSidebarState=function(){if(cc.sys.isBrowser)return new Promise(function(e,t){console.warn("\u975e\u5b57\u8282\u5e73\u53f0"),t()});switch(d.currentPlatform){case d.platformEnum.toutiao:return f.checkSidebarState();default:return new Promise(function(e,t){console.warn("\u975e\u5b57\u8282\u5e73\u53f0"),t()})}},r.navigateToScene=function(e){if(!cc.sys.isBrowser)switch(d.currentPlatform){case d.platformEnum.toutiao:f.navigateToScene(e)}},r.getUserData=function(e,t){switch(void 0===e&&(e=null),void 0===t&&(t=null),d.currentPlatform){case d.platformEnum.toutiao:f.getUserData(e,t)}},r.getImg=function(e){switch(d.currentPlatform){case d.platformEnum.toutiao:return f.getImg(e)}},r.inviteShowShare=function(){if(cc.sys.isBrowser)console.log("\u9080\u8bf7 \u4e3b\u52a8\u62c9\u8d77\u5206\u4eab");else switch(d.currentPlatform){case d.platformEnum.wechat:h.inviteShowShare();break;case d.platformEnum.toutiao:f.inviteShowShare();break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1ashowShare")}},r.showCustomBannerAd=function(e){if(cc.sys.isBrowser)console.log("showCustomBannerAd");else switch(d.currentPlatform){case d.platformEnum.wechat:h.showCustomBannerAd(e);break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1ashowCustomBannerAd")}},r.showCustomGridAd=function(e){if(cc.sys.isBrowser)console.log("showCustomGridAd");else switch(d.currentPlatform){case d.platformEnum.wechat:h.showCustomGridAd(e);break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1ashowCustomGridAd")}},r.copyToClipboard=function(e){if(cc.sys.isBrowser)console.log("copyToClipboard");else switch(d.currentPlatform){case d.platformEnum.wechat:h.copyToClipboard(e);break;case d.platformEnum.toutiao:f.copyToClipboard(e);break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1acopyToClipboard")}},r.forceGC=function(){if(cc.sys.isBrowser)console.log("forceGC");else switch(d.currentPlatform){case d.platformEnum.wechat:h.forceGC();break;case d.platformEnum.toutiao:f.forceGC();break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1aforceGC")}},r.requestFeedSubscribe=function(e,t){if(void 0===e&&(e=null),void 0===t&&(t=null),cc.sys.isBrowser)console.log("requestFeedSubscribe");else switch(d.currentPlatform){case d.platformEnum.toutiao:f.requestFeedSubscribe(e,t);break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1arequestFeedSubscribe")}},r.checkFeedSubscribeStatus=function(e,t){if(void 0===e&&(e=null),void 0===t&&(t=null),cc.sys.isBrowser)console.log("checkFeedSubscribeStatus");else switch(d.currentPlatform){case d.platformEnum.toutiao:f.checkFeedSubscribeStatus(e,t);break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1acheckFeedSubscribeStatus")}},r.onFeedStatusChange=function(e,t){if(void 0===e&&(e=null),void 0===t&&(t=null),cc.sys.isBrowser)console.log("onFeedStatusChange");else switch(d.currentPlatform){case d.platformEnum.toutiao:f.onFeedStatusChange(e,t);break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1aonFeedStatusChange")}},r.getGameTitle=function(){switch(d.currentPlatform){case d.platformEnum.toutiao:return f.getGameTitle();case d.platformEnum.wechat:return h.getGameTitle();default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1agetGameTitle")}},r.inviter=function(e){if(void 0===e&&(e=function(){}),cc.sys.isBrowser)return console.log("inviter"),y.default.InviteCount++,void(e&&e());switch(d.currentPlatform){case d.platformEnum.toutiao:f.inviter(e);break;case d.platformEnum.wechat:h.inviter(e);break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1ainviter")}},r.createGameClubButton=function(e,t,o,n){if(cc.sys.isBrowser)console.log("createGameClubButton");else switch(d.currentPlatform){case d.platformEnum.wechat:h.createGameClubButton(e,t,o,n);break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1acreateGameClubButton")}},r.showGameClubButton=function(e){switch(d.currentPlatform){case d.platformEnum.wechat:h.showGameClubButton(e);break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1ashowGameClubButton")}},r.destroyGameClubButton=function(){switch(d.currentPlatform){case d.platformEnum.wechat:h.destroyGameClubButton();break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1adestroyGameClubButton")}},r.getGameClubData=function(e){if(void 0===e&&(e=function(){}),cc.sys.isBrowser)console.log("getGameClubData");else switch(d.currentPlatform){case d.platformEnum.wechat:return h.getGameClubData(e);default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1agetGameClubData")}},r.showGameCenter=function(){if(cc.sys.isBrowser)console.log("showGameCenter");else switch(d.currentPlatform){case d.platformEnum.wechat:h.showGameCenter();break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1ashowGameCenter")}},r.showRecommend=function(){if(cc.sys.isBrowser)console.log("showRecommend");else switch(d.currentPlatform){case d.platformEnum.wechat:h.showRecommend();break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1ashowRecommend")}},r.showSubGameUpdate=function(){if(cc.sys.isBrowser)console.log("showSubGameUpdate");else switch(d.currentPlatform){case d.platformEnum.wechat:h.showSubGameUpdate();break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1ashowSubGameUpdate")}},r.showSubFriendRank=function(){if(cc.sys.isBrowser)console.log("showSubFriendRank");else switch(d.currentPlatform){case d.platformEnum.wechat:h.showSubFriendRank();break;default:console.log("\u5e73\u53f0"+d.currentPlatform+"\u672a\u5b9a\u4e49API\uff1ashowSubFriendRank")}},cc._RF.pop(),cc._RF.pop()},{}],Objectentries:[function(e,t){"use strict";cc._RF.push(t,"dab53dtzldLsLZUYbQfFKXn","Objectentries"),Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),o=t.length,n=new Array(o);o--;)n[o]=[t[o],e[t[o]]];return n}),cc._RF.pop()},{}],PKManager:[function(e,t){"use strict";cc._RF.push(t,"1b9138Kz4pDaLff7zinHdkG","PKManager");var o=t;cc._RF.push(o,"1b9138Kz4pDaLff7zinHdkG","PKManager"),cc._RF.pop(),cc._RF.pop()},{}],PackageAD:[function(e,t,o){"use strict";cc._RF.push(t,"e87429NtitA5px3J/kYkzcU","PackageAD");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"e87429NtitA5px3J/kYkzcU","PackageAD");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("const"),d=n("GameManager"),f=n("DataNexusEnum"),h=n("DataNexusSDK"),y=n("Package"),m=n("PackageManger"),g=cc._decorator,v=g.ccclass,_=(g.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pack=null,t}return s(t,e),t.prototype.onLoad=function(){h.default.instance.trackAdPlacementShow(f.RewardADEvent.ADD_CONTAINER),this.pack=this.node.parent.getComponent(y.default)},t.prototype.onBtn_Unlock=function(){var e=this;m.default.instance.ifThirdUnlock||(u.default.instance.playSFX(u.AudioRef.ClickButton),d.default.platform.reportVideoEvent("GamePage_addPackage_video",1),h.default.instance.trackAdClick(f.RewardADEvent.ADD_CONTAINER),d.default.platform.showRewardAD(function(){h.default.instance.trackAdVideoFinish(f.RewardADEvent.ADD_CONTAINER),m.default.instance.ifThirdUnlock=!0,m.default.instance.isClearing=!0,e.pack.unlock(),d.default.platform.reportVideoEvent("GamePage_addPackage_video",2),cc.tween(e.node).to(.2,{scale:0},{easing:"sineIn"}).call(function(){e.node.destroy(),cc.director.emit(p.EventNames.DoPour)}).start()}))},t.prototype.unlockImmediately=function(){if(!m.default.instance.ifThirdUnlock){var e=this;u.default.instance.playSFX(u.AudioRef.ClickButton),m.default.instance.ifThirdUnlock=!0,m.default.instance.isClearing=!0,e.pack.unlock(),cc.tween(e.node).to(.2,{scale:0},{easing:"sineIn"}).call(function(){e.node.destroy(),cc.director.emit(p.EventNames.DoPour)}).start()}},l([v],t)}(cc.Component));r.default=_,cc._RF.pop(),cc._RF.pop()},{}],PackageManger:[function(e,t,o){"use strict";cc._RF.push(t,"a7efaV8cUJNWK9WW/MA8Kpn","PackageManger");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"a7efaV8cUJNWK9WW/MA8Kpn","PackageManger");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<o;t++)for(var r=arguments[t],a=0,c=r.length;a<c;a++,i++)n[i]=r[a];return n};Object.defineProperty(r,"__esModule",{value:!0});var p=n("AudioManager"),d=n("CommonData"),f=n("const"),h=n("UnlockData"),y=n("Cup"),m=n("CupMgr"),g=n("Package"),v=cc._decorator,_=v.ccclass,S=v.property,b=["qf","zl","zq"],C=[2,3,4,2,3],P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.packageNode=null,t.packagePrefab=null,t.packageAdPrefab=null,t.collectEffectPrefab=null,t.goldCoinPrefab=null,t.packageColorIdQueue=[],t.packageSpawnPos=[cc.v2(-280,0),cc.v2(-100,0),cc.v2(80,0)],t.currentPackages=[null,null,null],t.targetPackageNum=0,t.finishedPackageNum=0,t.isMultiLevel=!1,t.ifThirdUnlock=!1,t.isClearing=!1,t.speedFactorCnt=0,t.tryTime=0,t.ifAllCupFinished=!1,t.bonusCount=3,t}var o;return s(t,e),o=t,t.prototype.onLoad=function(){o.instance=this,d.default.CurrentUnlockIndex>d.default.collectionList.length&&d.default.Level%5!=0||d.default.Level%5==0&&null==h.default.CurrentUnlockItem?this.packageSpawnPos=[cc.v2(-220,0),cc.v2(0,0),cc.v2(220,0)]:d.default.Level%5==0&&null!==h.default.CurrentUnlockItem&&h.default.CurrentUnlockItem.type===h.UnlockType.RIDER&&(this.packageSpawnPos=[cc.v2(-270,0),cc.v2(-90,0),cc.v2(90,0),cc.v2(270,0)]),cc.director.getScene().name==f.SceneNames.RingFight&&(this.packageSpawnPos=[cc.v2(-220,0),cc.v2(0,0),cc.v2(220,0)]),cc.director.on(f.EventNames.LoadColorIds,this.initializePackageQueue,this),cc.director.on(f.EventNames.TryCollect,this.tryCollectPackage,this),cc.director.on(f.EventNames.LoadLevel,this.initPackages,this)},t.prototype.onDestroy=function(){cc.director.off(f.EventNames.LoadColorIds,this.initializePackageQueue,this),cc.director.off(f.EventNames.TryCollect,this.tryCollectPackage,this),cc.director.off(f.EventNames.LoadLevel,this.initPackages,this)},t.prototype.initializePackageQueue=function(e){if(0===m.default.getInstance().candidateCupCfgs.length){for(var t=[],o=1;o<e.length;o++)for(var n=0;n<e[o];n++)t.push(o);this.packageColorIdQueue=this.shuffleArray(t)}else this.isMultiLevel=!0,this.packageColorIdQueue=e,cc.director.getScene().name!==f.SceneNames.Game&&(this.isMultiLevel=!1),d.default.autoPlaying&&(this.isMultiLevel=!1);this.targetPackageNum=this.packageColorIdQueue.length,m.default.getInstance().totalWater=4*this.targetPackageNum},t.prototype.popQueueColorId=function(){this.packageColorIdQueue.pop()},t.prototype.generateOnePackage=function(e){var t=cc.instantiate(this.packagePrefab);return t.getComponent(g.default).init(e),this.packageNode.addChild(t),t.getComponent(g.default)},t.prototype.initPackages=function(){this.isMultiLevel&&this.initMultiLevel();for(var e=0;e<this.currentPackages.length-1;e++){var t=this.packageColorIdQueue.shift();t&&((i=this.generateOnePackage(t)).node.setPosition(this.packageSpawnPos[e]),this.currentPackages[e]=i)}var o=this.packageColorIdQueue.shift();if(this.packageColorIdQueue.push(o),d.default.Level%5==0&&null!=h.default.CurrentUnlockItem&&h.default.CurrentUnlockItem.type===h.UnlockType.RIDER){var n=cc.instantiate(this.packagePrefab),i=n.getComponent(g.default);this.packageNode.addChild(n),i.node.setPosition(this.packageSpawnPos[3]),i.setUnlock(1),i.node.color=cc.Color.WHITE;var r=this.generateOnePackage(1);r.node.setPosition(this.packageSpawnPos[2]),this.currentPackages[2]=r,(a=cc.instantiate(this.packageAdPrefab)).parent=r.node,a.setPosition(0,-75),r.pigSkeleton.node.active=!1,r.boxSprite.node.color=cc.Color.WHITE,r.isLocked=!0,r.setGrayEffect()}else{var a;(i=this.generateOnePackage(1)).node.setPosition(this.packageSpawnPos[2]),this.currentPackages[2]=i,(a=cc.instantiate(this.packageAdPrefab)).parent=i.node,a.setPosition(0,-75),i.pigSkeleton.node.active=!1,i.boxSprite.node.color=cc.Color.WHITE,i.isLocked=!0,i.setGrayEffect()}},t.prototype.startCollectSafetyTimer=function(){},t.prototype.stopCollectSafetyTimer=function(){},t.prototype.collectSafetyTimer=function(){this.tryTime++,this.tryTime>=2&&this.tryCollectPackage()},t.prototype.getSpeedFactor=function(){var e=1;return 0==m.default.getInstance().cups.filter(function(e){return e.currentState!==y.CupState.Finished&&e.currentState!==y.CupState.ReadyToBeCollected&&!e.isEmpty()}).length&&(0==this.ifAllCupFinished&&this.speedFactorCnt++,this.ifAllCupFinished=!0,1==this.speedFactorCnt&&cc.director.emit(f.EventNames.AllCupFinished),e=1-.05*this.speedFactorCnt),e<.6&&(e=.6),e},t.prototype.fillPackage=function(){var e=this,t=this.getSpeedFactor();if(0!==this.packageColorIdQueue.length&&!(this.finishedPackageNum>=this.targetPackageNum))for(var o=0;o<this.currentPackages.length;o++)if(null===this.currentPackages[o]){this.isMultiLevel&&30!==d.default.CurrentLevel&&this.updateMulitPackageColors(o);var n=this.packageColorIdQueue.shift();if(!n)return;var i=this.generateOnePackage(n),r=this.packageSpawnPos[o];i.node.setPosition(-750,r.y),this.currentPackages[o]=i,cc.tween(i.node).to(.5*t,{x:r.x},{easing:"sineIn"}).call(function(){e.scheduleOnce(function(){e.tryCollectPackage()},0)}).start()}},t.prototype.initMultiLevel=function(){for(var e=m.default.getInstance().cups,t=new Map,o=0,n=e;o<n.length;o++){var i=n[o],r=i.getTop().topColorId,a=i.getTop().topColorNum;t.set(r,(t.get(r)||0)+a)}for(var c=[],s=1;s<=10;s++){var l=t.get(s);t.has(s)||(l=0);var u={colorId:s,num:l};c.push(u)}c.sort(function(){return Math.random()-.5}),c.sort(function(e,t){return t.num-e.num});var p=c[0].colorId,d=c[1].colorId;for(s=0;s<this.packageColorIdQueue.length;s++)this.packageColorIdQueue[s]===p&&this.packageColorIdQueue[0]!==p&&(this.packageColorIdQueue[s]=this.packageColorIdQueue[0],this.packageColorIdQueue[0]=p),0!=s&&this.packageColorIdQueue[s]===d&&this.packageColorIdQueue[1]!==d&&(this.packageColorIdQueue[s]=this.packageColorIdQueue[1],this.packageColorIdQueue[1]=d)},t.prototype.updateMulitPackageColors=function(e){for(var t=m.default.getInstance().cups,o=[],n=[],i=[],r=[],a=[],c=[],s=new Map,l=new Map,u=0,p=999,d=0,f=0,h=t;f<h.length;f++){var g=h[f];if(g&&g.isValid){var v=g.getTop().topColorId,_=g.getTop().topColorNum;g.currentState!==y.CupState.ReadyToBeCollected&&g.currentState!==y.CupState.Finished||c.push(v),l.set(v,(l.get(v)||0)+_),l.get(v)>d&&(d=l.get(v));for(var S=0,b=g.info.colorIds;S<b.length;S++){var P=b[S];if(0!==P&&(P%1e3>100?s.set(P%1e3-100,(s.get(P%1e3-100)||0)+1):s.set(P,(s.get(P)||0)+1),g.cupType===y.CupType.Temp1||g.cupType===y.CupType.Temp1AD||g.cupType===y.CupType.Absorb))break}if(g.isSingleColor()){if(g.hasMask()||g.isFrozen())continue;for(var k=0,w=t;k<w.length;k++){var I=w[k];I.hasMask()||I.isFrozen()||I.cupType===y.CupType.Fixed||I.cupType===y.CupType.BombFixed||g!==I&&I.getTop().topColorId===v&&I.getTop().topColorNum>=g.getTop().emptyNum&&a.push(I.getTop().topColorId)}}}}for(var T=1;T<=10;T++)void 0===(O=s.get(T))&&(s.set(T,0),O=0),O<p&&O>0&&(p=O),O>u&&(u=O);var A=999;for(T=1;T<=10;T++)void 0===(O=s.get(T))&&(s.set(T,0),O=0),O<A&&O>p&&(A=O);for(T=1;T<=10;T++){var O;(O=s.get(T))===u&&o.push(T),O===p&&n.push(T),O===A&&i.push(T),(_=l.get(T))===d&&r.push(T)}var R=JSON.parse(JSON.stringify(C));0===o.length&&(R[0]=0),0===n.length&&(R[1]=0),0===r.length&&(R[2]=0),0===a.length&&(R[3]=0),0===c.length&&(R[4]=0);var N=R,M=N.reduce(function(e,t){return e+t},0);if(0!==M){var L=Math.random()*M;console.error("\u968f\u673a\u5305\u88f9\u2014\u2014\u968f\u673a\u6570 r:",L,"\u603b\u6743\u91cd total:",M,"\u6743\u91cd:",N);var E=0;for(T=0;T<N.length;T++)if((L-=N[T])<0){E=T;break}console.error("isClearing:",this.isClearing),this.isClearing&&(c.length>0?E=4:this.isClearing=!1);var F=[],x=0;switch(E){case 0:x=(F=o)[Math.floor(Math.random()*F.length)],console.error("\u5305\u88f91\u2014\u2014\u6700\u591a\u7684\u989c\u8272 id:",x,"");break;case 1:x=(F=n)[Math.floor(Math.random()*F.length)],console.error("\u5305\u88f92\u2014\u2014\u6700\u5c11\u7684\u989c\u8272 id:",x,"");var D=0;if(0===e&&(D=1),null===this.currentPackages[D])break;var B=this.currentPackages[D].colorId;n.includes(B)&&s.get(B)<8&&(i.length>0&&(x=i[Math.floor(Math.random()*i.length)]),console.error("\u5305\u88f92\u2014\u2014\u6700\u5c11\u7684\u989c\u8272\u66ff\u6362\u6210\u7b2c\u4e8c\u5c11\u7684\u989c\u8272 id:",x,""));break;case 2:x=(F=r)[Math.floor(Math.random()*F.length)],console.error("\u5305\u88f93\u2014\u2014\u4e0a\u5c42\u6700\u591a\u7684\u989c\u8272 id:",x,"");break;case 3:x=(F=a)[Math.floor(Math.random()*F.length)],console.error("\u5305\u88f94\u2014\u2014\u5373\u5c06\u96c6\u6ee1\u7684\u989c\u8272 id:",x,"");break;case 4:x=(F=c)[Math.floor(Math.random()*F.length)],console.error("\u5305\u88f95\u2014\u2014\u6536\u96c6\u6ee1\u7684\u989c\u8272 id:",x,"")}if(F.length>0)for(T=0;T<this.packageColorIdQueue.length;T++)if(this.packageColorIdQueue[T]===x){this.packageColorIdQueue[T]=this.packageColorIdQueue[0],this.packageColorIdQueue[0]=x;break}}},t.prototype.tryCollectPackage=function(){this.tryTime=0;for(var e=0;e<this.currentPackages.length;e++){var t=this.currentPackages[e];if((!t||!t.isLocked)&&t&&t.isValid)for(var o=0,n=m.default.getInstance().cups;o<n.length;o++){var i=n[o];if(i&&i.isValid&&t&&t.colorId===i.getTop().topColorId&&i.currentState===y.CupState.ReadyToBeCollected){this.collectPackage(i,t);break}}}},t.prototype.collectPackage=function(e,t){this.ifAllCupFinished&&this.speedFactorCnt++;var o,n=this.getSpeedFactor(),i=this,r=this.packageSpawnPos[this.currentPackages.indexOf(t)],a=e.node.getPosition(),c=r;c=this.packageNode.convertToWorldSpaceAR(c),c=m.default.getInstance().node.convertToNodeSpaceAR(c),this.currentPackages[this.currentPackages.indexOf(t)]=null,m.default.getInstance().emptyCupPosArray.push(a),m.default.getInstance().cups.splice(m.default.getInstance().cups.indexOf(e),1),m.default.getInstance().addCandidateCup(),cc.director.emit(f.EventNames.UpdateTestNumber),o=.4/m.default.getInstance().node.scale,e.hideThumbAnimation(),cc.tween(e.node).parallel(cc.tween(e.node).to(.2*n,{scale:o},{easing:"sineInOut"}),cc.tween(e.node).bezierTo(.2*n,cc.v2(a.x,(c.y+50+a.y)/2),cc.v2((c.x+a.x)/2,c.y+50),cc.v2(c.x,c.y+50))).call(function(){t.playIdleAnimation()}).to(.2*n,{y:c.y-45},{easing:"quadOut"}).delay(.15*n).call(function(){if(cc.tween(t.node).call(function(){var e=Math.random(),t=p.AudioRef.PigOut;e<.25?t=p.AudioRef.PigOut1:e<.5?t=p.AudioRef.PigOut2:e<.75&&(t=p.AudioRef.PigOut3),p.default.instance.playSFX(t)}).to(.5*n,{x:750},{easing:"sineOut"}).start(),i.playCollectEffect(t.node.getPosition()),i.finishedPackageNum++,cc.director.emit(f.EventNames.Collect,i.finishedPackageNum/i.targetPackageNum),i.finishedPackageNum>=i.targetPackageNum)return d.default.OrderNum+=i.targetPackageNum,i.stopCollectSafetyTimer(),void cc.director.emit(f.EventNames.LevelFinish);i.fillPackage()}).to(.5*n,{x:1e3},{easing:"sineOut"}).call(function(){t.node.destroy(),e.node.destroy(),cc.director.emit(f.EventNames.DoPour)}).start()},t.prototype.playCollectEffect=function(e){var t=cc.instantiate(this.collectEffectPrefab),o=cc.instantiate(this.goldCoinPrefab);o.setPosition(e),o.y-=50,o.zIndex=1e3,this.scheduleOnce(function(){p.default.instance.playSFX(p.AudioRef.GoldCoin)},.2*Math.random()),this.packageNode.addChild(o),t.setPosition(e),this.packageNode.addChild(t);var n=t.getComponent(sp.Skeleton),i=b[Math.floor(Math.random()*b.length)];t.zIndex=1e3,n.setAnimation(0,i,!1),n.setCompleteListener(function(){t.destroy()})},t.prototype.getLevelGoldNum=function(){return 5*this.targetPackageNum},t.prototype.unlockPackage=function(){o.instance.ifThirdUnlock||this.currentPackages[2].node.getChildByName("PackageAd").getComponent("PackageAD").unlockImmediately()},t.prototype.unlockPackageByAd=function(){o.instance.ifThirdUnlock||this.currentPackages[2].node.getChildByName("PackageAd").getComponent("PackageAD").onBtn_Unlock()},t.prototype.shuffleArray=function(e){for(var t,o=u(e),n=o.length-1;n>0;n--){var i=Math.floor(Math.random()*(n+1));t=[o[i],o[n]],o[n]=t[0],o[i]=t[1]}return o},t.prototype.refreshPackage=function(){for(var e=this,t=this.getSpeedFactor(),o=!1,n=function(e){var n=i.currentPackages[e];n&&!n.isLocked&&(i.packageColorIdQueue.push(n.colorId),i.currentPackages[e]=null,o=!0,cc.tween(n.node).by(.5*t,{x:-1e3},{easing:"sineOut"}).call(function(){n.node.destroy()}).start())},i=this,r=0;r<this.currentPackages.length;r++)n(r);o&&this.scheduleOnce(function(){e.isClearing=!0,cc.director.emit(f.EventNames.DoPour),e.fillPackage()},.4*t)},t.instance=null,l([S(cc.Node)],t.prototype,"packageNode",void 0),l([S(cc.Prefab)],t.prototype,"packagePrefab",void 0),l([S(cc.Prefab)],t.prototype,"packageAdPrefab",void 0),l([S(cc.Prefab)],t.prototype,"collectEffectPrefab",void 0),l([S(cc.Prefab)],t.prototype,"goldCoinPrefab",void 0),o=l([_],t)}(cc.Component);r.default=P,cc._RF.pop(),cc._RF.pop()},{}],Package:[function(e,t,o){"use strict";cc._RF.push(t,"9a6f91NQd5LIbhx4jFhrG1n","Package");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"9a6f91NQd5LIbhx4jFhrG1n","Package");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=n("const"),d=n("UnlockData"),f=n("Cup"),h=n("CupMgr"),y=n("PackageManger"),m=n("CollectionData"),g=cc._decorator,v=g.ccclass,_=g.property,S=["hong","shenlan","huang","lv","zi","hui","lan","cheng","zong","fen"],b=cc.v2(-1,115),C=cc.v2(0,183),P=cc.v2(0,124),k=cc.v2(0,130),w=cc.v2(0,91),I=cc.v2(-1,128),T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.colorId=0,t.isLocked=!1,t.boxSprite=null,t.SkeletonData=[],t.eyesNode=null,t.eyeSpriteFrames=[],t.pigSkeleton=null,t.sleepSkeleton=null,t.boxSpriteFrame=[],t.initialPos=cc.v3(0,0,0),t.Effects=[],t.isPlaying=!1,t.animationTimer=0,t.sleepTimer=0,t}return s(t,e),t.prototype.onLoad=function(){cc.director.on(p.EventNames.OnClickCup,this.moveEyes,this)},t.prototype.onDestroy=function(){cc.director.off(p.EventNames.OnClickCup,this.moveEyes,this),this.stopAnimationStateMachine()},t.prototype.setGrayEffect=function(){this.boxSprite.setMaterial(0,this.Effects[0]),this.pigSkeleton.setMaterial(0,this.Effects[0])},t.prototype.setNormalEffect=function(){this.boxSprite.setMaterial(0,this.Effects[1]),this.pigSkeleton.setMaterial(0,this.Effects[1])},t.prototype.setUnlock=function(e){var t=this,o=d.default.CurrentUnlockItem.id;switch(o){case 1:this.pigSkeleton.node.scale=1;break;case 2:this.pigSkeleton.node.scale=.65;break;case 3:this.pigSkeleton.node.scale=1;break;case 4:this.pigSkeleton.node.scale=.65;break;case 5:this.pigSkeleton.node.scale=.9;break;case 6:this.pigSkeleton.node.scale=1;break;case 7:this.pigSkeleton.node.scale=.85;break;case 8:this.pigSkeleton.node.scale=.9}this.unscheduleAllCallbacks(),this.pigSkeleton.skeletonData=this.SkeletonData[o-1];var n=f.ColorIDRef[e];n>=0&&n<=this.boxSpriteFrame.length&&(this.boxSprite.spriteFrame=this.boxSpriteFrame[n-1]),m.noSkinCharacters.includes(o)||(this.pigSkeleton.defaultSkin=S[n-1],this.pigSkeleton.setSkin(S[n-1])),this.pigSkeleton.node.color=cc.Color.GRAY,this.boxSprite.node.color=cc.Color.GRAY,this.pigSkeleton.animation=null,this.scheduleOnce(function(){t.pigSkeleton.setAnimation(0,"zZ",!0),t.sleepSkeleton.setAnimation(0,"zZ",!0)},0),this.eyesNode.active=!1},t.prototype.init=function(e){var t=this;switch(u.default.SelectedCharacterIndex){case 1:this.pigSkeleton.node.scale=1,this.initialPos=cc.v3(b);break;case 2:this.pigSkeleton.node.scale=.7;break;case 3:this.pigSkeleton.node.scale=1,this.initialPos=cc.v3(P);break;case 4:this.pigSkeleton.node.scale=.65,this.initialPos=cc.v3(C);break;case 5:this.pigSkeleton.node.scale=.9,this.initialPos=cc.v3(k);break;case 6:this.pigSkeleton.node.scale=1,this.initialPos=cc.v3(w);break;case 7:this.pigSkeleton.node.scale=.85;break;case 8:this.pigSkeleton.node.scale=.9,this.initialPos=cc.v3(I)}this.pigSkeleton.skeletonData=this.SkeletonData[u.default.SelectedCharacterIndex-1],this.eyesNode.getComponent(cc.Sprite).spriteFrame=this.eyeSpriteFrames[u.default.SelectedCharacterIndex-1],this.eyesNode.position=this.initialPos,this.colorId=e;var o=f.ColorIDRef[e];o>=0&&o<=this.boxSpriteFrame.length&&(this.boxSprite.spriteFrame=this.boxSpriteFrame[o-1]),this.startAnimationStateMachine(),m.noSkinCharacters.includes(u.default.SelectedCharacterIndex)||(this.pigSkeleton.defaultSkin=S[o-1],this.pigSkeleton.setSkin(S[o-1])),this.pigSkeleton.animation=null,this.scheduleOnce(function(){t.pigSkeleton.setAnimation(0,"idle_1",!0)},0)},t.prototype.setSkin=function(e,t){switch(e){case 1:this.pigSkeleton.node.scale=1,this.initialPos=cc.v3(b);break;case 2:this.pigSkeleton.node.scale=.7;break;case 3:this.pigSkeleton.node.scale=1,this.initialPos=cc.v3(P);break;case 4:this.pigSkeleton.node.scale=.65,this.initialPos=cc.v3(C);break;case 5:this.pigSkeleton.node.scale=.9,this.initialPos=cc.v3(k);break;case 6:this.pigSkeleton.node.scale=1,this.initialPos=cc.v3(w);break;case 7:this.pigSkeleton.node.scale=.85;break;case 8:this.pigSkeleton.node.scale=.9,this.initialPos=cc.v3(I)}this.pigSkeleton.skeletonData=this.SkeletonData[e-1],this.eyesNode.getComponent(cc.Sprite).spriteFrame=this.eyeSpriteFrames[e-1],this.eyesNode.position=this.initialPos,this.colorId=t;var o=f.ColorIDRef[t];o>=0&&o<=this.boxSpriteFrame.length&&(this.boxSprite.spriteFrame=this.boxSpriteFrame[o-1]),this.startAnimationStateMachine(),m.noSkinCharacters.includes(e)||(this.pigSkeleton.defaultSkin=S[o-1])},t.prototype.playCollectAnimation=function(){},t.prototype.unlock=function(){var e=this;this.setNormalEffect(),this.pigSkeleton.node.active=!0,this.pigSkeleton.node.setPosition(520,-80),cc.director.emit(p.EventNames.PackageUnlock),y.default.instance.isMultiLevel&&y.default.instance.updateMulitPackageColors();var t=y.default.instance.packageColorIdQueue.shift();null==t&&(t=Math.floor(10*Math.random())+1),this.init(t),cc.tween(this.pigSkeleton.node).to(.4,{x:0},{easing:"sineIn"}).call(function(){e.isLocked=!1,cc.director.emit(p.EventNames.TryCollect)}).start(),cc.tween(this.boxSprite.node).to(.2,{color:cc.Color.WHITE},{easing:"sineIn"}).start()},t.prototype.moveEyes=function(e){if(!this.isPlaying){var t=(e=h.default.getInstance().node.convertToWorldSpaceAR(e)).sub(this.eyesNode.parent.convertToWorldSpaceAR(this.initialPos)).normalize(),o=0;switch(u.default.SelectedCharacterIndex){case 1:o=7;break;case 2:case 3:o=5;break;case 4:case 5:case 6:case 7:case 8:o=7}var n=this.initialPos.add(t.mul(o));cc.tween(this.eyesNode).to(.2,{position:n},{easing:"sineOut"}).start()}},t.prototype.resetEyes=function(e){this.isPlaying=!0,cc.tween(this.eyesNode).to(.3,{position:this.initialPos},{easing:"sineIn"}).call(function(){e&&e()}).start()},t.prototype.startAnimationStateMachine=function(){this.eyesNode.active=!0,this.pigSkeleton.setAnimation(0,"idle_1",!0),this.sleepSkeleton.animation=null,this.animationTimer=0,this.sleepTimer=0,this.isPlaying=!1,this.schedule(this.updateAnimationStateMachine,1)},t.prototype.stopAnimationStateMachine=function(){this.unschedule(this.updateAnimationStateMachine)},t.prototype.updateAnimationStateMachine=function(){if(!this.isPlaying)if(this.animationTimer++,this.sleepTimer++,this.sleepTimer>=30)this.playSleepAnimation();else{var e=Math.floor(2*Math.random())+8;this.animationTimer>=e&&(this.animationTimer=0,Math.random()<.5?this.playEyeBlink():this.playSnotAnimation())}},t.prototype.playEyeBlink=function(){var e=this;e.resetEyes(function(){e.eyesNode.active=!1,e.pigSkeleton.setAnimation(0,"zhayan",!1),e.pigSkeleton.setCompleteListener(function(){e.eyesNode.active=!0,e.eyesNode.position=e.initialPos,e.isPlaying=!1,e.pigSkeleton.setAnimation(0,"idle_1",!1),e.pigSkeleton.setCompleteListener(null)})})},t.prototype.playSnotAnimation=function(){var e=this,t=this;t.resetEyes(function(){t.eyesNode.active=!1,t.pigSkeleton.setAnimation(0,"biti",!1),t.pigSkeleton.setCompleteListener(function(){t.eyesNode.active=!0,t.eyesNode.position=t.initialPos,t.isPlaying=!1,e.pigSkeleton.setAnimation(0,"idle_1",!1),t.pigSkeleton.setCompleteListener(null)})})},t.prototype.playSleepAnimation=function(){var e=this,t=this;t.isPlaying||(t.isPlaying=!0,t.resetEyes(function(){t.eyesNode.active=!1,t.pigSkeleton.setAnimation(0,"zZ",!0),t.sleepSkeleton.setAnimation(0,"zZ",!0)}),t.pigSkeleton.setCompleteListener(null),this.stopAnimationStateMachine(),this.scheduleOnce(function(){e.startAnimationStateMachine()},10+10*Math.random()))},t.prototype.playIdleAnimation=function(){"zZ"==this.pigSkeleton.animation&&this.pigSkeleton.setAnimation(0,"idle",!0),"zZ"==this.sleepSkeleton.animation&&(this.sleepSkeleton.animation=null)},l([_(cc.Sprite)],t.prototype,"boxSprite",void 0),l([_([sp.SkeletonData])],t.prototype,"SkeletonData",void 0),l([_(cc.Node)],t.prototype,"eyesNode",void 0),l([_([cc.SpriteFrame])],t.prototype,"eyeSpriteFrames",void 0),l([_(sp.Skeleton)],t.prototype,"pigSkeleton",void 0),l([_(sp.Skeleton)],t.prototype,"sleepSkeleton",void 0),l([_([cc.SpriteFrame])],t.prototype,"boxSpriteFrame",void 0),l([_([cc.Material])],t.prototype,"Effects",void 0),l([v],t)}(cc.Component);r.default=T,cc._RF.pop(),cc._RF.pop()},{}],PanelBase_SS:[function(e,t,o){"use strict";cc._RF.push(t,"6d3b2t0ZS1KdZNBsFLHQOgP","PanelBase_SS");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"6d3b2t0ZS1KdZNBsFLHQOgP","PanelBase_SS");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData_SS"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bg=null,t}return s(t,e),t.prototype.init=function(){},t.prototype.show=function(e){this.init(),this.node.active=!0,this.bg.scale=0,this.bg.opacity=0,cc.tween(this.bg).to(.15,{scale:1,opacity:255}).call(function(){e&&e(),u.default.curPanelCount++}).start()},t.prototype.hide=function(e){var t=this;this.bg.scale=1,this.bg.opacity=255,cc.tween(this.bg).to(.15,{scale:0,opacity:0}).call(function(){u.default.curPanelCount--,t.node.destroy(),e&&e()}).start()},l([f(cc.Node)],t.prototype,"bg",void 0),l([d],t)}(cc.Component);r.default=h,cc._RF.pop(),cc._RF.pop()},{}],PenguinProgressNode:[function(e,t,o){"use strict";cc._RF.push(t,"c0d4edV0/NJNKqAKMlAZfF0","PenguinProgressNode");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"c0d4edV0/NJNKqAKMlAZfF0","PenguinProgressNode");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("EventManager"),p=n("EventRewardPanel"),d=n("SignInManager"),f=cc._decorator,h=f.ccclass,y=f.property,m=f.menu,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.slider=null,t.progressLabel=null,t.cnt=0,t}return s(t,e),t.prototype.onEnable=function(){this.slider.fillRange=0,this.cnt=d.default.instance.eventToken;var e=this.cnt/d.default.instance.getEventTarget();e>1&&(e=1),this.progressLabel.string="\u6536\u96c6\u8fdb\u5ea6:"+(this.cnt>d.default.instance.getEventTarget()?d.default.instance.getEventTarget():this.cnt)+"/"+d.default.instance.getEventTarget(),e<=0||cc.tween(this.slider).delay(1).to(.4,{fillRange:e},{easing:"sineOut"}).start()},t.prototype.addOneSlider=function(){var e=this;this.cnt+=1;var t=this.cnt/d.default.instance.getEventTarget();t>1&&(t=1),this.progressLabel.string="\u6536\u96c6\u8fdb\u5ea6:"+(this.cnt>d.default.instance.getEventTarget()?d.default.instance.getEventTarget():this.cnt)+"/"+d.default.instance.getEventTarget(),cc.tween(this.slider).to(.4,{fillRange:t},{easing:"sineOut"}).call(function(){if(e.slider.fillRange>=1){var t=u.default.instance.showPanel("EventRewardPanel");1==d.default.instance.getMonth()?t.getComponent(p.default).setUpImageAndName(3,7):2==d.default.instance.getMonth()&&t.getComponent(p.default).setUpImageAndName(3,8)}}).start()},l([y(cc.Sprite)],t.prototype,"slider",void 0),l([y(cc.Label)],t.prototype,"progressLabel",void 0),l([h,m("Event/PenguinProgressNode")],t)}(cc.Component);r.default=g,cc._RF.pop(),cc._RF.pop()},{}],PropPanel:[function(e,t,o){"use strict";cc._RF.push(t,"ea3933sr3lA7ZpddPPAw8pp","PropPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"ea3933sr3lA7ZpddPPAw8pp","PropPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("CommonData"),d=n("CupMgr"),f=n("const"),h=n("GameManager"),y=n("BasePanel"),m=cc._decorator,g=m.ccclass,v=m.property,_=["\u64a4\u56de\u4e0a\u4e00\u6b65\u64cd\u4f5c","\u8ba9\u6c34\u6309\u989c\u8272\u6392\u5e8f","\u62bd\u53d6\u74f6\u5b50\u4e2d\u7684\u4efb\u610f\u989c\u8272\n\u5e76\u7f6e\u9876","\u8ba9\u4e00\u79cd\u989c\u8272\u7684\u6c34\u66f4\u591a","\u589e\u52a0\u4e00\u4e2a\u6c34\u74f6"],S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propIconList=[],t.propTitleList=[],t.propText=null,t.propBtn=null,t.propBtnImgs=[],t}return s(t,e),t.prototype.reportPage=function(e){switch(e){case 0:h.default.platform.reportPageEvent("GamePage_WithDrawPage");break;case 2:h.default.platform.reportPageEvent("GamePage_TopUpPage");break;case 4:h.default.platform.reportPageEvent("GamePage_AddCupPage")}},t.prototype.showPropPanel=function(e){var t=this;this.node.active=!0,this.show(),this.reportPage(e),this.propIconList[e].active=!0,this.propTitleList[e].active=!0,this.propText.string=_[e],this.propBtnImgs.length>0&&p.default.Level<3&&cc.director.getScene().name===f.SceneNames.Game&&(this.propBtn.node.getComponent(cc.Sprite).spriteFrame=this.propBtnImgs[2]),this.propBtn.node.on(cc.Node.EventType.TOUCH_END,function(){if(p.default.Level<3&&cc.director.getScene().name===f.SceneNames.Game)t.onBtn_UseProp(e);else{switch(e){case 0:h.default.platform.reportVideoEvent("GamePage_withdrawBtn_video",1);break;case 1:h.default.platform.reportVideoEvent("GamePage_sortBtn_video",1);break;case 2:h.default.platform.reportVideoEvent("GamePage_topUpBtn_video",1);break;case 3:h.default.platform.reportVideoEvent("GamePage_dyedBtn_video",1);break;case 4:h.default.platform.reportVideoEvent("GamePage_addCupBtn_video",1)}h.default.platform.showRewardAD(function(){switch(t.onBtn_UseProp(e),"Game"===cc.director.getScene().name&&h.default.platform.reportAdPointEvent("AdPoint",d.default.getInstance().getProgress()),e){case 0:h.default.platform.reportVideoEvent("GamePage_withdrawBtn_video",2);break;case 1:h.default.platform.reportVideoEvent("GamePage_sortBtn_video",2);break;case 2:h.default.platform.reportVideoEvent("GamePage_topUpBtn_video",2);break;case 3:h.default.platform.reportVideoEvent("GamePage_dyedBtn_video",2);break;case 4:h.default.platform.reportVideoEvent("GamePage_addCupBtn_video",2)}u.default.instance.playSFX(u.AudioRef.ClickButton)})}},this)},t.prototype.onBtn_UseProp=function(e){var t=this;cc.director.emit("use_prop",e),this.hide(function(){t.propIconList[e].active=!1,t.propTitleList[e].active=!1,t.propBtn.node.off(cc.Node.EventType.TOUCH_END)})},t.prototype.onBtn_Close=function(){var e=this;this.hide(function(){for(var t=0;t<e.propIconList.length;t++)e.propIconList[t].active=!1,e.propTitleList[t].active=!1,e.propBtn.node.off(cc.Node.EventType.TOUCH_END)})},l([v([cc.Node])],t.prototype,"propIconList",void 0),l([v([cc.Node])],t.prototype,"propTitleList",void 0),l([v(cc.Label)],t.prototype,"propText",void 0),l([v(cc.Button)],t.prototype,"propBtn",void 0),l([v([cc.SpriteFrame])],t.prototype,"propBtnImgs",void 0),l([g],t)}(y.default);r.default=S,cc._RF.pop(),cc._RF.pop()},{}],PropPnl_ED:[function(e,t,o){"use strict";cc._RF.push(t,"42999lkXrZADqLh+2xpOkEk","PropPnl_ED");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"42999lkXrZADqLh+2xpOkEk","PropPnl_ED");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager_ED"),p=n("ExternalManager_ED"),d=n("GameManager_ED"),f=n("BasePanel_ED"),h=cc._decorator,y=h.ccclass,m=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.title=null,t.propImg=null,t.move=null,t.title_sf=[],t.propImg_sf=[],t.move_sf=[],t.describe=null,t.describeList=["\u52a0\u4e00\u4e2a\u7a7a\u74f6\u5b50","\u64a4\u56de\u4e0a\u4e00\u6b65\u64cd\u4f5c","\u6d88\u9664\u4e00\u4e2a\u74f6\u5b50"],t}return s(t,e),t.prototype.init=function(){this.title.spriteFrame=this.title_sf[d.default.instance.propState-1],this.propImg.spriteFrame=this.propImg_sf[d.default.instance.propState-1],this.move.spriteFrame=this.move_sf[d.default.instance.propState-1],this.describe.string=this.describeList[d.default.instance.propState-1]},t.prototype.useProp=function(){d.default.instance.hideTip(),this.hide(function(){switch(d.default.instance.propState){case 1:d.default.instance.Add();break;case 2:d.default.instance.Withdraw(),u.default.instance.playBtn();break;case 3:d.default.instance.Remove(),u.default.instance.playBtn()}d.default.instance.propState=0})},t.prototype.clickUse=function(){var e=this;p.default.showRewardAd(function(){e.useProp()})},t.prototype.clickClose=function(){u.default.instance.playBtn(),this.hide(function(){d.default.instance.propState=0})},l([m(cc.Sprite)],t.prototype,"title",void 0),l([m(cc.Sprite)],t.prototype,"propImg",void 0),l([m(cc.Sprite)],t.prototype,"move",void 0),l([m(cc.SpriteFrame)],t.prototype,"title_sf",void 0),l([m(cc.SpriteFrame)],t.prototype,"propImg_sf",void 0),l([m(cc.SpriteFrame)],t.prototype,"move_sf",void 0),l([m(cc.Label)],t.prototype,"describe",void 0),l([y],t)}(f.default);r.default=g,cc._RF.pop(),cc._RF.pop()},{}],Puzzle:[function(e,t,o){"use strict";cc._RF.push(t,"2804dAJJElIo5mIh4HXoMGn","Puzzle");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"2804dAJJElIo5mIh4HXoMGn","Puzzle");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0}),r.PuzzleType=void 0;var u,p=n("JourneyPanel"),d=n("ThemeDataManager");!function(e){e[e.Completed=0]="Completed",e[e.Four=1]="Four",e[e.Nine=2]="Nine"}(u=r.PuzzleType||(r.PuzzleType={}));var f=cc._decorator,h=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.puzzleType=u.Completed,t.puzzle4PieceArr=[],t.puzzle9PieceArr=[],t.completeImg=null,t}return s(t,e),t.prototype.setUp=function(e,t,o){return void 0===t&&(t=!1),4===d.default.ThemeUnlockNeedMap[e]?this.puzzleType=u.Four:9===d.default.ThemeUnlockNeedMap[e]?this.puzzleType=u.Nine:this.puzzleType=u.Completed,!0===d.default.ThemeUnlockMap[e]||this.puzzleType===u.Completed?(this.puzzle4PieceArr[0].node.parent.active=!1,this.puzzle9PieceArr[0].node.parent.active=!1,this.completeImg.node.active=!0,void this.setUpImg(e)):void(this.puzzleType===u.Four?(this.puzzle4PieceArr[0].node.parent.active=!0,this.puzzle9PieceArr[0].node.parent.active=!1,this.completeImg.node.active=!1,this.setUpPuzzle(e,this.puzzle4PieceArr,t,o)):this.puzzleType===u.Nine&&(this.puzzle4PieceArr[0].node.parent.active=!1,this.puzzle9PieceArr[0].node.parent.active=!0,this.completeImg.node.active=!1,this.setUpPuzzle(e,this.puzzle9PieceArr,t,o)))},t.prototype.setUpImg=function(e){var t=this,o=e+"/"+e,n=cc.assetManager.getBundle("Theme");n?n.load(o,cc.SpriteFrame,function(e,o){e?console.error("Theme Img Load Error: "+e):(t.puzzle4PieceArr[0].node.parent.active=!1,t.puzzle9PieceArr[0].node.parent.active=!1,t.completeImg.spriteFrame=o)}):cc.assetManager.loadBundle("Theme",function(e,n){e?console.error("Bundle Load Error: "+e):n.load(o,cc.SpriteFrame,function(e,o){e?console.error("Theme Img Load Error: "+e):(t.puzzle4PieceArr[0].node.parent.active=!1,t.puzzle9PieceArr[0].node.parent.active=!1,t.completeImg.spriteFrame=o)})})},t.prototype.setUpPuzzle=function(e,t,o,n){void 0===t&&(t=[]),void 0===o&&(o=!1);var i=this,r=cc.assetManager.getBundle("Theme");if(r)for(var a=function(a){var c=e+"/"+e+"_"+(a+1);r.load(c,cc.SpriteFrame,function(r,c){r?console.error("Theme Img Load Error: "+r):(t[a].spriteFrame=c,a==d.default.ThemeUnlockNeedMap[e]-1&&i.setUpPuzzlePieces(t,e,o,n))})},c=0;c<d.default.ThemeUnlockNeedMap[e];c++)a(c);else cc.assetManager.loadBundle("Theme",function(r,a){if(r)console.error("Bundle Load Error: "+r);else for(var c=function(r){var c=e+"/"+e+"_"+(r+1);a.load(c,cc.SpriteFrame,function(a,c){a?console.error("Theme Img Load Error: "+a):(t[r].spriteFrame=c,r==d.default.ThemeUnlockNeedMap[e]-1&&i.setUpPuzzlePieces(t,e,o,n))})},s=0;s<d.default.ThemeUnlockNeedMap[e];s++)c(s)})},t.prototype.setUpPuzzlePieces=function(e,t,o,n){void 0===o&&(o=!1);for(var i=function(i){if(o&&n==i+1){e[i].setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite"));var a=e[i].node,c=a.parent;return c&&r.scheduleOnce(function(){var e=cc.instantiate(a);c.addChild(e),e.zIndex=a.zIndex+1,p.default.rewardPosY&&0!=p.default.rewardPosY||(p.default.rewardPosY=200),e.setPosition(cc.v3(-150,p.default.rewardPosY,0)),e.active=!0,e.opacity=0,e.scale=.5;var t=e.getComponent(cc.Sprite);t&&t.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite"));var o=cc.v2(a.position);cc.tween(e).to(.1,{scale:1.5,opacity:255}).parallel(cc.tween().to(.6,{scale:1,opacity:255},{easing:"backIn"}),cc.tween().to(.6,{position:cc.v3(o.x,o.y)},{easing:"sineIn"})).start()},0),o=!1,"continue"}!0===d.default.ThemeUnlockMap[t+"_"+(i+1)]?e[i].setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")):e[i].setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite"))},r=this,a=0;a<d.default.ThemeUnlockNeedMap[t];a++)i(a)},l([y([cc.Sprite])],t.prototype,"puzzle4PieceArr",void 0),l([y([cc.Sprite])],t.prototype,"puzzle9PieceArr",void 0),l([y(cc.Sprite)],t.prototype,"completeImg",void 0),l([h],t)}(cc.Component);r.default=m,cc._RF.pop(),cc._RF.pop()},{}],RandomRiderDisplay:[function(e,t,o){"use strict";cc._RF.push(t,"ca123ueJ7VEppNyc5QOaq+N","RandomRiderDisplay");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"ca123ueJ7VEppNyc5QOaq+N","RandomRiderDisplay");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CollectionManager"),p=n("CollectionData"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spineAnimal=null,t.ifPlayer=!1,t}return s(t,e),t.prototype.onEnable=function(){this.ifPlayer?this.showSpine(u.default.SelectedCharacterIndex):this.showSpine(Math.floor(Math.random()*(p.animalSpine.length-1))+1)},t.prototype.showSpine=function(e){var t=this,o=cc.assetManager.getBundle("AnimalSpines");if(this.spineAnimal.node.scale=5==e?.24:7==e?.282:8==e?.27:.3,!o)return cc.error("AnimalSpines\u8d44\u6e90\u5305\u672a\u52a0\u8f7d\uff0c\u8bf7\u5148\u52a0\u8f7d\u8d44\u6e90\u5305"),void cc.assetManager.loadBundle("AnimalSpines",function(o,n){o?cc.error("\u52a0\u8f7dAnimalSpines\u8d44\u6e90\u5305\u5931\u8d25:",o):n.load(""+p.animalSpineRoot+p.animalSpine[e-1],sp.SkeletonData,function(o,n){o?console.error("\u52a0\u8f7d\u9aa8\u9abc\u52a8\u753b"+p.animalSpine[e-1]+"\u5931\u8d25:",o):(t.spineAnimal.node.active=!0,t.spineAnimal.skeletonData=n,t.spineAnimal.setAnimation(0,p.animationName[e-1],!0))})});o.load(""+p.animalSpineRoot+p.animalSpine[e-1],sp.SkeletonData,function(o,n){o?console.error("\u52a0\u8f7d\u9aa8\u9abc\u52a8\u753b"+p.animalSpine[e-1]+"\u5931\u8d25:",o):(t.spineAnimal.node.active=!0,t.spineAnimal.skeletonData=n,t.spineAnimal.setAnimation(0,p.animationName[e-1],!0))})},l([h(sp.Skeleton)],t.prototype,"spineAnimal",void 0),l([h(cc.Boolean)],t.prototype,"ifPlayer",void 0),l([f],t)}(cc.Component);r.default=y,cc._RF.pop(),cc._RF.pop()},{}],RankPanel:[function(e,t,o){"use strict";cc._RF.push(t,"f5cfdnDH1pC+LDprpdA4Cs2","RankPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"f5cfdnDH1pC+LDprpdA4Cs2","RankPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u,p=n("AudioManager"),d=n("CommonData"),f=n("GameManager"),h=n("CollectionScroll_ChallengeRank"),y=n("CollectionScroll_Rank"),m=n("MyItem"),g=n("Rankdata"),v=n("BasePanel");!function(e){e[e.WORLD=0]="WORLD",e[e.FRIEND=1]="FRIEND",e[e.CHALLENGE=2]="CHALLENGE"}(u||(u={}));var _=cc._decorator,S=_.ccclass,b=_.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.subContextView=null,t.myItem=null,t.collectionScrollRank=null,t.collectionScrollChallengeRank=null,t.sliderNode=null,t.rankState=u.WORLD,t}return s(t,e),t.prototype.onEnable=function(){this.sliderNode.x=-142.5,this.rankState=u.WORLD,this.hideChallengeRank(),this.hideFriendRank(),this.showWorldRank()},t.prototype.hide=function(){1===this.node.scale&&e.prototype.hide.call(this)},t.prototype.showWorldRank=function(){var e=this;if(!this.ifUpdateData())return this.rankState===u.FRIEND?(this.collectionScrollRank.node.active=!1,void(this.myItem.node.active=!1)):(this.collectionScrollChallengeRank.node.active=!1,this.collectionScrollRank.node.active=!0,this.myItem.node.active=!0,void this.myItem.setData(g.default.playerRankData));g.default.getRankData().then(function(){if(e.rankState===u.FRIEND)return e.collectionScrollRank.node.active=!1,void(e.myItem.node.active=!1);e.collectionScrollRank.node.active=!0,e.myItem.node.active=!0,e.myItem.setData(g.default.playerRankData)})},t.prototype.showChallengeRank=function(){var e=this;if(!this.ifUpdateData())return this.rankState===u.FRIEND?(this.collectionScrollChallengeRank.node.active=!1,void(this.myItem.node.active=!1)):(this.collectionScrollRank.node.active=!1,this.collectionScrollChallengeRank.node.active=!0,this.myItem.node.active=!0,void this.myItem.setData(g.default.playerChallengeRankData));g.default.getChallengeRankData().then(function(){if(e.rankState===u.FRIEND)return e.collectionScrollChallengeRank.node.active=!1,void(e.myItem.node.active=!1);e.collectionScrollChallengeRank.node.active=!0,e.myItem.node.active=!0,e.myItem.setData(g.default.playerChallengeRankData)})},t.prototype.ifUpdateData=function(){var e=g.default.playerRankData;return!e||e.score!==d.default.Level},t.prototype.ifUpdateChallengeData=function(){var e=g.default.playerChallengeRankData;return!e||e.score!==d.default.ChallengeRecord},t.prototype.hideWorldRank=function(){this.collectionScrollRank.node.active=!1,this.myItem.node.active=!1},t.prototype.hideChallengeRank=function(){this.collectionScrollChallengeRank.node.active=!1,this.myItem.node.active=!1},t.prototype.showFriendRank=function(){this.subContextView.node.scale=1,f.default.platform.getRank(),this.updatePanel(),this.collectionScrollRank.node.active=!1,this.myItem.node.active=!1},t.prototype.hideFriendRank=function(){0!==this.subContextView.node.scale&&(this.subContextView.node.scale=0,f.default.platform.wxPostMessage({message:d.default.Level-1,type:2}),this.updatePanel())},t.prototype.updatePanel=function(){this.subContextView.reset(),this.subContextView.updateSubContextViewport()},t.prototype.onBtn_worldRank=function(){if(this.rankState===u.FRIEND)this.hideFriendRank();else{if(this.rankState!==u.CHALLENGE)return;this.hideChallengeRank()}this.rankState=u.WORLD,this.sliderNode.x=-142.5,p.default.instance.playSFX(p.AudioRef.ClickButton),this.showWorldRank()},t.prototype.onBtn_challengeRank=function(){if(this.rankState===u.FRIEND)this.hideFriendRank();else{if(this.rankState!==u.WORLD)return;this.hideWorldRank()}this.rankState=u.CHALLENGE,this.sliderNode.x=0,p.default.instance.playSFX(p.AudioRef.ClickButton),this.showChallengeRank()},t.prototype.onBtn_friendRank=function(){if(0==d.default.subFriendRank&&f.default.platform.showSubFriendRank(),this.rankState===u.WORLD)this.hideWorldRank();else{if(this.rankState!==u.CHALLENGE)return;this.hideChallengeRank()}this.rankState=u.FRIEND,this.sliderNode.x=142.5,p.default.instance.playSFX(p.AudioRef.ClickButton),this.showFriendRank()},t.prototype.onBtnClsoe=function(){p.default.instance.playSFX(p.AudioRef.ClickClose),this.rankState===u.FRIEND&&this.hideFriendRank(),this.hide()},t.prototype.onBtn_Share=function(){p.default.instance.playSFX(p.AudioRef.ClickButton),f.default.platform.showShare()},l([b(cc.SubContextView)],t.prototype,"subContextView",void 0),l([b(m.default)],t.prototype,"myItem",void 0),l([b(y.default)],t.prototype,"collectionScrollRank",void 0),l([b(h.default)],t.prototype,"collectionScrollChallengeRank",void 0),l([b(cc.Node)],t.prototype,"sliderNode",void 0),l([S],t)}(v.default);r.default=C,cc._RF.pop(),cc._RF.pop()},{}],Rankdata:[function(e,t,o){"use strict";cc._RF.push(t,"fee0apyBVtNwZuKhSG9v3fu","Rankdata");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"fee0apyBVtNwZuKhSG9v3fu","Rankdata");var c=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},s=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},l=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0});var u=n("config"),p=n("CommonData"),d=n("DataManager"),f=cc._decorator,h=f.ccclass,y=(f.property,"https://api.flysheeep.com/api/pour_water/get_rank"),m="https://api.flysheeep.com/api/pour_water/update_user_info",g=function(){function e(){}var t;return t=e,e.getRankData=function(){var e,o;return s(this,void 0,void 0,function(){var n,i,r,a,c,s;return l(this,function(l){switch(l.label){case 0:if(cc.sys.isBrowser)return[2];if(n=null,u.currentPlatform===u.platformEnum.wechat)n=wx;else{if(u.currentPlatform!==u.platformEnum.toutiao)return[2];n=tt}l.label=1;case 1:return l.trys.push([1,5,,6]),!1!==p.default.userInfoAuthorized||""===p.default.avatarUrl?[3,3]:[4,new Promise(function(e,t){n.request({url:m,method:"POST",header:{"content-type":"application/json","x-appid":p.default.appId},data:{head_url:p.default.avatarUrl,nick_name:p.default.nickName},success:e,fail:t})})];case 2:l.sent(),p.default.userInfoAuthorized=!0,l.label=3;case 3:return[4,new Promise(function(e,t){n.request({url:y,method:"POST",header:{"content-type":"application/json","x-appid":p.default.appId},data:{open_id:p.default.openId,app_id:p.default.appId,game_mode:1},success:e,fail:t})})];case 4:return i=l.sent(),r=null===(e=null==i?void 0:i.data)||void 0===e?void 0:e.data,console.error("res",i),console.error("res.data",i.data),console.error("payload",r),r?(a={rank:r.my_rank.rank,nick_name:r.my_rank.nick_name,head_url:r.my_rank.head_url,score:r.my_rank.rank_level-1},t.playerRankData=a,c=r.list||[],t.rankDataList=c.map(function(e){return{rank:e.rank,nick_name:e.nick_name,head_url:e.head_url,score:e.rank_level-1}}),[3,6]):[2];case 5:return s=l.sent(),null===(o=console.error)||void 0===o||o.call(console,"RankDataManager.getRankData failed",s),[3,6];case 6:return[2]}})})},e.getChallengeRankData=function(){var e,o;return s(this,void 0,void 0,function(){var n,i,r,a,c,s;return l(this,function(l){switch(l.label){case 0:if(cc.sys.isBrowser)return[2];if(n=null,u.currentPlatform===u.platformEnum.wechat)n=wx;else{if(u.currentPlatform!==u.platformEnum.toutiao)return[2];n=tt}l.label=1;case 1:return l.trys.push([1,5,,6]),!1!==p.default.userInfoAuthorized||""===p.default.avatarUrl?[3,3]:[4,new Promise(function(e,t){n.request({url:m,method:"POST",header:{"content-type":"application/json","x-appid":p.default.appId},data:{head_url:p.default.avatarUrl,nick_name:p.default.nickName},success:e,fail:t})})];case 2:l.sent(),p.default.userInfoAuthorized=!0,l.label=3;case 3:return[4,new Promise(function(e,t){n.request({url:y,method:"POST",header:{"content-type":"application/json","x-appid":p.default.appId},data:{open_id:p.default.openId,app_id:p.default.appId,game_mode:2},success:e,fail:t})})];case 4:return i=l.sent(),r=null===(e=null==i?void 0:i.data)||void 0===e?void 0:e.data,console.error("res",i),console.error("res.data",i.data),console.error("payload",r),r?(a={rank:r.my_rank.rank,nick_name:r.my_rank.nick_name,head_url:r.my_rank.head_url,score:r.my_rank.rank_level},t.playerChallengeRankData=a,c=r.list||[],t.challengeRankDataList=c.map(function(e){return{rank:e.rank,nick_name:e.nick_name,head_url:e.head_url,score:e.rank_level}}),[3,6]):[2];case 5:return s=l.sent(),null===(o=console.error)||void 0===o||o.call(console,"RankDataManager.getRankData failed",s),[3,6];case 6:return[2]}})})},e.getRandomPlayerInfo=function(){var e,o;return s(this,void 0,void 0,function(){var n,i,r,a,c,s,d,f;return l(this,function(l){switch(l.label){case 0:if(n=null,u.currentPlatform===u.platformEnum.wechat)n=wx;else{if(u.currentPlatform!==u.platformEnum.toutiao)return[2];n=tt}l.label=1;case 1:return l.trys.push([1,3,,4]),[4,new Promise(function(e,t){n.request({url:"https://api.flysheeep.com/api/pourpour/get_random_user",method:"POST",header:{"content-type":"application/json","x-appid":p.default.appId},success:e,fail:t})})];case 2:return i=l.sent(),r=null===(e=null==i?void 0:i.data)||void 0===e?void 0:e.data,console.error("get-random-user-res",i),r?(a={rank:0,nick_name:r.list[0].nick_name,head_url:r.list[0].head_url,score:0},c={rank:0,nick_name:r.list[1].nick_name,head_url:r.list[1].head_url,score:0},s={rank:0,nick_name:r.list[2].nick_name,head_url:r.list[2].head_url,score:0},d={rank:0,nick_name:r.list[3].nick_name,head_url:r.list[3].head_url,score:0},t.randomPlayerData=a,t.randomPlayerData2=c,t.randomPlayerData3=s,t.randomPlayerData4=d,[3,4]):[2];case 3:return f=l.sent(),null===(o=console.error)||void 0===o||o.call(console,"RankDataManager.getRandomPlayerInfo failed",f),[3,4];case 4:return[2]}})})},Object.defineProperty(e,"RankCache",{get:function(){var e=p.default.getStorage("RankCache");return null==e||""===e||isNaN(parseInt(e))?0:(t._rankCache=parseInt(e),t._rankCache)},set:function(e){p.default.setStorage("RankCache",e)},enumerable:!1,configurable:!0}),e.getCurFakeRank=function(){if(cc.sys.isBrowser)return 3333;var e=0,o=0;return t.playerRankData&&0==t.playerRankData.rank?(e=t.rankDataList[t.rankDataList.length-1].score,o=100+Math.floor(1e7*Math.pow((e-p.default.Level)/e,2)),t.RankCache=o,o):(t.RankCache=t.playerRankData.rank,t.playerRankData.rank)},e.getPrevFakeRank=function(){if(cc.sys.isBrowser)return 9999;var e=t.RankCache;return e<=0?this.getCurFakeRank():e},e.syncChallengeRecord=function(){var e=this;this.getChallengeRankData().then(function(){var t=Math.max(p.default.ChallengeRecord,e.playerChallengeRankData?e.playerChallengeRankData.score:0);d.default.updateChallengeRecord(t)})},e.rankDataList=[],e.challengeRankDataList=[],e.playerRankData=null,e.playerChallengeRankData=null,e.randomPlayerData=null,e.randomPlayerData2=null,e.randomPlayerData3=null,e.randomPlayerData4=null,e._rankCache=0,t=c([h],e)}();r.default=g,cc._RF.pop(),cc._RF.pop()},{}],ResourceManager_SS:[function(e,t,o){"use strict";cc._RF.push(t,"4a477XkGDdAaJvty+yFdMoY","ResourceManager_SS");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"4a477XkGDdAaJvty+yFdMoY","ResourceManager_SS");var a=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(i,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,l=(c.property,function(){function e(){}return e.panelsBundle=null,e.panelsList={},e.screwSortBundle=null,e.screwSortGamePrefab=null,e.boltsPrefab=[],e.collectRes={},e.ifCollectShop_Loaded=!1,a([s],e)}());i.default=l,cc._RF.pop(),cc._RF.pop()},{}],RewardPanel:[function(e,t,o){"use strict";cc._RF.push(t,"7232fv/jwdMJ4CBv/d6mE0T","RewardPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"7232fv/jwdMJ4CBv/d6mE0T","RewardPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("CollectionManager"),d=n("CommonData"),f=n("const"),h=n("UIManager"),y=n("BasePanel"),m=cc._decorator,g=m.ccclass,v=m.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Icons_Reward=[],t.Animation_Title=null,t.Animation_Titleback=null,t.GameClubRewardNode=null,t.RewardImage=null,t.RewardName=null,t.btn_collection=null,t.btn_change=null,t.light_effect=null,t.Animation_Box=null,t.RewardIcons=[],t.contentNode=null,t.type=0,t.id=0,t}return s(t,e),t.prototype.initReward=function(e,t,o,n,i){var r=this;void 0===t&&(t=0),void 0===o&&(o=0),void 0===n&&(n=!1),void 0===i&&(i=1),this.Icons_Reward[0].parent.active=!0,e.every(function(e){return 0===e})&&(this.Icons_Reward[0].parent.active=!1);for(var a=0;a<this.Icons_Reward.length;a++)e[a]>0?(this.Icons_Reward[a].active=!0,this.Icons_Reward[a].children[0].getComponent(cc.Label).string="X"+e[a]):this.Icons_Reward[a].active=!1;n&&(this.contentNode.scale=0,this.Animation_Box&&(this.Animation_Box.node.active=!0,this.Animation_Box.setCompleteListener(function(){r.Animation_Box.node.active=!1})),cc.tween(this.contentNode).delay(1).to(.5,{scale:1},{easing:"backOut"}).start()),this.RewardImage.node.parent.y=200,0!=o&&(1==o?(this.type=1,this.id=t,this.RewardImage.node.parent.y=100,this.setImgAndName(o,t),this.btn_change.active=!0,this.btn_collection.active=!0,cc.director.getScene().name!==f.SceneNames.Game&&(this.btn_collection.active=!1)):2==o?(this.type=2,this.id=t,this.RewardImage.node.parent.y=100,this.setImgAndName(o,t),this.btn_change.active=!0,this.btn_collection.active=!0):3==o&&(this.type=3,this.id=t,this.RewardImage.node.parent.y=100,this.light_effect.active=!0,this.light_effect.position=this.RewardImage.node.position,1===i?this.RewardImage.node.x+=10:2===i?this.RewardImage.node.y-=10:3===i?this.RewardImage.node.y+=10:4===i&&(this.RewardImage.node.x-=10),this.setImgAndName(o,t,i),this.btn_change.active=!1,this.btn_collection.active=!1))},t.prototype.initGameClubReward=function(e,t,o){void 0===e&&(e=[0,0,0,0]),void 0===t&&(t=15),void 0===o&&(o=1),this.initReward(e,t,o)},t.prototype.setImgAndName=function(e,t,o){var n=this;void 0===e&&(e=0),void 0===t&&(t=0),void 0===o&&(o=0),this.RewardImage.node.active=!0;var i="";1==e?i="Caps":2==e?i="Animals":3==e&&(i="Theme");var r=cc.assetManager.getBundle(i);r?this.loadDrinkTexture(r,t,e,o):cc.assetManager.loadBundle(i,function(i,r){i?cc.error("\u52a0\u8f7dDrinkTexture\u8d44\u6e90\u5305\u5931\u8d25:",i):n.loadDrinkTexture(r,t,e,o)})},t.prototype.loadDrinkTexture=function(e,t,o,n){var i=this;if(void 0===n&&(n=0),3===o){var r=t+"/"+t+"_"+n;return e.load(r,cc.SpriteFrame,function(e,t){e?cc.error("\u52a0\u8f7d\u56fe\u7247"+r+"\u5931\u8d25:",e):i.RewardImage.spriteFrame=t}),void(this.RewardImage.node.scale=.8)}e.load(""+t,cc.Texture2D,function(e,o){e?cc.error("\u52a0\u8f7d\u56fe\u7247"+t+"\u5931\u8d25:",e):i.RewardImage.spriteFrame=new cc.SpriteFrame(o)}),1===o?(this.RewardImage.node.scale=2.5,this.RewardName.string=p.default.capNameMap[t]):2===o&&(this.RewardImage.node.scale=.8,this.RewardName.string=p.default.characterNameMap[t])},t.prototype.onEnable=function(){var e=this;u.default.instance.playSFX(u.AudioRef.Reward),this.Animation_Title&&(this.Animation_Title.setAnimation(0,"animation",!1),this.Animation_Title.setCompleteListener(function(){e.Animation_Title.setAnimation(0,"animation_loop",!0)}))},t.prototype.initTitle=function(){var e=this;this.Animation_Title&&(this.Animation_Title.setAnimation(0,"gxhd_start",!1),this.Animation_Title.setCompleteListener(function(){e.Animation_Title.setAnimation(0,"gxhd_idle",!0)})),this.Animation_Titleback&&(this.Animation_Titleback.setAnimation(0,"animation",!1),this.Animation_Titleback.setCompleteListener(function(){e.Animation_Titleback.setAnimation(0,"animation_loop",!0)}))},t.prototype.show=function(){this.init(),this.node.active=!0,this.node.opacity=255,this.node.scale=1;var e=this.node.getChildByName("Root");e&&(cc.Tween.stopAllByTarget(e),e.scale=.5,e.opacity=0,cc.tween(e).to(.2,{scale:1.1,opacity:150},{easing:"smooth"}).to(.2,{scale:1,opacity:255},{easing:"smooth"}).call(function(){}).start())},t.prototype.hide=function(){var e=this.node.getChildByName("Root"),t=this;if(3==this.type)return t.node.active=!1,void h.default.getInstance().showPanel("BeginnerTaskPanel");e&&(cc.Tween.stopAllByTarget(e),e.scale=1,e.opacity=255,cc.tween(e).to(.2,{scale:.5,opacity:100},{easing:"smooth"}).delay(.05).call(function(){t.node.active=!1}).start())},t.prototype.onBtn_Change=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),1===this.type?d.default.SelectedCapIndex=this.id:2===this.type&&(d.default.SelectedCharacterIndex=this.id),this.hide()},t.prototype.onBtn_Collection=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),cc.Canvas.instance.node.getChildByName("UIRoot").getComponent(h.default).showPanel("CollectionPanel")},l([v([cc.Node])],t.prototype,"Icons_Reward",void 0),l([v(sp.Skeleton)],t.prototype,"Animation_Title",void 0),l([v(sp.Skeleton)],t.prototype,"Animation_Titleback",void 0),l([v(cc.Node)],t.prototype,"GameClubRewardNode",void 0),l([v(cc.Sprite)],t.prototype,"RewardImage",void 0),l([v(cc.Label)],t.prototype,"RewardName",void 0),l([v(cc.Node)],t.prototype,"btn_collection",void 0),l([v(cc.Node)],t.prototype,"btn_change",void 0),l([v(cc.Node)],t.prototype,"light_effect",void 0),l([v(sp.Skeleton)],t.prototype,"Animation_Box",void 0),l([v([cc.Sprite])],t.prototype,"RewardIcons",void 0),l([v(cc.Node)],t.prototype,"contentNode",void 0),l([g],t)}(y.default);r.default=_,cc._RF.pop(),cc._RF.pop()},{}],RingFightManager:[function(e,t,o){"use strict";cc._RF.push(t,"d7e1fTMMpFF8YyFfZe0BZll","RingFightManager");var n=e,i=t,r=o;cc._RF.push(i,"d7e1fTMMpFF8YyFfZe0BZll","RingFightManager"),Object.defineProperty(r,"__esModule",{value:!0});var a=n("config"),c=n("GameManager"),s=n("const"),l="wxeb3a3f764474c346"==n("AppConfig").appId?"challenge":"timeTest",u=function(){function e(){this.isChallenger=!1}return Object.defineProperty(e,"instance",{get:function(){return a.currentPlatform!==a.platformEnum.wechat?new Proxy({},{get:function(){return function(){}}}):(this._instance||(this._instance=new e),this._instance)},enumerable:!1,configurable:!0}),e.prototype.init=function(){var e=this;wx.getRankManager().onChallengeStart(function(t){e.isChallenger=!0,console.error("\u6311\u6218\u8d5b\u5f00\u59cb",t),c.default.hideGameClubButton(),cc.director.getScene().name!==s.SceneNames.Load&&cc.director.loadScene(s.SceneNames.RingFight),console.error("challengeInfo",t)})},e.prototype.create=function(e){var t=wx.getRankManager();t.update({scoreKey:l,score:1e3*e,success:function(e){console.error("\u5206\u6570\u4e0a\u62a5\u6210\u529f",e),t.createChallenge({scoreKey:l,success:function(e){console.error("\u64c2\u53f0\u8d5b\u521b\u5efa\u6210\u529f",e)},fail:function(e){console.error("\u64c2\u53f0\u8d5b\u521b\u5efa\u5931\u8d25",e)}})},fail:function(e){console.error("\u5206\u6570\u4e0a\u62a5\u5931\u8d25",e)}})},e.prototype.plainCreate=function(){wx.getRankManager().createChallenge({scoreKey:l,success:function(e){console.error("\u64c2\u53f0\u8d5b\u521b\u5efa\u6210\u529f",e)},fail:function(e){console.error("\u64c2\u53f0\u8d5b\u521b\u5efa\u5931\u8d25",e)}})},e.prototype.midUpdate=function(e){wx.getRankManager().middleUpdate({scoreKey:l,score:1e3*e,success:function(e){console.error("\u64c2\u53f0\u8d5b\u5206\u6570\u66f4\u65b0\u6210\u529f",e)},fail:function(e){console.error("\u64c2\u53f0\u8d5b\u5206\u6570\u66f4\u65b0\u5931\u8d25",e)}})},e.prototype.fullUpdate=function(e){wx.getRankManager().update({scoreKey:l,score:1e3*e,success:function(e){console.error("\u64c2\u53f0\u8d5b\u5206\u6570\u66f4\u65b0\u6210\u529f",e)},fail:function(e){console.error("\u64c2\u53f0\u8d5b\u5206\u6570\u66f4\u65b0\u5931\u8d25",e)}})},e.prototype.abort=function(){wx.getRankManager().abort({success:function(e){console.error("\u64c2\u53f0\u8d5b\u653e\u5f03\u6210\u529f",e)},fail:function(e){console.error("\u64c2\u53f0\u8d5b\u653e\u5f03\u5931\u8d25",e)}})},e}();r.default=u,cc._RF.pop(),cc._RF.pop()},{}],Row_ED:[function(e,t,o){"use strict";cc._RF.push(t,"36900cm8k9Fo64NVtb4jWM8","Row_ED");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"36900cm8k9Fo64NVtb4jWM8","Row_ED");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("Cup_ED"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cupImgBottomArea=null,t.cupsArea=null,t.row_uid=0,t.cupAmounts=0,t.rowRear=null,t}return s(t,e),t.prototype.initBottle=function(e,t){e<0||e>=this.cupsArea.children.length||this.cupsArea.children[e].getComponent(u.default).initBottle(t)},t.prototype.bindBottleRear=function(){var e=this;this.cupsArea.children.forEach(function(t){var o,n,i=t.getComponent(u.default).colIndex,r="row_x4"===e.node.name?4:3;t.getComponent(u.default).bottle_leftRear=null===(o=e.rowRear.cupsArea.children[4===r?i-1:i])||void 0===o?void 0:o.getComponent(u.default),t.getComponent(u.default).bottle_rightRear=null===(n=e.rowRear.cupsArea.children[4===r?i:i+1])||void 0===n?void 0:n.getComponent(u.default)})},l([f(cc.Node)],t.prototype,"cupImgBottomArea",void 0),l([f(cc.Node)],t.prototype,"cupsArea",void 0),l([d],t)}(cc.Component);r.default=h,cc._RF.pop(),cc._RF.pop()},{}],ScrewSortGame_SS:[function(e,t,o){"use strict";cc._RF.push(t,"92f0eVMfSFK/LRQUTtytop8","ScrewSortGame_SS");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"92f0eVMfSFK/LRQUTtytop8","ScrewSortGame_SS");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<o;t++)for(var r=arguments[t],a=0,c=r.length;a<c;a++,i++)n[i]=r[a];return n};Object.defineProperty(r,"__esModule",{value:!0});var p=n("CommonData"),d=n("AutoPlay_SS"),f=n("CommonData_SS"),h=n("DataManager_SS"),y=n("GameManager_SS"),m=n("MusicManager_SS"),g=n("UIManager_SS"),v=n("ScrewSortGenerateConfigured_SS"),_=n("ScrewSortGenerate_SS"),S=cc._decorator,b=S.ccclass,C=S.property,P=S.menu,k=p.default.ifTest?999:3,w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.boltsArea=null,t.steelBackLayer=null,t.steelLayer=null,t.locateNode=null,t.btns=null,t.mask=null,t.numberLayer=null,t.guideLabel=null,t.screw=null,t.steel=null,t.steelBack=null,t.steelLocked=null,t.firework=null,t.drop=null,t.light=null,t.steelTop=null,t.guide=null,t.addListGuide=null,t.withdrawBtn=null,t.addListBtn=null,t.putTopBtn=null,t.withdrawTimesBg=null,t.addListTimesBg=null,t.putTopTimesBg=null,t.withdrawTimes=null,t.addListTimes=null,t.putTopTimes=null,t.screwSF=[],t.screwBackSF=[],t.steelSF=[],t.screwHideSF=null,t.screwHideBackSF=null,t.timesBg=[],t.pushAudio=null,t.popAudio=null,t.completeAudio=null,t.isDialogShowing=!1,t.dialogCount=999,t.dialogTweenDuration=.1,t.withdrawDialog=null,t.addListDialog=null,t.putTopDialog=null,t.putTopTips=null,t.dialogTimer=0,t.ifDuringGenerate=!0,t.ifGameWin=!1,t.reviveTimes=2,t.stalemateTimes=2,t.audioLimit=0,t.ifPopScrew=!1,t._canOperate=!1,t.restAmount=0,t.restLocked=0,t.lastSteelIndex=0,t.typeInOperation=0,t.screwInOperation=[],t.screwInOperation_Back=[],t.operationRecord=[],t.ifPuttingTop=!1,t.chockLevel=[[[3,3,4,1,1,1,5,5,3,3,1,4,4,1,5,5,5],[2,5,4,4,1,2,2,3,3,1,3,3,1,1,1,1,4],[1,1,1,5,5,5,4,4,4,3,1,1,3,4,4,4,4],[2,2,2,1,2,4,4,4,5,2,2,4,5,5,5,3,2],[2,2,5,3,3,5,3,3,5,5,2,2,3,3,2,2,2]],[[1,3,5,2,2,2,2,1,1,1,1,4,3,1,1,1,3],[3,5,5,5,3,1,1,5,3,5,5,1,1,3,3,5,5],[4,1,1,1,1,3,3,4,4,4,3,4,1,4,5,5,5],[2,4,2,5,5,5,4,3,2,5,5,4,3,2,2,2,2],[4,3,3,2,2,2,4,4,4,3,3,4,4,4,2,2,2]],[[4,4,4,2,5,4,4,4,1,3,3,1,2,2,5,5,3],[4,1,5,1,1,3,3,4,4,4,4,3,3,3,2,2,5],[4,4,1,1,5,5,3,3,3,3,4,4,4,1,1,1,1],[3,3,3,3,2,4,2,2,3,2,5,1,1,1,5,5,5],[2,2,2,2,1,2,1,5,2,5,5,5,1,2,2,5,5]],[[3,3,3,2,2,2,2,3,3,3,4,4,4,5,1,1,2],[2,2,5,5,1,1,5,5,5,5,3,4,3,3,2,4,4],[4,4,2,5,5,5,5,5,1,4,4,2,2,2,2,1,1],[1,4,4,1,1,1,4,4,4,1,3,3,4,4,5,5,1],[1,2,1,1,2,2,2,1,3,3,3,3,5,5,5,3,3]],[[1,3,3,3,2,2,2,5,5,5,5,5,4,4,4,5,5],[5,1,1,5,3,3,5,5,5,3,3,1,4,4,1,5,5],[5,2,3,3,3,3,2,2,2,3,4,5,5,2,4,4,4],[4,3,3,1,1,1,2,4,1,2,2,2,2,4,4,4,1],[4,4,2,2,2,2,1,1,1,4,1,3,3,3,1,1,1]],[[1,3,5,1,3,3,4,3,3,3,3,4,4,4,1,4,4],[4,1,1,1,1,5,1,1,1,1,4,4,4,5,5,5,2],[2,2,2,1,1,1,2,2,1,3,3,3,3,2,2,1,1],[4,4,4,3,2,3,5,5,5,4,4,3,3,3,4,4,2],[2,2,5,5,3,5,5,5,2,5,5,2,5,2,5,2,2]]],t}var o;return s(t,e),o=t,t.prototype.showItemDialog=function(){this.dialogCount<=0||this.isDialogShowing||(this.dialogCount--,this.isDialogShowing=!0,console.log("\u5192\u6ce1\u63d0\u793a:"),this.showDialog(this.withdrawDialog),this.showDialog(this.addListDialog),this.showDialog(this.putTopDialog))},t.prototype.hideItemDialog=function(){console.log("\u6536\u56de\u5192\u6ce1:"),this.dialogTimer=0,this.isDialogShowing=!1,this.hideDialog(this.withdrawDialog),this.hideDialog(this.addListDialog),this.hideDialog(this.putTopDialog)},t.prototype.showDialog=function(e){cc.tween(e).to(this.dialogTweenDuration,{scale:1}).start()},t.prototype.hideDialog=function(e){cc.tween(e).to(this.dialogTweenDuration,{scale:0}).start()},t.prototype.onLoad=function(){o.instance=this},t.prototype.start=function(){this.updateToolsTimes(),this.withdrawBtn.interactable=!1,this.withdrawTimesBg.node.color=cc.Color.GRAY,this.mask.opacity=f.default.ifOpenBlock?150:0,this.generateGame()},t.prototype.generateGame=function(){switch(this.reviveTimes=2,this.stalemateTimes=0,f.default.mode){case f.default.gameMode.configured:v.default.generateConfiguredLevel();break;case f.default.gameMode.normal:1===h.default.curLevel?(_.default.generateLevel(!0),this.guideLabel.active=!0):_.default.generateLevel(!1)}},t.prototype.checkAutoPlay=function(){f.default.ifOpenAuto&&(this.canOperate=!1,this.scheduleOnce(function(){d.default.startAutoPlay()},2.5))},t.prototype.update=function(e){this.canOperate&&(this.dialogTimer+=e),this.dialogTimer>15&&this.showItemDialog()},Object.defineProperty(t.prototype,"canOperate",{get:function(){return this._canOperate},set:function(e){this._canOperate=e,this.mask.active=!e,e||(this.audioLimit=0)},enumerable:!1,configurable:!0}),t.prototype.updateToolsTimes=function(){this.withdrawTimes.string=h.default.withdrawTimes>0?h.default.withdrawTimes.toString():"+",this.withdrawTimes.node.active=h.default.withdrawTimes>0,this.withdrawTimesBg.spriteFrame=h.default.withdrawTimes>0?this.timesBg[0]:this.timesBg[1],this.addListTimes.string=h.default.addListTimes>0?h.default.addListTimes.toString():"+",this.addListTimes.node.active=h.default.addListTimes>0,this.addListTimesBg.spriteFrame=h.default.addListTimes>0?this.timesBg[0]:this.timesBg[1],this.putTopTimes.string=h.default.putTopTimes>0?h.default.putTopTimes.toString():"+",this.putTopTimes.node.active=h.default.putTopTimes>0,this.putTopTimesBg.spriteFrame=h.default.putTopTimes>0?this.timesBg[0]:this.timesBg[1]},t.prototype.playFireworkAnim=function(e){var t,o,n,i=this,r=cc.instantiate(this.steelTop);r.parent=e,r.setPosition(0,e.height+30),r.scale=0;var a=cc.tween;a(r).parallel(a().by(.15,{y:20},{easing:"quadOut"}),a().to(.3,{scale:1.2},{easing:"bounceOut"})).parallel(a().to(.25,{y:e.height-10},{easing:"quadIn"}),a().to(.25,{scale:1},{easing:"bounceIn"})).delay(.1).call(function(){var a=cc.instantiate(i.light);a.parent=i.node,a.setPosition(i.node.convertToNodeSpaceAR(e.convertToWorldSpaceAR(cc.Vec2.ZERO))),a.scaleY*=e.height/925,e.color=cc.Color.GRAY,r.color=cc.Color.GRAY,t=cc.instantiate(i.firework),e.height>900&&((o=cc.instantiate(i.firework)).parent=i.node,o.setPosition(i.node.convertToNodeSpaceAR(e.convertToWorldSpaceAR(cc.v2(0,.2*e.height)))),(n=cc.instantiate(i.firework)).parent=i.node,n.setPosition(i.node.convertToNodeSpaceAR(e.convertToWorldSpaceAR(cc.v2(0,.4*e.height))))),t.parent=i.node,t.setPosition(i.node.convertToNodeSpaceAR(e.convertToWorldSpaceAR(cc.Vec2.ZERO)))}).start(),cc.tween(t).delay(4).call(function(){t.destroy(),e.height>900&&(o.destroy(),n.destroy()),(void 0).destroy()}).start()},t.prototype.playDropDownAnim=function(e){var t=cc.instantiate(this.drop);t.parent=e,t.setSiblingIndex(0),t.setPosition(0,-30),cc.tween(t).delay(4).call(function(){t.destroy()}).start()},t.prototype.playPushAudio=function(e){h.default.soundOn&&this.audioLimit<(e||k)&&(cc.audioEngine.play(this.pushAudio,!1,1),this.audioLimit++)},t.prototype.playPopAudio=function(e){h.default.soundOn&&this.audioLimit<(e||k)&&(cc.audioEngine.play(this.popAudio,!1,1),this.audioLimit++)},t.prototype.gameWin=function(){this.hideItemDialog(),this.ifGameWin=!0,console.error("\u6e38\u620f\u80dc\u5229"),g.default.instance.showPanel(g.default.instance.pnlEnum.gameOver),m.default.instance.playWinAudio()},t.prototype.withdraw=function(){var e=this;if(this.hideItemDialog(),this.canOperate=!1,0===this.screwInOperation.length)this._executeWithdraw(function(){e.canOperate=!0});else{var t=this.steelLayer.children[this.lastSteelIndex].getComponent("ScrewSortSteel_SS");t._lastSteelIndex=this.lastSteelIndex,t._curOperatingList=u(this.screwInOperation),this.screwInOperation=[],t._curOperatingList_Back=u(this.screwInOperation_Back),this.screwInOperation_Back=[],t.retreatScrew(function(){t._canOperate=!0,e._executeWithdraw(function(){t._canOperate=!0,e.canOperate=!0})})}},t.prototype._executeWithdraw=function(e){var t,o=this,n=this.operationRecord[this.operationRecord.length-1];if("push"===n.state){for(var i=this.steelLayer.children[n.list[0].from.list].getComponent("ScrewSortSteel_SS"),r=this.steelLayer.children[n.list[0].to.list].getComponent("ScrewSortSteel_SS"),a=function(e){var t=n.list[e],a=i.getScrewPosY(t.from.i),s=c.steelLayer.children[t.to.list].getChildByName("screwArea").children[t.to.i];cc.tween(s).to(.25,{scale:0,opacity:0}).call(function(){var e=cc.instantiate(s);e.parent=o.steelLayer.children[t.from.list].getChildByName("screwArea"),e.setPosition(0,a),cc.tween(e).to(.25,{scale:1,opacity:255}).start(),s.destroy()}).start();var l=c.steelBackLayer.children[t.to.list].getChildByName("screwArea").children[t.to.i];cc.tween(l).to(.25,{scale:0,opacity:0}).call(function(){var e=cc.instantiate(l);e.parent=o.steelBackLayer.children[t.from.list].getChildByName("screwArea"),e.setPosition(0,a),cc.tween(e).to(.25,{scale:1,opacity:255}).start(),l.destroy()}).start(),i.pushToScrewList(t.from.i,t.type),r.spliceFromScrewList(t.to.i)},c=this,s=n.list.length-1;s>=0;s--)a(s);r.onWithdrawCall()}else if("putTop"===n.state){var l=n.list[0],u=this.steelLayer.children[l.from.list].getComponent("ScrewSortSteel_SS");n.list.forEach(function(e){var t=u.getScrewPosY(e.from.i),n=o.steelLayer.children[e.to.list].getChildByName("screwArea").children[e.to.i];cc.tween(n).to(.25,{scale:0,opacity:0}).call(function(){n.setPosition(0,t),cc.tween(n).to(.25,{scale:1,opacity:255}).start()}).start();var i=o.steelBackLayer.children[e.to.list].getChildByName("screwArea").children[e.to.i];cc.tween(i).to(.25,{scale:0,opacity:0}).call(function(){i.setPosition(0,t),cc.tween(i).to(.25,{scale:1,opacity:255}).start()}).start()}),this.steelLayer.children[l.to.list].getChildByName("screwArea").children[l.to.i].setSiblingIndex(l.from.i),this.steelBackLayer.children[l.to.list].getChildByName("screwArea").children[l.to.i].setSiblingIndex(l.from.i),u.rearrangeScrewList(l.to.i,l.from.i)}n.unlockData&&((t=this.steelLayer.children[n.unlockData.list].getComponent("ScrewSortSteel_SS")).node.getChildByName("screwArea").children[n.unlockData.i].getChildByName("lock").active=!0,t._screwList[n.unlockData.i]+=1e3),n.unhideData&&((t=this.steelLayer.children[n.unhideData.list].getComponent("ScrewSortSteel_SS")).node.getChildByName("screwArea").children[n.unhideData.i].getChildByName("hide").active=!0,t._screwArea_Back.children[n.unhideData.i].getChildByName("hide").active=!0,t._screwList[n.unhideData.i]+=100),this.scheduleOnce(function(){e&&e()},.5),this.operationRecord.splice(this.operationRecord.length-1,1),0===this.operationRecord.length&&(this.withdrawBtn.interactable=!1,this.withdrawTimesBg.node.color=cc.Color.GRAY)},t.prototype.addList=function(){this.hideItemDialog();for(var e=0;e<this.steelLayer.children.length;e++)if(this.steelLayer.children[e].getChildByName("lock")){this.steelLayer.children[e].color=cc.Color.WHITE,this.steelLayer.children[e].getChildByName("lock").destroy(),this.restLocked--,0===this.restLocked&&(this.addListBtn.interactable=!1,this.addListTimesBg.node.color=cc.Color.GRAY);break}},t.prototype.putTop=function(){var e=this;if(this.hideItemDialog(),this.btns.active=!1,this.putTopTips.active=!0,this.canOperate=!1,0===this.screwInOperation.length)this.canOperate=!0;else{var t=this.steelLayer.children[this.lastSteelIndex].getComponent("ScrewSortSteel_SS");t._curOperatingColor=this.typeInOperation,t._lastSteelIndex=this.lastSteelIndex,t._curOperatingList=u(this.screwInOperation),this.screwInOperation=[],t._curOperatingList_Back=u(this.screwInOperation_Back),this.screwInOperation_Back=[],t.retreatScrew(function(){e.canOperate=!0,t._canOperate=!0})}this.ifPuttingTop||(this.ifPuttingTop=!0)},t.prototype.revive=function(){var e=f.default.mode===f.default.gameMode.normal?-200:-400,t=cc.v2(1===this.reviveTimes?-300:300,e-100),o=this.steelLayer.children.length,n=cc.instantiate(this.steel);n.parent=this.steelLayer,n.getComponent(cc.Sprite).spriteFrame=this.steelSF[Math.max(1,0)],n.setPosition(t),n.opacity=0,n.scale=.75,cc.tween(n).to(.25,{y:e,opacity:255}).start();var i=cc.instantiate(this.steelBack);i.parent=this.steelBackLayer,i.getComponent(cc.Sprite).spriteFrame=n.getComponent(cc.Sprite).spriteFrame,i.setPosition(n.getPosition()),i.opacity=0,i.scale=.75,cc.tween(i).to(.25,{y:e,opacity:255}).start();var r=n.getComponent("ScrewSortSteel_SS");r.steelInit(o,Math.max(2,1),!0),r.createScrew([]);var a=cc.instantiate(this.numberLayer.children[0]);a.parent=this.numberLayer,a.getComponent(cc.Label).string=(o+1).toString(),a.setPosition(n.getPosition().x,n.getPosition().y+60),a.active=!0},t.prototype.checkIfStalemate=function(){for(var e=0;e<this.steelLayer.children.length;e++){var t=this.steelLayer.children[e].getComponent("ScrewSortSteel_SS");if(!this.steelLayer.children[e].getChildByName("lock")&&!t._ifComplete&&t.checkIfCanPlace())return}this.stalemateTimes++,console.warn("\u50f5\u5c40"),this.reviveTimes>0&&this.stalemateTimes%5==0&&g.default.instance.showPanel(g.default.instance.pnlEnum.revive)},t.prototype.clickWithdraw=function(){y.default.playVibrateShort(),h.default.withdrawTimes>0?(h.default.withdrawTimes--,this.updateToolsTimes(),this.withdraw()):g.default.instance.showPanel(g.default.instance.pnlEnum.withdraw)},t.prototype.clickAddList=function(){y.default.playVibrateShort(),f.default.mode===f.default.gameMode.configured&&2===h.default.curLevel?(this.addList(),this.node.getChildByName("addListGuide")&&this.node.getChildByName("addListGuide").destroy()):h.default.addListTimes>0?(h.default.addListTimes--,this.updateToolsTimes(),this.addList()):g.default.instance.showPanel(g.default.instance.pnlEnum.addList)},t.prototype.clickPutTop=function(){y.default.playVibrateShort(),h.default.putTopTimes>0?(h.default.putTopTimes--,this.updateToolsTimes(),this.putTop()):g.default.instance.showPanel(g.default.instance.pnlEnum.putTop)},t.prototype.skipLevel=function(){console.log("GameManager>>>\u8df3\u5173\uff01"),this.hideItemDialog()},t.prototype.onDisable=function(){this.hideItemDialog()},t.instance=null,l([C(cc.Node)],t.prototype,"boltsArea",void 0),l([C(cc.Node)],t.prototype,"steelBackLayer",void 0),l([C(cc.Node)],t.prototype,"steelLayer",void 0),l([C(cc.Node)],t.prototype,"locateNode",void 0),l([C(cc.Node)],t.prototype,"btns",void 0),l([C(cc.Node)],t.prototype,"mask",void 0),l([C(cc.Node)],t.prototype,"numberLayer",void 0),l([C(cc.Node)],t.prototype,"guideLabel",void 0),l([C({type:cc.Prefab,tooltip:"\u87ba\u6bcd\u9884\u5236\u4f53"})],t.prototype,"screw",void 0),l([C({type:cc.Prefab,tooltip:"\u87ba\u6813\u9884\u5236\u4f53"})],t.prototype,"steel",void 0),l([C({type:cc.Prefab,tooltip:"\u900f\u89c6\u5c42\u87ba\u6813\u9884\u5236\u4f53"})],t.prototype,"steelBack",void 0),l([C({type:cc.Prefab,tooltip:"\u4e0a\u9501\u87ba\u6813\u9884\u5236\u4f53"})],t.prototype,"steelLocked",void 0),l([C(cc.Prefab)],t.prototype,"firework",void 0),l([C(cc.Prefab)],t.prototype,"drop",void 0),l([C(cc.Prefab)],t.prototype,"light",void 0),l([C(cc.Prefab)],t.prototype,"steelTop",void 0),l([C(cc.Prefab)],t.prototype,"guide",void 0),l([C(cc.Prefab)],t.prototype,"addListGuide",void 0),l([C(cc.Button)],t.prototype,"withdrawBtn",void 0),l([C(cc.Button)],t.prototype,"addListBtn",void 0),l([C(cc.Button)],t.prototype,"putTopBtn",void 0),l([C(cc.Sprite)],t.prototype,"withdrawTimesBg",void 0),l([C(cc.Sprite)],t.prototype,"addListTimesBg",void 0),l([C(cc.Sprite)],t.prototype,"putTopTimesBg",void 0),l([C(cc.Label)],t.prototype,"withdrawTimes",void 0),l([C(cc.Label)],t.prototype,"addListTimes",void 0),l([C(cc.Label)],t.prototype,"putTopTimes",void 0),l([C({type:cc.SpriteFrame,tooltip:"\u87ba\u6bcd\u56fe\u7247\uff08\u4e0a\u5c42\uff09"})],t.prototype,"screwSF",void 0),l([C({type:cc.SpriteFrame,tooltip:"\u87ba\u6bcd\u56fe\u7247\uff08\u900f\u89c6\u5c42\uff09"})],t.prototype,"screwBackSF",void 0),l([C({type:cc.SpriteFrame,tooltip:"\u87ba\u6813\u56fe\u7247"})],t.prototype,"steelSF",void 0),l([C(cc.SpriteFrame)],t.prototype,"screwHideSF",void 0),l([C(cc.SpriteFrame)],t.prototype,"screwHideBackSF",void 0),l([C(cc.SpriteFrame)],t.prototype,"timesBg",void 0),l([C(cc.AudioClip)],t.prototype,"pushAudio",void 0),l([C(cc.AudioClip)],t.prototype,"popAudio",void 0),l([C(cc.AudioClip)],t.prototype,"completeAudio",void 0),l([C],t.prototype,"dialogTweenDuration",void 0),l([C(cc.Node)],t.prototype,"withdrawDialog",void 0),l([C(cc.Node)],t.prototype,"addListDialog",void 0),l([C(cc.Node)],t.prototype,"putTopDialog",void 0),l([C(cc.Node)],t.prototype,"putTopTips",void 0),o=l([b,P("ScrewSort/GameController")],t)}(cc.Component);r.default=w,cc._RF.pop(),cc._RF.pop()},{}],ScrewSortGenerateConfigured_SS:[function(e,t,o){"use strict";cc._RF.push(t,"f28bfnAWydF9pFpkyMWLxzV","ScrewSortGenerateConfigured_SS");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"f28bfnAWydF9pFpkyMWLxzV","ScrewSortGenerateConfigured_SS");var c=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var s=n("DataManager_SS"),l=n("ScrewSortGame_SS"),u=cc._decorator,p=u.ccclass,d=(u.property,cc.Enum({Red:0,Yellow:1,Green:2,Blue:3,Orange:4,Purple:5,Magenta:6,Cyan:7,Grey:8})),f=function(){function e(){}return e.loadLevelData=function(e,t){var o="level/"+(e-1)+"/"+(e-1);cc.assetManager.loadBundle("ScrewSortConfig",function(e,n){e?console.error("load ScrewSortConfig bundle err",e):n.load(o,cc.JsonAsset,function(e,o){e?console.error("load levelConfig err",e):t&&t(o)})})},e.generateConfiguredLevel=function(){var e=this,t=s.default.curLevel;this.loadLevelData(t,function(t){e.levelConfig=t.json,console.log("\u5173\u5361\u914d\u7f6e",e.levelConfig),e.startPos=cc.v2(-l.default.instance.boltsArea.width/2,l.default.instance.boltsArea.height/2),e.spacingX=l.default.instance.boltsArea.width/(e.levelConfig.levelData.row-1),e.spacingY=l.default.instance.boltsArea.height/(e.levelConfig.levelData.column-1),l.default.instance.canOperate=!1,e.createBolts(),l.default.instance.restLocked=1})},e.createBolts=function(){for(var e=this,t=0,o=0;o<this.levelConfig.boltsData.length;o++){var n=this.levelConfig.boltsData[o],i=this._recodeNutsData(n.nuts);i.length>0&&l.default.instance.restAmount++;var r,a=n.nutNum,c=o===this.levelConfig.boltsData.length-1;r=!(n.nuts.length>0)||""===n.nuts[0].nutcolor||"-1"===n.nuts[0].nutcolor;var u=cc.instantiate(c?l.default.instance.steelLocked:l.default.instance.steel);u.parent=l.default.instance.steelLayer,u.getComponent(cc.Sprite).spriteFrame=l.default.instance.steelSF[Math.max(a-1,0)],u.setPosition(this._getBoltPos(n.position.x,n.position.y)),u.scale=.75;var p=cc.instantiate(l.default.instance.steelBack);p.parent=l.default.instance.steelBackLayer,p.getComponent(cc.Sprite).spriteFrame=u.getComponent(cc.Sprite).spriteFrame,p.setPosition(u.getPosition()),p.scale=.75;var d=u.getComponent("ScrewSortSteel_SS"),f=c||r;d.steelInit(o,Math.max(a,1),f),0===i.length&&++t===this.levelConfig.boltsData.length&&(this._checkAddListGuide(),l.default.instance.scheduleOnce(function(){l.default.instance.canOperate=!0,l.default.instance.ifDuringGenerate=!1},2===s.default.curLevel?.5:0)),d.createScrew(i,function(){++t===e.levelConfig.boltsData.length&&(e._checkAddListGuide(),l.default.instance.scheduleOnce(function(){l.default.instance.canOperate=!0,l.default.instance.ifDuringGenerate=!1},2===s.default.curLevel?.5:0))});var h=cc.instantiate(l.default.instance.numberLayer.children[0]);h.parent=l.default.instance.numberLayer,h.getComponent(cc.Label).string=(o+1).toString(),h.setPosition(u.getPosition().x,u.getPosition().y-40),h.active=!0}},e._recodeNutsData=function(e){for(var t=[],o=e.length-1;o>=0;o--){var n=e[o].nutcolor;if(d[n]||0===d[n]){var i=d[n];e[o].isHiden?i+=100:e[o].isLocked&&(i+=1e3),t.push(i)}}return t},e._getBoltPos=function(e,t){var o=this.startPos.x+e*this.spacingX,n=this.startPos.y-t*this.spacingY;return cc.v2(o,n)},e._checkAddListGuide=function(){2===s.default.curLevel&&(cc.instantiate(l.default.instance.addListGuide).parent=l.default.instance.node)},e.levelConfig=null,e.startPos=cc.Vec2.ZERO,e.spacingX=0,e.spacingY=0,c([p],e)}();r.default=f,cc._RF.pop(),cc._RF.pop()},{}],ScrewSortGenerate_SS:[function(e,t,o){"use strict";cc._RF.push(t,"0346ey+vORMg42OYgq+4Zb2","ScrewSortGenerate_SS");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"0346ey+vORMg42OYgq+4Zb2","ScrewSortGenerate_SS");var c=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var s=n("CommonData_SS"),l=n("DataManager_SS"),u=n("Tool_SS"),p=n("ScrewSortGame_SS"),d=cc._decorator,f=d.ccclass,h=(d.property,function(){function e(){}return e.generateLevel=function(e){p.default.instance.canOperate=!1,e?this.generateGuideLevel():this.generateNormalLevel()},e.generateGuideLevel=function(){var e=this;p.default.instance.boltsArea.setPosition(0,0),p.default.instance.node.setPosition(0,-175),p.default.instance.btns.active=!1,this.typeAmount=2,this.blankAmount=1,this.lockedAmount=0,this.screwAmount=4,this.screwLockedAmount=0,p.default.instance.restAmount=this.typeAmount,p.default.instance.restLocked=this.lockedAmount,this.createSteels([[3,3,1,1],[3,1,3,1],[]],!0),p.default.instance.scheduleOnce(function(){e.showGuide()},1)},e.generateNormalLevel=function(){var e,t=this;p.default.instance.boltsArea.setPosition(0,100),this.typeAmount=5,this.blankAmount=2,this.lockedAmount=1,this.screwAmount=17,this.screwLockedAmount=4,p.default.instance.restAmount=this.typeAmount,p.default.instance.restLocked=this.lockedAmount;for(var o=[],n=[],i=0;i<this.typeAmount;i++){var r=new Array(this.screwAmount).fill(i);n.push(r),o=o.concat(r)}if(s.default.ifOver3MinWatchingAd&&Math.random()>.5){s.default.lastTimeWatchingAd=(new Date).getTime();var a=Math.floor(Math.random()*p.default.instance.chockLevel.length);console.log("chock\u5173\u5361",a),n=p.default.instance.chockLevel[a];var c=[0,1,2,3,4,5,6,7,8];for(i=c.length-1;i>0;i--)e=[c[u=Math.floor(Math.random()*(i+1))],c[i]],c[i]=e[0],c[u]=e[1];var l=new Map;for(i=1;i<=5;i++)l.set(i,c[i-1]);for(i=0;i<n.length;i++)for(var u=0;u<n[i].length;u++)l.has(n[i][u])&&(n[i][u]=l.get(n[i][u]));this.distributeAllType_choke(n)}else this.applyDifficultyConfig(n,function(e){o=e,t.distributeAllType(o)})},e.distributeAllType_choke=function(e){for(var t=e,o=0;o<this.blankAmount;o++)t.splice(Math.floor(Math.random()*t.length),0,new Array(0));console.log("chock\u5173\u5361",t),this.createSteels(t,!1)},e.distributeAllType=function(e){for(var t=[],o=0;o<this.typeAmount;o++)t.push(e.splice(0,this.screwAmount));t=this.makeLastElementsUnique(t);for(var n=0;n<this.blankAmount;n++)t.splice(Math.floor(Math.random()*t.length),0,new Array(0));this.createSteels(t,!1)},e.makeLastElementsUnique=function(e){for(var t,o=e.length,n=e[0].length,i=new Set,r=0;r<o;r++){var a=e[r][n-1];if(i.has(a))for(var c=0;c<n-1;c++)if(!i.has(e[r][c])){t=[e[r][n-1],e[r][c]],e[r][c]=t[0],e[r][n-1]=t[1],a=e[r][n-1];break}i.add(a)}for(r=0;r<o;r++)e[r].reverse();return e},e.createSteels=function(e,t){for(var o=this,n=0,i=this.typeAmount+this.blankAmount+this.lockedAmount,r=0;r<i;r++){var a=r>=i-this.lockedAmount,c=a?p.default.instance.steelLocked:p.default.instance.steel,s=cc.instantiate(c);s.parent=p.default.instance.steelLayer;var l=-(s.width+this._steelGap)*(i-1)/2+(s.width+this._steelGap)*r;s.setPosition(l,0),t&&(s.getComponent(cc.Sprite).spriteFrame=p.default.instance.steelSF[3]);var u=cc.instantiate(p.default.instance.steelBack);u.parent=p.default.instance.steelBackLayer,u.getComponent(cc.Sprite).spriteFrame=t||a?p.default.instance.steelSF[3]:p.default.instance.steelSF[16],u.setPosition(l,0);var d=s.getComponent("ScrewSortSteel_SS");d.steelInit(r,a?this.screwLockedAmount:this.screwAmount,a),a||d.createScrew(e[r],function(){++n===o.typeAmount&&(p.default.instance.canOperate=!0,p.default.instance.ifDuringGenerate=!1,p.default.instance.checkAutoPlay())});var f=cc.instantiate(p.default.instance.numberLayer.children[0]);f.parent=p.default.instance.numberLayer,f.getComponent(cc.Label).string=(r+1).toString(),f.setPosition(l,-300),f.active=!0}p.default.instance.node.scale=Math.min(1,7/i)},e.showGuide=function(){cc.instantiate(p.default.instance.guide).parent=p.default.instance.node},e.applyDifficultyConfig=function(e,t){var o=this._getWeightList();this.reconcatTypeList([],o,e,0,function(e){t&&t(e)})},e._getWeightList=function(){var e=[20,0,80],t=[30,30,30,10],o=[40,25,25,10];if(2===l.default.curLevel)return console.warn("\u56f0\u96be"),s.default.difficultyData="hard",o;if(3===l.default.curLevel)return console.warn("\u7b80\u5355"),s.default.difficultyData="easy",t;if(4===l.default.curLevel)return console.warn("\u56f0\u96be"),s.default.difficultyData="hard",o;var n=u.default.getInterval(e,u.default.sum(e));return 0===n?(console.warn("\u7b80\u5355"),s.default.difficultyData="easy",t):1===n?(console.warn("\u666e\u901a"),s.default.difficultyData="normal",[34,11,33,22]):(console.warn("\u56f0\u96be"),s.default.difficultyData="hard",o)},e.reconcatTypeList=function(e,t,o,n,i){if(0!==o.length){var r=this._confirmBlocks(t),a=Math.floor(Math.random()*o.length);a===n&&(a=a===o.length-1?0:a+1),n=a,e=e.concat(o[a].splice(0,r)),0===o[a].length&&o.splice(a,1),this.reconcatTypeList(e,t,o,n,i)}else i&&i(e)},e._confirmBlocks=function(e){return u.default.getInterval(e,u.default.sum(e))+1},e._steelGap=5,e.typeAmount=5,e.blankAmount=2,e.lockedAmount=1,e.screwAmount=17,e.screwLockedAmount=4,c([f],e)}());r.default=h,cc._RF.pop(),cc._RF.pop()},{}],ScrewSortSteel_SS:[function(e,t,o){"use strict";cc._RF.push(t,"f2ca0sfQPNGPaEhondbPWiH","ScrewSortSteel_SS");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"f2ca0sfQPNGPaEhondbPWiH","ScrewSortSteel_SS");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<o;t++)for(var r=arguments[t],a=0,c=r.length;a<c;a++,i++)n[i]=r[a];return n};Object.defineProperty(r,"__esModule",{value:!0});var p=n("DataManager_SS"),d=n("Tool_SS"),f=n("ScrewSortGame_SS"),h=cc._decorator,y=h.ccclass,m=h.property,g=h.menu,v=cc.Enum({0:"red",1:"orange",2:"green",3:"blue",4:"purple",5:"cyan",6:"chartreuse",7:"brown",8:"pink"}),_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.intialPos=null,t.screwArea=null,t._steelIndex=0,t._listContain=0,t._ifExtra=!1,t._screwList=[],t._curOperatingList=[],t._curOperatingList_Back=[],t._curOperatingColor=-1,t._lastSteelIndex=-1,t._ifComplete=!1,t._canOperate=!0,t}return s(t,e),Object.defineProperty(t.prototype,"riseSpeed",{get:function(){return p.default.riseSpeed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"moveSpeed",{get:function(){return p.default.moveSpeed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fallSpeed",{get:function(){return p.default.fallSpeed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_listTail",{get:function(){return this._screwList[this._screwList.length-1]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_tailList",{get:function(){return d.default.getTailList(this._screwList)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_screwArea_Back",{get:function(){return f.default.instance.steelBackLayer.children[this._steelIndex].getChildByName("screwArea")},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){this._touchInit()},t.prototype.steelInit=function(e,t,o){this._steelIndex=e,this._listContain=t,this._ifExtra=o,this.intialPos.setPosition(cc.v2(0,this.getScrewPosY(t+1)))},t.prototype._touchInit=function(){this.node.on(cc.Node.EventType.TOUCH_START,this._touchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this._touchEnd,this)},t.prototype._touchStart=function(){console.log("\u70b9\u51fb\u7684\u961f\u5217",this._steelIndex,this._screwList),f.default.instance.node.getChildByName("guide")&&f.default.instance.node.getChildByName("guide").destroy()},t.prototype._touchEnd=function(e){var t=this;if(this._canOperate&&f.default.instance.canOperate)if(this._ifExtra&&this.node.getChildByName("lock"))f.default.instance.clickAddList();else if(f.default.instance.ifPuttingTop)f.default.instance.canOperate=!1,this.putScrewTop(e.getLocation(),function(){f.default.instance.canOperate=!0,f.default.instance.btns.active=!0,f.default.instance.putTopTips.active=!1});else if(this._canOperate&&!this._ifComplete)if(this._canOperate=!1,f.default.instance.screwInOperation.length>0)if(this._curOperatingList=u(f.default.instance.screwInOperation),this._curOperatingList_Back=u(f.default.instance.screwInOperation_Back),f.default.instance.screwInOperation=[],f.default.instance.screwInOperation_Back=[],this._curOperatingColor=f.default.instance.typeInOperation,this._lastSteelIndex=f.default.instance.lastSteelIndex,f.default.instance.lastSteelIndex=-1,this._screwList.length>=this._listContain)f.default.instance.steelLayer.children[this._lastSteelIndex].getComponent("ScrewSortSteel_SS")._canOperate=!1,this.retreatScrew(function(){t._canOperate=!0,f.default.instance.steelLayer.children[t._lastSteelIndex].getComponent("ScrewSortSteel_SS")._canOperate=!0});else if(this._screwList.length>0&&this._listTail%100!==this._curOperatingColor&&!(this._listTail>=1200&&this._listTail<1100))f.default.instance.steelLayer.children[this._lastSteelIndex].getComponent("ScrewSortSteel_SS")._canOperate=!1,this.retreatScrew(function(){t._canOperate=!0,f.default.instance.steelLayer.children[t._lastSteelIndex].getComponent("ScrewSortSteel_SS")._canOperate=!0,f.default.instance.checkIfStalemate()});else if(f.default.instance.steelLayer.children[this._lastSteelIndex].getComponent("ScrewSortSteel_SS")._canOperate=!1,this._steelIndex===this._lastSteelIndex)this.retreatScrew(function(){t._canOperate=!0,f.default.instance.steelLayer.children[t._lastSteelIndex].getComponent("ScrewSortSteel_SS")._canOperate=!0,f.default.instance.checkIfStalemate()});else{var o={state:"push",list:[]},n=this._checkUnlockInfo(this._curOperatingColor);if(-1!==n){var i={list:this._steelIndex,i:n};o.unlockData=i}var r=this._checkUnfreezeInfo(this._curOperatingColor);if(-1!==r){var a={list:this._steelIndex,i:r};o.unfreezeData=a}this.pushScrew(o,function(){if(console.log("//// \u64cd\u4f5c\u8bb0\u5f55 ////",o),f.default.instance.operationRecord.push(o),f.default.instance.withdrawBtn.interactable=!0,f.default.instance.withdrawTimesBg.node.color=cc.Color.WHITE,o.unlockData&&(t._screwList[o.unlockData.i]-=1e3,t.screwArea.children[o.unlockData.i].getChildByName("lock").active=!1),o.unfreezeData&&(t._screwList[o.unfreezeData.i]-=100,t.screwArea.children[o.unfreezeData.i].getChildByName("frozen").active=!1),t._curOperatingList.length>0)t._canOperate=!0,f.default.instance.steelLayer.children[t._lastSteelIndex].getComponent("ScrewSortSteel_SS")._canOperate=!1,t.retreatScrew(function(){f.default.instance.steelLayer.children[t._lastSteelIndex].getComponent("ScrewSortSteel_SS")._canOperate=!0,t._canOperate=!0,f.default.instance.checkIfStalemate()});else{var e=f.default.instance.steelLayer.children[t._lastSteelIndex],n=f.default.instance.steelBackLayer.children[t._lastSteelIndex],i=e.getComponent("ScrewSortSteel_SS")._screwList;if(i[i.length-1]>=100&&i[i.length-1]<1e3){var r={list:t._lastSteelIndex,i:i.length-1};o.unhideData=r,i[o.unhideData.i]-=100,e.getChildByName("screwArea").children[o.unhideData.i].getChildByName("hide").active=!1,n.getChildByName("screwArea").children[o.unhideData.i].getChildByName("hide").active=!1}t._canOperate=!0,f.default.instance.steelLayer.children[t._lastSteelIndex].getComponent("ScrewSortSteel_SS")._canOperate=!0,t.checkIfTypeFilled(t._listTail)&&t._onTypeFilled(t._listTail),f.default.instance.checkIfStalemate()}})}else f.default.instance.screwInOperation.length<=0&&this._curOperatingList.length<=0&&(f.default.instance.lastSteelIndex=this._steelIndex,this._lastSteelIndex=this._steelIndex,this._screwList.length>0?(f.default.instance.canOperate=!1,f.default.instance.typeInOperation=this._listTail,this._canOperate=!1,this.popScrew(this._listTail,function(){t._canOperate=!0,f.default.instance.canOperate=!0})):(f.default.instance.canOperate=!0,this._canOperate=!0))},t.prototype.createScrew=function(e,t){var o=this;if(!(e.length<=0)){var n=e[e.length-1],i=n>=100&&n<1e3,r=n>=1e3;console.log("\u7c7b\u578b-"+n+"; \u662f\u5426\u9690\u85cf-"+i+"; \u662f\u5426\u4e0a\u9501-"+r);var a=cc.instantiate(f.default.instance.screw);a.parent=this.screwArea,a.opacity=0,a.setPosition(this.intialPos.getPosition()),a.getChildByName("screw").getComponent(cc.Sprite).spriteFrame=f.default.instance.screwSF[n%100],a.getChildByName("hide").getComponent(cc.Sprite).spriteFrame=f.default.instance.screwHideSF,a.getChildByName("hide").active=i,a.getChildByName("lock").active=r,this._playRotationAnim(a,n,!0);var c=cc.instantiate(f.default.instance.screw);c.parent=this._screwArea_Back,c.opacity=0,c.setPosition(this.intialPos.getPosition()),c.getChildByName("screw").getComponent(cc.Sprite).spriteFrame=f.default.instance.screwBackSF[n%100],c.getChildByName("hide").getComponent(cc.Sprite).spriteFrame=f.default.instance.screwHideBackSF,c.getChildByName("hide").active=i,c.getChildByName("lock").active=r;var s=this.getScrewPosY(this._screwList.length);this._screwList.push(n),e.pop();var l=0===e.length;this._createEffect(a,s,!1,function(){l&&t&&t()}),this._createEffect(c,s,!0),this.scheduleOnce(function(){o.createScrew(e,t)},.2)}},t.prototype._createEffect=function(e,t,o,n){var i=this;o||f.default.instance.playPushAudio(999),e.opacity=255,cc.tween(e).to(Math.abs(t-e.y)/this.fallSpeed,{y:t},{easing:p.default.ifTwiceSpeed?"":"cubicOut"}).call(function(){o||i._stopRotationAnim(e),n&&n()}).start()},t.prototype.pushScrew=function(e,t){var o=this;if(!(this._screwList.length>=this._listContain||this._curOperatingList.length<=0)){this._canOperate=!1,this.setOR_push(e);var n=this._curOperatingList[0],i=this._curOperatingList_Back[0],r=n.parent.parent,a=r.getChildByName("intialPos").getPosition(),c=n.parent.convertToNodeSpaceAR(this.intialPos.convertToWorldSpaceAR(cc.Vec2.ZERO)),s=d.default.getDistance(this.intialPos,r.getChildByName("intialPos")),l=this.getScrewPosY(this._screwList.length);this._curOperatingList.splice(0,1),this._curOperatingList_Back.splice(0,1),this._screwList.push(this._curOperatingColor);var u=this._screwList.length>=this._listContain||this._curOperatingList.length<=0;this._pushEffect(n,a,c,s,l,!1,function(){u&&t&&t()}),this._pushEffect(i,a,c,s,l,!0),p.default.ifOpenGap?this.scheduleOnce(function(){o.pushScrew(e,t)},.2):this.scheduleOnce(function(){o.pushScrew(e,t)},.05)}},t.prototype._pushEffect=function(e,t,o,n,i,r,a){var c=this;cc.tween(e).to((t.y-e.y)/this.moveSpeed,{y:t.y},{easing:p.default.ifTwiceSpeed?"":"cubicOut"}).to(Math.abs(n)/this.moveSpeed,{x:o.x,y:o.y}).call(function(){r||f.default.instance.playPushAudio();var t=cc.instantiate(e);t.parent=r?c._screwArea_Back:c.screwArea,t.setPosition(t.parent.convertToNodeSpaceAR(e.convertToWorldSpaceAR(cc.Vec2.ZERO))),r||c._playRotationAnim(t,c._curOperatingColor,!0),e.destroy(),cc.tween(t).to(Math.abs(i-t.y)/c.fallSpeed,{y:i},{easing:p.default.ifTwiceSpeed?"":"cubicOut"}).call(function(){r||(f.default.instance.playDropDownAnim(t),c._stopRotationAnim(t),a&&a())}).start()}).start()},t.prototype.retreatScrew=function(e){var t=this;if(!(this._curOperatingList.length<=0)){this._canOperate=!1;var o=f.default.instance.steelLayer.children[this._lastSteelIndex].getComponent("ScrewSortSteel_SS")._screwList,n=this._curOperatingList[this._curOperatingList.length-1];this._playRotationAnim(n,this._curOperatingColor,!0);var i=this._curOperatingList_Back[this._curOperatingList_Back.length-1],r=this.getScrewPosY(o.length);this._curOperatingList.pop(),this._curOperatingList_Back.pop(),o.push(this._curOperatingColor);var a=this._curOperatingList.length<=0;this._retreatScrewEffect(n,r,!1,1,function(){a&&e&&e()}),this._retreatScrewEffect(i,r,!0),p.default.ifOpenGap?this.scheduleOnce(function(){t.retreatScrew(e)},.2):this.retreatScrew(e)}},t.prototype._retreatScrewEffect=function(e,t,o,n,i){var r=this;o||f.default.instance.playPushAudio(),cc.tween(e).to(Math.abs(t-e.y)/this.fallSpeed,{y:t},{easing:p.default.ifTwiceSpeed?"":"cubicOut"}).call(function(){o||r._stopRotationAnim(e),i&&i()}).start()},t.prototype.popScrew=function(e,t){var o=this;if(!(this._screwList.length<=0)&&(this._canOperate=!1,e===this._listTail))if(this._listTail>=1e3)t&&t();else{var n=this.screwArea.children[this._screwList.length-1];this._playRotationAnim(n,this._listTail,!1);var i=this._screwArea_Back.children[this._screwList.length-1],r=0===f.default.instance.screwInOperation.length?this.intialPos.y:this.getScrewPosY(this._listContain-f.default.instance.screwInOperation.length);this._screwList.pop(),f.default.instance.screwInOperation.push(n),f.default.instance.screwInOperation_Back.push(i);var a=this._screwList.length<=0||e!==this._listTail;this._popEffect(n,r,!1,function(){a&&t&&t()}),this._popEffect(i,r,!0),p.default.ifOpenGap?this.scheduleOnce(function(){o.popScrew(e,t)},.2):this.popScrew(e,t)}},t.prototype._popEffect=function(e,t,o,n){var i=this;o||f.default.instance.playPopAudio(),cc.tween(e).to(Math.abs(t-e.y)/this.riseSpeed,{y:t},{easing:p.default.ifTwiceSpeed?"":"cubicOut"}).call(function(){o||(i._stopRotationAnim(e),n&&n())}).start()},t.prototype.putScrewTop=function(e,t){if(0===this._screwList.length||this._ifComplete)t&&t();else for(var o=this._screwList.length-1;o>=0;o--)if(this.screwArea.children[o].getBoundingBoxToWorld().contains(e)){if(this._screwList[o]>=100)return void(t&&t());this.setOR_putTop(o);var n=this.screwArea.children[o],i=this._screwArea_Back.children[o];this.rearrangeScrewList(o,this._screwList.length-1);var r=this.getScrewPosY(this._screwList.length-1);this._putTopEffect(n,r,!1,o,function(){f.default.instance.ifPuttingTop=!1,t&&t()}),this._putTopEffect(i,r,!0,o);break}},t.prototype._putTopEffect=function(e,t,o,n,i){var r=this;cc.tween(e).to(.25,{scale:0,opacity:0}).call(function(){e.setSiblingIndex(r._screwList.length-1),e.setPosition(0,t);for(var a=function(e){var t=o?r._screwArea_Back.children[e]:r.screwArea.children[e],n=r.getScrewPosY(e);o||r._playRotationAnim(t,r._screwList[e],!0),cc.tween(t).to((t.getPosition().y-n)/r.fallSpeed,{y:n}).call(function(){o||r._stopRotationAnim(t)}).start()},c=n;c<r._screwList.length-1;c++)a(c);cc.tween(e).to(.25,{scale:1,opacity:255}).call(function(){i&&i()}).start()}).start()},t.prototype.setOR_push=function(e){var t=this._curOperatingList[0];e.list.push({type:this._curOperatingColor,from:{list:t.parent.parent.getSiblingIndex(),i:t.getSiblingIndex()},to:{list:this._steelIndex,i:this._screwList.length}})},t.prototype.setOR_putTop=function(e){for(var t={state:"putTop",list:[]},o=e;o<this._screwList.length;o++)o===e?t.list.push({type:this._screwList[o],from:{list:this._steelIndex,i:o},to:{list:this._steelIndex,i:this._screwList.length-1}}):t.list.push({type:this._screwList[o],from:{list:this._steelIndex,i:o},to:{list:this._steelIndex,i:o-1}});f.default.instance.operationRecord.push(t),f.default.instance.withdrawBtn.interactable=!0,f.default.instance.withdrawTimesBg.node.color=cc.Color.WHITE},t.prototype._playRotationAnim=function(e,t,o){var n=e.getChildByName("ske").getComponent(sp.Skeleton);n.node.active=!0,n.node.scaleX=o?1:-1,n.animation=v[t.toString()]},t.prototype._stopRotationAnim=function(e){var t=e.getChildByName("ske").getComponent(sp.Skeleton);t.node.active=!1,t.animation=""},t.prototype.getScrewPosY=function(e){return 51*e+65},t.prototype.pushToScrewList=function(e,t){this._screwList.splice(e,0,t)},t.prototype.spliceFromScrewList=function(e){this._screwList.splice(e,1)},t.prototype.rearrangeScrewList=function(e,t){var o=this._screwList[e];this._screwList.splice(e,1),this._screwList.splice(t,0,o)},t.prototype.onWithdrawCall=function(){this._ifComplete&&(this._ifComplete=!1,this.node.color=cc.Color.WHITE,f.default.instance.restAmount++)},t.prototype.checkIfTypeFilled=function(e){var t=!0;return this._checkIfComplete()?f.default.instance.steelLayer.children.forEach(function(o){var n=o.getComponent("ScrewSortSteel_SS");-1===n._screwList.indexOf(e)&&-1===n._screwList.indexOf(e+100)&&-1===n._screwList.indexOf(e+1e3)||n._checkIfComplete()||(t=!1)}):t=!1,t},t.prototype._checkIfComplete=function(){if(this._ifExtra)return!1;var e=d.default.getFrequency(this._screwList);return this._screwList.length>=this._listContain&&1==Object.keys(e).length},t.prototype._onTypeFilled=function(e){f.default.instance.steelLayer.children.forEach(function(t){var o=t.getComponent("ScrewSortSteel_SS");o._listTail===e&&(t.color=cc.Color.GRAY,o._ifComplete=!0,f.default.instance.restAmount--,f.default.instance.playFireworkAnim(t),0===f.default.instance.restAmount&&f.default.instance.gameWin())})},t.prototype._checkUnlockInfo=function(e){for(var t=this._screwList.length-1;t>=0;t--){if(this._screwList[t]%100!==e)return-1;if(this._screwList[t]>=1e3)return t}return-1},t.prototype._checkUnfreezeInfo=function(e){for(var t=this._screwList.length-1;t>=0;t--){if(this._screwList[t]%100!==e)return-1;if(this._screwList[t]>=1100&&this._screwList[t]<1200)return t}return-1},t.prototype.checkIfCanPlace=function(){for(var e=this._listContain-this._screwList.length,t=0;t<f.default.instance.steelLayer.children.length;t++){var o=f.default.instance.steelLayer.children[t].getComponent("ScrewSortSteel_SS");if(this._steelIndex!==o._steelIndex&&(this._listTail%100===o._listTail||0===this._screwList.length)&&e>=o._tailList.length)return!0}return!1},t.prototype.getCanPlace=function(){for(var e=[],t=this._listContain-this._screwList.length,o=0;o<f.default.instance.steelLayer.children.length;o++){var n=f.default.instance.steelLayer.children[o].getComponent("ScrewSortSteel_SS");this._steelIndex!==n._steelIndex&&!n._ifComplete&&!this.node.getChildByName("lock")&&!n.node.getChildByName("lock")&&n._screwList.length>0&&(this._listTail%100===n._listTail||0===this._screwList.length)&&t>=n._tailList.length&&(0===this._screwList.length&&n._tailList.length===n._screwList.length||e.push({popSteel:f.default.instance.steelLayer.children[o],pushSteel:this.node}))}return e},l([m({type:cc.Node,tooltip:"\u87ba\u6bcd\u62e7\u51fa\u7684\u4f4d\u7f6e"})],t.prototype,"intialPos",void 0),l([m({type:cc.Node,tooltip:"\u87ba\u6bcd\u7236\u8282\u70b9"})],t.prototype,"screwArea",void 0),l([y,g("ScrewSort/SteelController")],t)}(cc.Component);r.default=_,cc._RF.pop(),cc._RF.pop()},{}],Scroll2Today:[function(e,t,o){"use strict";cc._RF.push(t,"e952dWHjnBDu5A2sU6daap6","Scroll2Today");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"e952dWHjnBDu5A2sU6daap6","Scroll2Today");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("SignInManager"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollView=null,t.duration=1,t.isHorizontal=!1,t}return s(t,e),t.prototype.onEnable=function(){var e=this,t=u.default.instance.getDay(),o=0;t>10&&(o=.5),t>15&&(o=1),this.scheduleOnce(function(){e.scrollToPercent(o,e.duration)},1.5)},t.prototype.scrollToPercent=function(e,t){if(void 0===t&&(t=this.duration),this.scrollView){var o=cc.misc.clampf(e,0,1);this.isHorizontal?this.scrollView.scrollToOffset(cc.v2(this.getMaxOffsetX()*o,this.scrollView.getScrollOffset().y),t):this.scrollView.scrollToOffset(cc.v2(this.scrollView.getScrollOffset().x,this.getMaxOffsetY()*o),t)}},t.prototype.scrollToNode=function(e,t){if(void 0===t&&(t=this.duration),this.scrollView&&e){var o=this.scrollView.content;if(o&&e.isValid&&e.parent===o){var n=e.position,i=this.scrollView.node.getContentSize(),r=o.getContentSize();if(this.isHorizontal){var a=this.getMaxOffsetX(),c=cc.misc.clampf(n.x+.5*r.width-.5*i.width,0,a);this.scrollView.scrollToOffset(cc.v2(c,this.scrollView.getScrollOffset().y),t)}else{var s=this.getMaxOffsetY(),l=cc.misc.clampf(.5*r.height-n.y-.5*i.height,0,s);this.scrollView.scrollToOffset(cc.v2(this.scrollView.getScrollOffset().x,l),t)}}}},t.prototype.getMaxOffsetX=function(){var e=this.scrollView.content,t=this.scrollView.node.getContentSize(),o=e.getContentSize();return Math.max(0,o.width-t.width)},t.prototype.getMaxOffsetY=function(){var e=this.scrollView.content,t=this.scrollView.node.getContentSize(),o=e.getContentSize();return Math.max(0,o.height-t.height)},l([f(cc.ScrollView)],t.prototype,"scrollView",void 0),l([d],t)}(cc.Component);r.default=h,cc._RF.pop(),cc._RF.pop()},{}],SettingPanel_BP:[function(e,t,o){"use strict";cc._RF.push(t,"8bf61YApwdIy4Z9LfEyIk2Q","SettingPanel_BP");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"8bf61YApwdIy4Z9LfEyIk2Q","SettingPanel_BP");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("AudioManager_BP"),d=n("ExternalManager_BP"),f=n("GameManager_BP"),h=cc._decorator,y=h.ccclass,m=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.musicBase=null,t.musicSlider=null,t.soundBase=null,t.soundSlider=null,t.vibrationBase=null,t.vibrationSlider=null,t.btnClose=null,t.btnHome=null,t.btnResume=null,t}return s(t,e),t.prototype.onLoad=function(){f.default.instance.ifGamePause=!0,this.btnClose&&this.btnClose.on(cc.Node.EventType.TOUCH_END,this.clickClose,this),this.btnHome&&this.btnHome.on(cc.Node.EventType.TOUCH_END,this.clickHome,this),this.btnResume&&this.btnResume.on(cc.Node.EventType.TOUCH_END,this.clickResume,this)},t.prototype.show=function(){this.node.active=!0,this.init()},t.prototype.hide=function(){this.node.active=!1},t.prototype.init=function(){f.default.instance.ifGamePause=!0,this.musicSlider.x=d.default.CommonData.MusicOn?70:-70,this.musicBase.opacity=d.default.CommonData.MusicOn?255:0,this.soundSlider.x=d.default.CommonData.SoundOn?70:-70,this.soundBase.opacity=d.default.CommonData.SoundOn?255:0,this.vibrationSlider.x=d.default.CommonData.VibrationOn?70:-70,this.vibrationBase.opacity=d.default.CommonData.VibrationOn?255:0},t.prototype.onClickMusic=function(){d.default.CommonData.MusicOn=!d.default.CommonData.MusicOn,p.default.instance.playBtn(),d.default.CommonData.MusicOn?(u.default.instance.setBGMVolume(1),cc.tween(this.musicSlider).to(.2,{x:70},{easing:"smooth"}).start(),cc.tween(this.musicBase).to(.2,{opacity:255},{easing:"smooth"}).start()):(u.default.instance.setBGMVolume(0),cc.tween(this.musicSlider).to(.2,{x:-70},{easing:"smooth"}).start(),cc.tween(this.musicBase).to(.2,{opacity:0},{easing:"smooth"}).start())},t.prototype.onClickSound=function(){p.default.instance.playBtn(),d.default.CommonData.SoundOn=!d.default.CommonData.SoundOn,d.default.CommonData.SoundOn?(cc.tween(this.soundSlider).to(.2,{x:70},{easing:"smooth"}).start(),cc.tween(this.soundBase).to(.2,{opacity:255},{easing:"smooth"}).start()):(cc.tween(this.soundSlider).to(.2,{x:-70},{easing:"smooth"}).start(),cc.tween(this.soundBase).to(.2,{opacity:0},{easing:"smooth"}).start())},t.prototype.onClickVibration=function(){p.default.instance.playBtn(),d.default.CommonData.VibrationOn=!d.default.CommonData.VibrationOn,d.default.CommonData.VibrationOn?(d.default.vibrateShort(),cc.tween(this.vibrationSlider).to(.2,{x:70},{easing:"smooth"}).start(),cc.tween(this.vibrationBase).to(.2,{opacity:255},{easing:"smooth"}).start()):(cc.tween(this.vibrationSlider).to(.2,{x:-70},{easing:"smooth"}).start(),cc.tween(this.vibrationBase).to(.2,{opacity:0},{easing:"smooth"}).start())},t.prototype.clickClose=function(){p.default.instance.playClickClose(),f.default.instance.ifGamePause=!1,this.hide()},t.prototype.clickResume=function(){p.default.instance.playBtn(),f.default.instance.ifGamePause=!1,this.hide()},t.prototype.clickHome=function(){p.default.instance.playBtn(),f.default.instance.ifGamePause=!1,d.default.backHome()},l([m(cc.Node)],t.prototype,"musicBase",void 0),l([m(cc.Node)],t.prototype,"musicSlider",void 0),l([m(cc.Node)],t.prototype,"soundBase",void 0),l([m(cc.Node)],t.prototype,"soundSlider",void 0),l([m(cc.Node)],t.prototype,"vibrationBase",void 0),l([m(cc.Node)],t.prototype,"vibrationSlider",void 0),l([m(cc.Node)],t.prototype,"btnClose",void 0),l([m(cc.Node)],t.prototype,"btnHome",void 0),l([m(cc.Node)],t.prototype,"btnResume",void 0),l([y],t)}(cc.Component);r.default=g,cc._RF.pop(),cc._RF.pop()},{}],SettingPanel:[function(e,t,o){"use strict";cc._RF.push(t,"f6445CrkKFB4YjXSTG8GlmU","SettingPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"f6445CrkKFB4YjXSTG8GlmU","SettingPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("BasePanel"),p=n("CommonData"),d=n("AudioManager"),f=n("GameManager"),h=n("GameScene"),y=n("StaminaManager"),m=n("const"),g=n("GameManager_17"),v=n("GoldDataManager"),_=n("DataManager"),S=n("CupMgr"),b=n("DataNexusSDK"),C=n("DataNexusEnum"),P=n("LevelManager"),k=n("RingFightManager"),w=cc._decorator,I=w.ccclass,T=w.property,A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.textVersion=null,t.musicBase=null,t.musicSlider=null,t.soundBase=null,t.soundSlider=null,t.vibrationBase=null,t.vibrationSlider=null,t.gameBtns=null,t.gameBg=null,t.titleSetting=null,t.titleGame=null,t.whiteListNode=null,t.RestartMainButton=null,t.btn_share=null,t.btn_skip=null,t.text_OpenId=null,t.energyNode=null,t.whiteListCounter=0,t.text_gold=null,t}return s(t,e),t.prototype.onLoad=function(){this.textVersion.string="Version:"+p.default.version},t.prototype.onDisable=function(){cc.director.emit(m.EventNames.CloseSetting),cc.director.emit(m.EventNames.Resume),cc.director.emit(m.EventNames.ResumeAllBombs)},t.prototype.onEnable=function(){var e=this;cc.director.emit(m.EventNames.PauseAllBombs),cc.director.emit(m.EventNames.Pause),cc.director.on(m.EventNames.CloseSetting,this.hide,this),f.default.platform.reportPageEvent("SetPage"),this.textVersion.node.active=!1,this.scheduleOnce(function(){e.textVersion.node.active=!0},.3),"Main"==cc.director.getScene().name?(this.whiteListNode.active=p.default.ifWhiteList,this.text_OpenId.string="OpenId: "+p.default.openId,this.gameBtns.active=!1,this.gameBg.active=!1,this.titleSetting.active=!0,this.titleGame.active=!1,this.node.setPosition(0,0),this.textVersion.node.y=-770):(this.whiteListNode.active=!1,this.titleSetting.active=!1,this.gameBtns.active=!0,this.gameBg.active=!0,this.titleGame.active=!0),"Game"!==cc.director.getScene().name?(this.RestartMainButton.active=!1,this.btn_skip.active=!1,this.btn_share.active=!0):(this.btn_skip.active=!0,b.default.instance.trackAdPlacementShow(C.RewardADEvent.SKIP),this.btn_share.active=!1),this.checkEnergyNode(),this.initGoldNode(),p.default.MusicOn?(this.musicSlider.x=70,this.musicBase.opacity=255):(this.musicSlider.x=-70,this.musicBase.opacity=0),p.default.SoundOn?(this.soundSlider.x=70,this.soundBase.opacity=255):(this.soundSlider.x=-70,this.soundBase.opacity=0),p.default.VibrationOn?(this.vibrationSlider.x=70,this.vibrationBase.opacity=255):(this.vibrationSlider.x=-70,this.vibrationBase.opacity=0)},t.prototype.checkEnergyNode=function(){switch(cc.director.getScene().name){case m.SceneNames.Game:case m.SceneNames.GameLong:this.energyNode.active=!0;break;default:this.energyNode.active=!1}},t.prototype.initGoldNode=function(){switch(cc.director.getScene().name){case m.SceneNames.Game:this.text_gold.node.parent.active=!0,this.text_gold.string=v.default.Gold.toString();break;default:this.text_gold.node.parent.active=!1}},t.prototype.onClickMusic=function(){p.default.MusicOn=!p.default.MusicOn,d.default.instance.playSFX(d.AudioRef.ClickButton),p.default.MusicOn?(d.default.instance.setBGMVolume(1),cc.tween(this.musicSlider).to(.2,{x:70},{easing:"smooth"}).start(),cc.tween(this.musicBase).to(.2,{opacity:255},{easing:"smooth"}).start()):(d.default.instance.setBGMVolume(0),cc.tween(this.musicSlider).to(.2,{x:-70},{easing:"smooth"}).start(),cc.tween(this.musicBase).to(.2,{opacity:0},{easing:"smooth"}).start())},t.prototype.onClickSound=function(){d.default.instance.playSFX(d.AudioRef.ClickButton),p.default.SoundOn=!p.default.SoundOn,p.default.SoundOn?(d.default.instance.setSFXVolume(1),cc.tween(this.soundSlider).to(.2,{x:70},{easing:"smooth"}).start(),cc.tween(this.soundBase).to(.2,{opacity:255},{easing:"smooth"}).start()):(d.default.instance.setSFXVolume(0),cc.tween(this.soundSlider).to(.2,{x:-70},{easing:"smooth"}).start(),cc.tween(this.soundBase).to(.2,{opacity:0},{easing:"smooth"}).start())},t.prototype.onClickVibration=function(){p.default.TestCounter++,d.default.instance.playSFX(d.AudioRef.ClickButton),p.default.VibrationOn=!p.default.VibrationOn,p.default.VibrationOn?(cc.tween(this.vibrationSlider).to(.2,{x:70},{easing:"smooth"}).start(),cc.tween(this.vibrationBase).to(.2,{opacity:255},{easing:"smooth"}).start()):(cc.tween(this.vibrationSlider).to(.2,{x:-70},{easing:"smooth"}).start(),cc.tween(this.vibrationBase).to(.2,{opacity:0},{easing:"smooth"}).start())},t.prototype.onClickVibrationTitle=function(){p.default.TestCounter++},t.prototype.onBtn_Share=function(){d.default.instance.playSFX(d.AudioRef.ClickButton),f.default.platform.showShare()},t.prototype.onClickSkip=function(){d.default.instance.playSFX(d.AudioRef.ClickButton),f.default.platform.reportButtonEvent("SkipBtn",0),f.default.platform.reportVideoEvent("SkipBtn_video",1),b.default.instance.trackAdClick(C.RewardADEvent.SKIP),f.default.platform.showRewardAD(function(){b.default.instance.trackAdVideoFinish(C.RewardADEvent.SKIP),f.default.platform.reportVideoEvent("SkipBtn_video",2),"Game"==cc.director.getScene().name?p.default.Level++:p.default.LevelChallenge++,cc.director.loadScene(cc.director.getScene().name)})},t.prototype.onClickRestart=function(){if(d.default.instance.playSFX(d.AudioRef.ClickButton),cc.director.getScene().name!=m.SceneNames.Challenge){if(cc.director.getScene().name!==m.SceneNames.Game)return cc.director.getScene().name===m.SceneNames.RingFight&&(P.default.isRestartRingFight=!0),void cc.director.loadScene(cc.director.getScene().name);if(p.default.autoPlaying)cc.director.loadScene(cc.director.getScene().name);else{if(cc.director.getScene().name===m.SceneNames.Game&&p.default.WinStreak>=2)return this.hide(),void h.default.instance.uiManager.showPanel("EndStreakPanel").then(function(e){e.getComponent("EndStreakPanel").initPanel(1)});if(y.default.instance.energy<=0)cc.director.getScene().name===m.SceneNames.Game&&h.default.instance.uiManager.showPanel("EnergyPanel"),cc.director.getScene().name===m.SceneNames.GameLong&&g.default.instance.uiManager.showPanel("EnergyPanel");else{if(p.default.ifTest||cc.director.getScene().name!==m.SceneNames.Game&&cc.director.getScene().name!==m.SceneNames.GameLong||y.default.instance.consume(1),f.default.platform.reportPageEvent("RestartGame"),cc.director.getScene().name===m.SceneNames.Game&&(f.default.platform.reportAdPointEvent("WinProgress_BreakFirst",p.default.WinStreak),p.default.WinStreak=0),p.default.currentLevelReplayedTime++,cc.director.getScene().name===m.SceneNames.Game){var e={level_id:p.default.CurrentLevel,ad_cnt:S.default.getInstance().currentLevelAdWatchedCount};e.duration=h.default.instance.getLevelTime(),e.game_mode=cc.director.getScene().name,e.stamina_value=y.default.instance.energy,e.coin_amount=v.default.Gold,b.default.instance.trackLevelExit(e)}cc.director.loadScene(cc.director.getScene().name)}}}else p.default.FreeChallengeTimes>0?(p.default.FreeChallengeTimes--,cc.director.loadScene(m.SceneNames.Challenge)):0===p.default.FreeChallengeTimes?f.default.platform.showShare(function(){p.default.FreeChallengeTimes--,cc.director.loadScene(m.SceneNames.Challenge)}):(b.default.instance.trackAdClick(C.RewardADEvent.REPLAY),f.default.platform.showRewardAD(function(){b.default.instance.trackAdVideoFinish(C.RewardADEvent.REPLAY),p.default.FreeChallengeTimes--,cc.director.loadScene(m.SceneNames.Challenge),f.default.platform.reportVideoEvent("StartPage_challengeBtn_video",2)}))},t.prototype.onClickBack=function(){if(d.default.instance.playSFX(d.AudioRef.ClickButton),"Game"===cc.director.getScene().name&&p.default.WinStreak>=2)return this.hide(),void h.default.instance.uiManager.showPanel("EndStreakPanel").then(function(e){e.getComponent("EndStreakPanel").initPanel(2)});if(cc.director.getScene().name===m.SceneNames.Game&&p.default.ifTest,p.default.isReturnToMain=!0,f.default.forceGC(),cc.director.getScene().name===m.SceneNames.Game&&(f.default.platform.reportAdPointEvent("WinProgress_BreakFirst",p.default.WinStreak),p.default.WinStreak=0),cc.director.getScene().name===m.SceneNames.Game){var e={level_id:p.default.CurrentLevel,ad_cnt:S.default.getInstance().currentLevelAdWatchedCount};e.duration=h.default.instance.getLevelTime(),e.game_mode=cc.director.getScene().name,e.stamina_value=y.default.instance.energy,e.coin_amount=v.default.Gold,b.default.instance.trackLevelExit(e)}cc.director.getScene().name===m.SceneNames.RingFight&&k.default.instance.isChallenger&&k.default.instance.abort(),cc.director.loadScene("Main")},t.prototype.onClickClose=function(){d.default.instance.playSFX(d.AudioRef.ClickClose),cc.director.getScene().name!==m.SceneNames.GameModeFillLong&&cc.director.getScene().name!==m.SceneNames.GameModeMultiple||cc.director.emit(m.EventNames.Resume),this.hide()},t.prototype.onClickSettingTitle=function(){"Main"===cc.director.getScene().name&&(this.whiteListCounter++,this.whiteListCounter>=5&&(p.default.ifWhiteList=!0,this.whiteListNode.active=!0))},t.prototype.onClickCupShowCase=function(){d.default.instance.playSFX(d.AudioRef.ClickButton),h.default.instance.uiManager.showPanel("CupShowCasePanel")},t.prototype.onClickCopyOpenId=function(){f.default.platform.copyToClipboard(p.default.openId)},t.prototype.onClickClearMemory=function(){p.default.clearMemory()},t.prototype.onClickClearOnlineData=function(){p.default.clearMemory(),_.default.clearUserData()},t.prototype.hide=function(){e.prototype.hide.call(this),this.textVersion.node.active=!1},l([T(cc.Label)],t.prototype,"textVersion",void 0),l([T(cc.Node)],t.prototype,"musicBase",void 0),l([T(cc.Node)],t.prototype,"musicSlider",void 0),l([T(cc.Node)],t.prototype,"soundBase",void 0),l([T(cc.Node)],t.prototype,"soundSlider",void 0),l([T(cc.Node)],t.prototype,"vibrationBase",void 0),l([T(cc.Node)],t.prototype,"vibrationSlider",void 0),l([T(cc.Node)],t.prototype,"gameBtns",void 0),l([T(cc.Node)],t.prototype,"gameBg",void 0),l([T(cc.Node)],t.prototype,"titleSetting",void 0),l([T(cc.Node)],t.prototype,"titleGame",void 0),l([T(cc.Node)],t.prototype,"whiteListNode",void 0),l([T(cc.Node)],t.prototype,"RestartMainButton",void 0),l([T(cc.Node)],t.prototype,"btn_share",void 0),l([T(cc.Node)],t.prototype,"btn_skip",void 0),l([T(cc.Label)],t.prototype,"text_OpenId",void 0),l([T(cc.Node)],t.prototype,"energyNode",void 0),l([T(cc.Label)],t.prototype,"text_gold",void 0),l([I],t)}(u.default);r.default=A,cc._RF.pop(),cc._RF.pop()},{}],SettingPnl_ED:[function(e,t,o){"use strict";cc._RF.push(t,"d7818bc/4FKVY27KuArS0bY","SettingPnl_ED");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"d7818bc/4FKVY27KuArS0bY","SettingPnl_ED");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("AudioManager_ED"),d=n("ExternalManager_ED"),f=n("GameManager_ED"),h=n("BasePanel_ED"),y=cc._decorator,m=y.ccclass,g=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.musicBase=null,t.musicSlider=null,t.soundBase=null,t.soundSlider=null,t.vibrationBase=null,t.vibrationSlider=null,t}return s(t,e),t.prototype.init=function(){f.default.instance.ifGamePause=!0,this.musicSlider.x=d.default.CommonData.MusicOn?70:-70,this.musicBase.opacity=d.default.CommonData.MusicOn?255:0,this.soundSlider.x=d.default.CommonData.SoundOn?70:-70,this.soundBase.opacity=d.default.CommonData.SoundOn?255:0,this.vibrationSlider.x=d.default.CommonData.VibrationOn?70:-70,this.vibrationBase.opacity=d.default.CommonData.VibrationOn?255:0},t.prototype.start=function(){},t.prototype.onClickMusic=function(){d.default.CommonData.MusicOn=!d.default.CommonData.MusicOn,p.default.instance.playBtn(),d.default.CommonData.MusicOn?(u.default.instance.setBGMVolume(1),cc.tween(this.musicSlider).to(.2,{x:70},{easing:"smooth"}).start(),cc.tween(this.musicBase).to(.2,{opacity:255},{easing:"smooth"}).start()):(u.default.instance.setBGMVolume(0),cc.tween(this.musicSlider).to(.2,{x:-70},{easing:"smooth"}).start(),cc.tween(this.musicBase).to(.2,{opacity:0},{easing:"smooth"}).start())},t.prototype.onClickSound=function(){p.default.instance.playBtn(),d.default.CommonData.SoundOn=!d.default.CommonData.SoundOn,d.default.CommonData.SoundOn?(cc.tween(this.soundSlider).to(.2,{x:70},{easing:"smooth"}).start(),cc.tween(this.soundBase).to(.2,{opacity:255},{easing:"smooth"}).start()):(cc.tween(this.soundSlider).to(.2,{x:-70},{easing:"smooth"}).start(),cc.tween(this.soundBase).to(.2,{opacity:0},{easing:"smooth"}).start())},t.prototype.onClickVibration=function(){d.default.CommonData.TestCounter++,p.default.instance.playBtn(),d.default.CommonData.VibrationOn=!d.default.CommonData.VibrationOn,d.default.CommonData.VibrationOn?(cc.tween(this.vibrationSlider).to(.2,{x:70},{easing:"smooth"}).start(),cc.tween(this.vibrationBase).to(.2,{opacity:255},{easing:"smooth"}).start()):(cc.tween(this.vibrationSlider).to(.2,{x:-70},{easing:"smooth"}).start(),cc.tween(this.vibrationBase).to(.2,{opacity:0},{easing:"smooth"}).start())},t.prototype.clickClose=function(){p.default.instance.playBtn(),f.default.instance.ifGamePause=!1,this.hide()},t.prototype.clickResume=function(){p.default.instance.playBtn(),f.default.instance.ifGamePause=!1,this.hide()},t.prototype.clickHome=function(){p.default.instance.playBtn(),d.default.backHome()},l([g(cc.Node)],t.prototype,"musicBase",void 0),l([g(cc.Node)],t.prototype,"musicSlider",void 0),l([g(cc.Node)],t.prototype,"soundBase",void 0),l([g(cc.Node)],t.prototype,"soundSlider",void 0),l([g(cc.Node)],t.prototype,"vibrationBase",void 0),l([g(cc.Node)],t.prototype,"vibrationSlider",void 0),l([m],t)}(h.default);r.default=v,cc._RF.pop(),cc._RF.pop()},{}],ShareTitle:[function(e,t,o){"use strict";cc._RF.push(t,"637d6mFBepJx5Har6mcoYqD","ShareTitle");var n=t,i=o;cc._RF.push(n,"637d6mFBepJx5Har6mcoYqD","ShareTitle"),Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(){}return e.getRandomTitle=function(){},e.getRandomImageUrl=function(){},e.shareSay=["\u8d85\u597d\u73a9\u7684\u6e38\u620f\uff0c\u5feb\u6765\u8bd5\u8bd5\u5427"],e.sharePATH=[1,2,3,4],e}();i.default=r,cc._RF.pop(),cc._RF.pop()},{}],SideModePanel:[function(e,t,o){"use strict";cc._RF.push(t,"fe0410QgqdJc7cRCMsyxpV+","SideModePanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"fe0410QgqdJc7cRCMsyxpV+","SideModePanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("BundleManager"),d=n("CommonData"),f=n("const"),h=n("GameManager"),y=n("BasePanel"),m=n("config"),g=n("DataNexusSDK"),v=n("DataNexusEnum"),_=cc._decorator,S=_.ccclass,b=_.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.AdNode_EndlessBottle=null,t.AdNode_MultiBottle=null,t.AdNode_FillLong=null,t.AdNode_ScrewSort=null,t.AdNode_BottlePuzzle=null,t.JumpNodes=[],t}return s(t,e),t.prototype.onEnable=function(){g.default.instance.trackAdPlacementShow(v.RewardADEvent.MORE_GAMEPLAY),d.default.LastUnlockDate_EndlessBottle===d.default.getTodayDate()&&(this.AdNode_EndlessBottle.active=!1),d.default.LastUnlockDate_MultiBottle===d.default.getTodayDate()&&(this.AdNode_MultiBottle.active=!1),d.default.LastUnlockDate_FillLong===d.default.getTodayDate()&&(this.AdNode_FillLong.active=!1),d.default.LastUnlockDate_ScrewSort===d.default.getTodayDate()&&(this.AdNode_ScrewSort.active=!1),d.default.LastUnlockDate_BottlePuzzle===d.default.getTodayDate()&&(this.AdNode_BottlePuzzle.active=!1),this.tiktokDiff()},t.prototype.tiktokDiff=function(){if(m.currentPlatform===m.platformEnum.toutiao)for(var e=0;e<this.JumpNodes.length;e++)this.JumpNodes[e].active=!1},t.prototype.hide=function(){1===this.node.scale&&e.prototype.hide.call(this)},t.prototype.onBtn_JumpToArrowClear=function(){h.default.platform.reportButtonEvent("SideModePanel_NaviToArrow",0),u.default.instance.playSFX(u.AudioRef.ClickButton),m.currentPlatform===m.platformEnum.wechat&&window.wx&&wx.navigateToMiniProgram({appId:"wx5fa85b481374e5b8",success:function(){},fail:function(){},complete:function(){}})},t.prototype.onBtn_JumpToPig=function(){h.default.platform.reportButtonEvent("SideModePanel_NaviToPig",0),u.default.instance.playSFX(u.AudioRef.ClickButton),m.currentPlatform===m.platformEnum.wechat&&window.wx&&wx.navigateToMiniProgram({appId:"wx2bd39bc6b432744f",success:function(){},fail:function(){},complete:function(){}})},t.prototype.onBtn_JumpToCar=function(){h.default.platform.reportButtonEvent("SideModePanel_NaviToPig",0),u.default.instance.playSFX(u.AudioRef.ClickButton),m.currentPlatform===m.platformEnum.wechat&&window.wx&&wx.navigateToMiniProgram({appId:"wx78e912b9e33712cd",success:function(){},fail:function(){},complete:function(){}})},t.prototype.onBtn_EndlessBottle=function(){var e=this;u.default.instance.playSFX(u.AudioRef.ClickButton),h.default.platform.reportButtonEvent("Button_EndlessBottle",0),d.default.LastUnlockDate_EndlessBottle===d.default.getTodayDate()?p.default.getInstance().loadBundle("EndlessBottle",function(e){e||cc.director.loadScene(f.SceneNames.EndlessBottle)}):(g.default.instance.trackAdClick(v.RewardADEvent.MORE_GAMEPLAY),h.default.platform.reportVideoEvent("Video_EndlessBottleUnlock",1),h.default.platform.showRewardAD(function(){h.default.platform.reportVideoEvent("Video_EndlessBottleUnlock",2),g.default.instance.trackAdVideoFinish(v.RewardADEvent.MORE_GAMEPLAY),d.default.LastUnlockDate_EndlessBottle=d.default.getTodayDate(),cc.tween(e.AdNode_EndlessBottle).to(.2,{scale:0}).call(function(){e.AdNode_EndlessBottle.active=!1,p.default.getInstance().loadBundle("EndlessBottle",function(e){e||cc.director.loadScene(f.SceneNames.EndlessBottle)})}).start()}))},t.prototype.onBtn_ScrewSort=function(){var e=this;u.default.instance.playSFX(u.AudioRef.ClickButton),h.default.platform.reportButtonEvent("Button_ScrewSort",0),d.default.LastUnlockDate_ScrewSort===d.default.getTodayDate()?p.default.getInstance().loadBundle("ScrewSort",function(e){e||(u.default.instance.stopAll(),cc.director.loadScene(f.SceneNames.ScrewSort))}):(g.default.instance.trackAdClick(v.RewardADEvent.MORE_GAMEPLAY),h.default.platform.reportVideoEvent("Video_ScrewSortUnlock",1),h.default.platform.showRewardAD(function(){h.default.platform.reportVideoEvent("Video_ScrewSortUnlock",2),g.default.instance.trackAdVideoFinish(v.RewardADEvent.MORE_GAMEPLAY),d.default.LastUnlockDate_ScrewSort=d.default.getTodayDate(),cc.tween(e.AdNode_ScrewSort).to(.2,{scale:0}).call(function(){e.AdNode_ScrewSort.active=!1,p.default.getInstance().loadBundle("ScrewSort",function(e){e||(u.default.instance.stopAll(),cc.director.loadScene(f.SceneNames.ScrewSort))})}).start()}))},t.prototype.onBtn_BottlePuzzle=function(){var e=this;u.default.instance.playSFX(u.AudioRef.ClickButton),h.default.platform.reportButtonEvent("Button_BottlePuzzle",0),d.default.LastUnlockDate_BottlePuzzle===d.default.getTodayDate()?p.default.getInstance().loadBundle("BottlePuzzle",function(e){e||(u.default.instance.stopAll(),cc.director.loadScene(f.SceneNames.BottlePuzzle))}):(g.default.instance.trackAdClick(v.RewardADEvent.MORE_GAMEPLAY),h.default.platform.reportVideoEvent("Video_BottlePuzzleUnlock",1),h.default.platform.showRewardAD(function(){h.default.platform.reportVideoEvent("Video_BottlePuzzleUnlock",2),g.default.instance.trackAdVideoFinish(v.RewardADEvent.MORE_GAMEPLAY),d.default.LastUnlockDate_BottlePuzzle=d.default.getTodayDate(),cc.tween(e.AdNode_BottlePuzzle).to(.2,{scale:0}).call(function(){e.AdNode_BottlePuzzle.active=!1,p.default.getInstance().loadBundle("BottlePuzzle",function(e){e||(u.default.instance.stopAll(),cc.director.loadScene(f.SceneNames.BottlePuzzle))})}).start()}))},t.prototype.onBtn_MultiBottle=function(){var e=this;u.default.instance.playSFX(u.AudioRef.ClickButton),d.default.LastUnlockDate_MultiBottle!==d.default.getTodayDate()?(g.default.instance.trackAdClick(v.RewardADEvent.MORE_GAMEPLAY),h.default.platform.showRewardAD(function(){g.default.instance.trackAdVideoFinish(v.RewardADEvent.MORE_GAMEPLAY),d.default.LastUnlockDate_MultiBottle=d.default.getTodayDate(),cc.tween(e.AdNode_MultiBottle).to(.2,{scale:0}).call(function(){e.AdNode_MultiBottle.active=!1,cc.director.loadScene(f.SceneNames.GameLong)}).start()})):cc.director.loadScene(f.SceneNames.GameLong)},t.prototype.onBtn_FillLong=function(){var e=this;u.default.instance.playSFX(u.AudioRef.ClickButton),d.default.LastUnlockDate_FillLong!==d.default.getTodayDate()?(g.default.instance.trackAdClick(v.RewardADEvent.MORE_GAMEPLAY),h.default.platform.showRewardAD(function(){g.default.instance.trackAdVideoFinish(v.RewardADEvent.MORE_GAMEPLAY),d.default.LastUnlockDate_FillLong=d.default.getTodayDate(),cc.tween(e.AdNode_FillLong).to(.2,{scale:0}).call(function(){e.AdNode_FillLong.active=!1,cc.director.loadScene(f.SceneNames.GameModeFillLong)}).start()})):cc.director.loadScene(f.SceneNames.GameModeFillLong)},l([b(cc.Node)],t.prototype,"AdNode_EndlessBottle",void 0),l([b(cc.Node)],t.prototype,"AdNode_MultiBottle",void 0),l([b(cc.Node)],t.prototype,"AdNode_FillLong",void 0),l([b(cc.Node)],t.prototype,"AdNode_ScrewSort",void 0),l([b(cc.Node)],t.prototype,"AdNode_BottlePuzzle",void 0),l([b([cc.Node])],t.prototype,"JumpNodes",void 0),l([S],t)}(y.default);r.default=C,cc._RF.pop(),cc._RF.pop()},{}],SidebarPanel:[function(e,t,o){"use strict";cc._RF.push(t,"28790L+6l5C9oEqWeo5NBBj","SidebarPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"28790L+6l5C9oEqWeo5NBBj","SidebarPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("BasePanel"),p=n("CommonData"),d=n("AudioManager"),f=n("GameManager"),h=n("const"),y=cc._decorator,m=y.ccclass,g=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btn_reward=null,t.btn_sidebar=null,t}return s(t,e),t.prototype.onEnable=function(){var e=this;this.btn_reward.active=p.default.ifOpenBySidebar&&p.default.LastGetRewardDate!==p.default.getTodayDate(),this.btn_sidebar.active=!this.btn_reward.active,this.btn_sidebar.active&&(this.btn_sidebar.opacity=0,this.btn_sidebar.scale=0,this.scheduleOnce(function(){cc.tween(e.btn_sidebar).to(.3,{opacity:255,scale:1.1}).to(.1,{scale:1}).start()},2))},t.prototype.show=function(e){var t=this.node.children[1];cc.director.emit("UpdateOpenPanelCount"),t&&(cc.Tween.stopAllByTarget(t),t.scale=.5,t.opacity=0,cc.tween(t).to(.2,{scale:1.1,opacity:200},{easing:"smooth"}).to(.2,{scale:1,opacity:255},{easing:"smooth"}).call(function(){e&&e()}).start())},t.prototype.hide=function(e){var t=this,o=this.node.children[1];o&&(cc.Tween.stopAllByTarget(o),o.scale=1,o.opacity=255,cc.tween(o).to(.2,{scale:0,opacity:200},{easing:"smooth"}).call(function(){t.node.active=!1,e&&e(),cc.director.emit("UpdateOpenPanelCount")}).start())},t.prototype.onBtnClsoe=function(){d.default.instance.playSFX(d.AudioRef.ClickClose),this.hide()},t.prototype.onBtnGoTOSidebar=function(){d.default.instance.playSFX(d.AudioRef.ClickButton),f.default.platform.navigateToScene("sidebar"),this.hide()},t.prototype.onBtnGetReward=function(){p.default.LastGetRewardDate=p.default.getTodayDate(),f.default.showRewardPanel([1,1,1,0]),p.default.PropUndo++,p.default.PropAddCup++,p.default.PropPump++,p.default.SideBarRewardCount++,cc.director.emit(h.EventNames.GetSidebarReward),this.hide()},l([g(cc.Node)],t.prototype,"btn_reward",void 0),l([g(cc.Node)],t.prototype,"btn_sidebar",void 0),l([m],t)}(u.default);r.default=v,cc._RF.pop(),cc._RF.pop()},{}],SignInData:[function(e,t,o){"use strict";cc._RF.push(t,"1ed32OiMRZJUp0kxXd8rSyu","SignInData");var n=t,i=o;cc._RF.push(n,"1ed32OiMRZJUp0kxXd8rSyu","SignInData"),Object.defineProperty(i,"__esModule",{value:!0}),i.rewardMap_3=i.rewardMap_2=i.rewardMap_1=void 0,i.rewardMap_1={15:{type:1,id:38},16:{type:2,id:"9_1"},17:{type:2,id:"9_2"},18:{type:5,id:1},19:{type:2,id:"9_3"},20:{type:2,id:"9_4"},21:{type:5,id:1},22:{type:2,id:"9_5"},23:{type:1,id:39},24:{type:2,id:"9_6"},25:{type:5,id:1},26:{type:2,id:"9_7"},27:{type:2,id:"9_8"},28:{type:5,id:1},29:{type:2,id:"9_9"}},i.rewardMap_2={1:{type:5,id:1},2:{type:2,id:"10_1"},3:{type:4,id:100},4:{type:5,id:1},5:{type:2,id:"10_2"},6:{type:1,id:40},7:{type:5,id:1},8:{type:2,id:"10_3"},9:{type:4,id:100},10:{type:5,id:1},11:{type:2,id:"10_4"},12:{type:4,id:100},13:{type:5,id:1},14:{type:2,id:"10_5"},15:{type:1,id:41},16:{type:5,id:1},17:{type:2,id:"10_6"},18:{type:4,id:100},19:{type:5,id:1},20:{type:2,id:"10_7"},21:{type:4,id:100},22:{type:2,id:"10_8"},23:{type:5,id:1},24:{type:2,id:"10_9"},25:{type:1,id:42}},i.rewardMap_3={1:{type:5,id:1},2:{type:2,id:"10_1"},3:{type:4,id:100},4:{type:5,id:1},5:{type:2,id:"10_2"},6:{type:1,id:40},7:{type:5,id:1},8:{type:2,id:"10_3"},9:{type:4,id:100},10:{type:5,id:1},11:{type:2,id:"10_4"},12:{type:4,id:100},13:{type:5,id:1},14:{type:2,id:"10_5"},15:{type:1,id:41},16:{type:5,id:1},17:{type:2,id:"10_6"},18:{type:4,id:100},19:{type:5,id:1},20:{type:2,id:"10_7"},21:{type:4,id:100},22:{type:2,id:"10_8"},23:{type:5,id:1},24:{type:2,id:"10_9"},25:{type:1,id:42}},i.default=function(){},cc._RF.pop(),cc._RF.pop()},{}],SignInEnum:[function(e,t,o){"use strict";cc._RF.push(t,"048d56FOSxPWaBmStNkoUWW","SignInEnum");var n=t,i=o;cc._RF.push(n,"048d56FOSxPWaBmStNkoUWW","SignInEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.SIGN_IN_SHEEP_TARGET=i.SIGN_IN_HORSE_TARGET=i.SIGN_IN_SNOWFLAKE_TARGET=i.EVENT_END_DAY=i.END_DAY=i.START_DAY=i.EventInfo_3=i.EventInfo_2=i.EventInfo_1=i.SignInState=void 0,function(e){e[e.UNCERTAIN=-1]="UNCERTAIN",e[e.LOCKED=0]="LOCKED",e[e.MISSED=1]="MISSED",e[e.READY=2]="READY",e[e.CLAIMED=3]="CLAIMED"}(i.SignInState||(i.SignInState={})),i.EventInfo_1={startDay:15,endDay:29,totalDay:31},i.EventInfo_2={startDay:1,endDay:25,totalDay:28},i.EventInfo_3={startDay:1,endDay:25,totalDay:31},i.START_DAY=15,i.END_DAY=29,i.EVENT_END_DAY=31,i.SIGN_IN_SNOWFLAKE_TARGET=4,i.SIGN_IN_HORSE_TARGET=8,i.SIGN_IN_SHEEP_TARGET=8,cc._RF.pop(),cc._RF.pop()},{}],SignInManager:[function(e,t,o){"use strict";cc._RF.push(t,"e86badTU+NCfIxQDHa/f/jp","SignInManager");var n=e,i=t,r=o;cc._RF.push(i,"e86badTU+NCfIxQDHa/f/jp","SignInManager");var a=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},c=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0});var s=n("SignInEnum"),l=n("config"),u=n("SignInData"),p=n("UnlockData"),d=n("DataManager"),f=n("CommonData"),h=n("GameManager"),y=n("CollectionManager"),m=n("ThemeDataManager"),g=n("GoldDataManager"),v=function(){function e(){this.dayStateMap={15:0,16:0,17:0,18:0,19:0,20:0,21:0,22:0,23:0,24:0,25:0,26:0,27:0,28:0,29:0},this._dailyWinCount=0,this._resignCount=3,this._eventToken=0,this.ifNotified=!1,this._isFirstOpenEvent=!0,this._serverTime="",this.init()}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),e.prototype.isEventActive=function(){this.fetchServerTime();var e=this.getMonth(),t=this.getDay();return 1===e&&t>=this.getStartDay()},e.prototype.isEvent2Active=function(){return this.fetchServerTime(),2===this.getMonth()},e.prototype.getDefaultDayStateMap=function(){for(var e={},t=1;t<=3;t++)for(var o=1==t?s.EventInfo_1:2==t?s.EventInfo_2:s.EventInfo_3,n=o.startDay;n<=o.endDay;n++)e[this.calculateDayIndex(t,n)]=s.SignInState.LOCKED;return e},e.prototype.init=function(){return a(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return this.dayStateMap=this.getDefaultDayStateMap(),this.dayStateMap=this.getData(),[4,this.fetchServerTime()];case 1:return e.sent(),[2]}})})},Object.defineProperty(e.prototype,"DayStateMap",{get:function(){return this.getData()},set:function(e){this.dayStateMap=e,this.saveData()},enumerable:!1,configurable:!0}),e.prototype.setDayStateMap=function(e,t){this.dayStateMap[e]!==t&&(this.dayStateMap[e]=t,this.saveData(),d.default.tryUpdateUserData())},Object.defineProperty(e.prototype,"dailyWinCount",{get:function(){return null!==f.default.getStorage("DailyWinCount")&&void 0!==f.default.getStorage("DailyWinCount")&&""!==f.default.getStorage("DailyWinCount")?(this._dailyWinCount=parseInt(f.default.getStorage("DailyWinCount")),this.dayStateMap[this.getDay()]!==s.SignInState.CLAIMED&&this.dayStateMap[this.getDay()]!==s.SignInState.READY||(this._dailyWinCount<5&&(this._dailyWinCount=5),f.default.setStorage("DailyWinCount",this._dailyWinCount)),this._dailyWinCount):this.dayStateMap[this.getDay()]===s.SignInState.CLAIMED||this.dayStateMap[this.getDay()]===s.SignInState.READY?(this._dailyWinCount<5&&(this._dailyWinCount=5),f.default.setStorage("DailyWinCount",this._dailyWinCount),5):0},set:function(e){e>=5&&this.DayStateMap[this.getDay()]!==s.SignInState.CLAIMED&&(h.default.platform.reportButtonEvent("Event_DailyTaskCompleted",0),this.setDayStateMap(this.getDay(),s.SignInState.READY)),f.default.setStorage("DailyWinCount",e),this._dailyWinCount=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resignCount",{get:function(){return null!==f.default.getStorage("ResignCount")&&void 0!==f.default.getStorage("ResignCount")&&""!==f.default.getStorage("ResignCount")?(this._resignCount=parseInt(f.default.getStorage("ResignCount")),this._resignCount):3},set:function(e){e<0&&(e=0),f.default.setStorage("ResignCount",e),this._resignCount=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"eventToken",{get:function(){var e="SnowFlakeCount";if(2==this.getMonth()&&(e="EventToken_2"),null!==f.default.getStorage(e)&&void 0!==f.default.getStorage(e)&&""!==f.default.getStorage(e)){for(var t=parseInt(f.default.getStorage(e)),o=0,n=this.getStartDay();n<=this.getEndDay();n++){var i=this.calculateDayIndex(this.getMonth(),n);this.DayStateMap[i]===s.SignInState.CLAIMED&&this.getRewardInfo(n)&&5===this.getRewardInfo(n).type&&o++}return this._eventToken=Math.max(t,o),this._eventToken}for(o=0,n=this.getStartDay();n<=this.getEndDay();n++)i=this.calculateDayIndex(this.getMonth(),n),this.DayStateMap[i]===s.SignInState.CLAIMED&&this.getRewardInfo(n)&&5===this.getRewardInfo(n).type&&o++;return o},set:function(e){var t="SnowFlakeCount";2==this.getMonth()&&(t="EventToken_2"),f.default.setStorage(t,e),this._eventToken=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFirstOpenEvent",{get:function(){var e=f.default.getStorage("IsFirstOpenEvent"+this.getMonth().toString());return null==e||""===e||(this._isFirstOpenEvent="true"===e,this._isFirstOpenEvent)},set:function(e){f.default.setStorage("IsFirstOpenEvent"+this.getMonth().toString(),e.toString()),this._isFirstOpenEvent=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDailyTaskCompleted",{get:function(){return this.getDay()>this.getEndDay()||this.dayStateMap[this.getDayIndex()]===s.SignInState.CLAIMED||this.dayStateMap[this.getDayIndex()]===s.SignInState.READY||(1==this.getMonth()?e.instance.dailyWinCount>=5:2==this.getMonth()?e.instance.dailyWinCount>=8:3==this.getMonth()?e.instance.dailyWinCount>=10:void 0)},enumerable:!1,configurable:!0}),e.prototype.getFinalEventMap=function(e,t){var o=this.getDefaultDayStateMap();if(!e[15])return this.getFinalEventMapLocal(t);if(this.getMonth()>1)for(var n=this.getStartDay(1);n<=this.getEndDay(1);n++)e[i=this.calculateDayIndex(1,n)]!==s.SignInState.CLAIMED&&t[i]!==s.SignInState.CLAIMED?e[i]!==s.SignInState.READY&&t[i]!==s.SignInState.READY?o[i]=s.SignInState.MISSED:o[i]=s.SignInState.READY:o[i]=s.SignInState.CLAIMED;if(this.getMonth()>2)for(n=this.getStartDay(2);n<=this.getEndDay(2);n++)e[i=this.calculateDayIndex(2,n)]!==s.SignInState.CLAIMED&&t[i]!==s.SignInState.CLAIMED?e[i]!==s.SignInState.READY&&t[i]!==s.SignInState.READY?o[i]=s.SignInState.MISSED:o[i]=s.SignInState.READY:o[i]=s.SignInState.CLAIMED;for(n=this.getStartDay();n<=this.getEndDay();n++){var i=this.calculateDayIndex(this.getMonth(),n);if(n>this.getDay())o[i]=s.SignInState.LOCKED;else if(n!==this.getDay())e[i]!==s.SignInState.CLAIMED&&t[i]!==s.SignInState.CLAIMED?e[i]!==s.SignInState.READY&&t[i]!==s.SignInState.READY?o[i]=s.SignInState.MISSED:o[i]=s.SignInState.READY:o[i]=s.SignInState.CLAIMED;else{if(e[i]===s.SignInState.CLAIMED||t[i]===s.SignInState.CLAIMED){o[i]=s.SignInState.CLAIMED;continue}this.isDailyTaskCompleted?o[i]=s.SignInState.READY:o[i]=s.SignInState.LOCKED}}return o},e.prototype.getFinalEventMapLocal=function(e){var t=this.getDefaultDayStateMap();if(this.getMonth()>1)for(var o=this.getStartDay(1);o<=this.getEndDay(1);o++)t[n=this.calculateDayIndex(1,o)]=e[n];if(this.getMonth()>2)for(o=this.getStartDay(2);o<=this.getEndDay(2);o++)t[n=this.calculateDayIndex(2,o)]=e[n];for(o=this.getStartDay();o<=this.getEndDay();o++){var n=this.calculateDayIndex(this.getMonth(),o);if(o>this.getDay())t[n]=s.SignInState.LOCKED;else if(o!==this.getDay())e[n]!==s.SignInState.CLAIMED?e[n]!==s.SignInState.READY?t[n]=s.SignInState.MISSED:t[n]=s.SignInState.READY:t[n]=s.SignInState.CLAIMED;else{if(e[n]===s.SignInState.CLAIMED){t[n]=s.SignInState.CLAIMED;continue}this.isDailyTaskCompleted?t[n]=s.SignInState.READY:t[n]=s.SignInState.LOCKED}}return t},e.prototype.updateDayStateMap=function(){for(var e=this.getDay(),t=this.getStartDay();t<=this.getEndDay();t++){var o=this.calculateDayIndex(this.getMonth(),t);if(t>e)this.dayStateMap[o]=s.SignInState.LOCKED;else if(t===e){if(this.dayStateMap[o]===s.SignInState.CLAIMED)continue;this.isDailyTaskCompleted?this.dayStateMap[o]=s.SignInState.READY:this.dayStateMap[o]=s.SignInState.LOCKED}else this.dayStateMap[o]!==s.SignInState.CLAIMED&&this.dayStateMap[o]!==s.SignInState.READY&&(this.dayStateMap[o]=s.SignInState.MISSED)}this.saveData()},e.prototype.saveData=function(){this.dayStateMap&&cc.sys.localStorage.setItem("MonthlyEventData_1",JSON.stringify(this.dayStateMap))},e.prototype.getData=function(){var e=cc.sys.localStorage.getItem("MonthlyEventData_1");return e?JSON.parse(e):this.dayStateMap},e.prototype.getCurrentDayIndex=function(){return this.getDay()},e.prototype.getRewardInfo=function(e){return 1===this.getMonth()?u.rewardMap_1[e]||null:2===this.getMonth()||3===this.getMonth()?u.rewardMap_2[e]||null:void 0},Object.defineProperty(e.prototype,"serverTime",{get:function(){return f.default.getStorage("ServerTime")&&(this._serverTime=f.default.getStorage("ServerTime")),this._serverTime},set:function(e){this._serverTime=e,f.default.setStorage("ServerTime",e)},enumerable:!1,configurable:!0}),e.prototype.fetchServerTime=function(){var e,t=this;if(cc.sys.isBrowser)return Promise.resolve(this.getLocalTimeString());if(l.currentPlatform===l.platformEnum.wechat)e=wx;else{if(l.currentPlatform!==l.platformEnum.toutiao)return Promise.resolve(this.getLocalTimeString());e=tt}return new Promise(function(o){e.request({url:"https://api.flysheeep.com/api/erhe/get_server_time",method:"GET",header:{"content-type":"application/json","x-appid":f.default.appId},success:function(e){var n,i,r=null===(i=null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.data)||void 0===i?void 0:i.server_time;if(r)((a=t.serverTime)?parseInt(a.split(" ")[0].split("-")[2]):-1)!==parseInt(r.split(" ")[0].split("-")[2])&&t.newDayCheck(),t.serverTime=r,console.error("Fetched server time:",t.serverTime),o(t.serverTime);else{var a,c=t.getLocalTimeString();((a=t.serverTime)?parseInt(a.split(" ")[0].split("-")[2]):-1)!==parseInt(c.split(" ")[0].split("-")[2])&&t.newDayCheck(),t.serverTime=c,console.error("Failed to fetch server time, using local time:",t.serverTime),o(t.serverTime)}},fail:function(){var e=t.getLocalTimeString(),n=t.serverTime;(n?parseInt(n.split(" ")[0].split("-")[2]):-1)!==parseInt(e.split(" ")[0].split("-")[2])&&t.newDayCheck(),t.serverTime=e,console.error("Failed to fetch server time, using local time:",t.serverTime),o(t.serverTime)}})})},e.prototype.getLocalTimeString=function(){var e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1).toString().padStart(2,"0")+"-"+e.getDate().toString().padStart(2,"0")+" "+e.getHours().toString().padStart(2,"0")+":"+e.getMinutes().toString().padStart(2,"0")+":"+e.getSeconds().toString().padStart(2,"0")},e.prototype.getDay=function(){var e=this.serverTime||this.getLocalTimeString();return parseInt(e.split(" ")[0].split("-")[2])},e.prototype.getMonth=function(){var e=this.serverTime||this.getLocalTimeString();return parseInt(e.split(" ")[0].split("-")[1])},e.prototype.getDayIndex=function(){var e=this.getDay(),t=this.getMonth();return 1==t&&(t=0),100*t+e},e.prototype.calculateDayIndex=function(e,t){return 1==e&&(e=0),100*e+t},e.prototype.newDayCheck=function(){this.dailyWinCount=0,this.resignCount=3},e.prototype.getEventInfo=function(e){void 0===e&&(e=0);var t=this.getMonth();return 0!==e&&(t=e),1===t?s.EventInfo_1:2===t?s.EventInfo_2:3===t?s.EventInfo_3:void 0},e.prototype.getStartDay=function(e){return void 0===e&&(e=0),this.getEventInfo(e).startDay},e.prototype.getEndDay=function(e){return void 0===e&&(e=0),this.getEventInfo(e).endDay},e.prototype.getTotalDay=function(e){return void 0===e&&(e=0),this.getEventInfo(e).totalDay},e.prototype.getEventTarget=function(e){void 0===e&&(e=0);var t=this.getMonth();return 0!==e&&(t=e),1===t?s.SIGN_IN_SNOWFLAKE_TARGET:2===t?s.SIGN_IN_HORSE_TARGET:3===t?s.SIGN_IN_SHEEP_TARGET:void 0},e.prototype.getDailyTaskTarget=function(e){void 0===e&&(e=0);var t=this.getMonth();return 0!==e&&(t=e),1===t?5:2===t?8:3===t?10:void 0},e.prototype.reportEventData=function(){for(var e=0,t=0,o=0,n=this.getStartDay();n<=this.getEndDay();n++){var i=this.dayStateMap[n];i===s.SignInState.CLAIMED?e++:i===s.SignInState.MISSED?t++:i===s.SignInState.READY&&o++}h.default.platform.reportCollectionEvent("Event1_ClaimCount",e.toString(),"",""),h.default.platform.reportCollectionEvent("Event1_MissCount",t.toString(),"",""),h.default.platform.reportCollectionEvent("Event1_ReadyCount",o.toString(),"",""),h.default.platform.reportCollectionEvent("Event1",e.toString(),t.toString(),o.toString())},e.prototype.checkAndResendRewards=function(){var e=this.getMonth()-1;if(e<1)return[];for(var t=[],o=1===e?u.rewardMap_1:2===e?u.rewardMap_2:u.rewardMap_3,n=this.getStartDay(e),i=this.getEndDay(e),r=n;r<=i;r++){var a=this.calculateDayIndex(e,r);(l=this.DayStateMap[a])===s.SignInState.READY&&((f=o[r]).type!==p.UnlockType.EVENT&&t.push(f),f&&(f.type===p.UnlockType.CAP?y.default.setCapUnlockMap(f.id,!0):f.type===p.UnlockType.THEME?m.default.setThemeUnlockMap(f.id,!0):f.type===p.UnlockType.GOLD&&(g.default.Gold+=Number(f.id)),this.setDayStateMap(a,s.SignInState.CLAIMED)))}var c=!0;for(r=n;r<=i;r++){a=this.calculateDayIndex(e,r);var l=this.DayStateMap[a];if((f=o[r]).type===p.UnlockType.EVENT&&l!==s.SignInState.CLAIMED){c=!1;break}}if(c){var d=1===e?7:8;if(!0!==y.default.CharacterUnlockMap[d]){y.default.setCharacterUnlockMap(d,!0);var f={type:p.UnlockType.RIDER,id:d};t.push(f)}}return t},e.prototype.ifShowNotify=function(){for(var e=!0,t=this.getStartDay();t<=this.getDay();t++){var o=this.calculateDayIndex(this.getMonth(),t);if(this.DayStateMap[o]!==s.SignInState.CLAIMED){e=!1;break}}return!e},e}();r.default=v,cc._RF.pop(),cc._RF.pop()},{}],SimpleLevelGen:[function(e,t,o){"use strict";cc._RF.push(t,"9a917Y2FKhCcIkWEEnPo/wi","SimpleLevelGen");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"9a917Y2FKhCcIkWEEnPo/wi","SimpleLevelGen");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("LevelGenerator_BP"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startLevel=1,t.endLevel=20,t._running=!1,t}return s(t,e),t.prototype.onClickGenerate=function(){if(this._running)cc.warn("SimpleLevelGen: \u5df2\u5728\u751f\u6210\u4e2d\uff0c\u7a0d\u5019\u518d\u8bd5");else{this._running=!0;try{this.generateLevelsSync()}catch(e){console.error("\u751f\u6210\u5173\u5361\u51fa\u9519:",e),cc.error("\u751f\u6210\u5173\u5361\u51fa\u9519:",e)}finally{this._running=!1}}},t.prototype.generateLevelsSync=function(){var e,t;cc.log("=".repeat(60)),cc.log("\u5f00\u59cb\u751f\u6210\u5173\u5361 "+this.startLevel+"-"+this.endLevel),cc.log("=".repeat(60));for(var o={},n=0,i=this.startLevel;i<=this.endLevel;i++){var r=this.getDifficultyType(i),a=1===i?5:3,c="\n>>> \u6b63\u5728\u751f\u6210\u5173\u5361 "+i+" (\u96be\u5ea6: "+r+", \u74f6\u5b50\u6570: "+a+")...";console.log(c),cc.log(c);for(var s=null,l=0,p="extreme"===r?500:"hard"===r?100:50;!s&&l<p;)s=u.LevelGenerator_BP.generateLevel(i,r,a,!0),l++,console.log("[SimpleLevelGen] L"+i+" attempt="+l+"/"+p+" generating..."),!s&&l%20==0&&l<p&&cc.log("  >>> \u5c1d\u8bd5 "+l+"/"+p+"...");if(s)o[i]=s,n++,cc.log("\u2713 \u5173\u5361 "+i+" \u751f\u6210\u6210\u529f! (\u5bb9\u91cf: ["+s.capacities+"], \u6b65\u6570: "+s.solutionSteps+")"),cc.log("\n--- \u5173\u5361 "+i+" JSON\u6570\u636e ---"),console.log(JSON.stringify(((e={})[i]=s,e),null,2)),cc.log("--- \u7ed3\u675f ---\n");else{cc.error("\u2717 \u5173\u5361 "+i+" \u751f\u6210\u5931\u8d25");var d={levelId:i,status:"failed",attempts:l,difficultyType:r,bottleCount:a};cc.log("\n--- \u5173\u5361 "+i+" \u5931\u8d25\u5360\u4f4d JSON ---"),console.log(JSON.stringify(((t={})[i]=d,t),null,2)),cc.log("--- \u7ed3\u675f ---\n")}}cc.log("\n"+"=".repeat(60)),cc.log("\u751f\u6210\u5b8c\u6210\uff01\u6210\u529f: "+n+"/"+(this.endLevel-this.startLevel+1)),cc.log("=".repeat(60)),n<this.endLevel-this.startLevel+1&&cc.error("\u8b66\u544a\uff1a\u90e8\u5206\u5173\u5361\u751f\u6210\u5931\u8d25"),cc.log("\n\u8bf7\u590d\u5236\u4ee5\u4e0b JSON \u6570\u636e\uff1a"),cc.log("=".repeat(60));var f=JSON.stringify(o,null,2);console.log(f),cc.log("=".repeat(60)),cc.log("\u590d\u5236\u4e0a\u9762\u7684 JSON \u6570\u636e\uff0c\u4fdd\u5b58\u4e3a\uff1a"),cc.log("assets/SideMode/BottlePuzzle/data/levels.json"),cc.log("=".repeat(60)),this.tryUseClipboard(f)},t.prototype.tryUseClipboard=function(e){navigator&&navigator.clipboard&&navigator.clipboard.writeText(e).then(function(){cc.log("\u2713 JSON \u6570\u636e\u5df2\u590d\u5236\u5230\u526a\u8d34\u677f\uff01")}).catch(function(){cc.log("\u63d0\u793a\uff1a\u9700\u8981\u624b\u52a8\u4ece\u63a7\u5236\u53f0\u590d\u5236 JSON \u6570\u636e")})},t.prototype.getDifficultyType=function(e){return e<=5?"simple":e<=10?"medium":e<=15?"hard":"extreme"},l([f],t.prototype,"startLevel",void 0),l([f],t.prototype,"endLevel",void 0),l([d],t)}(cc.Component);r.default=h,cc._RF.pop(),cc._RF.pop()},{}],SingleColorCup:[function(e,t,o){"use strict";cc._RF.push(t,"a9e62n6K61Cd74lz0FHk2dh","SingleColorCup");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"a9e62n6K61Cd74lz0FHk2dh","SingleColorCup");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("Cup"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cupImg=null,t.cupImgDown=null,t.cupFrames=[],t.cupFramesDown=[],t.defaultCupImg=null,t.defaultCupImgDown=null,t._singleColorId=0,t}return s(t,e),Object.defineProperty(t.prototype,"singleColorId",{get:function(){return this._singleColorId},set:function(e){this._singleColorId=e,this.changeCupColor(e)},enumerable:!1,configurable:!0}),t.prototype.changeCupColor=function(e){this.defaultCupImg=this.cupImg.spriteFrame,this.defaultCupImgDown=this.cupImgDown.spriteFrame,this.cupFrames[e-1]&&(this.cupImg.spriteFrame=this.cupFrames[e-1]),this.cupFramesDown[e-1]&&(this.cupImgDown.spriteFrame=this.cupFramesDown[e-1])},t.prototype.unmaskCup=function(){e.prototype.unmaskCup.call(this)},t.prototype.setDefaultCupImg=function(){this.defaultCupImg&&(this.cupImg.spriteFrame=this.defaultCupImg),this.defaultCupImgDown&&(this.cupImgDown.spriteFrame=this.defaultCupImgDown)},l([f(cc.Sprite)],t.prototype,"cupImg",void 0),l([f(cc.Sprite)],t.prototype,"cupImgDown",void 0),l([f([cc.SpriteFrame])],t.prototype,"cupFrames",void 0),l([f([cc.SpriteFrame])],t.prototype,"cupFramesDown",void 0),l([d],t)}(u.default);r.default=h,cc._RF.pop(),cc._RF.pop()},{}],Slide:[function(e,t,o){"use strict";cc._RF.push(t,"4db2dYQ7DdE/IWyXbG8rVpI","Slide");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"4db2dYQ7DdE/IWyXbG8rVpI","Slide");var a,c=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(i,"__esModule",{value:!0});var l=cc._decorator,u=l.ccclass,p=l.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.minX=-500,t.maxX=0,t.brake=.95,t._velocity=0,t._dragging=!1,t}return c(t,e),t.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},t.prototype.onTouchStart=function(){this._dragging=!0,this._velocity=0},t.prototype.onTouchMove=function(e){var t=e.getDelta();this.node.x+=t.x,this._velocity=t.x,this.checkBoundary()},t.prototype.onTouchEnd=function(){this._dragging=!1},t.prototype.update=function(){this._dragging||Math.abs(this._velocity)>.1&&(this.node.x+=this._velocity,this._velocity*=this.brake,this.checkBoundary())},t.prototype.checkBoundary=function(){this.node.x<this.minX&&(this.node.x=this.minX,this._velocity=0),this.node.x>this.maxX&&(this.node.x=this.maxX,this._velocity=0)},s([p({tooltip:"\u6700\u5c0fX\u5750\u6807"})],t.prototype,"minX",void 0),s([p({tooltip:"\u6700\u5927X\u5750\u6807"})],t.prototype,"maxX",void 0),s([p({tooltip:"\u60ef\u6027\u8870\u51cf\u7cfb\u6570"})],t.prototype,"brake",void 0),s([u],t)}(cc.Component);i.default=d,cc._RF.pop(),cc._RF.pop()},{}],SpinAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"6106c31gpBP7JYM3etFivS2","SpinAnimation");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"6106c31gpBP7JYM3etFivS2","SpinAnimation");var a,c=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(i,"__esModule",{value:!0});var l=cc._decorator,u=l.ccclass,p=l.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.speed=180,t}return c(t,e),t.prototype.update=function(e){this.node.angle-=this.speed*e},s([p({tooltip:"\u81ea\u8f6c\u901f\u5ea6 (\u5ea6/\u79d2)"})],t.prototype,"speed",void 0),s([u],t)}(cc.Component);i.default=d,cc._RF.pop(),cc._RF.pop()},{}],SpriteConfig_BP:[function(e,t,o){"use strict";cc._RF.push(t,"2330fXLaj1KspiMwkt/b80L","SpriteConfig_BP");var n=t,i=o;cc._RF.push(n,"2330fXLaj1KspiMwkt/b80L","SpriteConfig_BP"),Object.defineProperty(i,"__esModule",{value:!0}),i.SpriteConfig_BP=void 0;var r=function(){function e(){}return e.getBottleSpriteName=function(e){var t=this.findClosestMapping(e);return t?t.bottleSpriteName:"ping5"},e.getWaterSpriteName=function(e){var t=this.findClosestMapping(e);return t?t.waterSpriteName:"shui5"},e.getWaterMaxHeightRatio=function(e){var t=this.waterMaxHeightRatioMapping[this.waterMaxHeightRatioMapping.length-1];if(e>=t.capacity)return t.maxRatio;var o=this.waterMaxHeightRatioMapping.find(function(t){return t.capacity===e});if(o)return o.maxRatio;for(var n=this.waterMaxHeightRatioMapping.length-1;n>=0;n--)if(this.waterMaxHeightRatioMapping[n].capacity<=e)return this.waterMaxHeightRatioMapping[n].maxRatio;return this.waterMaxHeightRatioMapping[0].maxRatio},e.findClosestMapping=function(e){if(e<=0)return null;if(e>10)return this.spriteMapping[this.spriteMapping.length-1];var t=this.spriteMapping.find(function(t){return t.capacity===e});if(t)return t;for(var o=this.spriteMapping.length-1;o>=0;o--)if(this.spriteMapping[o].capacity<=e)return this.spriteMapping[o];return this.spriteMapping[0]},e.getAtlasPath=function(){return this.ATLAS_PATH},e.addMapping=function(e,t,o){var n=this.spriteMapping.findIndex(function(t){return t.capacity===e});n>=0?this.spriteMapping[n]={capacity:e,bottleSpriteName:t,waterSpriteName:o}:(this.spriteMapping.push({capacity:e,bottleSpriteName:t,waterSpriteName:o}),this.spriteMapping.sort(function(e,t){return e.capacity-t.capacity}))},e.getAllCapacities=function(){return this.spriteMapping.map(function(e){return e.capacity})},e.ATLAS_PATH="BottlePuzzle/texture/BottleAtlas",e.spriteMapping=[{capacity:1,bottleSpriteName:"ping1",waterSpriteName:"shui1"},{capacity:2,bottleSpriteName:"ping2",waterSpriteName:"shui2"},{capacity:3,bottleSpriteName:"ping3",waterSpriteName:"shui3"},{capacity:4,bottleSpriteName:"ping4",waterSpriteName:"shui4"},{capacity:5,bottleSpriteName:"ping5",waterSpriteName:"shui5"},{capacity:6,bottleSpriteName:"ping6",waterSpriteName:"shui6"},{capacity:7,bottleSpriteName:"ping7",waterSpriteName:"shui7"},{capacity:8,bottleSpriteName:"ping8",waterSpriteName:"shui8"},{capacity:9,bottleSpriteName:"ping9",waterSpriteName:"shui9"},{capacity:10,bottleSpriteName:"ping10",waterSpriteName:"shui10"}],e.waterMaxHeightRatioMapping=[{capacity:1,maxRatio:.5},{capacity:2,maxRatio:.7},{capacity:3,maxRatio:.75},{capacity:4,maxRatio:.81},{capacity:5,maxRatio:.83},{capacity:6,maxRatio:.85},{capacity:7,maxRatio:.87},{capacity:8,maxRatio:.88},{capacity:9,maxRatio:.89},{capacity:10,maxRatio:.9}],e}();i.SpriteConfig_BP=r,cc._RF.pop(),cc._RF.pop()},{}],StaminaManager:[function(e,t,o){"use strict";cc._RF.push(t,"413d4lZk0xNR6bsLf+RWDLo","StaminaManager");var n=t,i=o;cc._RF.push(n,"413d4lZk0xNR6bsLf+RWDLo","StaminaManager"),Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(){this.maxEnergy=5,this.recoverIntervalMs=6e5,this.infiniteDurationMs=18e5,this._energy=this.maxEnergy,this._nextRecoverTs=0,this._isInfinite=!1,this._infiniteEndTs=0}return Object.defineProperty(e,"instance",{get:function(){return this._inst||(this._inst=new e),this._inst},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"energy",{get:function(){return this._energy},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextRecoverTs",{get:function(){return this._nextRecoverTs},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isInfinite",{get:function(){return this._isInfinite},enumerable:!1,configurable:!0}),e.prototype.init=function(){this._energy=parseInt(cc.sys.localStorage.getItem("energy_value")||""+this.maxEnergy,10),this._nextRecoverTs=parseInt(cc.sys.localStorage.getItem("energy_next_recover")||"0",10),this._isInfinite="true"===cc.sys.localStorage.getItem("energy_infinite_state"),this._infiniteEndTs=parseInt(cc.sys.localStorage.getItem("energy_infinite_end_ts")||"0",10),this._isInfinite&&Date.now()>=this._infiniteEndTs&&(this._isInfinite=!1,this._infiniteEndTs=0,this._saveInfiniteState()),this._fastForwardRecover();var e=cc.director.getScheduler();e.enableForTarget(this),e.schedule(this._tick,this,1,cc.macro.REPEAT_FOREVER,0,!1)},e.prototype.consume=function(e){return void 0===e&&(e=1),!!this._isInfinite||!(this._energy<e)&&(this._energy-=e,this._saveEnergy(),this._energy===this.maxEnergy-1&&(this._nextRecoverTs=Date.now()+this.recoverIntervalMs,this._saveNextRecover()),!0)},e.prototype.add=function(e){void 0===e&&(e=1);var t=this._energy;this._energy=Math.min(this.maxEnergy,this._energy+e),this._saveEnergy(),t<this.maxEnergy&&this._energy===this.maxEnergy&&(this._nextRecoverTs=0,this._saveNextRecover())},e.prototype.enableInfinite=function(e){void 0===e&&(e=18e5),this._energy=this.maxEnergy,this._isInfinite=!0,this._infiniteEndTs=Date.now()+e,this._nextRecoverTs=this._infiniteEndTs,this._saveInfiniteState(),this._saveEnergy(),this._saveNextRecover()},e.prototype.getSecondsToNextRecover=function(){return this._energy>=this.maxEnergy?0:Math.max(0,Math.ceil((this._nextRecoverTs-Date.now())/1e3))},e.prototype.getInfiniteRemainingSeconds=function(){return this._isInfinite?Math.max(0,Math.ceil((this._infiniteEndTs-Date.now())/1e3)):0},e.prototype.canShareToday=function(){var e=(new Date).toISOString().slice(0,10);return cc.sys.localStorage.getItem("energy_last_share_date")!==e},e.prototype.markSharedToday=function(){var e=(new Date).toISOString().slice(0,10);cc.sys.localStorage.setItem("energy_last_share_date",e)},e.prototype._tick=function(){if(!(this._energy>=this.maxEnergy)){var e=Date.now();this._isInfinite?e>=this._infiniteEndTs&&(this._isInfinite=!1,this._infiniteEndTs=0,this._saveInfiniteState()):e>=this._nextRecoverTs&&(this._energy++,this._saveEnergy(),this._energy<this.maxEnergy?(this._nextRecoverTs+=this.recoverIntervalMs,this._saveNextRecover()):(this._nextRecoverTs=0,this._saveNextRecover()))}},e.prototype._fastForwardRecover=function(){if(!(this._energy>=this.maxEnergy)){var e=Date.now();if(0===this._nextRecoverTs)return this._nextRecoverTs=e+this.recoverIntervalMs,void this._saveNextRecover();if(e>this._nextRecoverTs){var t=e-this._nextRecoverTs,o=1+Math.floor(t/this.recoverIntervalMs);this._energy=Math.min(this.maxEnergy,this._energy+o),this._saveEnergy(),this._energy<this.maxEnergy?(this._nextRecoverTs=this._nextRecoverTs+o*this.recoverIntervalMs,this._saveNextRecover()):(this._nextRecoverTs=0,this._saveNextRecover())}}},e.prototype._saveEnergy=function(){cc.sys.localStorage.setItem("energy_value",""+this._energy)},e.prototype._saveNextRecover=function(){cc.sys.localStorage.setItem("energy_next_recover",""+this._nextRecoverTs)},e.prototype._saveInfiniteState=function(){cc.sys.localStorage.setItem("energy_infinite_state",""+this._isInfinite),cc.sys.localStorage.setItem("energy_infinite_end_ts",""+this._infiniteEndTs)},e}();i.default=r,cc._RF.pop(),cc._RF.pop()},{}],StartingRiderAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"8b148z/ujtKzYvf0xSCI6Uz","StartingRiderAnimation");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"8b148z/ujtKzYvf0xSCI6Uz","StartingRiderAnimation");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=n("const"),d=n("PackageManger"),f=n("CollectionData"),h=cc._decorator,y=h.ccclass,m=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.riderNode=null,t.pigSkeleton=null,t.SkeletonData=[],t}return s(t,e),t.prototype.onEnable=function(){switch(cc.director.on(p.EventNames.LoadLevelFinish,this.startRiderAnimation,this),u.default.SelectedCharacterIndex){case 1:this.pigSkeleton.node.scale=.9;break;case 2:this.pigSkeleton.node.scale=.63;break;case 3:this.pigSkeleton.node.scale=.9;break;case 4:this.pigSkeleton.node.scale=.65*.9;break;case 5:this.pigSkeleton.node.scale=.81;break;case 6:this.pigSkeleton.node.scale=.9;break;case 7:this.pigSkeleton.node.scale=.765;break;case 8:this.pigSkeleton.node.scale=.81}this.pigSkeleton.skeletonData=this.SkeletonData[u.default.SelectedCharacterIndex-1],f.noSkinCharacters.includes(u.default.SelectedCharacterIndex)||(this.pigSkeleton.defaultSkin="lan",this.pigSkeleton.setSkin("lan"))},t.prototype.onDisable=function(){cc.director.off(p.EventNames.LoadLevelFinish,this.startRiderAnimation,this)},t.prototype.startRiderAnimation=function(){var e=this;this.riderNode.x=d.default.instance.currentPackages[2].node.x,this.riderNode.y=320,cc.tween(this.riderNode).by(.5,{y:150},{easing:"sineOut"}).call(function(){e.pigSkeleton.setAnimation(0,"zhayan",!1),e.pigSkeleton.setCompleteListener(function(){e.pigSkeleton.setAnimation(0,"idle",!0)})}).delay(3).call(function(){e.pigSkeleton.setAnimation(0,"zhayan",!1),e.pigSkeleton.setCompleteListener(function(){e.pigSkeleton.setAnimation(0,"idle",!0)})}).delay(3).call(function(){e.pigSkeleton.setAnimation(0,"zhayan",!1),e.pigSkeleton.setCompleteListener(function(){e.pigSkeleton.setAnimation(0,"idle",!0)})}).delay(1).by(.5,{y:-150},{easing:"sineIn"}).call(function(){e.riderNode.active=!1,e.node.destroy()}).start()},l([m(cc.Node)],t.prototype,"riderNode",void 0),l([m(sp.Skeleton)],t.prototype,"pigSkeleton",void 0),l([m([sp.SkeletonData])],t.prototype,"SkeletonData",void 0),l([y],t)}(cc.Component);r.default=g,cc._RF.pop(),cc._RF.pop()},{}],SubItem_Animal:[function(e,t,o){"use strict";cc._RF.push(t,"59d59dRSmNO56LaySoqiBY/","SubItem_Animal");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"59d59dRSmNO56LaySoqiBY/","SubItem_Animal");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=n("const"),d=n("CollectionManager"),f=n("DataManager"),h=n("GameManager"),y=n("GoldDataManager"),m=n("CollectionItem_Animal"),g=n("CollectionData"),v=n("CollectionData"),_=cc._decorator,S=_.ccclass,b=_.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.index=0,t.lockNode=null,t.lockLabel=null,t.iconCondition=null,t.iconConditionFrames=[],t.spineAnimal=null,t.coinNode=null,t.coinText=null,t}return s(t,e),t.prototype.onEnable=function(){cc.director.on(p.EventNames.UpdateAnimalSelection,this.setDefaultSelection,this)},t.prototype.onDisable=function(){cc.director.off(p.EventNames.UpdateAnimalSelection,this.setDefaultSelection,this)},t.prototype.setDefaultSelection=function(e){e||1!=this.index||cc.director.emit(p.EventNames.UpdateAnimalSelection,this.node)},t.prototype.updateIndex=function(e,t){this.index=e,this.lockLabel.node.color=(new cc.Color).fromHEX("#c36b31"),e==u.default.SelectedCharacterIndex&&cc.director.emit(p.EventNames.UpdateAnimalSelection,this.node),t?this.setItemUnlocked(e):this.setItemLocked(e)},t.prototype.setItemUnlocked=function(e){this.lockLabel.node.color=(new cc.Color).fromHEX("#c36b31"),this.lockLabel.string=d.default.characterNameMap[this.index],this.lockLabel.node.active=!0,this.lockNode.active=!1,this.iconCondition.node.active=!1,this.showSpine(e),this.coinNode.active=!1},t.prototype.setItemLocked=function(e){if(this.spineAnimal.node.active=!1,this.lockNode.active=!0,this.lockLabel.node.color=(new cc.Color).fromHEX("#c8cef1"),0!==g.characterUnlockConditionMap[e])return this.lockLabel.string=g.characterUnlockConditionMap[e],4==e&&(this.iconCondition.node.active=!0),void this.setPurchaseState(e);this.iconCondition.node.active=!1,this.lockLabel.string="\u901a\u8fc7\u7b2c"+d.default.unlockCharacterByLevelArray.get(e).toString()+"\u5173\u89e3\u9501",this.setPurchaseState(e)},t.prototype.setPurchaseState=function(e){d.default.characterPriceMap[e]>0?(this.coinNode.active=!0,this.lockLabel.node.active=!1,this.coinText.string=d.default.characterPriceMap[e].toString()):(this.lockLabel.node.active=!0,this.coinNode.active=!1)},t.prototype.onBtnSelect=function(){this.coinNode.active?this.onBtnBuy():this.lockNode.active||(u.default.SelectedCharacterIndex!==this.index?(u.default.SelectedCharacterIndex=this.index,cc.director.emit(p.EventNames.UpdateAnimalSelection,this.node),cc.director.emit(p.EventNames.OnSelectCharacterSkin)):(u.default.SelectedCharacterIndex=1,cc.director.emit(p.EventNames.UpdateAnimalSelection),cc.director.emit(p.EventNames.OnSelectCharacterSkin)))},t.prototype.refreshItem=function(){this.node.parent.getComponent(m.default).refreshItem()},t.prototype.onBtnBuy=function(){var e=this;if(this.coinNode.active)return cc.sys.isBrowser?(d.default.setCharacterUnlockMap(this.index,!0),this.lockNode.active=!1,this.coinNode.active=!1,void this.setItemUnlocked(this.index)):void(y.default.Gold>=d.default.characterPriceMap[this.index]?f.default.uploadGoldCoin(y.default.Gold-d.default.characterPriceMap[this.index],function(){h.default.platform.showTips("\u8d2d\u4e70\u6210\u529f!"),console.log("\u8d2d\u4e70\u6210\u529f\uff01"),y.default.Gold-=d.default.characterPriceMap[e.index],d.default.setCharacterUnlockMap(e.index,!0),e.lockNode.active=!1,e.coinNode.active=!1,e.setItemUnlocked(e.index)},function(){h.default.platform.showTips("\u8d2d\u4e70\u5931\u8d25!\u8bf7\u91cd\u8bd5"),console.error("\u8d2d\u4e70\u5931\u8d25\uff01")}):(console.error("\u91d1\u5e01\u4e0d\u8db3\uff0c\u8d2d\u4e70\u5931\u8d25\uff01"),h.default.platform.showTips("\u91d1\u5e01\u4e0d\u8db3\uff0c\u8d2d\u4e70\u5931\u8d25\uff01")))},t.prototype.showSpine=function(e){var t=this,o=cc.assetManager.getBundle("AnimalSpines");if(this.spineAnimal.node.scale=5==e?.4:7==e?.47:8==e?.45:.5,!o)return cc.error("AnimalSpines\u8d44\u6e90\u5305\u672a\u52a0\u8f7d\uff0c\u8bf7\u5148\u52a0\u8f7d\u8d44\u6e90\u5305"),void cc.assetManager.loadBundle("AnimalSpines",function(o,n){o?cc.error("\u52a0\u8f7dAnimalSpines\u8d44\u6e90\u5305\u5931\u8d25:",o):n.load(""+v.animalSpineRoot+v.animalSpine[e-1],sp.SkeletonData,function(o,n){o?console.error("\u52a0\u8f7d\u9aa8\u9abc\u52a8\u753b"+v.animalSpine[e-1]+"\u5931\u8d25:",o):(t.spineAnimal.node.active=!0,t.spineAnimal.skeletonData=n,t.spineAnimal.setAnimation(0,v.animationName[e-1],!0))})});o.load(""+v.animalSpineRoot+v.animalSpine[e-1],sp.SkeletonData,function(o,n){o?console.error("\u52a0\u8f7d\u9aa8\u9abc\u52a8\u753b"+v.animalSpine[e-1]+"\u5931\u8d25:",o):(t.spineAnimal.node.active=!0,t.spineAnimal.skeletonData=n,t.spineAnimal.setAnimation(0,v.animationName[e-1],!0))})},l([b(cc.Node)],t.prototype,"lockNode",void 0),l([b(cc.Label)],t.prototype,"lockLabel",void 0),l([b(cc.Sprite)],t.prototype,"iconCondition",void 0),l([b([cc.SpriteFrame])],t.prototype,"iconConditionFrames",void 0),l([b(sp.Skeleton)],t.prototype,"spineAnimal",void 0),l([b(cc.Node)],t.prototype,"coinNode",void 0),l([b(cc.Label)],t.prototype,"coinText",void 0),l([S],t)}(cc.Component);r.default=C,cc._RF.pop(),cc._RF.pop()},{}],SubItem_Cap:[function(e,t,o){"use strict";cc._RF.push(t,"64570Ret0dCXIzQ3PSi/P78","SubItem_Cap");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"64570Ret0dCXIzQ3PSi/P78","SubItem_Cap");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=n("const"),d=n("DataManager"),f=n("GameManager"),h=n("GoldDataManager"),y=n("CollectionManager"),m=n("CollectionData"),g=cc._decorator,v=g.ccclass,_=g.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.index=0,t.lockNode=null,t.lockLabel=null,t.iconCondition=null,t.iconConditionFrames=[],t.selectionNode=null,t.coinNode=null,t.coinText=null,t.capImage=null,t}return s(t,e),t.prototype.onEnable=function(){cc.director.on(p.EventNames.UpdateCapSelection,this.updateSelection,this)},t.prototype.onDisable=function(){cc.director.off(p.EventNames.UpdateCapSelection,this.updateSelection,this)},t.prototype.updateSelection=function(){this.index==u.default.SelectedCapIndex?this.selectionNode.active=!0:this.selectionNode.active=!1},t.prototype.updateIndex=function(e,t){void 0===t&&(t=!1),this.index=e,this.updateSelection(),this.lockLabel.node.color=(new cc.Color).fromHEX("#c36b31"),e==u.default.SelectedCapIndex&&cc.director.emit(p.EventNames.UpdateCapSelection,this.node),t?this.setItemUnlocked():this.setItemLocked(e)},t.prototype.setItemUnlocked=function(){this.lockLabel.node.color=(new cc.Color).fromHEX("#c36b31"),this.lockLabel.string=y.default.capNameMap[this.index],this.lockLabel.node.active=!0,this.lockNode.active=!1,this.iconCondition.node.active=!1,this.coinNode.active=!1},t.prototype.setItemLocked=function(e){if(this.lockNode.active=!0,this.lockLabel.node.color=(new cc.Color).fromHEX("#c8cef1"),0!==m.capUnlockConditionMap[e])return this.lockLabel.string=m.capUnlockConditionMap[e],15==e||43==e?(this.iconCondition.node.active=!0,this.iconCondition.spriteFrame=this.iconConditionFrames[0]):11!=e&&12!=e&&13!=e&&14!=e||(this.iconCondition.node.active=!0,this.iconCondition.spriteFrame=this.iconConditionFrames[1]),void this.setPurchaseState(e);this.iconCondition.node.active=!1,this.setPurchaseState(e),this.lockLabel.string="\u901a\u8fc7\u7b2c"+y.default.unlockCapByLevelArray.get(e).toString()+"\u5173\u89e3\u9501"},t.prototype.setPurchaseState=function(e){y.default.CapUnlockMap[this.index]||(y.default.capPriceMap[e]>0?(this.coinNode.active=!0,this.lockLabel.node.active=!1,this.coinText.string=y.default.capPriceMap[e].toString()):(this.lockLabel.node.active=!0,this.coinNode.active=!1))},t.prototype.refreshImg=function(e){var t=this,o=cc.assetManager.getBundle("Caps");o&&o.load(""+e,cc.Texture2D,function(e,o){t.capImage.spriteFrame=new cc.SpriteFrame(o)})},t.prototype.onBtnBuy=function(){var e=this;if(this.coinNode.active)return cc.sys.isBrowser?(y.default.setCapUnlockMap(this.index,!0),this.lockNode.active=!1,this.coinNode.active=!1,this.setItemUnlocked(),void this.refreshImg(this.index)):void(h.default.Gold>=y.default.capPriceMap[this.index]?d.default.uploadGoldCoin(h.default.Gold-y.default.capPriceMap[this.index],function(){f.default.platform.showTips("\u8d2d\u4e70\u6210\u529f!"),console.log("\u8d2d\u4e70\u6210\u529f\uff01"),h.default.Gold-=y.default.capPriceMap[e.index],y.default.setCapUnlockMap(e.index,!0),e.lockNode.active=!1,e.coinNode.active=!1,e.setItemUnlocked(),e.refreshImg(e.index)},function(){f.default.platform.showTips("\u8d2d\u4e70\u5931\u8d25!\u8bf7\u91cd\u8bd5"),console.error("\u8d2d\u4e70\u5931\u8d25\uff01")}):(console.error("\u91d1\u5e01\u4e0d\u8db3\uff0c\u8d2d\u4e70\u5931\u8d25\uff01"),f.default.platform.showTips("\u91d1\u5e01\u4e0d\u8db3\uff0c\u8d2d\u4e70\u5931\u8d25\uff01")))},t.prototype.onBtn_select=function(){this.coinNode.active?this.onBtnBuy():this.lockNode.active||(u.default.SelectedCapIndex!==this.index?(u.default.SelectedCapIndex=this.index,cc.director.emit(p.EventNames.UpdateCapSelection)):(u.default.SelectedCapIndex=0,cc.director.emit(p.EventNames.UpdateCapSelection)))},l([_(cc.Node)],t.prototype,"lockNode",void 0),l([_(cc.Label)],t.prototype,"lockLabel",void 0),l([_(cc.Sprite)],t.prototype,"iconCondition",void 0),l([_([cc.SpriteFrame])],t.prototype,"iconConditionFrames",void 0),l([_(cc.Node)],t.prototype,"selectionNode",void 0),l([_(cc.Node)],t.prototype,"coinNode",void 0),l([_(cc.Label)],t.prototype,"coinText",void 0),l([_(cc.Sprite)],t.prototype,"capImage",void 0),l([v],t)}(cc.Component);r.default=S,cc._RF.pop(),cc._RF.pop()},{}],SubItem_Effect:[function(e,t,o){"use strict";cc._RF.push(t,"1c45cXNlE5AV5W6/XOT/sRx","SubItem_Effect");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"1c45cXNlE5AV5W6/XOT/sRx","SubItem_Effect");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("const"),p=n("DataManager"),d=n("FinishEffectDataManager"),f=n("GameManager"),h=n("GoldDataManager"),y=n("SignInManager"),m=cc._decorator,g=m.ccclass,v=m.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.index=0,t.labelName=null,t.icon=null,t.coinNode=null,t.lockNode=null,t.discountNode=null,t}return s(t,e),t.prototype.onEnable=function(){cc.director.on(u.EventNames.UpdateAnimalSelection,this.setDefaultSelection,this)},t.prototype.onDisable=function(){cc.director.off(u.EventNames.UpdateAnimalSelection,this.setDefaultSelection,this)},t.prototype.setDefaultSelection=function(e){e||1!=this.index||cc.director.emit(u.EventNames.UpdateAnimalSelection,this.node)},t.prototype.updateIndex=function(e,t){if(this.index=e,e==d.default.CurrentFinishEffectIndex&&cc.director.emit(u.EventNames.UpdateAnimalSelection,this.node),this.setIcon(this.index),t)this.labelName.string=d.default.FinishEffectNameMap[this.index],this.lockNode.active=!1,this.coinNode.active=!1,this.discountNode&&(this.discountNode.active=!1);else{this.labelName.string=d.default.FinishEffectUnlockPriceMap[this.index],this.lockNode.active=!0,this.coinNode.active=!0;var o=[];1==y.default.instance.getMonth()?o=[9]:2==y.default.instance.getMonth()&&(o=[10]),o.includes(this.index)?this.discountNode&&(this.discountNode.active=!0):this.discountNode&&(this.discountNode.active=!1)}},t.prototype.onBtnSelect=function(){this.lockNode.active?this.onBtnBuy():d.default.CurrentFinishEffectIndex!==this.index?(d.default.CurrentFinishEffectIndex=this.index,cc.director.emit(u.EventNames.UpdateAnimalSelection,this.node)):(d.default.CurrentFinishEffectIndex=1,cc.director.emit(u.EventNames.UpdateAnimalSelection))},t.prototype.onBtnBuy=function(){var e=this;if(this.lockNode.active)return cc.sys.isBrowser?(d.default.setFinishEffectUnlockMap(this.index,!0),this.lockNode.active=!1,this.coinNode.active=!1,this.discountNode.active=!1,void(this.labelName.string=d.default.FinishEffectNameMap[this.index])):void(h.default.Gold>=d.default.FinishEffectUnlockPriceMap[this.index]?p.default.uploadGoldCoin(h.default.Gold-d.default.FinishEffectUnlockPriceMap[this.index],function(){f.default.platform.showTips("\u8d2d\u4e70\u6210\u529f!"),console.error("\u8d2d\u4e70\u6210\u529f\uff01"),h.default.Gold-=d.default.FinishEffectUnlockPriceMap[e.index],d.default.setFinishEffectUnlockMap(e.index,!0),e.discountNode.active=!1,e.lockNode.active=!1,e.coinNode.active=!1,e.labelName.string=d.default.FinishEffectNameMap[e.index]},function(){f.default.platform.showTips("\u8d2d\u4e70\u5931\u8d25!\u8bf7\u91cd\u8bd5"),console.error("\u8d2d\u4e70\u5931\u8d25\uff01")}):(console.error("\u91d1\u5e01\u4e0d\u8db3\uff0c\u8d2d\u4e70\u5931\u8d25\uff01"),f.default.platform.showTips("\u91d1\u5e01\u4e0d\u8db3\uff0c\u8d2d\u4e70\u5931\u8d25\uff01")))},t.prototype.setIcon=function(e){var t=this,o=cc.assetManager.getBundle("EffectShopIcon");o?o.load(""+e,cc.SpriteFrame,function(e,o){e||(t.icon.spriteFrame=o)}):cc.assetManager.loadBundle("EffectShopIcon",function(n,i){(o=i).load(""+e,cc.SpriteFrame,function(e,o){e||(t.icon.spriteFrame=o)})})},l([v(cc.Label)],t.prototype,"labelName",void 0),l([v(cc.Sprite)],t.prototype,"icon",void 0),l([v(cc.Node)],t.prototype,"coinNode",void 0),l([v(cc.Node)],t.prototype,"lockNode",void 0),l([v(cc.Node)],t.prototype,"discountNode",void 0),l([g],t)}(cc.Component);r.default=_,cc._RF.pop(),cc._RF.pop()},{}],SubItem_Theme:[function(e,t,o){"use strict";cc._RF.push(t,"f6311Ri+aBCsZW6wyyNcOwk","SubItem_Theme");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"f6311Ri+aBCsZW6wyyNcOwk","SubItem_Theme");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("const"),p=n("Puzzle"),d=n("ThemeDataManager"),f=n("DataManager"),h=n("GameManager"),y=n("GoldDataManager"),m=n("BundleManager"),g=cc._decorator,v=g.ccclass,_=g.property,S=[2,5],b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.index=0,t.labelName=null,t.puzzle=null,t.specialBGMNode=null,t.coinNode=null,t.coinText=null,t.isLocked=!0,t}return s(t,e),t.prototype.onEnable=function(){cc.director.on(u.EventNames.UpdateAnimalSelection,this.setDefaultSelection,this)},t.prototype.onDisable=function(){cc.director.off(u.EventNames.UpdateAnimalSelection,this.setDefaultSelection,this)},t.prototype.setDefaultSelection=function(e){e||1!=this.index||cc.director.emit(u.EventNames.UpdateAnimalSelection,this.node)},t.prototype.updateIndex=function(e,t){this.index=e,this.puzzle.setUp(e),e==d.default.CurrentSelectedThemeIndex&&cc.director.emit(u.EventNames.UpdateAnimalSelection,this.node),t?this.setItemUnlocked(e):this.setItemLocked(e)},t.prototype.setItemUnlocked=function(){this.labelName.string=d.default.ThemeNameMap[this.index],this.labelName.node.active=!0,this.specialBGMNode.active=S.includes(this.index),this.isLocked=!1},t.prototype.setItemLocked=function(){var e=d.default.getThemeUnlockProgress(this.index);this.labelName.string=d.default.ThemeNameMap[this.index]+"("+e.unlocked+"/"+e.need+")",this.specialBGMNode.active=S.includes(this.index),this.isLocked=!0,d.default.getThemePrice(this.index)>0?(this.coinNode.active=!0,this.labelName.node.active=!1,this.coinText.string=d.default.getThemePrice(this.index).toString()):(this.labelName.node.active=!0,this.coinNode.active=!1)},t.prototype.onBtnSelect=function(){this.coinNode.active?this.onBtnBuy():this.isLocked||(d.default.CurrentSelectedThemeIndex!==this.index?(d.default.CurrentSelectedThemeIndex=this.index,m.default.getInstance().loadRes("ThemeInGame",this.index.toString(),cc.SpriteFrame),cc.director.emit(u.EventNames.UpdateAnimalSelection,this.node)):(d.default.CurrentSelectedThemeIndex=1,cc.director.emit(u.EventNames.UpdateAnimalSelection)),cc.director.getScene().name===u.SceneNames.Game&&cc.director.emit(u.EventNames.ChangeBg))},t.prototype.onBtnBuy=function(){var e=this;if(this.coinNode.active)return cc.sys.isBrowser?(d.default.unlockThemeById(this.index),this.coinNode.active=!1,this.puzzle.setUp(this.index),void this.setItemUnlocked(this.index)):void(y.default.Gold>=d.default.getThemePrice(this.index)?f.default.uploadGoldCoin(y.default.Gold-d.default.getThemePrice(this.index),function(){h.default.platform.showTips("\u8d2d\u4e70\u6210\u529f!"),console.log("\u8d2d\u4e70\u6210\u529f\uff01"),y.default.Gold-=d.default.getThemePrice(e.index),d.default.unlockThemeById(e.index),e.coinNode.active=!1,e.puzzle.setUp(e.index),e.setItemUnlocked(e.index)},function(){h.default.platform.showTips("\u8d2d\u4e70\u5931\u8d25!\u8bf7\u91cd\u8bd5"),console.error("\u8d2d\u4e70\u5931\u8d25\uff01")}):(console.error("\u91d1\u5e01\u4e0d\u8db3\uff0c\u8d2d\u4e70\u5931\u8d25\uff01"),h.default.platform.showTips("\u91d1\u5e01\u4e0d\u8db3\uff0c\u8d2d\u4e70\u5931\u8d25\uff01")))},l([_(cc.Label)],t.prototype,"labelName",void 0),l([_(p.default)],t.prototype,"puzzle",void 0),l([_(cc.Node)],t.prototype,"specialBGMNode",void 0),l([_(cc.Node)],t.prototype,"coinNode",void 0),l([_(cc.Label)],t.prototype,"coinText",void 0),l([v],t)}(cc.Component);r.default=b,cc._RF.pop(),cc._RF.pop()},{}],SuperHardTips:[function(e,t,o){"use strict";cc._RF.push(t,"539a0wcCxFBhKg/CJQ9ddBY","SuperHardTips");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"539a0wcCxFBhKg/CJQ9ddBY","SuperHardTips");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=n("GameManager"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.prefab=null,t}return s(t,e),t.prototype.start=function(){if(u.default.Level%10==5||u.default.Level%10==0){var e=cc.instantiate(this.prefab);p.default.playVibrateSquence(),e.setParent(this.node);var t=e.children[0],o=e.children[1].getComponent(sp.Skeleton);t.opacity=180;var n=0;u.default.Level%10==5?(o.setAnimation(0,"cngk",!1),o.node.opacity=255,n=o.findAnimation("cngk").duration):u.default.Level%10==0&&(u.default.Level<30?(o.setAnimation(0,"cngk",!1),o.node.opacity=255,n=o.findAnimation("cngk").duration):(o.setAnimation(0,"ccccngk",!1),o.node.opacity=255,n=o.findAnimation("ccccngk").duration)),cc.tween(t).delay(n-.3).to(.3,{opacity:0}).start(),o.setCompleteListener(function(){e.destroy()})}},l([h(cc.Prefab)],t.prototype,"prefab",void 0),l([f],t)}(cc.Component);r.default=y,cc._RF.pop(),cc._RF.pop()},{}],TEST_SS:[function(e,t,o){"use strict";cc._RF.push(t,"27b01R2/u9Lv7awrmfBJuFQ","TEST_SS");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"27b01R2/u9Lv7awrmfBJuFQ","TEST_SS");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData_SS"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.skipAdToggle=null,t.testLevelToggle=null,t.openBlockToggle=null,t.riseSpeed=null,t.moveSpeed=null,t.fallSpeed=null,t}return s(t,e),t.prototype.onLoad=function(){this.skipAdToggle.isChecked=u.default.ifSkipAd,this.testLevelToggle.isChecked=u.default.ifTestLevel,this.openBlockToggle.isChecked=u.default.ifOpenBlock},t.prototype.clickSkipAd=function(){u.default.ifSkipAd=!u.default.ifSkipAd,this.skipAdToggle.isChecked=u.default.ifSkipAd},t.prototype.clickTestLevel=function(){u.default.ifTestLevel=!u.default.ifTestLevel,this.testLevelToggle.isChecked=u.default.ifTestLevel},t.prototype.clickOpenBlock=function(){u.default.ifOpenBlock=!u.default.ifOpenBlock,this.openBlockToggle.isChecked=u.default.ifOpenBlock},l([f(cc.Toggle)],t.prototype,"skipAdToggle",void 0),l([f(cc.Toggle)],t.prototype,"testLevelToggle",void 0),l([f(cc.Toggle)],t.prototype,"openBlockToggle",void 0),l([f(cc.Label)],t.prototype,"riseSpeed",void 0),l([f(cc.Label)],t.prototype,"moveSpeed",void 0),l([f(cc.Label)],t.prototype,"fallSpeed",void 0),l([d],t)}(cc.Component);r.default=h,cc._RF.pop(),cc._RF.pop()},{}],TestNode_ED:[function(e,t,o){"use strict";cc._RF.push(t,"d006eTBKUVEdb1hdOTM0kj/","TestNode_ED");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"d006eTBKUVEdb1hdOTM0kj/","TestNode_ED");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pathLabel=null,t.modeNode=null,t}return s(t,e),t.prototype.onLoad=function(){this.pathLabel.string="\u66f4\u591a\u73a9\u6cd5-\u65e0\u5c3d\u5c0f\u74f6",this.pathLabel.node.parent.position=cc.v3(u.default.pathX,u.default.pathY,0),this.pathLabel.node.parent.active=u.default.ifTest,this.node.active=u.default.ifTest},t.prototype.onDestroy=function(){u.default.pathX=this.pathLabel.node.parent.position.x,u.default.pathY=this.pathLabel.node.parent.position.y},t.prototype.onBtn_Hide=function(){u.default.ifTestNode=!u.default.ifTestNode,this.node.opacity=u.default.ifTestNode?255:0},t.prototype.onBtn_Mode=function(){this.modeNode.active=!this.modeNode.active},t.prototype.onBtnShowPath=function(){u.default.ifTest=!u.default.ifTest,this.pathLabel.node.parent.active=u.default.ifTest,this.node.active=u.default.ifTest},l([f(cc.Label)],t.prototype,"pathLabel",void 0),l([f(cc.Node)],t.prototype,"modeNode",void 0),l([d],t)}(cc.Component);r.default=h,cc._RF.pop(),cc._RF.pop()},{}],TestNode:[function(e,t,o){"use strict";cc._RF.push(t,"48f537FOWZKDLdGuwbSYlGT","TestNode");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"48f537FOWZKDLdGuwbSYlGT","TestNode");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CollectionManager"),p=n("CommonData"),d=n("CupMgr"),f=n("LevelData"),h=n("LevelManager"),y=n("const"),m=n("FinishEffectDataManager"),g=n("CupMgr_17"),v=n("CupMgr_Long"),_=n("LevelManager_Long"),S=n("ThemeDataManager"),b=n("GameScene"),C=cc._decorator,P=C.ccclass,k=C.property,w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.editBox=null,t.pathLabel=null,t.time=null,t.modeNode=null,t.cupPositionMap=new Map,t.isFirstShowNumbers=!0,t.adLabel=null,t}return s(t,e),t.prototype.update=function(){var e=new Date,t=e.getHours().toString().padStart(2,"0"),o=e.getMinutes().toString().padStart(2,"0"),n=e.getSeconds().toString().padStart(2,"0");null!=this.time&&(this.time.string=t+":"+o+":"+n)},t.prototype.onLoad=function(){this.initEditBox(),this.initPath(),this.adLabel&&(this.adLabel.string=p.default.ifSkipAd?"\u5e7f\u544a(\u5173)":"\u5e7f\u544a(\u5f00)"),cc.director.on(y.EventNames.AutoPlayJumpToNextLevel,this.onBtn_Next,this)},t.prototype.initEditBox=function(){var e=cc.director.getScene().name;if(this.editBox)switch(e){case y.SceneNames.Game:this.editBox.placeholder="1 - "+f.default.MAX_LEVEL;break;case y.SceneNames.GameModeMultiple:this.editBox.placeholder="1 - "+h.MAX_LEVEL_MULTI;break;case y.SceneNames.GameModeFillLong:this.editBox.placeholder="1 - "+_.MAX_LEVEL_Long;default:this.editBox.placeholder=""}},t.prototype.initPath=function(){if(!p.default.ifTestNode)return this.pathLabel&&(this.pathLabel.node.parent.active=!1),void(this.modeNode&&(this.modeNode.active=!1));"Game"==cc.director.getScene().name?this.pathLabel.string="\u5f00\u59cb\u6e38\u620f-\u7b2c"+p.default.Level+"\u5173":"GameModeLong"==cc.director.getScene().name?this.pathLabel.string="\u6311\u6218\u6a21\u5f0f-\u7b2c"+p.default.LevelChallenge+"\u5173":cc.director.getScene().name==y.SceneNames.GameModeMultiple?this.pathLabel.string="\u66f4\u591a\u73a9\u6cd5-\u8d85\u591a\u5c0f\u74f6-\u7b2c"+p.default.LevelModeMultiple+"\u5173":cc.director.getScene().name==y.SceneNames.GameModeFillLong&&(this.pathLabel.string="\u66f4\u591a\u73a9\u6cd5-\u957f\u74f6\u5b50-\u7b2c"+p.default.LevelModeFillLong+"\u5173"),this.modeNode.position=cc.v3(p.default.pathX,p.default.pathY,0),p.default.ifTest&&this.modeNode?this.modeNode.active=p.default.ifShowMode:this.modeNode.active=!1},t.prototype.start=function(){if(!p.default.ifTestNode)return this.node.active=!1,this.pathLabel&&(this.pathLabel.node.parent.active=!1),void(this.modeNode&&(this.modeNode.active=!1));this.pathLabel&&(this.pathLabel.node.parent.children[0].opacity=150),this.node.opacity=255,p.default.ifTest?null!=this.time&&(this.time.node.active=p.default.TimeOn):null!=this.time&&(this.time.node.active=!1)},t.prototype.onDestroy=function(){cc.director.off(y.EventNames.AutoPlayJumpToNextLevel,this.onBtn_Next,this),p.default.pathX=this.pathLabel.node.parent.position.x,p.default.pathY=this.pathLabel.node.parent.position.y},t.prototype.onBtn_Time=function(){this.time.node.active=!this.time.node.active,this.time.node.active?p.default.TimeOn=!0:p.default.TimeOn=!1},t.prototype.onBtn_Jump=function(){var e=parseInt(this.editBox.string);isNaN(e)||e<1||("Game"==cc.director.getScene().name?p.default.Level=e:"GameModeLong"==cc.director.getScene().name?p.default.LevelChallenge=e:cc.director.getScene().name==y.SceneNames.GameModeMultiple?p.default.LevelModeMultiple=e:cc.director.getScene().name==y.SceneNames.GameModeFillLong&&(p.default.LevelModeFillLong=e),cc.director.loadScene(cc.director.getScene().name))},t.prototype.onBtn_ShowHidden=function(){for(var e=0,t=d.default.getInstance().cups;e<t.length;e++)for(var o=t[e],n=0;n<o.info.colorIds.length;n++)o.info.colorIds[n]>100&&(o.info.colorIds[n]-=100,o.onShowHidden(n),o.initWater())},t.prototype.onBtn_Next=function(){if("Game"==cc.director.getScene().name){if(p.default.Level++,p.default.ifRestart=!1,p.default.Level>300&&p.default.CurrentLevel>300)switch(p.default.currentLevelDifficulty){case 0:p.default.removeChallengeLevel0();break;case 1:p.default.removeChallengeLevel1();break;case 2:p.default.removeChallengeLevel2();break;case 3:p.default.removeChallengeLevel3()}}else"GameModeLong"==cc.director.getScene().name?p.default.LevelChallenge++:cc.director.getScene().name==y.SceneNames.GameModeMultiple?p.default.LevelModeMultiple++:cc.director.getScene().name==y.SceneNames.GameModeFillLong&&p.default.LevelModeFillLong++;cc.director.loadScene(cc.director.getScene().name)},t.prototype.onBtn_Hide=function(){p.default.ifTestNode=!p.default.ifTestNode,this.node.opacity=p.default.ifTestNode?255:0},t.prototype.onBtn_reStart=function(){cc.director.loadScene(cc.director.getScene().name)},t.prototype.onBtn_AutoPlay=function(){"Game"==cc.director.getScene().name?b.default.instance.autoPlayer.enabled=!b.default.instance.autoPlayer.enabled:cc.director.getScene().name==y.SceneNames.GameModeMultiple&&(b.default.instance.autoPlayerMulti.enabled=!b.default.instance.autoPlayerMulti.enabled)},t.prototype.onBtn_Mode=function(){p.default.ifShowMode=!p.default.ifShowMode,this.modeNode.active=p.default.ifShowMode},t.prototype.addCupToPositionMap=function(e,t){var o=e.x.toFixed(2)+","+e.y.toFixed(2);this.cupPositionMap.set(o,t)},t.prototype.getCupIndexByPosition=function(e){var t=e.x.toFixed(2)+","+e.y.toFixed(2);return this.cupPositionMap.get(t)||-1},t.prototype.clearCupPositionMap=function(){this.cupPositionMap.clear(),this.isFirstShowNumbers=!0},t.prototype.buildCupPositionMap=function(){if(this.clearCupPositionMap(),"Game"==cc.director.getScene().name||cc.director.getScene().name==y.SceneNames.GameModeMultiple)for(var e=d.default.getInstance().cups,t=0;t<e.length;t++)this.addCupToPositionMap(e[t].node.position,t+1);else if("GameModeLong"==cc.director.getScene().name)for(e=g.default.getInstance().cups,t=0;t<e.length;t++)this.addCupToPositionMap(e[t].node.position,t+1);else if(cc.director.getScene().name==y.SceneNames.GameModeFillLong)for(e=v.default.getInstance().cups,t=0;t<e.length;t++)this.addCupToPositionMap(e[t].node.position,t+1)},t.prototype.onBtn_UnlockAll=function(){p.default.CurrentUnlockIndex=p.default.collectionList.length+1;for(var e=1;e<=u.default.capCollectionList.length;e++)u.default.setCapUnlockMap(e,!0);for(e=1;e<=u.default.characterCollectionList.length;e++)u.default.setCharacterUnlockMap(e,!0);u.default.CurrentCapByWinStreakIndex=u.default.unlockCapByWinStreakArray.length+1,u.default.CurrentCharacterByWinStreakIndex=u.default.unlockCharacterByWinStreakArray.length+1,p.default.UnlockWinCount=9999,m.default.unlockAllFinishEffects(),S.default.unlockAllThemes()},t.prototype.onBtn_Ad=function(){p.default.ifSkipAd=!p.default.ifSkipAd,this.adLabel.string=p.default.ifSkipAd?"\u5e7f\u544a(\u5173)":"\u5e7f\u544a(\u5f00)"},t.prototype.onBtn_Win=function(){"Game"==cc.director.getScene().name?cc.director.emit("level_finish"):"GameModeLong"==cc.director.getScene().name?cc.director.emit("level_finished_long"):(cc.director.getScene().name==y.SceneNames.GameModeMultiple||cc.director.getScene().name==y.SceneNames.GameModeFillLong)&&cc.director.emit("level_finish")},l([k(cc.EditBox)],t.prototype,"editBox",void 0),l([k(cc.Label)],t.prototype,"pathLabel",void 0),l([k(cc.Label)],t.prototype,"time",void 0),l([k(cc.Node)],t.prototype,"modeNode",void 0),l([k(cc.Label)],t.prototype,"adLabel",void 0),l([P],t)}(cc.Component);r.default=w,cc._RF.pop(),cc._RF.pop()},{}],ThemeDataManager:[function(e,t,o){"use strict";cc._RF.push(t,"58862W+iAhOz50ZqQVWaarf","ThemeDataManager");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"58862W+iAhOz50ZqQVWaarf","ThemeDataManager");var c=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var s=n("CommonData"),l=n("SignInManager"),u=n("CollectionData"),p=cc._decorator,d=p.ccclass,f=(p.property,function(){function e(){}var t;return t=e,e.getThemePrice=function(e){if(1==e)return 0;if(9==e&&1==l.default.instance.getMonth())return 0;if(10==e&&2==l.default.instance.getMonth())return 0;for(var o=0,n=1;n<=t.ThemeUnlockNeedMap[e];n++){var i=e+"_"+n;0==t.ThemeUnlockMap[i]&&o++}return this._themePriceMap[e]*o},e.getThemeUnlockProgress=function(e){for(var t=this.ThemeUnlockNeedMap[e],o=0,n=1;n<=this.ThemeUnlockNeedMap[e];n++)1==this._themeUnlockMap[e+"_"+n]&&o++;return{need:t,unlocked:o}},Object.defineProperty(e,"ThemeUnlockMap",{get:function(){var e=s.default.getStorage("themeUnlockMap");if(e){var o=JSON.parse(e);for(var n in o)t._themeUnlockMap[n]=o[n]}return t._themeUnlockMap},enumerable:!1,configurable:!0}),e.setThemeUnlockMap=function(e,o){var n=s.default.getStorage("themeUnlockMap");n&&(t._themeUnlockMap=JSON.parse(n)),e.includes("_")?t._themeUnlockMap[e]=o:t._themeUnlockMap[parseInt(e)]=o,t.saveThemeUnlockMap();var i=e.split("_"),r=e.includes("_")?parseInt(i[0]):parseInt(e);t.checkUnlockComplete(r)},e.saveThemeUnlockMap=function(){var e=JSON.stringify(t._themeUnlockMap);s.default.setStorage("themeUnlockMap",e)},e.checkUnlockComplete=function(e){for(var o=t.ThemeUnlockNeedMap[e],n=1;n<=o;n++){var i=e+"_"+n;if(!0!==t._themeUnlockMap[i])return}!1===t._themeUnlockMap[e]&&t.setThemeUnlockMap(e.toString(),!0)},e.unlockAllThemes=function(){for(var e in t._themeUnlockMap)t._themeUnlockMap[e]=!0;t.saveThemeUnlockMap()},e.unlockThemeById=function(e){var o=e;t.setThemeUnlockMap(o.toString(),!0);for(var n=1;n<=t.ThemeUnlockNeedMap[e];n++){var i=e+"_"+n;t.setThemeUnlockMap(i,!0)}t.saveThemeUnlockMap()},Object.defineProperty(e,"CurrentSelectedThemeIndex",{get:function(){var e=s.default.getStorage("currentThemeIndex");return e&&(t._currentThemeIndex=parseInt(e)),t._currentThemeIndex},set:function(e){t._currentThemeIndex=e,s.default.setStorage("currentThemeIndex",e.toString())},enumerable:!1,configurable:!0}),e.checkData=function(){for(var e in t.ThemeUnlockNeedMap){var o=parseInt(e);if(!1===t.ThemeUnlockMap[o]){for(var n=!0,i=t.ThemeUnlockNeedMap[o],r=1;r<=i;r++){var a=o+"_"+r;if(!0!==t.ThemeUnlockMap[a]){n=!1;break}}n&&t.setThemeUnlockMap(o.toString(),!0)}}},e._currentThemeIndex=1,e.ThemeUnlockLevelMap=new Map,e.ThemeNameMap=u.ThemeNameMap,e.ThemeUnlockNeedMap=u.ThemeUnlockNeedMap,e._themePriceMap=u._themePriceMap,e._themeUnlockMap=u._themeUnlockMap,t=c([d],e)}());r.default=f,cc._RF.pop(),cc._RF.pop()},{}],ThemeData:[function(e,t){"use strict";cc._RF.push(t,"f0977C64xRPeYIVdyuneXeo","ThemeData");var o=t;cc._RF.push(o,"f0977C64xRPeYIVdyuneXeo","ThemeData"),cc._RF.pop(),cc._RF.pop()},{}],ThemeManager:[function(e,t,o){"use strict";cc._RF.push(t,"d18f0yB8VFHd7s2IFJUtoYB","ThemeManager");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"d18f0yB8VFHd7s2IFJUtoYB","ThemeManager");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("const"),d=n("ThemeDataManager"),f=cc._decorator,h=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bg_front=null,t.bg_back=null,t.front_light=null,t.front_dark=null,t.bg_frames=[],t.btn_setting=null,t.btn_setting_frames=[],t.level=null,t.level_frames=[],t}return s(t,e),t.prototype.onLoad=function(){cc.director.on(p.EventNames.ChangeBg,this.setBg,this),this.setBg(),u.default.instance.init(function(){2!=d.default.CurrentSelectedThemeIndex?5!=d.default.CurrentSelectedThemeIndex?u.default.instance.playBGM(u.AudioRef.LevelBGM,!0):u.default.instance.playBGM(u.AudioRef.LevelBgmH,!0):u.default.instance.playBGM(u.AudioRef.LevelBgmM,!0)})},t.prototype.onDestroy=function(){cc.director.off(p.EventNames.ChangeBg,this.setBg,this)},t.prototype.setBg=function(){var e=this,t=d.default.CurrentSelectedThemeIndex;1!=t&&(this.bg_back.spriteFrame=this.getSf(t.toString()),this.bg_back.spriteFrame||this.loadSfAsync(t.toString()).then(function(t){e.bg_back.spriteFrame=t}),2==t||5==t?(this.btn_setting.spriteFrame=this.btn_setting_frames[1],this.level.spriteFrame=this.level_frames[1],this.bg_front.spriteFrame=this.front_dark):(this.bg_front.spriteFrame=this.front_light,this.btn_setting.spriteFrame=this.btn_setting_frames[0],this.level.spriteFrame=this.level_frames[0]))},t.prototype.getSf=function(e){if(!e)return null;var t=e,o=cc.assetManager.getBundle("ThemeInGame");return o?o.get(t,cc.SpriteFrame)||null:void 0},t.prototype.loadSfAsync=function(e){return new Promise(function(t,o){if(e){var n=e,i=cc.assetManager.getBundle("ThemeInGame"),r=function(e){var i=e.get(n,cc.SpriteFrame);i?t(i):e.load(n,cc.SpriteFrame,function(e,i){e?o(e):i?t(i):o(new Error("SpriteFrame not found: "+n))})};i?r(i):cc.assetManager.loadBundle("ThemeInGame",function(e,t){!e&&t?r(t):o(e||new Error("Load bundle failed: ThemeInGame"))})}else t(null)})},l([y(cc.Sprite)],t.prototype,"bg_front",void 0),l([y(cc.Sprite)],t.prototype,"bg_back",void 0),l([y(cc.SpriteFrame)],t.prototype,"front_light",void 0),l([y(cc.SpriteFrame)],t.prototype,"front_dark",void 0),l([y([cc.SpriteFrame])],t.prototype,"bg_frames",void 0),l([y(cc.Sprite)],t.prototype,"btn_setting",void 0),l([y([cc.SpriteFrame])],t.prototype,"btn_setting_frames",void 0),l([y(cc.Sprite)],t.prototype,"level",void 0),l([y([cc.SpriteFrame])],t.prototype,"level_frames",void 0),l([h],t)}(cc.Component);r.default=m,cc._RF.pop(),cc._RF.pop()},{}],Tool_SS:[function(e,t,o){"use strict";cc._RF.push(t,"9a4bdvduupDf7VoMUPVjl64","Tool_SS");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"9a4bdvduupDf7VoMUPVjl64","Tool_SS");var a=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(i,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,l=(c.property,function(){function e(){}return e.recodeNumber=function(e,t){var o=t.toString();if(!(o.length>e))return new Array(e-o.length).fill("0").join("")+o;console.error("\u4f4d\u6570\u4e0d\u8db3\uff0c\u4e0d\u5408\u6cd5")},e.getInterval=function(e,t){for(var o=Math.random()*t,n=0,i=0;i<e.length;i++)if(o<(n+=e[i]))return i},e.shuffle=function(e){for(var t,o=e.length-1;o>0;o--){var n=Math.floor(Math.random()*(o+1));t=[e[n],e[o]],e[o]=t[0],e[n]=t[1]}return e},e.sum=function(e){var t=0;return e.forEach(function(e){t+=e}),t},e.getStackTail=function(e){var t=[],o=e[e.length-1];if(!o)return null;t.push(e.length-1);for(var n=e.length-2;n>=0;n--){if(e[n]!==o)return t;t.push(n)}},e.pushToTail=function(e,t){var o=e[t];e.splice(t,1),e.push(o)},e.getFrequency=function(e){var t={};return e.forEach(function(e){t[e.toString()]?t[e.toString()]++:t[e.toString()]=1}),t},e.rangeFilter=function(e,t,o){var n=[];return e.forEach(function(e){e>=t&&e<=o&&n.push(e)}),n},e.getTailList=function(e){for(var t=[],o=e.length-1;o>=0&&e[o]===e[e.length-1];o--)t.push(e[o]);return t},e.getConverseList=function(e){for(var t=[],o=e.length-1;o>=0;o--)t.push(e[o]);return t},e.getDistance=function(e,t){var o=e.convertToWorldSpaceAR(cc.Vec2.ZERO),n=t.convertToWorldSpaceAR(cc.Vec2.ZERO);return Math.sqrt(Math.pow(o.x-n.x,2)+Math.pow(o.y-n.y,2))},a([s],e)}());i.default=l,cc._RF.pop(),cc._RF.pop()},{}],TopPnl_SS:[function(e,t,o){"use strict";cc._RF.push(t,"2e5c6hFCf9Al5z85azpf8JL","TopPnl_SS");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"2e5c6hFCf9Al5z85azpf8JL","TopPnl_SS");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("GameManager_SS"),p=n("UIManager_SS"),d=cc._decorator,f=d.ccclass,h=d.property,y=d.menu,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.setBtn=null,t.setImg=null,t.pauseImg=null,t.energyCount=null,t.energyTimer=null,t.isCounting=!1,t}return s(t,e),t.prototype.start=function(){},t.prototype.update=function(){},t.prototype.convertSecondsToTimeFormat=function(e){var t=Math.floor(e/60),o=Math.floor(e%60);return t.toString().padStart(2,"0")+":"+o.toString().padStart(2,"0")},t.prototype.switchSetBtn=function(e){this.setBtn.spriteFrame=e?this.pauseImg:this.setImg},t.prototype.clickSetBtn=function(){u.default.playVibrateShort(),p.default.instance.gamePnl.active,p.default.instance.showPanel(p.default.instance.pnlEnum.set)},l([h(cc.Sprite)],t.prototype,"setBtn",void 0),l([h(cc.SpriteFrame)],t.prototype,"setImg",void 0),l([h(cc.SpriteFrame)],t.prototype,"pauseImg",void 0),l([h(cc.Label)],t.prototype,"energyCount",void 0),l([h(cc.Label)],t.prototype,"energyTimer",void 0),l([h()],t.prototype,"isCounting",void 0),l([f,y("ScrewSortGame/Top")],t)}(cc.Component);r.default=m,cc._RF.pop(),cc._RF.pop()},{}],TutorialPanel:[function(e,t,o){"use strict";cc._RF.push(t,"a29e1ZD3/hCxJmv/XJsbVjf","TutorialPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"a29e1ZD3/hCxJmv/XJsbVjf","TutorialPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("Cup"),p=n("BasePanel"),d=n("LevelManager"),f=n("CommonData"),h=n("CupMgr"),y=cc._decorator,m=y.ccclass,g=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cupNode=null,t.contentLabel=null,t.title=null,t.titleImgs=[],t.right=null,t.wrong=null,t.to1=null,t.to2=null,t.to3=null,t.to4=null,t.to5=null,t.to6=null,t.canClose=!1,t.showCaseIndex=0,t}return s(t,e),t.prototype.show=function(){this.init(),this.canClose=!1;var e=this.cupNode.parent;cc.director.emit("UpdateOpenPanelCount"),e&&(cc.Tween.stopAllByTarget(e),e.scale=.5,e.opacity=0,cc.tween(e).to(.2,{scale:1.1,opacity:200},{easing:"smooth"}).to(.2,{scale:1,opacity:255},{easing:"smooth"}).call(function(){cc.director.emit("setDrinkPanelInfo")}).start())},t.prototype.hide=function(){var e=this;if(1===this.node.scale){this.unscheduleAllCallbacks(),this.to1&&(clearTimeout(this.to1),this.to1=null),this.to2&&(clearTimeout(this.to2),this.to2=null),this.to3&&(clearTimeout(this.to3),this.to3=null),this.to4&&(clearTimeout(this.to4),this.to4=null),this.to5&&(clearTimeout(this.to5),this.to5=null),this.to6&&(clearTimeout(this.to6),this.to6=null),h.default.getInstance().selected=null,h.default.getInstance().ifFirstClick=!0,this.scheduleOnce(function(){e.cupNode.removeAllChildren()},0),this.scheduleOnce(function(){e.cupNode.removeAllChildren(),h.default.getInstance().selected=null},.2);var t=this.cupNode.parent;t&&(cc.Tween.stopAllByTarget(t),t.scale=1,t.opacity=255,cc.tween(t).to(.4,{scale:0,opacity:0},{easing:"backIn"}).call(function(){e.node.active=!1,cc.director.emit("UpdateOpenPanelCount")}).start())}},t.prototype.onBtn_close=function(){this.canClose&&this.hide()},t.prototype.onEnable=function(){},t.prototype.defualtInGameSetUp=function(){switch(this.getTutorialIndex()){case 0:this.generateForzenTutorial(),f.default.TUTORIAL_INDEX[0]=-1;break;case 1:this.generateMaskTutorial(),f.default.TUTORIAL_INDEX[1]=-1;break;case 2:this.generateHiddenMarkTutorial(),f.default.TUTORIAL_INDEX[2]=-1;break;case 3:this.generateFillCupTutorial(),f.default.TUTORIAL_INDEX[3]=-1;break;case 4:this.generateSingleColorTutorial(),f.default.TUTORIAL_INDEX[4]=-1;break;case 5:this.generateTempTutorial(),f.default.TUTORIAL_INDEX[5]=-1;break;case 6:this.generateAbsorbTutorial(),f.default.ifPlayedAbsorbCup=!0;break;case 7:this.generateBombTutorial(),f.default.ifPlayedBombCup=!0;break;case 8:this.generateColorChangeTutorial(),f.default.ifPlayedChangeColorCup=!0;break;case 9:this.generateLockCupTutorial(),f.default.ifPlayedLockCup=!0;break;default:return void this.hide()}},t.prototype.getTutorialIndex=function(){if(-1!==f.default.TUTORIAL_INDEX.indexOf(f.default.Level))return f.default.TUTORIAL_INDEX.indexOf(f.default.Level);var e=h.default.getInstance().cups;if(!1===f.default.ifPlayedAbsorbCup)for(var t=0,o=e;t<o.length;t++)if((l=o[t]).cupType===u.CupType.Absorb)return 6;if(!1===f.default.ifPlayedBombCup)for(var n=0,i=e;n<i.length;n++)if((l=i[n]).cupType===u.CupType.Bomb||l.cupType===u.CupType.BombFixed||l.cupType===u.CupType.BombMasked||l.cupType===u.CupType.BombFrozen)return 7;if(!1===f.default.ifPlayedChangeColorCup)for(var r=0,a=e;r<a.length;r++)if((l=a[r]).cupType===u.CupType.ChangeColor)return 8;if(!1===f.default.ifPlayedLockCup)for(var c=0,s=e;c<s.length;c++){var l;if((l=s[c]).cupType===u.CupType.Lock)return 9}return-1},t.prototype.onDisable=function(){this.unscheduleAllCallbacks(),h.default.getInstance().selected=null,this.cupNode.removeAllChildren(),this.to1&&(clearTimeout(this.to1),this.to1=null),this.to2&&(clearTimeout(this.to2),this.to2=null),this.to3&&(clearTimeout(this.to3),this.to3=null),this.to4&&(clearTimeout(this.to4),this.to4=null)},t.prototype.generateLockCupTutorial=function(){var e=this;this.title.spriteFrame=this.titleImgs[0],this.contentLabel.string="\u9700\u8981\u6536\u96c6\u5230\u5bf9\u5e94\u7684\u94a5\u5319\u624d\u53ef\u4ee5\u89e3\u9501";var t={type:u.CupType.Lock,pos:{x:0,y:30},colorIds:[0,0,2,2003],lockType:1},o={type:u.CupType.Lock,pos:{x:-100,y:30},colorIds:[0,0,3,3004],lockType:2},n={type:u.CupType.Lock,pos:{x:-200,y:30},colorIds:[0,0,0,0],lockType:3},i={type:u.CupType.Normal,pos:{x:100,y:30},colorIds:[0,0,1,1002]},r={type:u.CupType.Normal,pos:{x:200,y:30},colorIds:[0,0,0,0]},a=d.default.getInstance().createOneCup(t,this.cupNode),c=d.default.getInstance().createOneCup(o,this.cupNode),s=d.default.getInstance().createOneCup(n,this.cupNode),l=d.default.getInstance().createOneCup(i,this.cupNode),p=d.default.getInstance().createOneCup(r,this.cupNode);this.to1=setTimeout(function(){l.onBtn_click()},500),this.to2=setTimeout(function(){p.onBtn_click()},1e3),this.to3=setTimeout(function(){a.onBtn_click(),e.to1=setTimeout(function(){l.onBtn_click()},500)},3e3),this.to4=setTimeout(function(){c.onBtn_click(),e.to1=setTimeout(function(){a.onBtn_click()},500),e.to2=setTimeout(function(){a.node.destroy(),c.node.destroy(),s.node.destroy(),p.node.destroy(),l.node.destroy(),e.canClose=!0},3e3)},5500),this.schedule(function(){var t={type:u.CupType.Lock,pos:{x:0,y:30},colorIds:[0,0,2,2003],lockType:1},o={type:u.CupType.Lock,pos:{x:-100,y:30},colorIds:[0,0,3,3004],lockType:2},n={type:u.CupType.Lock,pos:{x:-200,y:30},colorIds:[0,0,0,0],lockType:3},i={type:u.CupType.Normal,pos:{x:100,y:30},colorIds:[0,0,1,1002]},r={type:u.CupType.Normal,pos:{x:200,y:30},colorIds:[0,0,0,0]},a=d.default.getInstance().createOneCup(t,e.cupNode),c=d.default.getInstance().createOneCup(o,e.cupNode),s=d.default.getInstance().createOneCup(n,e.cupNode),l=d.default.getInstance().createOneCup(i,e.cupNode),p=d.default.getInstance().createOneCup(r,e.cupNode);e.to1=setTimeout(function(){l.onBtn_click()},500),e.to2=setTimeout(function(){p.onBtn_click()},1e3),e.to3=setTimeout(function(){a.onBtn_click(),e.to1=setTimeout(function(){l.onBtn_click()},500)},3e3),e.to4=setTimeout(function(){c.onBtn_click(),e.to1=setTimeout(function(){a.onBtn_click()},500),e.to2=setTimeout(function(){a.node.destroy(),c.node.destroy(),s.node.destroy(),p.node.destroy(),l.node.destroy()},3e3)},5500)},8.5)},t.prototype.generateColorChangeTutorial=function(){var e=this;this.title.spriteFrame=this.titleImgs[0],this.contentLabel.string="\u74f6\u5b50\u4e2d\u6c34\u5c42\u4f1a\u4e0a\u6d6e";var t={type:u.CupType.ChangeColor,pos:{x:0,y:30},colorIds:[0,1,2,2]},o={type:u.CupType.Normal,pos:{x:-120,y:30},colorIds:[0,0,0,1]},n={type:u.CupType.Normal,pos:{x:120,y:30},colorIds:[0,0,0,1]},i=d.default.getInstance().createOneCup(o,this.cupNode),r=d.default.getInstance().createOneCup(t,this.cupNode),a=d.default.getInstance().createOneCup(n,this.cupNode);this.to1=setTimeout(function(){a.onBtn_click()},500),this.to2=setTimeout(function(){r.onBtn_click()},1500),this.to3=setTimeout(function(){r.onBtn_click()},3e3),this.to4=setTimeout(function(){i.onBtn_click(),e.to1=setTimeout(function(){i.node.destroy(),r.node.destroy(),a.node.destroy(),e.canClose=!0},1500)},4e3),this.schedule(function(){var t={type:u.CupType.ChangeColor,pos:{x:0,y:30},colorIds:[0,1,2,2]},o={type:u.CupType.Normal,pos:{x:-120,y:30},colorIds:[0,0,0,1]},n={type:u.CupType.Normal,pos:{x:120,y:30},colorIds:[0,0,0,1]},i=d.default.getInstance().createOneCup(o,e.cupNode),r=d.default.getInstance().createOneCup(t,e.cupNode),a=d.default.getInstance().createOneCup(n,e.cupNode);e.to1=setTimeout(function(){a.onBtn_click()},500),e.to2=setTimeout(function(){r.onBtn_click()},1500),e.to3=setTimeout(function(){r.onBtn_click()},3e3),e.to4=setTimeout(function(){i.onBtn_click(),e.to1=setTimeout(function(){i.node.destroy(),r.node.destroy(),a.node.destroy()},1500)},4e3)},5.5)},t.prototype.generateAbsorbTutorial=function(){var e=this;this.title.spriteFrame=this.titleImgs[0],this.contentLabel.string="\u9700\u8981\u6d88\u8017\u6389\u84c4\u6c34\u74f6\u5b58\u50a8\u7684\u82e5\u5e72\u683c\u6c34";var t={type:u.CupType.Absorb,pos:{x:-120,y:-25},colorIds:[4,4,4,4],absorbArray:[5]},o={type:u.CupType.Normal,pos:{x:0,y:30},colorIds:[0,0,0,4]},n={type:u.CupType.Normal,pos:{x:120,y:30},colorIds:[0,0,0,5]},i=d.default.getInstance().createOneCup(t,this.cupNode),r=d.default.getInstance().createOneCup(o,this.cupNode),a=d.default.getInstance().createOneCup(n,this.cupNode);this.to1=setTimeout(function(){i.onBtn_click()},500),this.to2=setTimeout(function(){r.onBtn_click()},1200),this.to3=setTimeout(function(){i.onBtn_click()},2300),this.to4=setTimeout(function(){a.onBtn_click()},3e3),setTimeout(function(){r.node.destroy(),a.node.destroy(),e.canClose=!0},5500),this.schedule(function(){var t={type:u.CupType.Absorb,pos:{x:-120,y:-25},colorIds:[4,4,4,4],absorbArray:[5]},o={type:u.CupType.Normal,pos:{x:0,y:30},colorIds:[0,0,0,4]},n={type:u.CupType.Normal,pos:{x:120,y:30},colorIds:[0,0,0,5]},i=d.default.getInstance().createOneCup(t,e.cupNode),r=d.default.getInstance().createOneCup(o,e.cupNode),a=d.default.getInstance().createOneCup(n,e.cupNode);e.to1=setTimeout(function(){i.onBtn_click()},500),e.to2=setTimeout(function(){r.onBtn_click()},1200),e.to3=setTimeout(function(){i.onBtn_click()},2200),e.to4=setTimeout(function(){a.onBtn_click()},3e3),setTimeout(function(){r.node.destroy(),a.node.destroy()},5500)},5.5)},t.prototype.generateBombTutorial=function(){var e=this;this.title.spriteFrame=this.titleImgs[0],this.contentLabel.string="\u5728\u5012\u8ba1\u65f6\u7ed3\u675f\u524d\uff0c\u96c6\u6ee1\u70b8\u5f39\u74f6\u5b50\n\u5426\u5219\u6e38\u620f\u5931\u8d25";var t={type:u.CupType.Normal,pos:{x:-120,y:30},colorIds:[0,0,0,0]},o={type:u.CupType.Normal,pos:{x:0,y:30},colorIds:[0,0,3,2]},n={type:u.CupType.Bomb,pos:{x:120,y:30},colorIds:[0,2,2,2],bombTime:30},i=d.default.getInstance().createOneCup(t,this.cupNode),r=d.default.getInstance().createOneCup(o,this.cupNode),a=d.default.getInstance().createOneCup(n,this.cupNode);a.getComponent("BombCup").startTimer(),this.to1=setTimeout(function(){r.onBtn_click()},500),this.to2=setTimeout(function(){i.onBtn_click()},1e3),this.to3=setTimeout(function(){r.onBtn_click()},2e3),this.to4=setTimeout(function(){a.onBtn_click()},2500),setTimeout(function(){i.node.destroy(),r.node.destroy(),a.node.destroy(),e.canClose=!0},5500),this.schedule(function(){var t={type:u.CupType.Normal,pos:{x:-120,y:30},colorIds:[0,0,0,0]},o={type:u.CupType.Normal,pos:{x:0,y:30},colorIds:[0,0,3,2]},n={type:u.CupType.Bomb,pos:{x:120,y:30},colorIds:[0,2,2,2],bombTime:30},i=d.default.getInstance().createOneCup(t,e.cupNode),r=d.default.getInstance().createOneCup(o,e.cupNode),a=d.default.getInstance().createOneCup(n,e.cupNode);a.getComponent("BombCup").startTimer(),e.to1=setTimeout(function(){r.onBtn_click()},500),e.to2=setTimeout(function(){i.onBtn_click()},1e3),e.to3=setTimeout(function(){r.onBtn_click()},2e3),e.to4=setTimeout(function(){a.onBtn_click()},2500),setTimeout(function(){i.node.destroy(),r.node.destroy(),a.node.destroy()},5500)},5.5)},t.prototype.generateTempTutorial=function(){var e=this;this.title.spriteFrame=this.titleImgs[0],this.contentLabel.string="\u5c0f\u74f6\u5b50\u53ef\u4ee5\u7528\u6765\u4e34\u65f6\u5b58\u653e\u4e00\u683c\u6c34";var t={type:u.CupType.Normal,pos:{x:-120,y:30},colorIds:[5,5,4,4]},o={type:u.CupType.Normal,pos:{x:0,y:30},colorIds:[0,4,5,5]},n={type:u.CupType.Temp1,pos:{x:120,y:-35.5},colorIds:[0,0,0,0]},i=d.default.getInstance().createOneCup(t,this.cupNode),r=d.default.getInstance().createOneCup(o,this.cupNode),a=d.default.getInstance().createOneCup(n,this.cupNode);this.to1=setTimeout(function(){r.onBtn_click()},500),this.to2=setTimeout(function(){a.onBtn_click()},1e3),this.to3=setTimeout(function(){i.onBtn_click()},1500),this.to4=setTimeout(function(){r.onBtn_click()},2e3),setTimeout(function(){i.node.destroy(),r.node.destroy(),a.node.destroy(),e.canClose=!0},5500),this.schedule(function(){var t={type:u.CupType.Normal,pos:{x:-120,y:30},colorIds:[5,5,4,4]},o={type:u.CupType.Normal,pos:{x:0,y:30},colorIds:[0,4,5,5]},n={type:u.CupType.Temp1,pos:{x:120,y:-35.5},colorIds:[0,0,0,0]},i=d.default.getInstance().createOneCup(t,e.cupNode),r=d.default.getInstance().createOneCup(o,e.cupNode),a=d.default.getInstance().createOneCup(n,e.cupNode);e.to1=setTimeout(function(){r.onBtn_click()},500),e.to2=setTimeout(function(){a.onBtn_click()},1e3),e.to3=setTimeout(function(){i.onBtn_click()},1500),e.to4=setTimeout(function(){r.onBtn_click()},2e3),setTimeout(function(){i.node.destroy(),r.node.destroy(),a.node.destroy()},5500)},5.5)},t.prototype.generateForzenTutorial=function(){var e=this;this.title.spriteFrame=this.titleImgs[0],this.contentLabel.string="\u6d88\u9664\u5176\u4ed6\u74f6\u5b50\u89e3\u51bb";var t={type:u.CupType.Normal,pos:{x:80,y:30},colorIds:[0,4,4,4]},o={type:u.CupType.Normal,pos:{x:200,y:30},colorIds:[0,0,0,4]},n={type:u.CupType.Frozen,pos:{x:-80,y:30},colorIds:[5,6,7,8],frozenUnlockCount:1},i=d.default.getInstance().createOneCup(t,this.cupNode),r=d.default.getInstance().createOneCup(o,this.cupNode),a=d.default.getInstance().createOneCup(n,this.cupNode);r.node.opacity=0,this.to1=setTimeout(function(){r.onBtn_click(),cc.tween(r.node).to(.5,{opacity:255}).start()},500),this.to2=setTimeout(function(){i.onBtn_click(),cc.tween(r.node).delay(1).to(.5,{opacity:0}).start()},1e3),setTimeout(function(){a.unfreezeCup()},2500),setTimeout(function(){i.node.destroy(),r.node.destroy(),a.node.destroy(),e.canClose=!0},4500),this.schedule(function(){var t={type:u.CupType.Normal,pos:{x:80,y:30},colorIds:[0,4,4,4]},o={type:u.CupType.Normal,pos:{x:200,y:30},colorIds:[0,0,0,4]},n={type:u.CupType.Frozen,pos:{x:-80,y:30},colorIds:[5,6,7,8],frozenUnlockCount:1},i=d.default.getInstance().createOneCup(t,e.cupNode),r=d.default.getInstance().createOneCup(o,e.cupNode),a=d.default.getInstance().createOneCup(n,e.cupNode);r.node.opacity=0,e.to1=setTimeout(function(){r.onBtn_click(),cc.tween(r.node).to(.5,{opacity:255}).start()},500),e.to2=setTimeout(function(){i.onBtn_click(),cc.tween(r.node).delay(1).to(.5,{opacity:0}).start()},1e3),setTimeout(function(){a.unfreezeCup()},2500),setTimeout(function(){i.node.destroy(),r.node.destroy(),a.node.destroy()},4500)},4.5)},t.prototype.generateMaskTutorial=function(){var e=this;this.title.spriteFrame=this.titleImgs[0],this.contentLabel.string="\u6d88\u9664\u7279\u5b9a\u74f6\u5b50\u989c\u8272\u89e3\u9501";var t={type:u.CupType.Normal,pos:{x:120,y:30},colorIds:[0,1,1,1]},o={type:u.CupType.Normal,pos:{x:220,y:30},colorIds:[0,0,0,1]},n={type:u.CupType.Masked,pos:{x:0,y:30},colorIds:[5,5,6,6],maskUnlockCount:1,maskUnlockColorId:1},i={type:u.CupType.Masked,pos:{x:-120,y:30},colorIds:[7,7,8,8],maskUnlockCount:1,maskUnlockColorId:2},r=d.default.getInstance().createOneCup(t,this.cupNode),a=d.default.getInstance().createOneCup(o,this.cupNode),c=d.default.getInstance().createOneCup(n,this.cupNode),s=d.default.getInstance().createOneCup(i,this.cupNode);a.node.opacity=0,this.to1=setTimeout(function(){a.onBtn_click(),cc.tween(a.node).to(.5,{opacity:255}).start()},500),this.to2=setTimeout(function(){r.onBtn_click(),cc.tween(a.node).delay(1).to(.5,{opacity:0}).start()},1e3),setTimeout(function(){c.unmaskCup()},2500),setTimeout(function(){r.node.destroy(),a.node.destroy(),c.node.destroy(),s.node.destroy(),e.canClose=!0},4500),this.schedule(function(){var t={type:u.CupType.Normal,pos:{x:120,y:30},colorIds:[0,1,1,1]},o={type:u.CupType.Normal,pos:{x:220,y:30},colorIds:[0,0,0,1]},n={type:u.CupType.Masked,pos:{x:0,y:30},colorIds:[5,5,6,6],maskUnlockCount:1,maskUnlockColorId:1},i={type:u.CupType.Masked,pos:{x:-120,y:30},colorIds:[7,7,8,8],maskUnlockCount:1,maskUnlockColorId:2},r=d.default.getInstance().createOneCup(t,e.cupNode),a=d.default.getInstance().createOneCup(o,e.cupNode),c=d.default.getInstance().createOneCup(n,e.cupNode),s=d.default.getInstance().createOneCup(i,e.cupNode);a.node.opacity=0,e.to1=setTimeout(function(){a.onBtn_click(),cc.tween(a.node).to(.5,{opacity:255}).start()},500),e.to2=setTimeout(function(){r.onBtn_click(),cc.tween(a.node).delay(1).to(.5,{opacity:0}).start()},1e3),setTimeout(function(){c.unmaskCup()},2500),setTimeout(function(){r.node.destroy(),a.node.destroy(),c.node.destroy(),s.node.destroy()},4500)},4.5)},t.prototype.generateHiddenMarkTutorial=function(){var e=this;this.title.spriteFrame=this.titleImgs[1],this.contentLabel.string="\u79fb\u8d70\u4e0a\u5c42\u6c34\u540e\u663e\u793a\u989c\u8272";var t={type:u.CupType.Normal,pos:{x:100,y:30},colorIds:[0,0,0,1]},o={type:u.CupType.Normal,pos:{x:-100,y:30},colorIds:[0,0,1,101]},n=d.default.getInstance().createOneCup(t,this.cupNode),i=d.default.getInstance().createOneCup(o,this.cupNode);this.to1=setTimeout(function(){i.onBtn_click()},500),this.to2=setTimeout(function(){n.onBtn_click()},800),setTimeout(function(){n.node.destroy(),i.node.destroy(),e.canClose=!0},3e3),this.schedule(function(){var t={type:u.CupType.Normal,pos:{x:100,y:30},colorIds:[0,0,0,1]},o={type:u.CupType.Normal,pos:{x:-100,y:30},colorIds:[0,0,1,101]},n=d.default.getInstance().createOneCup(t,e.cupNode),i=d.default.getInstance().createOneCup(o,e.cupNode);e.to1=setTimeout(function(){i.onBtn_click()},500),e.to2=setTimeout(function(){n.onBtn_click()},1e3),setTimeout(function(){n.node.destroy(),i.node.destroy()},3e3)},3)},t.prototype.generateFillCupTutorial=function(){var e=this;this.title.spriteFrame=this.titleImgs[2],this.contentLabel.string="\u6d88\u9664\u74f6\u5b50\u540e\u8865\u5145\u65b0\u74f6\u5b50";var t={type:u.CupType.Normal,pos:{x:0,y:30},colorIds:[0,4,4,4]},o={type:u.CupType.Normal,pos:{x:150,y:30},colorIds:[0,0,0,4]},n={type:u.CupType.Normal,pos:{x:-150,y:30},colorIds:[5,6,7,8]},i={type:u.CupType.Normal,pos:{x:900,y:30},colorIds:[1,2,3,4]},r=d.default.getInstance().createOneCup(t,this.cupNode),a=d.default.getInstance().createOneCup(o,this.cupNode),c=d.default.getInstance().createOneCup(i,this.cupNode),s=d.default.getInstance().createOneCup(n,this.cupNode);a.node.opacity=0,this.to1=setTimeout(function(){a.onBtn_click(),cc.tween(a.node).to(.5,{opacity:255}).start()},500),this.to2=setTimeout(function(){r.onBtn_click(),cc.tween(a.node).delay(1).to(.5,{opacity:0}).start()},1e3),setTimeout(function(){cc.tween(r.node).to(.5,{x:-900}).start(),cc.tween(c.node).to(.5,{x:0}).start()},4e3),setTimeout(function(){r.node.destroy(),a.node.destroy(),c.node.destroy(),s.node.destroy(),e.canClose=!0},5500),this.schedule(function(){var t={type:u.CupType.Normal,pos:{x:0,y:30},colorIds:[0,4,4,4]},o={type:u.CupType.Normal,pos:{x:150,y:30},colorIds:[0,0,0,4]},n={type:u.CupType.Normal,pos:{x:900,y:30},colorIds:[1,2,3,4]},i={type:u.CupType.Normal,pos:{x:-150,y:30},colorIds:[5,6,7,8]},r=d.default.getInstance().createOneCup(i,e.cupNode),a=d.default.getInstance().createOneCup(t,e.cupNode),c=d.default.getInstance().createOneCup(o,e.cupNode),s=d.default.getInstance().createOneCup(n,e.cupNode);c.node.opacity=0,e.to1=setTimeout(function(){c.onBtn_click(),cc.tween(c.node).to(.5,{opacity:255}).start()},500),e.to2=setTimeout(function(){a.onBtn_click(),cc.tween(c.node).delay(1).to(.5,{opacity:0}).start()},1e3),setTimeout(function(){cc.tween(a.node).to(.5,{x:-900}).start(),cc.tween(s.node).to(.5,{x:0}).start()},4e3),setTimeout(function(){a.node.destroy(),c.node.destroy(),s.node.destroy(),r.node.destroy()},5500)},5.5)},t.prototype.generateSingleColorTutorial=function(){var e=this;this.title.spriteFrame=this.titleImgs[0],this.contentLabel.string="\u7279\u5b9a\u989c\u8272\u74f6\u5b50\u4ec5\u53ef\u5012\u5165\u540c\u8272\u6c34";var t={type:u.CupType.Normal,pos:{x:0,y:30},colorIds:[0,0,4,4]},o={type:u.CupType.Normal,pos:{x:120,y:30},colorIds:[0,0,3,3]},n={type:u.CupType.SingleColor,pos:{x:-120,y:30},colorIds:[0,0,0,0],singleColorId:3},i=d.default.getInstance().createOneCup(t,this.cupNode),r=d.default.getInstance().createOneCup(o,this.cupNode),a=d.default.getInstance().createOneCup(n,this.cupNode);this.to1=setTimeout(function(){i.onBtn_click(),e.wrong.active=!0,e.wrong.parent=a.node,e.wrong.setPosition(0,200),e.right.active=!1},500),this.to2=setTimeout(function(){r.onBtn_click(),e.right.active=!0,e.right.parent=a.node,e.right.setPosition(0,200),e.wrong.active=!1},1500),this.to3=setTimeout(function(){a.onBtn_click(),e.right.parent=e.node,e.wrong.parent=e.node,e.right.active=!1,e.wrong.active=!1},3e3),setTimeout(function(){i.node.destroy(),r.node.destroy(),a.node.destroy(),e.canClose=!0},5e3),this.schedule(function(){var t={type:u.CupType.Normal,pos:{x:0,y:30},colorIds:[0,0,2,2]},o={type:u.CupType.Normal,pos:{x:120,y:30},colorIds:[0,0,4,4]},n={type:u.CupType.SingleColor,pos:{x:-120,y:30},colorIds:[0,0,0,0],singleColorId:4},i=d.default.getInstance().createOneCup(t,e.cupNode),r=d.default.getInstance().createOneCup(o,e.cupNode),a=d.default.getInstance().createOneCup(n,e.cupNode);e.to1=setTimeout(function(){i.onBtn_click(),e.wrong.active=!0,e.wrong.parent=a.node,e.wrong.setPosition(0,200),e.right.active=!1},500),e.to2=setTimeout(function(){r.onBtn_click(),e.right.active=!0,e.right.parent=a.node,e.right.setPosition(0,200),e.wrong.active=!1},1500),e.to3=setTimeout(function(){a.onBtn_click(),e.right.parent=e.node,e.wrong.parent=e.node,e.right.active=!1,e.wrong.active=!1},3e3),setTimeout(function(){i.node.destroy(),r.node.destroy(),a.node.destroy()},5e3)},5)},t.prototype.setShowCaseIndex=function(e){switch(this.canClose=!0,e){case u.CupType.Absorb:this.showCaseIndex=6;break;case u.CupType.Bomb:this.showCaseIndex=7;break;case u.CupType.Frozen:this.showCaseIndex=0;break;case u.CupType.Masked:this.showCaseIndex=1;break;case u.CupType.Temp1:this.showCaseIndex=5;break;case u.CupType.SingleColor:this.showCaseIndex=4;break;case u.CupType.ChangeColor:this.showCaseIndex=8;break;case u.CupType.Lock:this.showCaseIndex=9}switch(this.showCaseIndex){case 0:this.generateForzenTutorial(),this.title.spriteFrame=this.titleImgs[3],f.default.TUTORIAL_INDEX[0]=-1;break;case 1:this.generateMaskTutorial(),this.title.spriteFrame=this.titleImgs[4],f.default.TUTORIAL_INDEX[1]=-1;break;case 2:this.generateHiddenMarkTutorial(),f.default.TUTORIAL_INDEX[2]=-1;break;case 3:this.generateFillCupTutorial(),f.default.TUTORIAL_INDEX[3]=-1;break;case 4:this.generateSingleColorTutorial(),this.title.spriteFrame=this.titleImgs[5],f.default.TUTORIAL_INDEX[4]=-1;break;case 5:this.generateTempTutorial(),this.title.spriteFrame=this.titleImgs[6],f.default.TUTORIAL_INDEX[5]=-1;break;case 6:this.generateAbsorbTutorial(),this.title.spriteFrame=this.titleImgs[7],f.default.ifPlayedAbsorbCup=!0;break;case 7:this.generateBombTutorial(),this.title.spriteFrame=this.titleImgs[8],f.default.ifPlayedBombCup=!0;break;case 8:this.generateColorChangeTutorial(),this.title.spriteFrame=this.titleImgs[9],f.default.ifPlayedChangeColorCup=!0;break;case 9:this.generateLockCupTutorial(),this.title.spriteFrame=this.titleImgs[10],f.default.ifPlayedLockCup=!0;break;default:return void this.hide()}},t.prototype.getShowCaseIndex=function(){return this.showCaseIndex},l([g(cc.Node)],t.prototype,"cupNode",void 0),l([g(cc.Label)],t.prototype,"contentLabel",void 0),l([g(cc.Sprite)],t.prototype,"title",void 0),l([g([cc.SpriteFrame])],t.prototype,"titleImgs",void 0),l([g(cc.Node)],t.prototype,"right",void 0),l([g(cc.Node)],t.prototype,"wrong",void 0),l([m],t)}(p.default);r.default=v,cc._RF.pop(),cc._RF.pop()},{}],UIManager_BP:[function(e,t,o){"use strict";cc._RF.push(t,"1b8e57isaxArpR5BOq+hYvW","UIManager_BP");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"1b8e57isaxArpR5BOq+hYvW","UIManager_BP");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager_BP"),p=n("LevelDataMgr_BP"),d=n("ExternalManager_BP"),f=n("GameOverPanel_BP"),h=n("SettingPanel_BP"),y=n("testPanel_BP"),m=cc._decorator,g=m.ccclass,v=m.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gameOverPanel=null,t.finalLevelLabel=null,t.pausePanel=null,t.settingsPanel=null,t.promptPanel=null,t.promptLabel=null,t.promptCloseBtn=null,t.promptOkBtn=null,t.advertisementVideoNode=null,t.testPnl=null,t.currentLevel=1,t.promptUnlockedLevels=new Set,t}var o;return s(t,e),o=t,t.prototype.onLoad=function(){o.instance=this},t.prototype.start=function(){this.hideAllPanels(),this.setupPromptListeners(),this.hidePromptPanel(),this.updatePromptAdState(),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},t.prototype.onKeyDown=function(e){e.keyCode===cc.macro.KEY.l&&this.toggletestPnl()},t.prototype.toggletestPnl=function(){this.testPnl&&(this.testPnl.active?this.hidetestPnl():this.showtestPnl())},t.prototype.showtestPnl=function(){if(this.testPnl){this.testPnl.active=!0;var e=this.testPnl.getComponent(y.default);e&&e.show()}},t.prototype.hidetestPnl=function(){if(this.testPnl){var e=this.testPnl.getComponent(y.default);e?e.hide():this.testPnl.active=!1}},t.prototype.setupPromptListeners=function(){var e=this;this.promptCloseBtn&&this.promptCloseBtn.on(cc.Node.EventType.TOUCH_END,function(){u.default.instance.playClickClose(),e.scheduleOnce(function(){e.hidePromptPanel()},.1)}),this.promptOkBtn&&this.promptOkBtn.on(cc.Node.EventType.TOUCH_END,function(){u.default.instance.playBtn(),e.scheduleOnce(function(){e.hidePromptPanel()},.1)})},t.prototype.showGameOverPanel=function(e){if(this.gameOverPanel){var t=this.gameOverPanel.getComponent(f.default);if(t)return this.gameOverPanel.active=!0,void t.show(e);this.gameOverPanel.active=!0,this.finalLevelLabel&&(this.finalLevelLabel.string="\u5df2\u5b8c\u6210 "+e+" \u4e2a\u5173\u5361\uff01"),this.gameOverPanel.opacity=0,cc.tween(this.gameOverPanel).to(.5,{opacity:255}).start()}},t.prototype.hideGameOverPanel=function(){if(this.gameOverPanel){var e=this.gameOverPanel.getComponent(f.default);if(e)return void e.hide();this.gameOverPanel.active=!1}},t.prototype.showPausePanel=function(){this.pausePanel&&(this.pausePanel.active=!0,this.pausePanel.opacity=0,cc.tween(this.pausePanel).to(.3,{opacity:255}).start())},t.prototype.hidePausePanel=function(){this.pausePanel&&(this.pausePanel.active=!1)},t.prototype.onClickSettingBtn=function(){u.default.instance.playBtn(),this.showSettingsPanel()},t.prototype.showSettingsPanel=function(){if(this.settingsPanel){var e=this.settingsPanel.getComponent(h.default);if(e)return void e.show();this.settingsPanel.active=!0,this.settingsPanel.opacity=0,cc.tween(this.settingsPanel).to(.3,{opacity:255}).start()}},t.prototype.hideSettingsPanel=function(){if(this.settingsPanel){var e=this.settingsPanel.getComponent(h.default);if(e)return void e.hide();this.settingsPanel.active=!1}},t.prototype.hideAllPanels=function(){this.hideGameOverPanel(),this.hidePausePanel(),this.hideSettingsPanel(),this.hidePromptPanel()},t.prototype.onLevelChanged=function(e){this.currentLevel=e,this.hidePromptPanel(),this.updatePromptAdState(e)},t.prototype.onPromptClick=function(e){var t=this;u.default.instance.playBtn(),this.currentLevel=e,this.promptUnlockedLevels.has(e)?this.showPromptPanel(e):(this.showAdvertisementVideo(),d.default.showRewardAd(function(){t.onPromptAdFinished(e)}))},t.prototype.onPromptAdFinished=function(e){this.promptUnlockedLevels.add(e),this.currentLevel===e&&(this.updatePromptAdState(e),this.showPromptPanel(e))},t.prototype.showPromptPanel=function(e){if(this.promptPanel&&(this.promptPanel.active=!0),this.promptLabel){var t=p.LevelDataMgr_BP.getLevelData(e),o=(null==t?void 0:t.solution)||[],n=o.length>0?o.map(function(e){return e.from+"\u2192"+e.to}).join(", "):"\u6682\u65e0\u89e3\u6cd5";this.promptLabel.string=n}},t.prototype.hidePromptPanel=function(){this.promptPanel&&(this.promptPanel.active=!1)},t.prototype.showAdvertisementVideo=function(){this.advertisementVideoNode&&(this.advertisementVideoNode.active=!0)},t.prototype.hideAdvertisementVideo=function(){this.advertisementVideoNode&&(this.advertisementVideoNode.active=!1)},t.prototype.updatePromptAdState=function(e){if(this.advertisementVideoNode){var t=null!=e?e:this.currentLevel,o=this.promptUnlockedLevels.has(t);this.advertisementVideoNode.active=!o,o&&this.hideAdvertisementVideo()}},t.prototype.showTip=function(e,t){void 0===t&&(t=2);var o=new cc.Node;o.name="TipNode";var n=o.addComponent(cc.Label);n.string=e,n.fontSize=32,this.node.addChild(o),o.setPosition(0,100),o.opacity=0,cc.tween(o).to(.3,{opacity:255}).delay(t-.6).to(.3,{opacity:0}).call(function(){o.destroy()}).start()},t.instance=null,l([v(cc.Node)],t.prototype,"gameOverPanel",void 0),l([v(cc.Label)],t.prototype,"finalLevelLabel",void 0),l([v(cc.Node)],t.prototype,"pausePanel",void 0),l([v(cc.Node)],t.prototype,"settingsPanel",void 0),l([v(cc.Node)],t.prototype,"promptPanel",void 0),l([v(cc.Label)],t.prototype,"promptLabel",void 0),l([v(cc.Node)],t.prototype,"promptCloseBtn",void 0),l([v(cc.Node)],t.prototype,"promptOkBtn",void 0),l([v(cc.Node)],t.prototype,"advertisementVideoNode",void 0),l([v(cc.Node)],t.prototype,"testPnl",void 0),o=l([g],t)}(cc.Component);r.default=_,cc._RF.pop(),cc._RF.pop()},{}],UIManager_ED:[function(e,t,o){"use strict";cc._RF.push(t,"cc47bPTNOZEq7CxFa5zeJ3L","UIManager_ED");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"cc47bPTNOZEq7CxFa5zeJ3L","UIManager_ED");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("GameOverPnl_ED"),p=n("PropPnl_ED"),d=n("SettingPnl_ED"),f=cc._decorator,h=f.ccclass,y=f.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pnlEnum=cc.Enum({gameOver:"gameOverPnl",prop:"propPnl",setting:"settingPnl"}),t.GameOverPnl=null,t.PropPnl=null,t.SettingPnl=null,t}var o;return s(t,e),o=t,t.prototype.onLoad=function(){o.instance=this},t.prototype.start=function(){},t.prototype.showPanel=function(e,t){var o=null;switch(e){case this.pnlEnum.gameOver:o=this.GameOverPnl.getComponent(u.default);break;case this.pnlEnum.prop:o=this.PropPnl.getComponent(p.default);break;case this.pnlEnum.setting:o=this.SettingPnl.getComponent(d.default)}o.show(t)},t.instance=null,l([y(cc.Node)],t.prototype,"GameOverPnl",void 0),l([y(cc.Node)],t.prototype,"PropPnl",void 0),l([y(cc.Node)],t.prototype,"SettingPnl",void 0),o=l([h],t)}(cc.Component);r.default=m,cc._RF.pop(),cc._RF.pop()},{}],UIManager_SS:[function(e,t,o){"use strict";cc._RF.push(t,"fc0e0pcWrVMi6HUf2TsHbvc","UIManager_SS");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"fc0e0pcWrVMi6HUf2TsHbvc","UIManager_SS");var a,c=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(i,"__esModule",{value:!0});var l=cc._decorator,u=l.ccclass,p=l.property,d=l.menu,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startPnl=null,t.gamePnl=null,t.topPnl=null,t.panelArea=null,t._doubleClickBlock=!1,t.addListPnl=null,t.withdrawPnl=null,t.putTopPnl=null,t.revivePnl=null,t.gameOverPnl=null,t.setPnl=null,t.pnlEnum=cc.Enum({gameOver:"gameOverPnl",set:"setPnl",sidebar:"sidebarPnl",withdraw:"withdrawPnl",addList:"addListPnl",putTop:"putTopPnl",revive:"revivePnl",collect:"collectPnl",invite:"invitePnl",energy:"energyPnl",infiniteEnergy:"infiniteEnergyPnl"}),t}var o;return c(t,e),o=t,t.prototype.onLoad=function(){o.instance=this,this.adapter()},Object.defineProperty(t.prototype,"startPnlCtrl",{get:function(){return this.startPnl.getComponent("StartPnl_SS")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"gamePnlCtrl",{get:function(){return this.gamePnl.getComponent("GamePnl_SS")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"topPnlCtrl",{get:function(){return this.topPnl.getComponent("TopPnl_SS")},enumerable:!1,configurable:!0}),t.prototype.adapter=function(){cc.find("Canvas").getComponent(cc.Canvas)},t.prototype.showPanel=function(e,t){if(!this._doubleClickBlock){this._doubleClickBlock=!0;var o=this[e];if(o){var n=cc.instantiate(o);n.parent=this.panelArea,"revivePnl"!==n.name&&"gameOverPnl"!==n.name||n.setSiblingIndex(0),n.getComponent(e+"_SS").show(t)}this._doubleClickBlock=!1}},t.instance=null,s([p(cc.Node)],t.prototype,"startPnl",void 0),s([p(cc.Node)],t.prototype,"gamePnl",void 0),s([p(cc.Node)],t.prototype,"topPnl",void 0),s([p(cc.Node)],t.prototype,"panelArea",void 0),s([p(cc.Prefab)],t.prototype,"addListPnl",void 0),s([p(cc.Prefab)],t.prototype,"withdrawPnl",void 0),s([p(cc.Prefab)],t.prototype,"putTopPnl",void 0),s([p(cc.Prefab)],t.prototype,"revivePnl",void 0),s([p(cc.Prefab)],t.prototype,"gameOverPnl",void 0),s([p(cc.Prefab)],t.prototype,"setPnl",void 0),o=s([u,d("ScrewSortGame/UIManager")],t)}(cc.Component);i.default=f,cc._RF.pop(),cc._RF.pop()},{}],UIManager:[function(e,t,o){"use strict";cc._RF.push(t,"b9a47lbH3hKN6/lIPE5THLl","UIManager");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"b9a47lbH3hKN6/lIPE5THLl","UIManager");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c},u=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},p=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0});var d=n("const"),f=n("SignInManager"),h=cc._decorator,y=h.ccclass,m=h.property,g=["AddDesktopPanel","CupShowCasePanel","DrinkCollectionPanel","GameClubPanel","GroupPanel","InvitePanel","JourneyMainPanel","RankPanel","SideModePanel"],v=["AddStepPanel","CollectionPanel","DrinkPanel","EndStreakPanel","EnergyPanel","GameLosePanel","GameOverMainPanel","JourneyPanel","SettingPanel","SidebarPanel","TutorialPanel","WxSidebarPanel","BeginnerTaskPanel"],_=["AddCupPanel","AddTimePanel","GameOverChallengePanel","GameOverPanel","LosePanel"],S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.panels=[],t.UIRoot=null,t._LRUQueue=[],t.panelMask=null,t.canHide=!1,t}var o;return s(t,e),o=t,t.getInstance=function(){return o._instance?o._instance:null},t.prototype.onLoad=function(){o._instance=this},t.prototype.onEnable=function(){cc.director.on("UpdateOpenPanelCount",this.updateActivePanelCount,this)},t.prototype.updateActivePanelCount=function(){var e=this.UIRoot.children.filter(function(e){return e.active}).length;0==e?(this.panelMask.active=!1,cc.director.emit(d.EventNames.ShowMainGameClubButton,!0),cc.director.emit(d.EventNames.NoActivePanel)):(this.panelMask.active=!0,1==e&&"EventPanel"==this.UIRoot.children.find(function(e){return e.active}).name&&(this.panelMask.active=!1),cc.director.emit(d.EventNames.ActivePanel),cc.director.emit(d.EventNames.ShowMainGameClubButton,!1))},t.prototype.showPanel=function(e){return u(this,void 0,Promise,function(){var t,o,n,i,r,a=this;return p(this,function(c){switch(c.label){case 0:if(this.canHide=!1,this.scheduleOnce(function(){a.canHide=!0},.3),t=this.UIRoot.getChildByName(e))return t.active=!1,t.active=!0,t.getComponent(e).show(),t.setSiblingIndex(this.UIRoot.childrenCount-1),[2,t];for(o=!1,n=0;n<this.panels.length;n++)if(this.panels[n].name===e)return o=!0,i=cc.instantiate(this.panels[n]),this.UIRoot.addChild(i),i.getComponent(e).show(),i.setSiblingIndex(this.UIRoot.childrenCount-1),[2,i];return o?[3,3]:(r=cc.assetManager.getBundle("Panels"))?[3,1]:[2,new Promise(function(t){cc.assetManager.loadBundle("Panels",function(o,n){return u(a,void 0,void 0,function(){var i;return p(this,function(r){switch(r.label){case 0:return o?[3,2]:[4,this.loadPanelInBundle(e,n)];case 1:return i=r.sent(),t(i),[3,3];case 2:cc.error("Load bundle 'Panels' error: ",o),t(null),r.label=3;case 3:return[2]}})})})})];case 1:return[4,this.loadPanelInBundle(e,r)];case 2:return[2,c.sent()];case 3:return[2,null]}})})},t.prototype.resolvePanelPath=function(e){return-1!=g.indexOf(e)?"PanelMain/"+e:-1!=v.indexOf(e)?"PanelMisc/"+e:-1!=_.indexOf(e)?"PanelSideMode/"+e:e},t.prototype.loadPanelInBundle=function(e,t){var o=this;return new Promise(function(n){var i=e;"Panels"==t.name&&(i=o.resolvePanelPath(e)),t.load(i,cc.Prefab,function(t,i){if(t)return cc.error("Load panel error: ",t),void n(null);var r=cc.instantiate(i);r.name=e,o.UIRoot.addChild(r),r.getComponent(e).show(),r.setSiblingIndex(o.UIRoot.childrenCount-1),n(r)})})},t.prototype.showEventPanel=function(e){var t=this;this.canHide=!1,this.scheduleOnce(function(){t.canHide=!0},.3);var o=this.UIRoot.getChildByName(e);if(o)return o.active=!1,o.active=!0,o.getComponent(e).show(),o.setSiblingIndex(this.UIRoot.childrenCount-1),o;var n="Eventb";2==f.default.instance.getMonth()&&(n="Event2");var i=cc.assetManager.getBundle(n);i?this.loadPanelInBundle(e,i):cc.assetManager.loadBundle(n,function(o,i){o?cc.error("Load bundle '"+n+"' error: ",o):t.loadPanelInBundle(e,i)})},t.prototype.hideTopPanel=function(){if(this.canHide){var e=this.UIRoot.children.filter(function(e){return e.active});if(0!=e.length){var t=e[e.length-1];t.getComponent(t.name).hide()}}},t._instance=null,l([m(cc.Prefab)],t.prototype,"panels",void 0),l([m(cc.Node)],t.prototype,"UIRoot",void 0),l([m(cc.Node)],t.prototype,"panelMask",void 0),o=l([y],t)}(cc.Component);r.default=S,cc._RF.pop(),cc._RF.pop()},{}],UITestNode:[function(e,t,o){"use strict";cc._RF.push(t,"81b92xKDsZFG5IirnUnF2k4","UITestNode");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"81b92xKDsZFG5IirnUnF2k4","UITestNode");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0}),r.changeModelTip=r.changeLiveMode=r.isModelTip=r.isLiveMode=void 0;var u=n("GameManager"),p=n("CommonData_SS"),d=n("DataManager_SS"),f=n("UIManager_SS"),h=cc._decorator,y=h.ccclass,m=h.property;function g(){r.isLiveMode=!r.isLiveMode}function v(){r.isModelTip=!r.isModelTip}r.isLiveMode=!0,r.isModelTip=!0,r.changeLiveMode=g,r.changeModelTip=v;var _=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tip=null,t.UIChangeBtn=null,t.LvEditBox=null,t.liveModeBtnLabel=null,t.NoLiveNeedHideNode=[],t.LiveNeedHideNode=[],t.LiveNeedOpacityNode=[],t.UIModelTip=null,t.UIModelTipLabel=null,t.isClick=!1,t.ifRapid=!0,t.ifOpenGap=!1,t}return s(t,e),t.prototype.onEnable=function(){!1!==p.default.ifTestLevel?this.changeModelTipInfo():this.node.active=!1},t.prototype.delayClick=function(){var e=this;this.isClick&&this.scheduleOnce(function(){e.isClick=!1},1)},t.prototype.clickChangeUI=function(){var e=255==this.UIChangeBtn.opacity;if(!r.isLiveMode){for(var t=0;t<this.NoLiveNeedHideNode.length;t++)this.NoLiveNeedHideNode[t].active=!e;p.default.ScrewSortCtrl.btns.active=!e}for(t=0;t<this.LiveNeedHideNode.length;t++)this.LiveNeedHideNode[t].active=!e;for(t=0;t<this.LiveNeedOpacityNode.length;t++)this.LiveNeedOpacityNode[t].opacity=e?0:255;cc.Tween.stopAllByTarget(this.tip),this.tip.opacity=0,e&&cc.tween(this.tip).delay(.2).to(.2,{opacity:255}).delay(2).to(.5,{opacity:0}).start()},t.prototype.clickModelBtn=function(){console.log("\u663e\u793a\u6a21\u5f0f\u4fe1\u606f"),v(),this.changeModelTipInfo()},t.prototype.changeModelTipInfo=function(){var e=this;p.default.mode=p.default.gameMode.normal;var t="";switch(p.default.mode){case p.default.gameMode.configured:t="\u6311\u6218\u5173\u5361";break;case p.default.gameMode.normal:t="\u5f00\u59cb\u6e38\u620f"}this.UIModelTipLabel.string=t+"\u2014\u2014\u7b2c"+d.default.curLevel+"\u5173",this.UIModelTip.active=r.isModelTip,this.scheduleOnce(function(){e.UIModelTip.getChildByName("background").width=e.UIModelTipLabel.node.width+30,e.UIModelTip.getChildByName("background").height=e.UIModelTipLabel.node.height+10},.5)},t.prototype.loadLv=function(){if(!this.isClick){this.isClick=!0,this.delayClick();var e=parseInt(this.LvEditBox.string);isNaN(e)?u.default.platform.showTips("\u8f93\u5165\u4e86\u4e0d\u5408\u6cd5\u7684\u5173\u5361\u6570"):p.default.mode===p.default.gameMode.configured&&e>d.default.levelConfiguredMax||(d.default.curLevel=e,f.default.instance.gamePnlCtrl.gameStart(),this.changeModelTipInfo())}},t.prototype.nextLv=function(){this.isClick||(this.isClick=!0,this.delayClick(),f.default.instance.showPanel(f.default.instance.pnlEnum.gameOver))},t.prototype.lastLv=function(){this.isClick||(this.isClick=!0,this.delayClick(),d.default.curLevel<=1||(d.default.curLevel--,f.default.instance.gamePnlCtrl.gameStart(),this.changeModelTipInfo()))},t.prototype.rePlay=function(){this.isClick||(this.isClick=!0,this.delayClick(),console.log("===>\u91cd\u73a9"),f.default.instance.gamePnlCtrl.gameStart())},t.prototype.changeLiveMode=function(){g(),this.checkLiveMode()},t.prototype.checkLiveMode=function(){r.isLiveMode?this.liveModeBtnLabel.string="\u5f53\u524d:\u4e3b\u64ad\u6a21\u5f0f":this.liveModeBtnLabel.string="\u5f53\u524d:\u8fbe\u4eba\u6a21\u5f0f"},t.prototype.clickNumberBtn=function(){p.default.ScrewSortCtrl.numberLayer.active=!p.default.ScrewSortCtrl.numberLayer.active},t.prototype.clickSpeedBtn=function(e){this.ifRapid=!this.ifRapid,d.default.ifSlow=!this.ifRapid,e.target.getChildByName("Background").getChildByName("Label").getComponent(cc.Label).string="\u901f\u5ea6\uff1a"+(this.ifRapid?"\u5feb":"\u6162")},t.prototype.clickGapBtn=function(e){this.ifOpenGap=!this.ifOpenGap,d.default.ifOpenGap=this.ifOpenGap,e.target.getChildByName("Background").getChildByName("Label").getComponent(cc.Label).string="\u95f4\u9694\uff1a"+(this.ifOpenGap?"\u5f00":"\u5173")},l([m(cc.Node)],t.prototype,"tip",void 0),l([m({type:cc.Node,tooltip:"UI\u663e\u9690\u6309\u94ae"})],t.prototype,"UIChangeBtn",void 0),l([m({type:cc.EditBox})],t.prototype,"LvEditBox",void 0),l([m({type:cc.Label})],t.prototype,"liveModeBtnLabel",void 0),l([m({type:cc.Node,tooltip:"\u8fbe\u4eba\u6a21\u5f0f\u9700\u8981\u5355\u72ec\u9690\u85cf\u7684\u7ed3\u70b9"})],t.prototype,"NoLiveNeedHideNode",void 0),l([m({type:cc.Node,tooltip:"\u4e3b\u64ad\u6a21\u5f0f\u548c\u8fbe\u4eba\u6a21\u5f0f\u90fd\u9700\u8981\u9690\u85cf\u7684\u7ed3\u70b9"})],t.prototype,"LiveNeedHideNode",void 0),l([m({type:cc.Node,tooltip:"\u4e3b\u64ad\u6a21\u5f0f\u548c\u8fbe\u4eba\u6a21\u5f0f\u90fd\u9700\u8981\u6539\u53d8\u900f\u660e\u5ea6\u7684\u7ed3\u70b9\uff08\u76f8\u5f53\u4e8e\u662f\u9690\u85cf\u4e86\u4e5f\u80fd\u70b9\u51fb\uff09"})],t.prototype,"LiveNeedOpacityNode",void 0),l([m({type:cc.Node,tooltip:"\u663e\u793a\u6a21\u5f0f"})],t.prototype,"UIModelTip",void 0),l([m({type:cc.Label,tooltip:"\u663e\u793a\u6a21\u5f0f\u6587\u672c"})],t.prototype,"UIModelTipLabel",void 0),l([y],t)}(cc.Component);r.default=_,cc._RF.pop(),cc._RF.pop()},{}],UI_SS:[function(e,t,o){"use strict";cc._RF.push(t,"3e28214SYFFu4lAyiQn97aW","UI_SS");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"3e28214SYFFu4lAyiQn97aW","UI_SS");var a,c=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(i,"__esModule",{value:!0});var l=cc._decorator,u=l.ccclass,p=l.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.addListPnl=null,t.withdrawPnl=null,t.puttopPnl=null,t.revivePnl=null,t.gameOverPnl=null,t.setPnl=null,t}return c(t,e),t.prototype.start=function(){},s([p(cc.Prefab)],t.prototype,"addListPnl",void 0),s([p(cc.Prefab)],t.prototype,"withdrawPnl",void 0),s([p(cc.Prefab)],t.prototype,"puttopPnl",void 0),s([p(cc.Prefab)],t.prototype,"revivePnl",void 0),s([p(cc.Prefab)],t.prototype,"gameOverPnl",void 0),s([p(cc.Prefab)],t.prototype,"setPnl",void 0),s([u],t)}(cc.Component);i.default=d,cc._RF.pop(),cc._RF.pop()},{}],UnlockData:[function(e,t,o){"use strict";cc._RF.push(t,"504ebCWAkhFlIPJl6YphCA8","UnlockData");var n=e,i=t,r=o;cc._RF.push(i,"504ebCWAkhFlIPJl6YphCA8","UnlockData"),Object.defineProperty(r,"__esModule",{value:!0}),r.UnlockList=r.UnlockType=void 0;var a,c=n("ThemeDataManager"),s=n("CollectionManager"),l=n("CommonData");(function(e){e[e.CAP=1]="CAP",e[e.THEME=2]="THEME",e[e.RIDER=3]="RIDER",e[e.GOLD=4]="GOLD",e[e.EVENT=5]="EVENT"})(a=r.UnlockType||(r.UnlockType={})),r.UnlockList=[{type:1,id:1},{type:2,id:"2_1"},{type:1,id:2},{type:2,id:"2_2"},{type:4,id:1},{type:2,id:"2_3"},{type:1,id:16},{type:2,id:"2_4"},{type:1,id:17},{type:2,id:"3_1"},{type:4,id:2},{type:2,id:"3_2"},{type:1,id:18},{type:2,id:"3_3"},{type:1,id:19},{type:2,id:"3_4"},{type:4,id:1},{type:2,id:"3_5"},{type:1,id:3},{type:2,id:"3_6"},{type:1,id:20},{type:2,id:"3_7"},{type:4,id:2},{type:2,id:"3_8"},{type:1,id:21},{type:2,id:"3_9"},{type:3,id:3},{type:2,id:"4_1"},{type:4,id:1},{type:2,id:"4_2"},{type:1,id:22},{type:2,id:"4_3"},{type:1,id:23},{type:2,id:"4_4"},{type:4,id:2},{type:2,id:"4_5"},{type:1,id:24},{type:2,id:"4_6"},{type:1,id:25},{type:2,id:"4_7"},{type:4,id:1},{type:2,id:"4_8"},{type:1,id:26},{type:2,id:"4_9"},{type:1,id:4},{type:2,id:"5_1"},{type:4,id:2},{type:2,id:"5_2"},{type:1,id:27},{type:2,id:"5_3"},{type:3,id:2},{type:2,id:"5_4"},{type:4,id:1},{type:2,id:"6_1"},{type:1,id:6},{type:2,id:"6_2"},{type:1,id:7},{type:2,id:"6_3"},{type:4,id:2},{type:2,id:"6_4"},{type:1,id:5},{type:2,id:"6_5"},{type:1,id:8},{type:2,id:"6_6"},{type:4,id:1},{type:2,id:"6_7"},{type:1,id:9},{type:2,id:"6_8"},{type:1,id:10},{type:2,id:"6_9"},{type:4,id:2},{type:2,id:"7_1"},{type:1,id:28},{type:2,id:"7_2"},{type:1,id:29},{type:2,id:"7_3"},{type:4,id:1},{type:2,id:"7_4"},{type:3,id:5},{type:2,id:"7_5"},{type:1,id:30},{type:2,id:"7_6"},{type:4,id:2},{type:2,id:"7_7"},{type:1,id:31},{type:2,id:"7_8"},{type:1,id:32},{type:2,id:"7_9"},{type:4,id:1},{type:2,id:"8_1"},{type:1,id:33},{type:2,id:"8_2"},{type:1,id:34},{type:2,id:"8_3"},{type:4,id:2},{type:2,id:"8_4"},{type:1,id:35},{type:2,id:"8_5"},{type:1,id:36},{type:2,id:"8_6"},{type:4,id:1},{type:2,id:"8_7"},{type:1,id:37},{type:2,id:"8_8"},{type:3,id:6},{type:2,id:"8_9"},{type:4,id:2},{type:2,id:"11_1"},{type:2,id:"11_2"},{type:2,id:"11_3"},{type:2,id:"11_4"}];var u=function(){function e(){}return e.initUnlockArray=function(){var t=e.loadUnlockArray();console.error(t),e.unlockArray=[];for(var o=0,n=r.UnlockList;o<n.length;o++){var i=n[o];e.checkIfItemUnlocked(i.type,i.id)||e.unlockArray.push(i)}for(var a=0;a<e.unlockArray.length;a++){var c=l.default.Level;c-=c%5!=0?c%5:5;var u=e.unlockArray[a],p=c+5*(a+1);e.setItemUnlockLevel(u.type,u.id,p)}console.error("UnlockData.unlockArray",e.unlockArray),console.error("CollectionManager.unlockCapByLevelArray",s.default.unlockCapByLevelArray),e.saveUnlockArray()},e.saveUnlockArray=function(){for(;e.unlockArray.length<8;)e.unlockArray.push({type:a.GOLD,id:3});var t=JSON.stringify(e.unlockArray);cc.sys.localStorage.setItem("JourneyUnlockArray",t)},e.loadUnlockArray=function(){var e=cc.sys.localStorage.getItem("JourneyUnlockArray");return console.error("loadUnlockArray",e),""==e?"":JSON.parse(e)},Object.defineProperty(e,"CurrentUnlockItem",{get:function(){return e.unlockArray.length>0?e.unlockArray[0]:null},enumerable:!1,configurable:!0}),e.checkIfItemUnlocked=function(t,o){switch(t){case a.CAP:return s.default.CapUnlockMap[o];case a.RIDER:return s.default.CharacterUnlockMap[o];case a.THEME:return c.default.ThemeUnlockMap[o];case a.GOLD:return 0==e.unlockArray.length;default:return!1}},e.setItemUnlockLevel=function(e,t,o){switch(e){case a.CAP:s.default.unlockCapByLevelArray.set(t,o);break;case a.RIDER:s.default.unlockCharacterByLevelArray.set(t,o);break;case a.THEME:c.default.ThemeUnlockLevelMap.set(t,o);break;case a.GOLD:}},e.getJourneyUnlockInfo=function(){for(var t=[null,null,null,null,null,null,null,null],o=0;o<t.length;o++)t[o]=e.unlockArray[o]?e.unlockArray[o]:null;return t},e.stopOrder=[1,2,3,4],e.unlockArray=[],e.currentUnlockIndex=0,e}();r.default=u,cc._RF.pop(),cc._RF.pop()},{}],Warning_Multi:[function(e,t,o){"use strict";cc._RF.push(t,"02c16nvvspB3J9l2Mb1Db/A","Warning_Multi");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"02c16nvvspB3J9l2Mb1Db/A","Warning_Multi");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("const"),p=cc._decorator,d=p.ccclass,f=(p.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tween=null,t.referenceCount=0,t}return s(t,e),t.prototype.onEnable=function(){cc.director.on(u.EventNames.BombTimeWarning,this.addRef,this),cc.director.on(u.EventNames.BombDefuse,this.decRef,this),cc.director.on(u.EventNames.Explode,this.decRef,this)},t.prototype.onDisable=function(){cc.director.off(u.EventNames.BombTimeWarning,this.addRef,this),cc.director.off(u.EventNames.BombDefuse,this.decRef,this),cc.director.off(u.EventNames.Explode,this.decRef,this)},t.prototype.addRef=function(){this.referenceCount++,1===this.referenceCount&&this.startBlink()},t.prototype.decRef=function(){this.referenceCount--,0===this.referenceCount&&this.stopBlink()},t.prototype.startBlink=function(){this.node.opacity=0,this.tween=cc.tween(this.node).repeatForever(cc.tween().to(.5,{opacity:255}).to(.5,{opacity:100})).start()},t.prototype.stopBlink=function(){this.tween.stop(),cc.tween(this.node).to(.2,{opacity:0}).start()},l([d],t)}(cc.Component));r.default=f,cc._RF.pop(),cc._RF.pop()},{}],WaterArrGenerate_ED:[function(e,t,o){"use strict";cc._RF.push(t,"ee5beY8EKBI34AEgR3HuFRr","WaterArrGenerate_ED");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"ee5beY8EKBI34AEgR3HuFRr","WaterArrGenerate_ED");var a=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(i,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,l=(c.property,[2,3,4,8,10]),u=[{colors:"2",config:[{sortType:[1,1,1,2],weight:100},{sortType:[1,2,1,1],weight:100},{sortType:[1,1,2,1],weight:100},{sortType:[2,1,1,1],weight:100},{sortType:[1,2,1,2],weight:100},{sortType:[1,1,2,2],weight:100},{sortType:[1,2,2,1],weight:100}]},{colors:"3",config:[{sortType:[1,2,1,3],weight:100},{sortType:[1,1,2,3],weight:100},{sortType:[1,2,2,3],weight:100},{sortType:[1,2,3,3],weight:100},{sortType:[1,2,3,2],weight:100},{sortType:[1,2,3,1],weight:100}]},{colors:"4",config:[{sortType:[1,2,3,4],weight:50}]}],p=[{colors:2,rows:3},{colors:3,rows:7},{colors:5,rows:2147483647}],d=function(){function e(){}return e.initSortTypeConfig=function(){for(var e=0;e<u.length;e++){var t=0===e?0:this._sortTypeConfig[u[e-1].colors].weightSum,o=0===e?[]:this._sortTypeConfig[u[e-1].colors].typeConfig;this._sortTypeConfig[u[e].colors]={weightSum:t+this.sum(u[e].config),typeConfig:o.concat(u[e].config.map(function(e){return e}))}}for(var n=this.shuffle(l.map(function(e){return e})),i=0;i<p.length;i++){var r=0===i?[]:this._colorTypes[p[i-1].colors],a=0===i?p[i].colors:p[i].colors-p[i-1].colors;this._colorTypes[p[i].colors]=r.concat(n.splice(0,a))}},e.createColorIds=function(e){for(var t=0,o=0;o<p.length;o++)if(e<=p[o].rows){t=p[o].colors;break}var n=this.confirmSortType(t).sortType,i=t>4?this.shuffle(this._colorTypes[t]):this._colorTypes[t];return[i[n[0]-1],i[n[1]-1],i[n[2]-1],i[n[3]-1]]},e.confirmSortType=function(e){var t=this._sortTypeConfig[Math.min(e,4).toString()];return t.typeConfig[this.getInterval(t.typeConfig,t.weightSum)]},e.shuffle=function(e){for(var t,o=e.length-1;o>0;o--){var n=Math.floor(Math.random()*(o+1));t=[e[n],e[o]],e[o]=t[0],e[n]=t[1]}return e},e.getInterval=function(e,t){for(var o=Math.random()*t,n=0,i=0;i<e.length;i++)if(o<(n+=e[i].weight))return i},e.sum=function(e){return e.reduce(function(e,t){return e+t.weight},0)},e._sortTypeConfig={},e._colorTypes={},a([s],e)}();i.default=d,cc._RF.pop(),cc._RF.pop()},{}],WaterFlow_BP:[function(e,t,o){"use strict";cc._RF.push(t,"32355rSYtVBA4UivxCtWxgq","WaterFlow_BP");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"32355rSYtVBA4UivxCtWxgq","WaterFlow_BP");var a,c=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(i,"__esModule",{value:!0}),i.WaterFlow_BP=void 0;var l=cc._decorator,u=l.ccclass,p=(l.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.graphics=null,t._fromPt=cc.v2(),t._toPt=cc.v2(),t._flowColor=cc.Color.WHITE.clone(),t._highlightColor=cc.Color.WHITE.clone(),t}return c(t,e),t.prototype.onLoad=function(){this.graphics=this.node.getComponent(cc.Graphics),this.graphics||(this.graphics=this.node.addComponent(cc.Graphics)),this.graphics.lineWidth=8,this.graphics.lineCap=cc.Graphics.LineCap.ROUND,this.graphics.lineJoin=cc.Graphics.LineJoin.ROUND},t.prototype.setColor=function(e,t){this._flowColor=e.clone(),this._highlightColor=t?t.clone():this.lightenColor(e,.3),this.graphics&&(this.graphics.strokeColor=this._flowColor)},t.prototype.lightenColor=function(e,t){return new cc.Color(Math.min(255,e.r+(255-e.r)*t),Math.min(255,e.g+(255-e.g)*t),Math.min(255,e.b+(255-e.b)*t),e.a)},Object.defineProperty(t.prototype,"toPt",{get:function(){return this._toPt},set:function(e){this._toPt=e,this.redraw()},enumerable:!1,configurable:!0}),t.prototype.clear=function(){this.graphics&&this.graphics.clear()},t.prototype.moveTo=function(e,t){this.graphics&&this.graphics.moveTo(e,t)},t.prototype.lineTo=function(e,t){this.graphics&&this.graphics.lineTo(e,t)},t.prototype.stroke=function(){this.graphics&&this.graphics.stroke()},t.prototype.redraw=function(){this.graphics&&(this.clear(),this.graphics.strokeColor=this._flowColor,this.graphics.lineWidth=8,this.moveTo(this._fromPt.x,this._fromPt.y),this.lineTo(this._toPt.x,this._toPt.y),this.stroke(),this.graphics.strokeColor=this._highlightColor,this.graphics.lineWidth=3.2,this.moveTo(this._fromPt.x-2,this._fromPt.y),this.lineTo(this._toPt.x-2,this._toPt.y),this.stroke())},t.prototype.playFlowAnimation=function(e,t,o,n,i){var r=this;if(this.clear(),this.node.stopAllActions(),n){this._fromPt=e.clone(),this._toPt=t.clone(),this.redraw();var a={t:0},c=e.clone(),s=t.clone();cc.tween(a).to(o,{t:1},{progress:function(e,t,o,n){return r._fromPt.x=c.x+(s.x-c.x)*n,r._fromPt.y=c.y+(s.y-c.y)*n,r.redraw(),n}}).call(function(){r.clear(),i&&i()}).start()}else{this._fromPt=e.clone(),this._toPt=e.clone(),a={t:0};var l=e.clone(),u=t.clone();cc.tween(a).to(o,{t:1},{progress:function(e,t,o,n){return r._toPt.x=l.x+(u.x-l.x)*n,r._toPt.y=l.y+(u.y-l.y)*n,r.redraw(),n}}).call(function(){i&&i()}).start()}},Object.defineProperty(t.prototype,"fromPt",{get:function(){return this._fromPt},set:function(e){this._fromPt=e,this.redraw()},enumerable:!1,configurable:!0}),t.prototype.updateFlow=function(e,t){this._fromPt=e.clone(),this._toPt=t.clone(),this.redraw()},t.prototype.stopFlow=function(){this.node.stopAllActions(),this.clear()},t.prototype.setLineScale=function(e){this.graphics&&(this.graphics.lineWidth=8*e)},s([u],t)}(cc.Component));i.WaterFlow_BP=p,cc._RF.pop(),cc._RF.pop()},{}],Water_17:[function(e,t,o){"use strict";cc._RF.push(t,"0c625KJIz1LhKdCzDHEPGiZ","Water_17");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"0c625KJIz1LhKdCzDHEPGiZ","Water_17");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0}),r.WaterAction=void 0;var u,p=n("Cup_17"),d=cc._decorator,f=d.ccclass,h=d.property,y=d.requireComponent,m=d.executeInEditMode,g=d.disallowMultiple,v=d.executionOrder;!function(e){e[e.none=0]="none",e[e.in=1]="in",e[e.out=2]="out",e[e.colorChange=3]="colorChange"}(u=r.WaterAction||(r.WaterAction={}));var _=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._action=u.none,t.infos=[],t.stopIdx=-1,t.curIdx=0,t.targetInfos=null,t.animationTime=0,t.animationElapsed=0,t.originalInfos=null,t._ratio=1,t.effect=null,t._skewAngle=0,t.material=null,t.addHeight=0,t.onOutStart=null,t.onOutFinish=null,t.onColorChangedFinish=null,t.onInFInish=null,t.dot=null,t}return s(t,e),Object.defineProperty(t.prototype,"skewAngle",{get:function(){return this._skewAngle},set:function(e){e=Math.round(100*e)/100,this._skewAngle=e,this.updateAngleHeight()},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){var e=this.node.getComponent(cc.Sprite);e.spriteFrame&&(e.spriteFrame.getTexture().packable=!1),this.effect&&(this.material=cc.Material.create(this.effect),e.setMaterial(0,this.material)),this.material=e.getMaterial(0),this._ratio=this.node.height/this.node.width},t.prototype.initInfos=function(e){this.infos=e,this.curIdx=this.infos.length-1,this.initSizeColor(),this.updateAngleHeight()},t.prototype.addInfo=function(e){this.addHeight=e.height,e.height=0,this.infos.push(e),this._action=u.in,this.curIdx=this.infos.length-1,this.initSizeColor()},t.prototype.setColorChangedFinish=function(e){this.onColorChangedFinish=e},t.prototype.setPourOutCallback=function(e,t){this.onOutStart=e,this.onOutFinish=t},t.prototype.setPourInCallback=function(e){this.onInFInish=e},t.prototype.getPourStartAngle=function(){for(var e=0;e<=this.curIdx;e++)this.infos[e].height;return 65},t.prototype.getPourEndAngle=function(e){this.splitColor(),this.curIdx=this.infos.length-1,this.stopIdx=this.curIdx-e;for(var t=0,o=0;o<=this.stopIdx;o++)t+=this.infos[o].height;return this.getCriticalAngleWithHeight(t)},t.prototype.getCriticalAngleWithHeight=function(e){var t=0;if(0==e)return 100;if(e<.5*p.HEIGHT_FACTOR){var o=this._ratio/(2*e);t=Math.atan(o)}else o=2*this._ratio*(1-e),t=Math.atan(o);return t/Math.PI*180},t.prototype.getTopSameColorNum=function(){for(var e=0,t=null,o=this.curIdx;o>=0;o--)if(null==t)e++,t=this.infos[o].colorId;else{if(this.infos[o].colorId!=t)break;e++}return e},t.prototype.onStartPour=function(e){this.splitColor(),this.curIdx=this.infos.length-1,this.stopIdx=this.curIdx-e,this._action=u.out},t.prototype.startColorAnimation=function(e,t,o){this.splitColor(),this.originalInfos=this.deepCopyWaterInfos(this.infos),this.targetInfos=e,this.animationTime=t,this.animationElapsed=0,this._action=u.colorChange,o&&this.setColorChangedFinish(o)},t.prototype.deepCopyWaterInfos=function(e){return e.map(function(e){return{colorId:e.colorId,height:e.height,color:new cc.Color(e.color.r,e.color.g,e.color.b,e.color.a),surfaceColor:new cc.Color(e.surfaceColor.r,e.surfaceColor.g,e.surfaceColor.b,e.surfaceColor.a)}})},t.prototype.update=function(){this._action==u.out?this.pourStep():this._action==u.in?this.addStep():this._action==u.colorChange&&this.colorChangeStep(cc.director.getDeltaTime())},t.prototype.addStep=function(){if(!(this.curIdx<0)){var e=this.infos[this.curIdx];e.height=Math.round(1e3*(e.height+.008))/1e3,e.height>=this.addHeight&&(e.height=this.addHeight,this._action=u.none,this.splitColor(),this.initSizeColor(),this.onInFInish&&(this.onInFInish(),this.onInFInish=null)),this.updateAngleHeight()}},t.prototype.pourStep=function(){if(this.curIdx<0)return this._action=u.none,void(this.onOutFinish&&(this.onOutFinish(),this.onOutFinish=null));for(var e=0,t=0;t<=this.curIdx;t++)e+=this.infos[t].height;var o=!1,n=this.skewAngle%360*Math.PI/180;if(Math.abs(Math.sin(n))>.98)o=!0;else{var i=Math.abs(Math.tan(n));o=e<.5?i>this._ratio/(2*e):i>2*this._ratio*(1-e)}var r=this.infos[this.curIdx];(o||r.height<.05)&&(this.onOutStart&&(this.onOutStart(),this.onOutStart=null),r.height=Math.round(1e3*(r.height-.008))/1e3,r.height<.01&&(r.height=0,this.infos.pop(),this.curIdx--,this.curIdx==this.stopIdx&&(this.onOutFinish&&(this.onOutFinish(),this.onOutFinish=null),this._action=u.none)),this.updateAngleHeight())},t.prototype.colorChangeStep=function(e){if(this.targetInfos&&this.originalInfos){this.animationElapsed+=e;for(var t=Math.min(this.animationElapsed/this.animationTime,1),o=0;o<this.infos.length;o++)o<this.targetInfos.length&&(this.infos[o].color=this.lerpColor(this.originalInfos[o].color,this.targetInfos[o].color,t),this.infos[o].surfaceColor=this.lerpColor(this.originalInfos[o].surfaceColor,this.targetInfos[o].surfaceColor,t));this.updateAngleHeight(),this.initSizeColor(),t>=1&&(this.infos=this.targetInfos,this.targetInfos=null,this.originalInfos=null,this._action=u.none,this.initSizeColor(),this.onColorChangedFinish&&(this.onColorChangedFinish(),this.onColorChangedFinish=null),cc.director.emit("color_changed"))}else this._action=u.none},t.prototype.splitColor=function(){for(var e=[],t=0;t<this.infos.length;t++){var o=this.infos[t],n=.49*p.HEIGHT_FACTOR,i=.25*p.HEIGHT_FACTOR;if(o.height>n)for(var r=o.height/i,a=i,c=0;c<r;c++)e.push({colorId:o.colorId,color:o.color,surfaceColor:o.surfaceColor,height:a});else e.push(o)}this.infos=e,this.initSizeColor()},t.prototype.lerpColor=function(e,t,o){return new cc.Color(Math.round(e.r+(t.r-e.r)*o),Math.round(e.g+(t.g-e.g)*o),Math.round(e.b+(t.b-e.b)*o),Math.round(e.a+(t.a-e.a)))},t.prototype.initSizeColor=function(){for(var e=new Float32Array(68),t=0;t<this.infos.length;t++){var o=this.infos[t].color;e[4*t]=o.r/255,e[4*t+1]=o.g/255,e[4*t+2]=o.b/255,e[4*t+3]=1}var n=new Float32Array(68);for(t=0;t<this.infos.length;t++)o=this.infos[t].surfaceColor,n[4*t]=o.r/255,n[4*t+1]=o.g/255,n[4*t+2]=o.b/255,n[4*t+3]=1;this.material.setProperty("colors",e),this.material.setProperty("surfaceColors",n),this.material.setProperty("iResolution",cc.v2(2*this.node.width,2*this.node.height))},t.prototype.updateAngleHeight=function(){for(var e=new Float32Array(68),t=0;t<this.infos.length;t++)e[4*t]=this.infos[t].height,e[4*t+1]=0,e[4*t+2]=0,e[4*t+3]=0;e[0]>.01&&(e[0]+=.02),this.material.setProperty("heights",e),this.material.setProperty("skewAngle",this._skewAngle)},t.prototype.getWaterCenter=function(){for(var e=0,t=0;t<this.infos.length;t++)e+=this.infos[t].height;return cc.v2(0,(e-.5)*this.node.height)},t.prototype.showDebugCenter=function(){if(null==this.dot){this.dot=new cc.Node,this.dot.parent=this.node;var e=this.dot.addComponent(cc.Label);e.string="\xb7",e.fontSize=60,this.dot.color=cc.Color.RED}for(var t=this.node.height/this.node.width,o=function(e){for(;e>360;)e-=360;for(;e<-360;)e+=360;return e%360*Math.PI/180}(this.skewAngle),n=0,i=0;i<=this.curIdx;i++)n+=this.infos[i].height;var r=Math.sin(o)>=0,a=cc.v2(.5,1-n),c=Math.abs(Math.tan(o));n<=.5?(c>2*t*n&&(a.x=Math.sqrt(2*n/c*t)/2,a.y=1-Math.sqrt(2*n*c/t)/2,c>t/(2*n)&&(a.y=.5,a.x=n)),r||(a.x=1-a.x),Math.abs(a.x-.25)<.01&&(i=0)):(c>2*t*(1-n)&&(a.x=Math.sqrt(2*t*(1-n)/c)/2,a.y=Math.sqrt(2*t*(1-n)*c)/2/t,c>t/(2*(1-n))&&(a.y=.5,a.x=1-n)),r&&(a.x=1-a.x)),a.x=a.x-.5,a.y=.5-a.y;var s=cc.v3(a.x*this.node.width,a.y*this.node.height);this.dot.position=s},l([h(cc.EffectAsset)],t.prototype,"effect",void 0),l([h],t.prototype,"_skewAngle",void 0),l([h({tooltip:!1})],t.prototype,"skewAngle",null),l([f,y(cc.Sprite),m,g,v(-100)],t)}(cc.Component);r.default=_,cc._RF.pop(),cc._RF.pop()},{}],Water_ED:[function(e,t,o){"use strict";cc._RF.push(t,"7a449MBNidC5YFAlSFAt/4u","Water_ED");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"7a449MBNidC5YFAlSFAt/4u","Water_ED");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0}),r.WaterAction=void 0;var u,p=n("Cup_ED"),d=cc._decorator,f=d.ccclass,h=d.property,y=d.requireComponent,m=d.executeInEditMode,g=d.disallowMultiple,v=d.executionOrder;!function(e){e[e.none=0]="none",e[e.in=1]="in",e[e.out=2]="out",e[e.colorChange=3]="colorChange"}(u=r.WaterAction||(r.WaterAction={}));var _=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._action=u.none,t.infos=[],t.stopIdx=-1,t.curIdx=0,t.targetInfos=null,t.animationTime=0,t.animationElapsed=0,t.originalInfos=null,t._ratio=1,t.effect=null,t._skewAngle=0,t.material=null,t.addHeight=0,t.onOutStart=null,t.onOutFinish=null,t.onColorChangedFinish=null,t.onInFInish=null,t.dot=null,t}return s(t,e),Object.defineProperty(t.prototype,"skewAngle",{get:function(){return this._skewAngle},set:function(e){e=Math.round(100*e)/100,this._skewAngle=e,this.updateAngleHeight()},enumerable:!1,configurable:!0}),t.prototype.onFadeOut=function(e,t){var o=this;e<=0||(e--,this.setOpacity(e/10*255),this.scheduleOnce(function(){o.onFadeOut(e,t)},t))},t.prototype.setOpacity=function(e){for(var t=new Float32Array(16),o=0;o<this.infos.length;o++){var n=this.infos[o].color;t[4*o]=n.r/255,t[4*o+1]=n.g/255,t[4*o+2]=n.b/255,t[4*o+3]=e/255}var i=new Float32Array(16);for(o=0;o<this.infos.length;o++)n=this.infos[o].surfaceColor,i[4*o]=n.r/255,i[4*o+1]=n.g/255,i[4*o+2]=n.b/255,i[4*o+3]=e/255;this.material.setProperty("colors",t),this.material.setProperty("surfaceColors",i)},t.prototype.onLoad=function(){var e=this.node.getComponent(cc.Sprite);e.spriteFrame&&(e.spriteFrame.getTexture().packable=!1),this.effect&&(this.material=cc.Material.create(this.effect),e.setMaterial(0,this.material)),this.material=e.getMaterial(0),this._ratio=this.node.height/this.node.width},t.prototype.initInfos=function(e){this.infos=e,this.curIdx=this.infos.length-1,this.initSizeColor(),this.updateAngleHeight()},t.prototype.addInfo=function(e){this.addHeight=e.height,e.height=0,this.infos.push(e),this._action=u.in,this.curIdx=this.infos.length-1,this.initSizeColor()},t.prototype.setColorChangedFinish=function(e){this.onColorChangedFinish=e},t.prototype.setPourOutCallback=function(e,t){this.onOutStart=e,this.onOutFinish=t},t.prototype.setPourInCallback=function(e){this.onInFInish=e},t.prototype.getPourStartAngle=function(){for(var e=0;e<=this.curIdx;e++)this.infos[e].height;return 60},t.prototype.getPourEndAngle=function(e){this.splitColor(),this.curIdx=this.infos.length-1,this.stopIdx=this.curIdx-e;for(var t=0,o=0;o<=this.stopIdx;o++)t+=this.infos[o].height;return this.getCriticalAngleWithHeight(t)},t.prototype.getCriticalAngleWithHeight=function(e){var t=0;if(0==e)return 105;if(e<.5){var o=this._ratio/(2*e);t=Math.atan(o)}else o=2*this._ratio*(1-e),t=Math.atan(o);return t/Math.PI*180},t.prototype.getTopSameColorNum=function(){for(var e=0,t=null,o=this.curIdx;o>=0;o--)if(null==t)e++,t=this.infos[o].colorId;else{if(this.infos[o].colorId!=t)break;e++}return e},t.prototype.onStartPour=function(e){this.splitColor(),this.curIdx=this.infos.length-1,this.stopIdx=this.curIdx-e,this._action=u.out},t.prototype.startColorAnimation=function(e,t,o){this.splitColor(),this.originalInfos=this.deepCopyWaterInfos(this.infos),this.targetInfos=e,this.animationTime=t,this.animationElapsed=0,this._action=u.colorChange,o&&this.setColorChangedFinish(o)},t.prototype.deepCopyWaterInfos=function(e){return e.map(function(e){return{colorId:e.colorId,height:e.height,color:new cc.Color(e.color.r,e.color.g,e.color.b,e.color.a),surfaceColor:new cc.Color(e.surfaceColor.r,e.surfaceColor.g,e.surfaceColor.b,e.surfaceColor.a)}})},t.prototype.update=function(){this._action==u.out?this.pourStep():this._action==u.in?this.addStep():this._action==u.colorChange&&this.colorChangeStep(cc.director.getDeltaTime())},t.prototype.addStep=function(){if(!(this.curIdx<0)){var e=this.infos[this.curIdx];e.height=Math.round(1e3*(e.height+.008))/1e3,e.height>=this.addHeight&&(e.height=this.addHeight,this._action=u.none,this.splitColor(),this.initSizeColor(),this.onInFInish&&(this.onInFInish(),this.onInFInish=null)),this.updateAngleHeight()}},t.prototype.pourStep=function(){if(this.curIdx<0)return this._action=u.none,void(this.onOutFinish&&(this.onOutFinish(),this.onOutFinish=null));console.log(this.infos[0].height);for(var e=0,t=0;t<=this.curIdx;t++)e+=this.infos[t].height;var o=!1,n=this.skewAngle%360*Math.PI/180;if(Math.abs(Math.sin(n))>.9)o=!0;else{var i=Math.abs(Math.tan(n));o=e<.5?i>this._ratio/(2*e):i>2*this._ratio*(1-e)}var r=this.infos[this.curIdx];(o||r.height<.05)&&(this.onOutStart&&(this.onOutStart(),this.onOutStart=null),r.height=Math.round(1e3*(r.height-.008))/1e3,r.height<.01&&(r.height=0,this.infos.pop(),this.curIdx--,this.curIdx==this.stopIdx&&(this.onOutFinish&&(this.onOutFinish(),this.onOutFinish=null),this._action=u.none)),this.updateAngleHeight())},t.prototype.colorChangeStep=function(e){if(this.targetInfos&&this.originalInfos){this.animationElapsed+=e;for(var t=Math.min(this.animationElapsed/this.animationTime,1),o=0;o<this.infos.length;o++)o<this.targetInfos.length&&(this.infos[o].color=this.lerpColor(this.originalInfos[o].color,this.targetInfos[o].color,t),this.infos[o].surfaceColor=this.lerpColor(this.originalInfos[o].surfaceColor,this.targetInfos[o].surfaceColor,t));this.updateAngleHeight(),this.initSizeColor(),t>=1&&(this.infos=this.targetInfos,this.targetInfos=null,this.originalInfos=null,this._action=u.none,this.initSizeColor(),this.onColorChangedFinish&&(this.onColorChangedFinish(),this.onColorChangedFinish=null))}else this._action=u.none},t.prototype.splitColor=function(){for(var e=[],t=0;t<this.infos.length;t++){var o=this.infos[t],n=.49*p.HEIGHT_FACTOR,i=.25*p.HEIGHT_FACTOR;if(o.height>n)for(var r=o.height/i,a=i,c=0;c<r;c++)e.push({colorId:o.colorId,color:o.color,surfaceColor:o.surfaceColor,height:a});else e.push(o)}this.infos=e,this.initSizeColor()},t.prototype.lerpColor=function(e,t,o){return new cc.Color(Math.round(e.r+(t.r-e.r)*o),Math.round(e.g+(t.g-e.g)*o),Math.round(e.b+(t.b-e.b)*o),Math.round(e.a+(t.a-e.a)))},t.prototype.initSizeColor=function(){for(var e=new Float32Array(16),t=0;t<this.infos.length;t++){var o=this.infos[t].color;e[4*t]=o.r/255,e[4*t+1]=o.g/255,e[4*t+2]=o.b/255,e[4*t+3]=1}var n=new Float32Array(16);for(t=0;t<this.infos.length;t++)o=this.infos[t].surfaceColor,n[4*t]=o.r/255,n[4*t+1]=o.g/255,n[4*t+2]=o.b/255,n[4*t+3]=1;this.material.setProperty("colors",e),this.material.setProperty("surfaceColors",n),this.material.setProperty("iResolution",cc.v2(this.node.width,this.node.height))},t.prototype.updateAngleHeight=function(){for(var e=new Float32Array(16),t=0;t<this.infos.length;t++)e[4*t]=this.infos[t].height,e[4*t+1]=0,e[4*t+2]=0,e[4*t+3]=0;e[0]>.01&&(e[0]+=.04),this.material.setProperty("heights",e),this.material.setProperty("skewAngle",this._skewAngle)},t.prototype.getWaterCenter=function(){for(var e=0,t=0;t<this.infos.length;t++)e+=this.infos[t].height;return cc.v2(0,(e-.5)*this.node.height)},t.prototype.showDebugCenter=function(){if(null==this.dot){this.dot=new cc.Node,this.dot.parent=this.node;var e=this.dot.addComponent(cc.Label);e.string="\xb7",e.fontSize=60,this.dot.color=cc.Color.RED}for(var t=this.node.height/this.node.width,o=function(e){for(;e>360;)e-=360;for(;e<-360;)e+=360;return e%360*Math.PI/180}(this.skewAngle),n=0,i=0;i<=this.curIdx;i++)n+=this.infos[i].height;var r=Math.sin(o)>=0,a=cc.v2(.5,1-n),c=Math.abs(Math.tan(o));n<=.5?(c>2*t*n&&(a.x=Math.sqrt(2*n/c*t)/2,a.y=1-Math.sqrt(2*n*c/t)/2,c>t/(2*n)&&(a.y=.5,a.x=n)),r||(a.x=1-a.x),Math.abs(a.x-.25)<.01&&(i=0)):(c>2*t*(1-n)&&(a.x=Math.sqrt(2*t*(1-n)/c)/2,a.y=Math.sqrt(2*t*(1-n)*c)/2/t,c>t/(2*(1-n))&&(a.y=.5,a.x=1-n)),r&&(a.x=1-a.x)),a.x=a.x-.5,a.y=.5-a.y;var s=cc.v3(a.x*this.node.width,a.y*this.node.height);this.dot.position=s},l([h(cc.EffectAsset)],t.prototype,"effect",void 0),l([h],t.prototype,"_skewAngle",void 0),l([h({tooltip:!1})],t.prototype,"skewAngle",null),l([f,y(cc.Sprite),m,g,v(-100)],t)}(cc.Component);r.default=_,cc._RF.pop(),cc._RF.pop()},{}],Water_Long:[function(e,t,o){"use strict";cc._RF.push(t,"799baIQWlpDB4P+FHdyFBIj","Water_Long");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"799baIQWlpDB4P+FHdyFBIj","Water_Long");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0}),r.WaterAction=void 0;var u,p=n("Cup_Long"),d=cc._decorator,f=d.ccclass,h=d.property,y=d.requireComponent,m=d.executeInEditMode,g=d.disallowMultiple,v=d.executionOrder;!function(e){e[e.none=0]="none",e[e.in=1]="in",e[e.out=2]="out",e[e.colorChange=3]="colorChange"}(u=r.WaterAction||(r.WaterAction={}));var _=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._action=u.none,t.infos=[],t.stopIdx=-1,t.curIdx=0,t.targetInfos=null,t.animationTime=0,t.animationElapsed=0,t.originalInfos=null,t._ratio=1,t.effect=null,t._skewAngle=0,t.material=null,t.addHeight=0,t.timeScaleIn=1,t.onOutStart=null,t.onOutFinish=null,t.onColorChangedFinish=null,t.onInFInish=null,t.dot=null,t}return s(t,e),Object.defineProperty(t.prototype,"skewAngle",{get:function(){return this._skewAngle},set:function(e){e=Math.round(100*e)/100,this._skewAngle=e,this.updateAngleHeight()},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){var e=this.node.getComponent(cc.Sprite);e.spriteFrame&&(e.spriteFrame.getTexture().packable=!1),this.effect&&(this.material=cc.Material.create(this.effect),e.setMaterial(0,this.material)),this.material=e.getMaterial(0),this._ratio=this.node.height/this.node.width},t.prototype.initInfos=function(e){this.infos=e,this.curIdx=this.infos.length-1,this.initSizeColor(),this.updateAngleHeight()},t.prototype.addInfo=function(e){this.addHeight=e.height,e.height=0,this.infos.push(e),this._action=u.in,this.curIdx=this.infos.length-1,this.initSizeColor()},t.prototype.setColorChangedFinish=function(e){this.onColorChangedFinish=e},t.prototype.setPourOutCallback=function(e,t){this.onOutStart=e,this.onOutFinish=t},t.prototype.setPourInCallback=function(e){this.onInFInish=e},t.prototype.getPourStartAngle=function(){for(var e=0;e<=this.curIdx;e++)this.infos[e].height;return 65},t.prototype.getPourEndAngle=function(e){this.splitColor(),this.curIdx=this.infos.length-1,this.stopIdx=this.curIdx-e;for(var t=0,o=0;o<=this.stopIdx;o++)t+=this.infos[o].height;return this.getCriticalAngleWithHeight(t)},t.prototype.getCriticalAngleWithHeight=function(e){var t=0;if(0==e)return 100;if(e<.5*p.HEIGHT_FACTOR){var o=this._ratio/(2*e);t=Math.atan(o)}else o=2*this._ratio*(1-e),t=Math.atan(o);return t/Math.PI*180},t.prototype.getTopSameColorNum=function(){for(var e=0,t=null,o=this.curIdx;o>=0;o--)if(null==t)e++,t=this.infos[o].colorId;else{if(this.infos[o].colorId!=t)break;e++}return e},t.prototype.onStartPour=function(e){this.splitColor(),this.curIdx=this.infos.length-1,this.stopIdx=this.curIdx-e,this._action=u.out},t.prototype.startColorAnimation=function(e,t,o){this.splitColor(),this.originalInfos=this.deepCopyWaterInfos(this.infos),this.targetInfos=e,this.animationTime=t,this.animationElapsed=0,this._action=u.colorChange,o&&this.setColorChangedFinish(o)},t.prototype.deepCopyWaterInfos=function(e){return e.map(function(e){return{colorId:e.colorId,height:e.height,color:new cc.Color(e.color.r,e.color.g,e.color.b,e.color.a),surfaceColor:new cc.Color(e.surfaceColor.r,e.surfaceColor.g,e.surfaceColor.b,e.surfaceColor.a)}})},t.prototype.update=function(e){this._action==u.out?this.pourStep(e):this._action==u.in?this.addStep(e):this._action==u.colorChange&&this.colorChangeStep(cc.director.getDeltaTime())},t.prototype.addStep=function(e){if(!(this.curIdx<0)){var t=this.infos[this.curIdx];t.height=Math.round(1e3*(t.height+.00353*60*e))/1e3,t.height>=this.addHeight&&(t.height=this.addHeight,this._action=u.none,this.splitColor(),this.initSizeColor(),this.onInFInish&&(this.onInFInish(),this.onInFInish=null)),this.updateAngleHeight()}},t.prototype.pourStep=function(e){if(this.curIdx<0)return this._action=u.none,void(this.onOutFinish&&(this.onOutFinish(),this.onOutFinish=null));for(var t=0,o=0;o<=this.curIdx;o++)t+=this.infos[o].height;var n=!1,i=this.skewAngle%360*Math.PI/180;if(Math.abs(Math.sin(i))>.98)n=!0;else{var r=Math.abs(Math.tan(i));n=t<.5?r>this._ratio/(2*t):r>2*this._ratio*(1-t)}var a=this.infos[this.curIdx];(n||a.height<.05)&&(this.onOutStart&&(this.onOutStart(),this.onOutStart=null),a.height=Math.round(1e3*(a.height-.00353*60*e))/1e3,a.height<.01&&(a.height=0,this.infos.pop(),this.curIdx--,this.curIdx==this.stopIdx&&(this.onOutFinish&&(this.onOutFinish(),this.onOutFinish=null),this._action=u.none)),this.updateAngleHeight())},t.prototype.colorChangeStep=function(e){if(this.targetInfos&&this.originalInfos){this.animationElapsed+=e;for(var t=Math.min(this.animationElapsed/this.animationTime,1),o=0;o<this.infos.length;o++)o<this.targetInfos.length&&(this.infos[o].color=this.lerpColor(this.originalInfos[o].color,this.targetInfos[o].color,t),this.infos[o].surfaceColor=this.lerpColor(this.originalInfos[o].surfaceColor,this.targetInfos[o].surfaceColor,t));this.updateAngleHeight(),this.initSizeColor(),t>=1&&(this.infos=this.targetInfos,this.targetInfos=null,this.originalInfos=null,this._action=u.none,this.initSizeColor(),this.onColorChangedFinish&&(this.onColorChangedFinish(),this.onColorChangedFinish=null),cc.director.emit("color_changed"))}else this._action=u.none},t.prototype.splitColor=function(){for(var e=[],t=0;t<this.infos.length;t++){var o=this.infos[t],n=.49*p.HEIGHT_FACTOR,i=.25*p.HEIGHT_FACTOR;if(o.height>n)for(var r=o.height/i,a=i,c=0;c<r;c++)e.push({colorId:o.colorId,color:o.color,surfaceColor:o.surfaceColor,height:a});else e.push(o)}this.infos=e,this.initSizeColor()},t.prototype.lerpColor=function(e,t,o){return new cc.Color(Math.round(e.r+(t.r-e.r)*o),Math.round(e.g+(t.g-e.g)*o),Math.round(e.b+(t.b-e.b)*o),Math.round(e.a+(t.a-e.a)))},t.prototype.initSizeColor=function(){for(var e=new Float32Array(112),t=0;t<this.infos.length;t++){var o=this.infos[t].color;e[4*t]=o.r/255,e[4*t+1]=o.g/255,e[4*t+2]=o.b/255,e[4*t+3]=1}var n=new Float32Array(112);for(t=0;t<this.infos.length;t++)o=this.infos[t].surfaceColor,n[4*t]=o.r/255,n[4*t+1]=o.g/255,n[4*t+2]=o.b/255,n[4*t+3]=1;this.material.setProperty("colors",e),this.material.setProperty("surfaceColors",n),this.material.setProperty("iResolution",cc.v2(this.node.width,this.node.height))},t.prototype.updateAngleHeight=function(){for(var e=new Float32Array(112),t=0;t<this.infos.length;t++)e[4*t]=this.infos[t].height,e[4*t+1]=0,e[4*t+2]=0,e[4*t+3]=0;e[0]>.01&&(e[0]+=.02),this.material.setProperty("heights",e),this.material.setProperty("skewAngle",this._skewAngle)},t.prototype.getWaterCenter=function(){for(var e=0,t=0;t<this.infos.length;t++)e+=this.infos[t].height;return cc.v2(0,(e-.5)*this.node.height)},t.prototype.showDebugCenter=function(){if(null==this.dot){this.dot=new cc.Node,this.dot.parent=this.node;var e=this.dot.addComponent(cc.Label);e.string="\xb7",e.fontSize=60,this.dot.color=cc.Color.RED}for(var t=this.node.height/this.node.width,o=function(e){for(;e>360;)e-=360;for(;e<-360;)e+=360;return e%360*Math.PI/180}(this.skewAngle),n=0,i=0;i<=this.curIdx;i++)n+=this.infos[i].height;var r=Math.sin(o)>=0,a=cc.v2(.5,1-n),c=Math.abs(Math.tan(o));n<=.5?(c>2*t*n&&(a.x=Math.sqrt(2*n/c*t)/2,a.y=1-Math.sqrt(2*n*c/t)/2,c>t/(2*n)&&(a.y=.5,a.x=n)),r||(a.x=1-a.x),Math.abs(a.x-.25)<.01&&(i=0)):(c>2*t*(1-n)&&(a.x=Math.sqrt(2*t*(1-n)/c)/2,a.y=Math.sqrt(2*t*(1-n)*c)/2/t,c>t/(2*(1-n))&&(a.y=.5,a.x=1-n)),r&&(a.x=1-a.x)),a.x=a.x-.5,a.y=.5-a.y;var s=cc.v3(a.x*this.node.width,a.y*this.node.height);this.dot.position=s},l([h(cc.EffectAsset)],t.prototype,"effect",void 0),l([h],t.prototype,"_skewAngle",void 0),l([h({tooltip:!1})],t.prototype,"skewAngle",null),l([f,y(cc.Sprite),m,g,v(-100)],t)}(cc.Component);r.default=_,cc._RF.pop(),cc._RF.pop()},{}],Water:[function(e,t,o){"use strict";cc._RF.push(t,"90a717vpVpNGLEwTpgmjLG+","Water");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"90a717vpVpNGLEwTpgmjLG+","Water");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0}),r.WaterAction=void 0;var u,p=n("Cup"),d=cc._decorator,f=d.ccclass,h=d.property,y=d.requireComponent,m=d.executeInEditMode,g=d.disallowMultiple,v=d.executionOrder;!function(e){e[e.none=0]="none",e[e.in=1]="in",e[e.out=2]="out",e[e.colorChange=3]="colorChange",e[e.leak=4]="leak"}(u=r.WaterAction||(r.WaterAction={}));var _=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._action=u.none,t.infos=[],t.stopIdx=-1,t.curIdx=0,t.targetInfos=null,t.animationTime=0,t.animationElapsed=0,t.originalInfos=null,t.speedFactor=1,t.heightFactor=p.HEIGHT_FACTOR,t.ifShowPourInSurface=!1,t._ratio=1,t.effect=null,t._skewAngle=0,t.material=null,t.addHeight=0,t.timeScaleIn=1,t.onOutStart=null,t.onOutFinish=null,t.onColorChangedFinish=null,t.onInFInish=null,t.dot=null,t}return s(t,e),Object.defineProperty(t.prototype,"skewAngle",{get:function(){return this._skewAngle},set:function(e){e=Math.round(100*e)/100,this._skewAngle=e,this.updateAngleHeight()},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){var e=this.node.getComponent(cc.Sprite);e.spriteFrame&&(e.spriteFrame.getTexture().packable=!1),this.effect&&(this.material=cc.Material.create(this.effect),e.setMaterial(0,this.material)),this.material=e.getMaterial(0),this._ratio=this.node.height/this.node.width},t.prototype.initInfos=function(e){this.infos=e,this.curIdx=this.infos.length-1,this.initSizeColor(),this.updateAngleHeight()},t.prototype.addInfo=function(e){0==this.addHeight&&this.infos.push(e),this.addHeight+=e.height,e.height=0,this._action=u.in,this.ifShowPourInSurface=!0,this.curIdx=this.infos.length-1,this.initSizeColor()},t.prototype.setColorChangedFinish=function(e){this.onColorChangedFinish=e},t.prototype.setPourOutCallback=function(e,t){this.onOutStart=e,this.onOutFinish=t},t.prototype.setPourInCallback=function(e){this.onInFInish=e},t.prototype.getPourStartAngle=function(){for(var e=0,t=0;t<=this.curIdx;t++)e+=this.infos[t].height;switch(e/this.heightFactor){case.25:return 80;case.5:return 75;case.75:return 70}return 55},t.prototype.getPourEndAngle=function(e){this.splitColor(),this.curIdx=this.infos.length-1,this.stopIdx=this.curIdx-e;for(var t=0;t<=this.stopIdx;t++)this.infos[t].height;switch(this.stopIdx){case-1:return 103;case 0:return 83;case 1:return 79;case 2:return 70}},t.prototype.getCriticalAngleWithHeight=function(e){var t=0;if(0==e)return 100;if(e<.5*this.heightFactor){var o=this._ratio/(2*e);t=Math.atan(o)}else o=2*this._ratio*(1-e),t=Math.atan(o);return t/Math.PI*180},t.prototype.getTopSameColorNum=function(){for(var e=0,t=null,o=this.curIdx;o>=0;o--)if(null==t)e++,t=this.infos[o].colorId;else{if(this.infos[o].colorId!=t)break;e++}return e},t.prototype.onStartPour=function(e){this.splitColor(),this.curIdx=this.infos.length-1,this.stopIdx=this.curIdx-e,this._action=u.out},t.prototype.startColorAnimation=function(e,t,o){this.splitColor(),this.originalInfos=this.deepCopyWaterInfos(this.infos),this.targetInfos=e,this.animationTime=t,this.animationElapsed=0,this._action=u.colorChange,o&&this.setColorChangedFinish(o)},t.prototype.deepCopyWaterInfos=function(e){return e.map(function(e){return{colorId:e.colorId,height:e.height,color:new cc.Color(e.color.r,e.color.g,e.color.b,e.color.a),surfaceColor:new cc.Color(e.surfaceColor.r,e.surfaceColor.g,e.surfaceColor.b,e.surfaceColor.a)}})},t.prototype.update=function(e){this._action==u.out?this.pourStep(e):this._action==u.in?this.addStep(e):this._action==u.colorChange&&this.colorChangeStep(cc.director.getDeltaTime())},t.prototype.addStep=function(e){if(!(this.curIdx<0)){var t=this.infos[this.curIdx];t.height=Math.round(1e3*(t.height+.015/this.speedFactor*e*60))/1e3,t.height>=this.addHeight&&(t.height=this.addHeight,this._action=u.none,this.splitColor(),this.initSizeColor(),this.onInFInish&&(this.onInFInish(),this.addHeight=0,this.ifShowPourInSurface=!1,this.onInFInish=null)),this.updateAngleHeight()}},t.prototype.leakStep=function(e){if(this.infos.length<=0)this._action=u.none;else{var t=this.infos[0];t.height=Math.round(1e3*(t.height-.005/this.speedFactor*e*60))/1e3,this.infos.length>1?t.height<=.01&&(this.infos.shift(),this.infos.length>0&&(this.infos[0].height+=.01),this.curIdx=this.infos.length-1,this.initSizeColor()):t.height<=.01&&(this.infos=[],this.curIdx=-1,this.initSizeColor()),this.updateAngleHeight()}},t.prototype.pourStep=function(e){if(this.curIdx<0)return this._action=u.none,void(this.onOutFinish&&(this.onOutFinish(),this.onOutFinish=null));for(var t=this.skewAngle%360*Math.PI/180,o=0,n=0;n<=this.curIdx;n++)o+=this.infos[n].height;var i=!1;if(Math.abs(Math.sin(t))>.9)i=!0;else{var r=Math.abs(Math.tan(t));i=o<.5?r>this._ratio/(2*o):r>2*this._ratio*(1-o)}var a=this.infos[this.curIdx];(i||a.height<.01)&&(this.onOutStart&&(this.onOutStart(),this.onOutStart=null),a.height=Math.round(1e3*(a.height-.015/this.speedFactor*e*60))/1e3,a.height<.001&&(a.height=0,this.infos.pop(),this.curIdx--,this.curIdx==this.stopIdx&&(this.onOutFinish&&(this.onOutFinish(),this.onOutFinish=null),this._action=u.none)),this.updateAngleHeight())},t.prototype.colorChangeStep=function(e){if(this.targetInfos&&this.originalInfos){this.animationElapsed+=e;for(var t=Math.min(this.animationElapsed/this.animationTime,1),o=0;o<this.infos.length;o++)o<this.targetInfos.length&&(this.infos[o].color=this.lerpColor(this.originalInfos[o].color,this.targetInfos[o].color,t),this.infos[o].surfaceColor=this.lerpColor(this.originalInfos[o].surfaceColor,this.targetInfos[o].surfaceColor,t));this.updateAngleHeight(),this.initSizeColor(),t>=1&&(this.infos=this.targetInfos,this.targetInfos=null,this.originalInfos=null,this._action=u.none,this.initSizeColor(),this.onColorChangedFinish&&(this.onColorChangedFinish(),this.onColorChangedFinish=null),cc.director.emit("color_changed"))}else this._action=u.none},t.prototype.splitColor=function(){for(var e=[],t=0;t<this.infos.length;t++){var o=this.infos[t],n=.49*this.heightFactor,i=.25*this.heightFactor;if(o.height>n)for(var r=o.height/i,a=i,c=0;c<r;c++)e.push({colorId:o.colorId,color:o.color,surfaceColor:o.surfaceColor,height:a});else e.push(o)}this.infos=e,this.initSizeColor()},t.prototype.lerpColor=function(e,t,o){return new cc.Color(Math.round(e.r+(t.r-e.r)*o),Math.round(e.g+(t.g-e.g)*o),Math.round(e.b+(t.b-e.b)*o),Math.round(e.a+(t.a-e.a)))},t.prototype.initSizeColor=function(){for(var e=new Float32Array(16),t=0;t<this.infos.length;t++){var o=this.infos[t].color;e[4*t]=o.r/255,e[4*t+1]=o.g/255,e[4*t+2]=o.b/255,e[4*t+3]=1}var n=new Float32Array(16);for(t=0;t<this.infos.length;t++)o=this.infos[t].surfaceColor,n[4*t]=o.r/255,n[4*t+1]=o.g/255,n[4*t+2]=o.b/255,n[4*t+3]=1;this.material.setProperty("colors",e),this.material.setProperty("surfaceColors",n),this.material.setProperty("iResolution",cc.v2(this.node.width,this.node.height))},t.prototype.updateAngleHeight=function(){for(var e=new Float32Array(16),t=0;t<this.infos.length;t++)e[4*t]=this.infos[t].height,e[4*t+1]=0,e[4*t+2]=0,e[4*t+3]=0;e[0]>.01&&(e[0]+=.06),this.material.setProperty("heights",e),this.material.setProperty("skewAngle",this._skewAngle)},t.prototype.getWaterCenter=function(){for(var e=0,t=0;t<this.infos.length;t++)e+=this.infos[t].height;return cc.v2(0,(e-.5)*this.node.height)},t.prototype.showDebugCenter=function(){if(null==this.dot){this.dot=new cc.Node,this.dot.parent=this.node;var e=this.dot.addComponent(cc.Label);e.string="\xb7",e.fontSize=60,this.dot.color=cc.Color.RED}for(var t=this.node.height/this.node.width,o=function(e){for(;e>360;)e-=360;for(;e<-360;)e+=360;return e%360*Math.PI/180}(this.skewAngle),n=0,i=0;i<=this.curIdx;i++)n+=this.infos[i].height;var r=Math.sin(o)>=0,a=cc.v2(.5,1-n),c=Math.abs(Math.tan(o));n<=.5?(c>2*t*n&&(a.x=Math.sqrt(2*n/c*t)/2,a.y=1-Math.sqrt(2*n*c/t)/2,c>t/(2*n)&&(a.y=.5,a.x=n)),r||(a.x=1-a.x),Math.abs(a.x-.25)<.01&&(i=0)):(c>2*t*(1-n)&&(a.x=Math.sqrt(2*t*(1-n)/c)/2,a.y=Math.sqrt(2*t*(1-n)*c)/2/t,c>t/(2*(1-n))&&(a.y=.5,a.x=1-n)),r&&(a.x=1-a.x)),a.x=a.x-.5,a.y=.5-a.y;var s=cc.v3(a.x*this.node.width,a.y*this.node.height);this.dot.position=s},l([h(cc.EffectAsset)],t.prototype,"effect",void 0),l([h],t.prototype,"_skewAngle",void 0),l([h({tooltip:!1})],t.prototype,"skewAngle",null),l([f,y(cc.Sprite),m,g,v(-100)],t)}(cc.Component);r.default=_,cc._RF.pop(),cc._RF.pop()},{}],WinPanel_RF:[function(e,t,o){"use strict";cc._RF.push(t,"ae54eDGsnVFtKhTDMQMd773","WinPanel_RF");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"ae54eDGsnVFtKhTDMQMd773","WinPanel_RF");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("AudioManager"),p=n("LevelManager"),d=n("const"),f=n("BasePanel"),h=n("GameManager_RF"),y=n("RingFightManager"),m=n("GameManager"),g=cc._decorator,v=g.ccclass,_=g.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label_time=null,t.starterNode=[],t.challengerNode=[],t}return s(t,e),t.prototype.onEnable=function(){if(y.default.instance.fullUpdate(h.default.instance.time),this.label_time.string="\u672c\u6b21\u8017\u65f6\uff1a"+h.default.instance.text_time.string,y.default.instance.isChallenger){for(var e=0;e<this.starterNode.length;e++)this.starterNode[e].active=!1;for(e=0;e<this.challengerNode.length;e++)this.challengerNode[e].active=!0}else{for(e=0;e<this.starterNode.length;e++)this.starterNode[e].active=!0;for(e=0;e<this.challengerNode.length;e++)this.challengerNode[e].active=!1}},t.prototype.onBtn_Home=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),m.default.platform.reportButtonEvent("RingFight_BtnHome",0),cc.director.loadScene(d.SceneNames.Main)},t.prototype.onBtn_Create=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),m.default.platform.reportButtonEvent("RingFight_BtnInitiate",0),y.default.instance.plainCreate()},t.prototype.onBtn_MoreGame=function(){u.default.instance.playSFX(u.AudioRef.ClickButton),m.default.platform.reportButtonEvent("RingFight_BtnMoreGame",0),cc.director.loadScene(d.SceneNames.Game)},t.prototype.onBtn_Restart=function(){m.default.platform.reportButtonEvent("RingFight_BtnRestart",0),u.default.instance.playSFX(u.AudioRef.ClickButton),p.default.isRestartRingFight=!0,cc.director.loadScene(d.SceneNames.RingFight)},l([_(cc.Label)],t.prototype,"label_time",void 0),l([_([cc.Node])],t.prototype,"starterNode",void 0),l([_([cc.Node])],t.prototype,"challengerNode",void 0),l([v],t)}(f.default);r.default=S,cc._RF.pop(),cc._RF.pop()},{}],WxSidebarPanel:[function(e,t,o){"use strict";cc._RF.push(t,"4daceHJDd5ER63+CiZAiGBC","WxSidebarPanel");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"4daceHJDd5ER63+CiZAiGBC","WxSidebarPanel");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("BasePanel"),p=n("CommonData"),d=n("AudioManager"),f=n("GameManager"),h=n("const"),y=cc._decorator,m=y.ccclass,g=y.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btn_reward=null,t.btn_go=null,t.bgs=[],t.bg=null,t.mask=null,t.iconFrames=[],t.iconDarkFrames=[],t.canHide=!1,t}return s(t,e),t.prototype.onEnable=function(){this.btn_reward.active=p.default.ifOpenBySidebar&&p.default.LastGetRewardDate!==p.default.getTodayDate(),this.btn_go.active=!this.btn_reward.active,this.canHide=!1},t.prototype.show=function(e){var t=this,o=this.node.children[1];cc.director.emit("UpdateOpenPanelCount"),o&&(cc.Tween.stopAllByTarget(o),o.scale=.5,o.opacity=0,cc.tween(o).to(.2,{scale:1.1,opacity:200},{easing:"smooth"}).to(.2,{scale:1,opacity:255},{easing:"smooth"}).call(function(){e&&e(),t.canHide=!0}).start())},t.prototype.hide=function(e){var t=this;if(1===this.node.scale&&this.canHide){var o=this.node.children[1];o&&(cc.Tween.stopAllByTarget(o),o.scale=1,o.opacity=255,cc.tween(o).to(.2,{scale:0,opacity:200},{easing:"smooth"}).call(function(){t.node.active=!1,e&&e(),cc.director.emit("UpdateOpenPanelCount")}).start())}},t.prototype.onBtnClsoe=function(){d.default.instance.playSFX(d.AudioRef.ClickClose),this.hide()},t.prototype.onBtnGoTOSidebar=function(){d.default.instance.playSFX(d.AudioRef.ClickButton),f.default.platform.navigateToScene("sidebar"),this.hide()},t.prototype.onBtnGetReward=function(){p.default.LastGetRewardDate=p.default.getTodayDate(),f.default.showRewardPanel([1,1,1,0]),p.default.PropUndo++,p.default.PropAddCup++,p.default.PropPump++,p.default.SideBarRewardCount++,f.default.platform.reportButtonEvent("RewardBtn_AddMP",0),cc.director.emit(h.EventNames.GetSidebarReward),this.hide()},l([g(cc.Node)],t.prototype,"btn_reward",void 0),l([g(cc.Node)],t.prototype,"btn_go",void 0),l([g([cc.SpriteFrame])],t.prototype,"bgs",void 0),l([g(cc.Sprite)],t.prototype,"bg",void 0),l([g(cc.Node)],t.prototype,"mask",void 0),l([g([cc.Sprite])],t.prototype,"iconFrames",void 0),l([g([cc.SpriteFrame])],t.prototype,"iconDarkFrames",void 0),l([m],t)}(u.default);r.default=v,cc._RF.pop(),cc._RF.pop()},{}],addListGuideCtrl_SS:[function(e,t,o){"use strict";cc._RF.push(t,"85aa1zA5BlOMKebHgYHqAub","addListGuideCtrl_SS");var n=t,i=o,r=function(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(n,"85aa1zA5BlOMKebHgYHqAub","addListGuideCtrl_SS");var a,c=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,n){var i,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(a<3?i(c):a>3?i(t,o,c):i(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(i,"__esModule",{value:!0});var l=cc._decorator,u=l.ccclass,p=l.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dialoge=null,t.light=null,t.finger=null,t}return c(t,e),t.prototype.start=function(){var e=this;this.dialoge.scale=0,this.dialoge.opacity=0,this.light.scale=0,this.light.opacity=0,this.finger.scale=0,this.finger.opacity=0,this.node.scaleX=5,this.node.scaleY=15,cc.tween(this.node).to(.3,{scaleX:1,scaleY:1,y:-245}).delay(.2).call(function(){cc.tween(e.dialoge).to(.5,{scale:1,opacity:255}).start(),e.playGuideAnim()}).start()},t.prototype.playGuideAnim=function(){var e=this;this._resetState(),cc.tween(this.finger).to(.5,{scale:1.2,opacity:255}).delay(.25).call(function(){e._playClickAnim(e.light,e.finger,function(){cc.tween(e.finger).to(.5,{opacity:0}).call(function(){e.playGuideAnim()}).start()})}).start()},t.prototype._resetState=function(){this.light.opacity=0,this.light.scale=0,this.finger.opacity=0,this.finger.scale=1.2},t.prototype._playClickAnim=function(e,t,o){cc.tween(t).to(.5,{scale:.9}).start(),cc.tween(e).delay(.25).to(.25,{scale:1,opacity:255}).delay(.5).call(function(){cc.tween(t).to(.5,{scale:1.2}).start(),cc.tween(e).to(.5,{scale:0,opacity:0}).call(function(){o&&o()}).start()}).start()},s([p(cc.Node)],t.prototype,"dialoge",void 0),s([p(cc.Node)],t.prototype,"light",void 0),s([p(cc.Node)],t.prototype,"finger",void 0),s([u],t)}(cc.Component);i.default=d,cc._RF.pop(),cc._RF.pop()},{}],addListPnl_SS:[function(e,t,o){"use strict";cc._RF.push(t,"11e4d+kkgtGW607k0q2iX3J","addListPnl_SS");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"11e4d+kkgtGW607k0q2iX3J","addListPnl_SS");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("GameManager"),p=n("CommonData_SS"),d=n("GameManager_SS"),f=n("PanelBase_SS"),h=cc._decorator,y=h.ccclass,m=(h.property,h.menu),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.start=function(){},t.prototype.clickClose=function(){d.default.playVibrateShort(),this.hide()},t.prototype.clickAddList=function(){var e=this;d.default.playVibrateShort(),u.default.platform.showRewardAD(function(){e.hide(function(){p.default.ScrewSortCtrl.addList()})})},l([y,m("ScrewSortGameUI/AddList")],t)}(f.default);r.default=g,cc._RF.pop(),cc._RF.pop()},{}],android:[function(e,t){"use strict";cc._RF.push(t,"a8369NFe6dCSYX2ZVTg9TFW","android");var o=t;cc._RF.push(o,"a8369NFe6dCSYX2ZVTg9TFW","android"),cc._RF.pop(),cc._RF.pop()},{}],asyncToGenerator:[function(e,t){"use strict";function o(e,t,o,n,i,r,a){try{var c=e[r](a),s=c.value}catch(e){return void o(e)}c.done?t(s):Promise.resolve(s).then(n,i)}cc._RF.push(t,"73dbaNPXX9D94hXcQzP6FnI","asyncToGenerator"),t.exports=function(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){var a=e.apply(t,n);function c(e){o(a,i,r,c,s,"next",e)}function s(e){o(a,i,r,c,s,"throw",e)}c(void 0)})}},cc._RF.pop()},{}],classCallCheck:[function(e,t){"use strict";cc._RF.push(t,"ec2abrDNMhOPIwqxrN79PCr","classCallCheck"),t.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},cc._RF.pop()},{}],config:[function(e,t,o){"use strict";cc._RF.push(t,"bdf27LNS3ZEQZZTNY15/iNs","config");var n,i=t,r=o;cc._RF.push(i,"bdf27LNS3ZEQZZTNY15/iNs","config"),Object.defineProperty(r,"__esModule",{value:!0}),r.isTouTiaoPlatform=r.isWeChatPlatform=r.isOpenLog=r.SUB_PACKAGE=r.platform_APPName=r.platform_APPID=r.adState=r.currentPlatform=r.platformEnum=void 0,function(e){e[e.wechat=1]="wechat",e[e.toutiao=2]="toutiao",e[e.qq=3]="qq",e[e.oppo=4]="oppo",e[e.meizu=5]="meizu",e[e.vivo=6]="vivo",e[e.android=7]="android",e[e.ios=8]="ios",e[e.huawei=9]="huawei",e[e.native=10]="native",e[e.web=11]="web",e[e.ks=12]="ks"}(n=r.platformEnum||(r.platformEnum={})),cc.Enum(n),r.currentPlatform=n.wechat,r.adState=!0,function(e){e.wechat_ID="",e.toutiao_ID="",e.qq_ID="",e.oppo_ID="",e.vivo_ID="",e.android_ID="",e.ios_ID=""}(r.platform_APPID||(r.platform_APPID={})),function(e){e.wechat_Name="   ",e.toutiao_Name=" ",e.qq_Name=" ",e.oppo_Name=" ",e.vivo_Name=" ",e.android_Name=" ",e.ios_Name=" "}(r.platform_APPName||(r.platform_APPName={})),r.isWeChatPlatform=function(){return cc.sys.platform===cc.sys.WECHAT_GAME&&r.currentPlatform==n.wechat},r.isTouTiaoPlatform=function(){return r.currentPlatform===n.toutiao},cc._RF.pop(),cc._RF.pop()},{}],const:[function(e,t,o){"use strict";cc._RF.push(t,"f0bc8jqpk1HfZntFWqAS+uu","const");var n=t,i=o;cc._RF.push(n,"f0bc8jqpk1HfZntFWqAS+uu","const"),Object.defineProperty(i,"__esModule",{value:!0}),i.PanelNames=i.EventNames=i.SceneNames=void 0,function(e){e.Game="Game",e.Main="Main",e.GameLong="GameModeLong",e.EndlessBottle="EndlessBottle",e.GameModeFillLong="GameModeFillLong",e.GameModeMultiple="GameModeMulti",e.ScrewSort="ScrewSort",e.Challenge="GameModeChanllenge",e.RingFight="RingFight",e.Load="Load",e.BottlePuzzle="BottlePuzzle"}(i.SceneNames||(i.SceneNames={})),function(e){e.LoadLevelFinish="load_level_finish",e.WaterDrop="water_drop",e.UseProp="use_prop",e.LoadLevel="load_level",e.ColorChanged="color_changed",e.DoPour="do_pour",e.CupFinish="cup_finish",e.OnClickPour="on_click_pour",e.GenerateCandidate="generate_candidate",e.GameLose="game_over",e.OnClickCup="on_click_cup",e.LoadColorIds="load_color_ids",e.TryCollect="cup_finish_animation_end",e.LevelFinish="level_finish",e.PackageUnlock="package_unlock",e.Pause="pause",e.Resume="resume",e.UpdateTestNumber="UpdateTestNumber",e.UpdateCandidateText="UpdateCandidateText",e.Collect="Collect",e.CloseSetting="CloseSetting",e.Rise="Rise",e.UpdateCapSelection="UpdateCapSelection",e.GetSidebarReward="GetSidebarReward",e.GetAddDesktopReward="GetAddDesktopReward",e.UpdateAnimalSelection="UpdateAnimalSelection",e.OnSelectCharacterSkin="OnSelectCharacterSkin",e.ShowMainGameClubButton="ShowMainGameClubButton",e.CreateMainGameClubButton="CreateMainGameClubButton",e.Explode="Explode",e.OnVideoAdEnd="OnVideoAdEnd",e.OnVideoAdStart="OnVideoAdStart",e.BombTimeWarning="BombTimeWarning",e.BombDefuse="BombDefuse",e.ResumeAllBombs="ResumeAllBombs",e.PauseAllBombs="PauseAllBombs",e.FirstClickCup="FirstClickCup",e.AllCupFinished="AllCupFinished",e.AllPanelClosed="AllPanelClosed",e.NoActivePanel="NoActivePanel",e.ActivePanel="ActivePanel",e.PlayCupTutorial="PlayCupTutorial",e.AutoPlayJumpToNextLevel="AutoPlayJumpToNextLevel",e.UpdateGold="UpdateGold",e.RevealKey="RevealKey",e.NextLevel="NextLevel",e.playFinishSFX="playFinishSFX",e.ChangeBg="ChangeBg",e.UpdateState="UpdateState"}(i.EventNames||(i.EventNames={})),function(e){e.AddDesktopPanel="AddDesktopPanel",e.CupShowCasePanel="CupShowCasePanel",e.DrinkCollectionPanel="DrinkCollectionPanel",e.GameClubPanel="GameClubPanel",e.GroupPanel="GroupPanel",e.InvitePanel="InvitePanel",e.JourneyMainPanel="JourneyMainPanel",e.RankPanel="RankPanel",e.SideModePanel="SideModePanel",e.AddStepPanel="AddStepPanel",e.CollectionPanel="CollectionPanel",e.DrinkPanel="DrinkPanel",e.EndStreakPanel="EndStreakPanel",e.EnergyPanel="EnergyPanel",e.GameLosePanel="GameLosePanel",e.GameOverMainPanel="GameOverMainPanel",e.JourneyPanel="JourneyPanel",e.SettingPanel="SettingPanel",e.SidebarPanel="SidebarPanel",e.TutorialPanel="TutorialPanel",e.WxSidebarPanel="WxSidebarPanel",e.AddCupPanel="AddCupPanel",e.AddTimePanel="AddTimePanel",e.GameOverChallengePanel="GameOverChallengePanel",e.GameOverPanel="GameOverPanel",e.LosePanel="LosePanel",e.RewardPanel="RewardPanel"}(i.PanelNames||(i.PanelNames={})),cc._RF.pop(),cc._RF.pop()},{}],countdownCtrl_ED:[function(e,t,o){"use strict";cc._RF.push(t,"6bb8fiVqYRAmLtOkvgy+Daq","countdownCtrl_ED");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"6bb8fiVqYRAmLtOkvgy+Daq","countdownCtrl_ED");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("GameManager_ED"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.countdownLabel=null,t.ifStartCountdown=!1,t.countdown_time=0,t}return s(t,e),t.prototype.startCountdown=function(e,t){this.ifStartCountdown||(this.ifStartCountdown=!0,this.node.active=!0,this.unscheduleAllCallbacks(),this.countdown_time=e?10:3,this.countdownLabel.string=this.countdown_time+"",this._countdown(t))},t.prototype.stopCountDown=function(){this.ifStartCountdown=!1,this.node.active=!1,this.unscheduleAllCallbacks(),this.countdown_time=0},t.prototype._countdown=function(e){var t=this;this.scheduleOnce(function(){u.default.instance.ifGamePause||t.countdown_time--,t.countdownLabel.string=t.countdown_time+"",0===t.countdown_time?(t.stopCountDown(),e&&e()):t._countdown(e)},1)},l([f(cc.Label)],t.prototype,"countdownLabel",void 0),l([d],t)}(cc.Component);r.default=h,cc._RF.pop(),cc._RF.pop()},{}],createClass:[function(e,t){"use strict";cc._RF.push(t,"66ebfDxuoRK9p1jJHyI6EaN","createClass");var o=e("./toPropertyKey");function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,o(i.key),i)}}t.exports=function(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e},cc._RF.pop()},{"./toPropertyKey":"toPropertyKey"}],gameOverPnl_SS:[function(e,t,o){"use strict";cc._RF.push(t,"1b65cQNfgJKxpYwg95MdxY1","gameOverPnl_SS");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"1b65cQNfgJKxpYwg95MdxY1","gameOverPnl_SS");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData_SS"),p=n("DataManager_SS"),d=n("GameManager_SS"),f=n("UIManager_SS"),h=n("PanelBase_SS"),y=cc._decorator,m=y.ccclass,g=y.property,v=y.menu,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.win=null,t.btns=null,t}return s(t,e),Object.defineProperty(t.prototype,"ifNext",{get:function(){switch(u.default.mode){case u.default.gameMode.configured:return p.default.curLevel<p.default.levelConfiguredMax;default:return!0}},enumerable:!1,configurable:!0}),t.prototype.init=function(){switch(this.win.active=!0,u.default.mode){case u.default.gameMode.normal:p.default.ifPassedGuide=!0,p.default.collectAmount<p.default.collectAmountMax&&p.default.collectAmount<p.default.curLevel?(p.default.collectAmount++,this.onWinInit(!0)):this.onWinInit(!1);break;case u.default.gameMode.configured:this.onWinInit(!1)}this.btns.children[0].setPosition(this.ifNext?-160:0,0),this.btns.children[1].active=this.ifNext,this.ifNext&&p.default.curLevel++,console.log("curLevel:",p.default.curLevel,"    collectAmount:",p.default.collectAmount)},t.prototype.onWinInit=function(){},t.prototype.clickHome=function(){d.default.playVibrateShort(),f.default.instance.gamePnlCtrl.gameClose()},t.prototype.clickShare=function(){d.default.playVibrateShort(),d.default.platform.showShare(function(){})},t.prototype.clickNextLevel=function(){d.default.playVibrateShort(),this.hide(function(){f.default.instance.gamePnlCtrl.gameStart()}),f.default.instance.gamePnlCtrl.testNode.getComponent("UITestNode").changeModelTipInfo()},l([g(cc.Node)],t.prototype,"win",void 0),l([g(cc.Node)],t.prototype,"btns",void 0),l([m,v("ScrewSortGameUI/GameOver")],t)}(h.default);r.default=_,cc._RF.pop(),cc._RF.pop()},{}],gravityAnalys:[function(e,t,o){"use strict";cc._RF.push(t,"96fa8QIbvtKOZNc5LZr/5ci","gravityAnalys");var n=t,i=o;cc._RF.push(n,"96fa8QIbvtKOZNc5LZr/5ci","gravityAnalys"),Object.defineProperty(i,"__esModule",{value:!0}),i.adShowEvent=i.track=i.setSuperProperties=i.initialize=i.startGravity=i.init=void 0;var r=null;i.init=function(e){this.startGravity(e),this.initialize(e),console.error("\u521d\u59cb\u5316\u7ed3\u675f====>")},i.startGravity=function(e){(r=new GravityAnalyticsAPI({accessToken:"5CEkJmLupkxjs2KWfTd3zNlqq1Gbw47m",clientId:e,autoTrack:{appLaunch:!0,appShow:!0,appHide:!0},name:"ge",debugMode:"none"})).setupAndStart()},i.initialize=function(e){r.initialize({name:e,version:11,openid:e,enable_sync_attribution:!1}).then(function(){a.forEach(function(e,t){r.track(t,e)}),a.clear()}).catch(function(){})},i.setSuperProperties=function(e){r.setSuperProperties({step:e})};var a=new Map,c=[],s=!1;i.track=function(e,t){if(console.error("\u4e0a\u62a5----\x3e",e,",\u6570\u636e---\x3e",t),r){if(r.track(e,t),console.error("\u6210\u529f"),!s){s=!0;for(var o=0,n=c;o<n.length;o++){var i=n[o];r.track(i.name,i.data)}}}else{var a={name:e,data:t};c.push(a)}},i.adShowEvent=function(e,t,o){CC_WECHATGAME&&r.adShowEvent(e,t,o)},cc._RF.pop(),cc._RF.pop()},{}],"gravityengine.mg.cocoscreator.min":[function(e,t,o){"use strict";cc._RF.push(t,"2ccb4ltSflHmatX8ia9d/h0","gravityengine.mg.cocoscreator.min"),e("./helpers/Arrayincludes");var n=e("./helpers/typeof");!function(e,i){"object"==(void 0===o?"undefined":n(o))&&void 0!==t?t.exports=i():"function"==typeof define&&define.amd?define(i):(e=e||self).gravityengine=i()}(void 0,function(){function e(e,t){var o,n=Object.keys(e);return Object.getOwnPropertySymbols&&(o=Object.getOwnPropertySymbols(e),t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)),n}function t(t){for(var o=1;o<arguments.length;o++){var n=null!=arguments[o]?arguments[o]:{};o%2?e(Object(n),!0).forEach(function(e){u(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function o(){o=function(){return e};var e={},t=Object.prototype,i=t.hasOwnProperty,r=Object.defineProperty||function(e,t,o){e[t]=o.value},a=(m="function"==typeof Symbol?Symbol:{}).iterator||"@@iterator",c=m.asyncIterator||"@@asyncIterator",s=m.toStringTag||"@@toStringTag";function l(e,t,o){return Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(t){l=function(e,t,o){return e[t]=o}}function u(e,t,o,n){var i,a,c,s;return t=t&&t.prototype instanceof f?t:f,t=Object.create(t.prototype),n=new P(n||[]),r(t,"_invoke",{value:(i=e,a=o,c=n,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return{value:void 0,done:!0}}for(c.method=e,c.arg=t;;){var o=c.delegate;if(o&&(o=function e(t,o){var n=o.method,i=t.iterator[n];return void 0===i?(o.delegate=null,"throw"===n&&t.iterator.return&&(o.method="return",o.arg=void 0,e(t,o),"throw"===o.method)||"return"!==n&&(o.method="throw",o.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d):"throw"===(n=p(i,t.iterator,o.arg)).type?(o.method="throw",o.arg=n.arg,o.delegate=null,d):(i=n.arg)?i.done?(o[t.resultName]=i.value,o.next=t.nextLoc,"return"!==o.method&&(o.method="next",o.arg=void 0),o.delegate=null,d):i:(o.method="throw",o.arg=new TypeError("iterator result is not an object"),o.delegate=null,d)}(o,c))){if(o===d)continue;return o}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if("suspendedStart"===s)throw s="completed",c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);if(s="executing","normal"===(o=p(i,a,c)).type){if(s=c.done?"completed":"suspendedYield",o.arg===d)continue;return{value:o.arg,done:c.done}}"throw"===o.type&&(s="completed",c.method="throw",c.arg=o.arg)}})}),t}function p(e,t,o){try{return{type:"normal",arg:e.call(t,o)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d={};function f(){}function h(){}function y(){}var m,g,v=(l(m={},a,function(){return this}),(g=(g=Object.getPrototypeOf)&&g(g(k([]))))&&g!==t&&i.call(g,a)&&(m=g),y.prototype=f.prototype=Object.create(m));function _(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e)})})}function S(e,t){var o;r(this,"_invoke",{value:function(r,a){function c(){return new t(function(o,c){!function o(r,a,c,s){var l;if("throw"!==(r=p(e[r],e,a)).type)return(a=(l=r.arg).value)&&"object"==n(a)&&i.call(a,"__await")?t.resolve(a.__await).then(function(e){o("next",e,c,s)},function(e){o("throw",e,c,s)}):t.resolve(a).then(function(e){l.value=e,c(l)},function(e){return o("throw",e,c,s)});s(r.arg)}(r,a,o,c)})}return o=o?o.then(c,c):c()}})}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function k(e){if(e||""===e){var t,o=e[a];if(o)return o.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return t=-1,(o=function o(){for(;++t<e.length;)if(i.call(e,t))return o.value=e[t],o.done=!1,o;return o.value=void 0,o.done=!0,o}).next=o}throw new TypeError(n(e)+" is not iterable")}return r(v,"constructor",{value:h.prototype=y,configurable:!0}),r(y,"constructor",{value:h,configurable:!0}),h.displayName=l(y,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){return!!(e="function"==typeof e&&e.constructor)&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},_(S.prototype),l(S.prototype,c,function(){return this}),e.AsyncIterator=S,e.async=function(t,o,n,i,r){void 0===r&&(r=Promise);var a=new S(u(t,o,n,i),r);return e.isGeneratorFunction(o)?a:a.next().then(function(e){return e.done?e.value:a.next()})},_(v),l(v,s,"Generator"),l(v,a,function(){return this}),l(v,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t,o=Object(e),n=[];for(t in o)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in o)return e.value=t,e.done=!1,e}return e.done=!0,e}},e.values=k,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(o,n){return a.type="throw",a.arg=e,t.next=o,n&&(t.method="next",t.arg=void 0),!!n}for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n],a=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var c=i.call(r,"catchLoc"),s=i.call(r,"finallyLoc");if(c&&s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(c){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;0<=o;--o){var n=this.tryEntries[o];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}var a=(r=r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc?null:r)?r.completion:{};return a.type=e,a.arg=t,r?(this.method="next",this.next=r.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var o=this.tryEntries[t];if(o.finallyLoc===e)return this.complete(o.completion,o.afterLoc),C(o),d}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var o,n,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(o=i.completion).type&&(n=o.arg,C(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,o){return this.delegate={iterator:k(e),resultName:t,nextLoc:o},"next"===this.method&&(this.arg=void 0),d}},e}function i(e){return(i="function"==typeof Symbol&&"symbol"==n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}function r(e,t,o,n,i,r,a){try{var c=e[r](a),s=c.value}catch(e){return void o(e)}c.done?t(s):Promise.resolve(s).then(n,i)}function a(e){return function(){var t=this,o=arguments;return new Promise(function(n,i){var a=e.apply(t,o);function c(e){r(a,n,i,c,s,"next",e)}function s(e){r(a,n,i,c,s,"throw",e)}c(void 0)})}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function l(e,t,o){return t&&s(e.prototype,t),o&&s(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e,t,o){return(t=p(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function p(e){return"symbol"==n(e=function(e){if("object"!=n(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0===t)return String(e);if("object"!=n(t=t.call(e,"string")))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}(e))?e:String(e)}var d="4.8.3",f="MG",h="https://backend.gravity-engine.com/event_center/api/v1",y={},m=Array.prototype,g=Object.prototype,v=m.slice,_=g.toString,S=Object.prototype.hasOwnProperty,b=m.forEach,C=(g=Array.isArray,{});function P(){return new RegExp(/(.*?)\.?([^.]*?)\.(com|net|org|biz|ws|in|me|co\.uk|co|org\.uk|ltd\.uk|plc\.uk|me\.uk|edu|mil|br\.com|cn\.com|eu\.com|hu\.com|no\.com|qc\.com|sa\.com|se\.com|se\.net|us\.com|uy\.com|ac|co\.ac|gv\.ac|or\.ac|ac\.ac|af|am|as|at|ac\.at|co\.at|gv\.at|or\.at|asn\.au|com\.au|edu\.au|org\.au|net\.au|id\.au|be|ac\.be|adm\.br|adv\.br|am\.br|arq\.br|art\.br|bio\.br|cng\.br|cnt\.br|com\.br|ecn\.br|eng\.br|esp\.br|etc\.br|eti\.br|fm\.br|fot\.br|fst\.br|g12\.br|gov\.br|ind\.br|inf\.br|jor\.br|lel\.br|med\.br|mil\.br|net\.br|nom\.br|ntr\.br|odo\.br|org\.br|ppg\.br|pro\.br|psc\.br|psi\.br|rec\.br|slg\.br|tmp\.br|tur\.br|tv\.br|vet\.br|zlg\.br|br|ab\.ca|bc\.ca|mb\.ca|nb\.ca|nf\.ca|ns\.ca|nt\.ca|on\.ca|pe\.ca|qc\.ca|sk\.ca|yk\.ca|ca|cc|ac\.cn|net\.cn|com\.cn|edu\.cn|gov\.cn|org\.cn|bj\.cn|sh\.cn|tj\.cn|cq\.cn|he\.cn|nm\.cn|ln\.cn|jl\.cn|hl\.cn|js\.cn|zj\.cn|ah\.cn|gd\.cn|gx\.cn|hi\.cn|sc\.cn|gz\.cn|yn\.cn|xz\.cn|sn\.cn|gs\.cn|qh\.cn|nx\.cn|xj\.cn|tw\.cn|hk\.cn|mo\.cn|cn|cx|cz|de|dk|fo|com\.ec|tm\.fr|com\.fr|asso\.fr|presse\.fr|fr|gf|gs|co\.il|net\.il|ac\.il|k12\.il|gov\.il|muni\.il|ac\.in|co\.in|org\.in|ernet\.in|gov\.in|net\.in|res\.in|is|it|ac\.jp|co\.jp|go\.jp|or\.jp|ne\.jp|ac\.kr|co\.kr|go\.kr|ne\.kr|nm\.kr|or\.kr|li|lt|lu|asso\.mc|tm\.mc|com\.mm|org\.mm|net\.mm|edu\.mm|gov\.mm|ms|nl|no|nu|pl|ro|org\.ro|store\.ro|tm\.ro|firm\.ro|www\.ro|arts\.ro|rec\.ro|info\.ro|nom\.ro|nt\.ro|se|si|com\.sg|org\.sg|net\.sg|gov\.sg|sk|st|tf|ac\.th|co\.th|go\.th|mi\.th|net\.th|or\.th|tm|to|com\.tr|edu\.tr|gov\.tr|k12\.tr|net\.tr|org\.tr|com\.tw|org\.tw|net\.tw|ac\.uk|uk\.com|uk\.net|gb\.com|gb\.net|vg|sh|kz|ch|info|ua|gov|name|pro|ie|hk|com\.hk|org\.hk|net\.hk|edu\.hk|us|tk|cd|by|ad|lv|eu\.lv|bz|es|jp|cl|ag|mobi|eu|co\.nz|org\.nz|net\.nz|maori\.nz|iwi\.nz|io|la|md|sc|sg|vc|tw|travel|my|se|tv|pt|com\.pt|edu\.pt|asia|fi|com\.ve|net\.ve|fi|org\.ve|web\.ve|info\.ve|co\.ve|tel|im|gr|ru|net\.ru|org\.ru|hr|com\.hr|ly|xyz)$/)}function k(e,t){var o=e.charAt(0);return t=t.split(o),o===e?t:t[(e=parseInt(e.substring(1),10))<0?t.length+e:e-1]}function w(e,t){for(var o,n=e.charAt(0),i=t.split("&"),r=[],a={},c=e.substring(1),s=0,l=i.length;s<l;s++)if(""!==(r=(r=i[s].match(/(.*?)=(.*)/))||[i[s],i[s],""])[1].replace(/\s/g,"")){if(r[2]=(o=r[2]||"",y.decodeURIComponent(o.replace(/\+/g," "))),c===r[1])return r[2];(o=r[1].match(/(.*)\[([0-9]+)\]/))?(a[o[1]]=a[o[1]]||[],a[o[1]][o[2]]=r[2]):a[r[1]]=r[2]}return n===e?a:a[c]}y.isNumber=function(e){return"number"==typeof e?0==e-e:"string"==typeof e&&""!==e.trim()&&(Number.isFinite?Number.isFinite(+e):isFinite(+e))},y.each=function(e,t,o){if(null==e)return!1;if(b&&e.forEach===b)e.forEach(t,o);else if(e.length===+e.length){for(var n=0,i=e.length;n<i;n++)if(n in e&&t.call(o,e[n],n,e)===C)return!1}else for(var r in e)if(S.call(e,r)&&t.call(o,e[r],r,e)===C)return!1},y.sleep=function(e){return new Promise(function(t){return setTimeout(t,e)})},y.extend=function(e){return y.each(v.call(arguments,1),function(t){for(var o in t)void 0!==t[o]&&(e[o]=t[o])}),e},y.extend2Layers=function(e){return y.each(v.call(arguments,1),function(t){for(var o in t)void 0!==t[o]&&(y.isObject(t[o])&&y.isObject(e[o])?y.extend(e[o],t[o]):e[o]=t[o])}),e},y.isArray=g||function(e){return"[object Array]"===_.call(e)},y.isFunction=function(e){try{return"function"==typeof e}catch(e){return!1}},y.isPromise=function(e){return"[object Promise]"===_.call(e)&&null!=e},y.isObject=function(e){return"[object Object]"===_.call(e)&&null!=e},y.isEmptyObject=function(e){if(y.isObject(e)){for(var t in e)if(S.call(e,t))return!1;return!0}return!1},y.isUndefined=function(e){return void 0===e},y.isString=function(e){return"[object String]"===_.call(e)},y.isDate=function(e){return"[object Date]"===_.call(e)},y.isBoolean=function(e){return"[object Boolean]"===_.call(e)},y.isNumber=function(e){return"[object Number]"===_.call(e)&&/[\d\.]+/.test(String(e))},y.isJSONString=function(e){try{JSON.parse(e)}catch(e){return!1}return!0},y.decodeURIComponent=function(e){var o="";try{o=decodeURIComponent(e)}catch(t){o=e}return o},y.encodeURIComponent=function(e){var o="";try{o=encodeURIComponent(e)}catch(t){o=e}return o},y.utf8Encode=function(e){for(var t,o="",n=t=0,i=(e=(e+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length,r=0;r<i;r++){var a=e.charCodeAt(r),c=null;a<128?t++:c=127<a&&a<2048?String.fromCharCode(a>>6|192,63&a|128):String.fromCharCode(a>>12|224,a>>6&63|128,63&a|128),null!==c&&(n<t&&(o+=e.substring(n,t)),o+=c,n=t=r+1)}return n<t&&(o+=e.substring(n,e.length)),o},y.base64Encode=function(e){var t,o,n,i,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=0,c=0,s="",l=[];if(!e)return e;for(e=y.utf8Encode(e);t=(i=e.charCodeAt(a++)<<16|e.charCodeAt(a++)<<8|e.charCodeAt(a++))>>12&63,o=i>>6&63,n=63&i,l[c++]=r.charAt(i>>18&63)+r.charAt(t)+r.charAt(o)+r.charAt(n),a<e.length;);switch(s=l.join(""),e.length%3){case 1:s=s.slice(0,-2)+"==";break;case 2:s=s.slice(0,-1)+"="}return s},y.encodeDates=function(e){return y.each(e,function(t,o){if(y.isDate(t))e[o]=y.formatDate(t);else if(y.isObject(t))e[o]=y.encodeDates(t);else if(y.isArray(t))for(var n=0;n<t.length;n++)y.isDate(t[n])&&(e[o][n]=y.formatDate(t[n]))}),e},y.formatDate=function(e){function t(e){return e<10?"0"+e:e}return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+" "+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())+"."+((e=e.getMilliseconds())<100&&9<e?"0"+e:e<10?"00"+e:e)},y.searchObjDate=function(e){try{(y.isObject(e)||y.isArray(e))&&y.each(e,function(t,o){y.isObject(t)||y.isArray(t)?y.searchObjDate(e[o]):y.isDate(t)&&(e[o]=y.formatDate(t))})}catch(e){I.warn(e)}},y.UUID=function(){var e=(new Date).getTime();return String(Math.random()).replace(".","").slice(1,11)+"-"+e},y.UUIDv4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},y.setMpPlatform=function(e){y.mpPlatform=e},y.getMpPlatform=function(){return y.mpPlatform},y.createExtraHeaders=function(){return{"GE-Integration-Type":f,"GE-Integration-Version":d,"GE-Integration-Count":"1","GE-Integration-Extra":y.getMpPlatform()}},y.checkAppId=function(e){if("number"==typeof e)e=String(e);else if("string"!=typeof e)return"";return e.replace(/\s*/g,"")},y.checkUrl=function(e){return e=e.replace(/\s*/g,""),y.url("basic",e)},y.url=function(e,t){var o,n={};if("tld?"===e)return P();if(t=t||window.location.toString(),!e)return t;if(e=e.toString(),t.match(/^mailto:([^/].+)/))o=t.match(/^mailto:([^/].+)/),n.protocol="mailto",n.email=o[1];else{if((t=t.match(/(.*?)\/#!(.*)/)?(o=t.match(/(.*?)\/#!(.*)/))[1]+o[2]:t).match(/(.*?)#(.*)/)&&(o=t.match(/(.*?)#(.*)/),n.hash=o[2],t=o[1]),n.hash&&e.match(/^#/))return w(e,n.hash);if(t.match(/(.*?)\?(.*)/)&&(o=t.match(/(.*?)\?(.*)/),n.query=o[2],t=o[1]),n.query&&e.match(/^\?/))return w(e,n.query);if(t.match(/(.*?):?\/\/(.*)/)&&(o=t.match(/(.*?):?\/\/(.*)/),n.protocol=o[1].toLowerCase(),t=o[2]),t.match(/(.*?)(\/.*)/)&&(o=t.match(/(.*?)(\/.*)/),n.path=o[2],t=o[1]),n.path=(n.path||"").replace(/^([^/])/,"/$1").replace(/\/$/,""),(e=e.match(/^[-0-9]+$/)?e.replace(/^([^/])/,"/$1"):e).match(/^\//))return k(e,n.path.substring(1));if((o=(o=k("/-1",n.path.substring(1)))&&o.match(/(.*?)\.(.*)/))&&(n.file=o[0],n.filename=o[1],n.fileext=o[2]),t.match(/(.*):([0-9]+)$/)&&(o=t.match(/(.*):([0-9]+)$/),n.port=o[2],t=o[1]),t.match(/(.*?)@(.*)/)&&(o=t.match(/(.*?)@(.*)/),n.auth=o[1],t=o[2]),n.auth&&(o=n.auth.match(/(.*):(.*)/),n.user=o?o[1]:n.auth,n.pass=o?o[2]:void 0),n.hostname=t.toLowerCase(),"."===e.charAt(0))return k(e,n.hostname);P()&&(o=n.hostname.match(P()))&&(n.tld=o[3],n.domain=o[2]?o[2]+"."+o[3]:void 0,n.sub=o[1]||void 0),t=n.port?":"+n.port:"",n.protocol=n.protocol||window.location.protocol.replace(":",""),n.port=n.port||("https"===n.protocol?"443":"80"),n.protocol=n.protocol||("443"===n.port?"https":"http"),n.basic=n.protocol+"://"+n.hostname+t}return e in n?n[e]:"{}"===e?n:""},y.createString=function(e){for(var t=e,o=Math.random().toString(36).substr(2);o.length<t;)o+=Math.random().toString(36).substr(2);return o.substr(0,e)},y.createAesKey=function(){return y.createString(16)},y.setQuery=function(e){var t,o=[];for(t in e)e.hasOwnProperty(t)&&o.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return o.join("&")},y.generateEncryptyData=function(e,t){if(void 0!==t){var o=t.publicKey;if(t=t.version,void 0!==o&&void 0!==t&&"undefined"!=typeof CryptoJS&&"undefined"!=typeof JSEncrypt){var n=y.createAesKey();try{var i=CryptoJS.enc.Utf8.parse(n),r=CryptoJS.enc.Utf8.parse(JSON.stringify(e)),a=y.isUndefined(CryptoJS.pad.Pkcs7)?CryptoJS.pad.PKCS7:CryptoJS.pad.Pkcs7,c=CryptoJS.AES.encrypt(r,i,{mode:CryptoJS.mode.ECB,padding:a}).toString(),s=new JSEncrypt,l=(s.setPublicKey(o),s.encrypt(n));return!1===l?(I.warn("\u79c1\u94a5\u52a0\u5bc6\u5931\u8d25\uff0c\u8fd4\u56de\u539f\u6570\u636e"),e):{pkv:t,ekey:l,payload:c}}catch(e){I.warn("\u6570\u636e\u52a0\u5bc6\u5931\u8d25\uff0c\u8fd4\u56de\u539f\u6570\u636e: "+e)}}}return e};var I="object"===i(I)?I:{},T=(I.info=function(){if("object"===("undefined"==typeof console?"undefined":i(console))&&console.log&&I.enabled)try{return console.log.apply(console,arguments)}catch(n){console.log(arguments[0])}},I.warn=function(){if("object"===("undefined"==typeof console?"undefined":i(console))&&console.log&&I.enabled)try{return console.warn.apply(console,arguments)}catch(n){console.warn(arguments[0])}},function(){function e(){c(this,e),this.config={persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_mg"}}return l(e,[{key:"getConfig",value:function(){return this.config}},{key:"getStorage",value:function(e,t,o){if(e=localStorage.getItem(e),!t)return y.isJSONString(e)?JSON.parse(e):{};y.isJSONString(e)?o(JSON.parse(e)):o({})}},{key:"setStorage",value:function(e,t){localStorage.setItem(e,t)}},{key:"_setSystemProxy",value:function(e){this._sysCallback=e}},{key:"getSystemInfo",value:function(e){var t={mp_platform:"web",system:this._getOs(),screenWidth:window.screen.width,screenHeight:window.screen.height,systemLanguage:navigator.language};this._sysCallback&&(t=y.extend(t,this._sysCallback(e))),e.success(t),e.complete()}},{key:"_getOs",value:function(){var e=navigator.userAgent;return/Windows/i.test(e)?/Phone/.test(e)||/WPDesktop/.test(e)?"Windows Phone":"Windows":/(iPhone|iPad|iPod)/.test(e)?"iOS":/Android/.test(e)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":/Mac/i.test(e)?"MacOS":/Linux/.test(e)?"Linux":/CrOS/.test(e)?"ChromeOS":""}},{key:"getNetworkType",value:function(e){e.complete()}},{key:"onNetworkStatusChange",value:function(){}},{key:"request",value:function(e){var t={},o=new XMLHttpRequest;if(o.open(e.method,e.url),e.header)for(var n in e.header)o.setRequestHeader(n,e.header[n]);return o.onreadystatechange=function(){4===o.readyState&&200===o.status?(t.statusCode=200,y.isJSONString(o.responseText)&&(t.data=JSON.parse(o.responseText)),e.success(t)):200!==o.status&&(t.errMsg="network error",e.fail(t))},o.ontimeout=function(){t.errMsg="timeout",e.fail(t)},o.send(e.data),o}},{key:"initAutoTrackInstance",value:function(e,t){this.instance=e,this.autoTrack=t.autoTrack;var o=this;"onpagehide"in window?window.onpagehide=function(){o.onPageHide(!0)}:window.onbeforeunload=function(){o.onPageHide(!0)},o.onPageShow(),o.autoTrack.appHide&&o.instance.timeEvent("ta_page_hide"),"onvisibilitychange"in document&&(document.onvisibilitychange=function(){document.hidden?o.onPageHide(!1):(o.onPageShow(),o.autoTrack.appHide&&o.instance.timeEvent("ta_page_hide"))})}},{key:"setGlobal",value:function(e,t){window[t]=e}},{key:"getAppOptions",value:function(){}},{key:"showToast",value:function(){}},{key:"onPageShow",value:function(){var e;this.autoTrack.appShow&&(y.extend(e={},this.autoTrack.properties),y.isFunction(this.autoTrack.callback)&&y.extend(e,this.autoTrack.callback("appShow")),this.instance._internalTrack("$WebPageView",e))}},{key:"onPageHide",value:function(e){var t;this.autoTrack.appHide&&(y.extend(t={},this.autoTrack.properties),y.isFunction(this.autoTrack.callback)&&y.extend(t,this.autoTrack.callback("appHide")),this.instance._internalTrack("$WebPageHide",t,new Date,null,e))}}],[{key:"createInstance",value:function(){return new e}}]),e}()),A=function(){function e(t,o){c(this,e),this.taInstance=t,this.config=o||{},this.referrer="Directly open",this.config.isPlugin?(t.App=function(){App.apply(this,arguments)},inension(t.Page)):(o=App,App=this._initAppExtention(o),t=Page,Page=this._initPageExtension(t))}return l(e,[{key:"_initPageExtension",value:function(e){var t=this;return function(o){var n=o.onLoad,i=o.onShow,r=o.onShareAppMessage,a={};return o.onLoad=function(e){a=e||{},"function"==typeof n&&n.call(this,e)},o.onShow=function(e){t.onPageShow(a),"function"==typeof i&&i.call(this,e)},"function"==typeof r&&(o.onShareAppMessage=function(e){return e=r.call(this,e),t.onPageShare(e)}),e(o)}}},{key:"_initAppExtention",value:function(e){var t=this;return function(o){var n=o.onLaunch,i=o.onShow,r=o.onHide;return o.onLaunch=function(e){t.onAppLaunch(e,this),"function"==typeof n&&n.call(this,e)},o.onShow=function(e){t.onAppShow(e),"function"==typeof i&&i.call(this,e)},o.onHide=function(){t.onAppHide(),"function"==typeof r&&r.call(this)},e(o)}}},{key:"onAppLaunch",value:function(e,t){this._setAutoTrackProperties(e),y.isUndefined(t)||(t[this.taInstance.name]=this.taInstance),this.config.appLaunch&&(t={},e&&e.path&&(t.$url_query=y.setQuery(e.query),t.$scene=String(e.scene||e.from)),this.taInstance._internalTrack("$MPLaunch",t))}},{key:"onAppShow",value:function(e){var t;this.config.appHide&&this.taInstance.timeEvent("$MPHide"),this._setAutoTrackProperties(e),this.config.appShow&&(t={},e&&e.path&&(t.$url_path=this._getPath(e.path),t.$url_query=y.setQuery(e.query),t.$scene=String(e.scene||e.from)),y.extend(t,this.config.properties),y.isFunction(this.config.callback)&&y.extend(t,this.config.callback("appShow")),this.taInstance._internalTrack("$MPShow",t))}},{key:"onAppHide",value:function(){var e;this.config.appHide&&(y.extend(e={},this.config.properties),y.isFunction(this.config.callback)&&y.extend(e,this.config.callback("appHide")),this.taInstance._internalTrack("$MPHide",e))}},{key:"_getCurrentPath",value:function(){var e="Not to get";try{var t=getCurrentPages();e=t[t.length-1].route}catch(e){I.info(e)}return e}},{key:"_setAutoTrackProperties",value:function(){this.taInstance._setAutoTrackProperties({})}},{key:"_getPath",value:function(e){return"string"==typeof e?e.replace(/^\//,""):"Abnormal values"}},{key:"onPageShare",value:function(e){if(this.config.pageShare){var t=1;try{t=getCurrentPages().length}catch(e){t=1}this.taInstance._internalTrack("$MPShare",{$share_method:"\u8f6c\u53d1\u6d88\u606f\u5361\u7247",$share_depth:t,$url_path:this._getCurrentPath()})}return y.isObject(e)?e:{}}},{key:"onPageShow",value:function(e){var t;this.config.pageShow&&(t=this._getCurrentPath(),y.setQuery(e),this.referrer=t)}}]),e}(),O=function(){function e(t,o,n){var i=this;c(this,e),this.taInstance=t,this.config=o||{},t=n.getLaunchOptionsSync(),this._onShow(t),this.startTracked=!0,n.onShow(function(e){i._onShow(e)}),n.onHide(function(){var e;i.startTracked=!1,i.config.appHide&&(y.extend(e={},i.config.properties),y.isFunction(i.config.callback)&&y.extend(e,i.config.callback("appHide")),i.taInstance._internalTrack("$MPHide",e))})}return l(e,[{key:"_onShow",value:function(e){var o;this.startTracked||(this.config.appHide&&this.taInstance.timeEvent("$MPHide"),this.config.appShow&&(y.extend(o={},this.config.properties),y.isFunction(this.config.callback)&&y.extend(o,this.config.callback("appShow")),this.taInstance._internalTrack("$MPShow",t(t({},o),{},{$scene:String(e.scene||e.from),$url_query:y.setQuery(x.getAppOptions().query)}))))}}]),e}(),R=function(){function e(t,o,n){c(this,e),this.api=t,this.config=o,this._config=n}return l(e,[{key:"getConfig",value:function(){return this.config}},{key:"getStorage",value:function(e,t,o){if(!t)return"dd_mp"===this._config.platform?(t=this.api.getStorageSync({key:e}),y.isJSONString(t.data)?JSON.parse(t.data):{}):(t=this.api.getStorageSync(e),y.isJSONString(t)?JSON.parse(t):{});this.api.getStorage({key:e,success:function(e){e=y.isJSONString(e.data)?JSON.parse(e.data):{},o(e)},fail:function(){I.warn("getStorage faild"),o({})}})}},{key:"setStorage",value:function(e,t){this.api.setStorage({key:e,data:t})}},{key:"_getPlatform",value:function(){return""}},{key:"getSystemInfo",value:function(e){var t=this._config.mpPlatform;this.api.getSystemInfo({success:function(o){y.isFunction(t)?o.mp_platform=t(o):o.mp_platform=t,e.success(o),"wechat"===t&&e.complete()},complete:function(){e.complete()}})}},{key:"getNetworkType",value:function(e){y.isFunction(this.api.getNetworkType)?this.api.getNetworkType({success:function(t){e.success(t)},complete:function(){e.complete()}}):(e.success({}),e.complete())}},{key:"onNetworkStatusChange",value:function(e){y.isFunction(this.api.onNetworkStatusChange)?this.api.onNetworkStatusChange(e):e({})}},{key:"request",value:function(e){var t;return"ali_mp"===this._config.platform||"dd_mp"===this._config.platform?((t=y.extend({},e)).headers=e.header,t.success=function(t){t.statusCode=t.status,e.success(t)},t.fail=function(t){t.errMsg=t.errorMessage,e.fail(t)},"dd_mp"===this._config.platform?this.api.httpRequest(t):this.api.request(t)):this.api.request(e)}},{key:"initAutoTrackInstance",value:function(e,t){return y.isObject(t.autoTrack)&&(t.autoTrack.isPlugin=t.is_plugin),new(this._config.mp?A:O)(e,t.autoTrack,this.api)}},{key:"setGlobal",value:function(e,t){this._config.mp?I.warn("GravityAnalytics: we do not set global name for GE instance when you do not enable auto track."):"ali_mg"!==this._config.platform&&(GameGlobal[t]=e)}},{key:"getAppOptions",value:function(e){var t={};try{t=this.api.getLaunchOptionsSync()}catch(e){I.warn("Cannot get launch options.")}if(y.isFunction(e))try{this._config.mp?this.api.onAppShow(e):this.api.onShow(e)}catch(e){I.warn("Cannot register onShow callback.")}return t}},{key:"showToast",value:function(e){var t;y.isFunction(this.api.showToast)&&(t={title:e},"dd_mp"!==this._config.platform&&"ali_mp"!==this._config.platform||(t.content=e),this.api.showToast(t))}}],[{key:"createInstance",value:function(){return this._createInstance("R_CURRENT_PLATFORM")}},{key:"_createInstance",value:function(t){switch(t){case"wechat_mp":return new e(wx,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_wechat"},{mpPlatform:"wechat",mp:!0,platform:t});case"wechat_mg":return new e(wx,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_wechat_game"},{mpPlatform:"wechat",platform:t});case"qq_mp":return new e(qq,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_qq"},{mpPlatform:"qq",mp:!0,platform:t});case"qq_mg":return new e(qq,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_qq_game"},{mpPlatform:"qq",platform:t});case"baidu_mp":return new e(swan,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_swan"},{mpPlatform:function(e){return e.host},mp:!0,platform:t});case"baidu_mg":return new e(swan,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_swan_game"},{mpPlatform:function(e){return e.host},platform:t});case"tt_mg":return new e(tt,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_tt_game"},{mpPlatform:function(e){return e.appName},platform:t});case"tt_mp":return new e(tt,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_tt"},{mpPlatform:function(e){return e.appName},mp:!0,platform:t});case"ali_mp":return new e(my,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_ali"},{mpPlatform:function(e){return e.app},mp:!0,platform:t});case"ali_mg":return new e(my,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_ali_game"},{mpPlatform:function(e){return e.app},platform:t});case"dd_mp":return new e(dd,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_dd"},{mpPlatform:"dingding",mp:!0,platform:t});case"bl_mg":return new e(bl,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_mg"},{mpPlatform:"bilibili",platform:t});case"kuaishou_mp":return new e(ks,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_kuaishou_program"},{mpPlatform:"kuaishou",mp:!0,platform:t});case"kuaishou_mg":return new e(ks,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_kuaishou_game"},{mpPlatform:"kuaishou_game",platform:t});case"qh360_mg":return new e(qh,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_qh360"},{mpPlatform:"qh360",platform:t});case"tb_mp":return new e(my,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_tb"},{mpPlatform:"tb",mp:!0,platform:t});case"jd_mp":return new e(jd,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_jd"},{mpPlatform:"jd",mp:!0,platform:t});case"qh360_mp":return new e(qh,{persistenceName:"GravityEngine",persistenceNameOld:"GravityEngine_qh360"},{mpPlatform:"qh360",mp:!0,platform:t});case"WEB":return new T.createInstance}}}]),e}(),N=l(function e(t,o){var n=this;c(this,e),this.taInstance=t,this.config=o||{},this.config.appShow&&this.taInstance._internalTrack("$MPShow"),this.config.appHide&&this.taInstance.timeEvent("$MPHide"),qg.onShow(function(){var e;n.config.appHide&&n.taInstance.timeEvent("$MPHide"),n.config.appShow&&(y.extend(e={},n.config.properties),y.isFunction(n.config.callback)&&y.extend(e,n.config.callback("appShow")),n.taInstance._internalTrack("$MPShow"))}),qg.onHide(function(){var e;n.config.appHide&&(y.extend(e={},n.config.properties),y.isFunction(n.config.callback)&&y.extend(e,n.config.callback("appHide")),n.taInstance._internalTrack("$MPHide"))})}),M=function(){function e(){c(this,e),this.config={persistenceName:"gravityengine",persistenceNameOld:"gravityengine_qg_vivo_game",asyncPersistence:!0}}return l(e,[{key:"getConfig",value:function(){return this.config||{}}},{key:"getStorage",value:function(e,t,o){if(!t)return t=qg.getStorageSync({key:e}),y.isJSONString(t)?JSON.parse(t):{};qg.getStorage({key:e,success:function(e){e=y.isJSONString(e)?JSON.parse(e):{},o(e)},fail:function(){o({})}})}},{key:"setStorage",value:function(e,t){qg.setStorage({key:e,value:t})}},{key:"getSystemInfo",value:function(e){qg.getSystemInfo({success:function(t){var o=t,n=[t.osType,t.osVersionName].join(" ");o.brand=t.manufacturer,o.system=n,o.mp_platform="vivo_qg",e.success(o)},complete:function(){e.complete()}})}},{key:"getQuickDevice",value:function(e){var t={os_name:"android",android_id:"",imei:"",oaid:"",mac:"",android_version:"",api_version:0,rom:{gravityengine_qg_huawei_game:"EMUI",gravityengine_qg:"MIUI",gravityengine_qg_oppo_game:"ColorOS",gravityengine_qg_vivo_game:"FuntouchOS",gravityengine_qg_mz_game:"Flyme"}[e.platform],rom_version:"",phone_brand:"",phone_model:""};qg.getSystemInfo({success:function(o){var n;t.android_version=o.system,t.api_version=o.platformVersionCode,t.rom_version=o.COREVersion,t.phone_brand=o.brand,t.phone_model=o.model,qg.getOAID&&(o=null!=(n=null==(n=(o=qg).getOAID)?void 0:n.call(o).oaid)?n:"",t.android_id=o,t.imei=o,t.oaid=o),e.success(t)}})}},{key:"getNetworkType",value:function(e){qg.getNetworkType({success:function(t){var o=t;o.networkType=t.type,e.success(o)},complete:function(){e.complete()}})}},{key:"onNetworkStatusChange",value:function(e){qg.subscribeNetworkStatus({callback:function(t){var o=t;o.networkType=t.type,e(o)}})}},{key:"request",value:function(e){return qg.request({url:e.url,data:e.data,method:e.method,header:e.header,success:function(t){e.success(t)},fail:function(t){e.fail(t)}})}},{key:"initAutoTrackInstance",value:function(e,t){return new N(e,t.autoTrack)}},{key:"setGlobal",value:function(e,t){globalThis[t]=e}},{key:"getAppOptions",value:function(){return{}}},{key:"showToast",value:function(e){qg.showToast({message:e,duration:0})}}],[{key:"createInstance",value:function(){return new e}}]),e}(),L=l(function e(t,o,n){var i=this;c(this,e),this.taInstance=t,this.config=o||{},this.config.appShow&&(y.extend(t={},this.config.properties),y.isFunction(this.config.callback)&&y.extend(t,this.config.callback("appShow")),this.taInstance._internalTrack("$MPShow",t)),this.config.appHide&&this.taInstance.timeEvent("$MPHide"),n.onShow(function(){var e;i.config.appHide&&i.taInstance.timeEvent("$MPHide"),i.config.appShow&&(y.extend(e={},i.config.properties),y.isFunction(i.config.callback)&&y.extend(e,i.config.callback("appShow")),i.taInstance._internalTrack("$MPShow",e))}),n.onHide(function(){var e;i.config.appHide&&(y.extend(e={},i.config.properties),y.isFunction(i.config.callback)&&y.extend(e,i.config.callback("appHide")),i.taInstance._internalTrack("$MPHide",e))})}),E=function(){function e(t,o,n){c(this,e),this.api=t,this.config=o,this._config=n}return l(e,[{key:"getConfig",value:function(){return this.config||{}}},{key:"getStorage",value:function(e,t,o){if(e=localStorage.getItem(e),!t)return y.isJSONString(e)?JSON.parse(e):{};y.isJSONString(e)?o(JSON.parse(e)):o({})}},{key:"setStorage",value:function(e,t){localStorage.setItem(e,t)}},{key:"getSystemInfo",value:function(e){var t=this._config.mpPlatform;this.api.getSystemInfo({success:function(o){o.mp_platform=t,e.success(o)},complete:function(){e.complete()}})}},{key:"getQuickDevice",value:function(e){var t={os_name:"android",android_id:"",imei:"",oaid:"",mac:"",android_version:"",api_version:0,rom:{gravityengine_qg_huawei_game:"EMUI",gravityengine_qg:"MIUI",gravityengine_qg_oppo_game:"ColorOS",gravityengine_qg_vivo_game:"FuntouchOS",gravityengine_qg_mz_game:"Flyme"}[e.platform],rom_version:"",phone_brand:"",phone_model:""},o=this;this.api.getSystemInfo({success:function(n){function i(){e.success(t)}t.android_version=n.system,t.api_version=n.platformVersionCode,t.rom_version=n.COREVersion,t.phone_brand=n.brand,t.phone_model=n.model,o.api.getDeviceId?o.api.getDeviceId({success:function(e){t.android_id=e.deviceId,t.imei=e.deviceId,t.oaid=e.deviceId,i()}}):o.api.getOAID?o.api.getOAID({success:function(e){t.android_id=e.oaid,t.imei=e.oaid,t.oaid=e.oaid,i()}}):i()}})}},{key:"getNetworkType",value:function(e){this.api.getNetworkType({success:function(t){e.success(t)},complete:function(){e.complete()}})}},{key:"onNetworkStatusChange",value:function(e){this.api.onNetworkStatusChange({callback:function(t){e(t)}})}},{key:"request",value:function(e){var t={},o=new XMLHttpRequest;if(o.open(e.method,e.url),e.header)for(var n in e.header)o.setRequestHeader(n,e.header[n]);return o.onreadystatechange=function(){4===o.readyState&&200===o.status?(t.statusCode=200,y.isJSONString(o.responseText)&&(t.data=JSON.parse(o.responseText)),e.success(t)):200!==o.status&&(t.errMsg="network error",e.fail(t))},o.ontimeout=function(){t.errMsg="timeout",e.fail(t)},o.send(e.data),o}},{key:"initAutoTrackInstance",value:function(e,t){return new L(e,t.autoTrack,this.api)}},{key:"setGlobal",value:function(e,t){globalThis[t]=e}},{key:"getAppOptions",value:function(){return this.api.getLaunchOptionsSync()}},{key:"showToast",value:function(e){this.api.showToast({title:e,icon:"none",duration:2e3})}}],[{key:"createInstance",value:function(){return this._createInstance("R_CURRENT_PLATFORM")}},{key:"_createInstance",value:function(t){switch(t){case"oppo":return new e(qg,{persistenceName:"gravityengine",persistenceNameOld:"gravityengine_qg_oppo_game"},{mpPlatform:"oppo_qg"});case"huawei":return new e(hbs,{persistenceName:"gravityengine",persistenceNameOld:"gravityengine_qg_huawei_game"},{mpPlatform:"huawei_qg"});case"mz":return new e(qg,{persistenceName:"gravityengine",persistenceNameOld:"gravityengine_qg_mz_game"},{mpPlatform:"mz"});case"xiaomi":return new e(qg,{persistenceName:"gravityengine",persistenceNameOld:"gravityengine_qg"},{mpPlatform:"xiaomi"})}}}]),e}(),F=function(){function e(){c(this,e)}return l(e,null,[{key:"createInstance",value:function(){var e,t=Object.freeze({WECHAT_GAME:104,QQ_PLAY:105,BAIDU_GAME:107,VIVO_GAME:108,OPPO_GAME:109,HUAWEI_GAME:110,XIAOMI_GAME:111,BYTEDANCE_GAME:117,QTT_GAME:116,LINKSURE:119,WECHAT_MINI_GAME:"WECHAT_GAME",BAIDU_MINI_GAME:"BAIDU_MINI_GAME",XIAOMI_QUICK_GAME:"XIAOMI_QUICK_GAME",OPPO_MINI_GAME:"OPPO_MINI_GAME",VIVO_MINI_GAME:"VIVO_MINI_GAME",HUAWEI_QUICK_GAME:"HUAWEI_QUICK_GAME",BYTEDANCE_MINI_GAME:"BYTEDANCE_MINI_GAME",QTT_MINI_GAME:"QTT_MINI_GAME",LINKSURE_MINI_GAME:"LINKSURE_MINI_GAME"});return cc.sys.platform===t.WECHAT_GAME||cc.sys.platform===t.WECHAT_MINI_GAME?R._createInstance("wechat_mg"):cc.sys.platform===t.BAIDU_GAME||cc.sys.platform===t.BAIDU_MIN_GAME?R._createInstance("baidu_mg"):cc.sys.platform===t.VIVO_GAME||cc.sys.platform===t.VIVO_MINI_GAME?M.createInstance():cc.sys.platform===t.QQ_PLAY?R._createInstance("qq_mg"):cc.sys.platform===t.OPPO_GAME||cc.sys.platform===t.OPPO_MINI_GAME?E._createInstance("oppo"):cc.sys.platform===t.HUAWEI_GAME||cc.sys.platform===t.HUAWEI_QUICK_GAME?E._createInstance("huawei"):cc.sys.platform===t.XIAOMI_GAME||cc.sys.platform===t.XIAOMI_QUICK_GAME?E._createInstance("xiaomi"):cc.sys.platform===t.BYTEDANCE_GAME||cc.sys.platform===t.BYTEDANCE_MINI_GAME?R._createInstance("tt_mg"):((e=T.createInstance())._sysCallback=function(){return{system:cc.sys.os.replace(" ","")+" "+cc.sys.osVersion}},e.getNetworkType=function(e){var t={};switch(cc.sys.getNetworkType()){case cc.sys.NetworkType.LAN:t.networkType="WIFI";break;case cc.sys.NetworkType.WWAN:t.networkType="WWAN";break;default:t.networkType="NONE"}e.success(t),e.complete()},e.getSystemInfo=function(t){var o={mp_platform:cc.sys.platform.toString(),system:e._getOs(),screenWidth:window.screen.width,screenHeight:window.screen.height};e._sysCallback&&(o=y.extend(o,e._sysCallback(t))),t.success(o),t.complete()},e)}}]),e}(),x=function(){function e(){c(this,e)}return l(e,null,[{key:"_getCurrentPlatform",value:function(){return this.currentPlatform||(this.currentPlatform=F.createInstance())}},{key:"getConfig",value:function(){return this._getCurrentPlatform().getConfig()}},{key:"getStorage",value:function(e,t,o){return this._getCurrentPlatform().getStorage(e,t,o)}},{key:"setStorage",value:function(e,t){return this._getCurrentPlatform().setStorage(e,t)}},{key:"getSystemInfo",value:function(e){return this._getCurrentPlatform().getSystemInfo(e)}},{key:"getNetworkType",value:function(e){return this._getCurrentPlatform().getNetworkType(e)}},{key:"getQuickDevice",value:function(e){return this._getCurrentPlatform().getQuickDevice(e)}},{key:"onNetworkStatusChange",value:function(e){this._getCurrentPlatform().onNetworkStatusChange(e)}},{key:"request",value:function(e){return this._getCurrentPlatform().request(e)}},{key:"initAutoTrackInstance",value:function(e,t){return this._getCurrentPlatform().initAutoTrackInstance(e,t)}},{key:"setGlobal",value:function(e,t){e&&t&&this._getCurrentPlatform().setGlobal(e,t)}},{key:"getAppOptions",value:function(e){return this._getCurrentPlatform().getAppOptions(e)}},{key:"showDebugToast",value:function(e){this._getCurrentPlatform().showToast(e)}}]),e}(),D=/^\$?[a-zA-Z][a-zA-Z0-9_]{0,49}$/,B=function(){function e(){c(this,e)}return l(e,null,[{key:"stripProperties",value:function(e){return y.isObject(e)&&y.each(e,function(e,t){y.isString(e)||y.isNumber(e)||y.isDate(e)||y.isBoolean(e)||y.isArray(e)||y.isObject(e)||I.warn("Your data -",t,e,"- format does not meet requirements and may not be stored correctly. Attribute values only support String, Number, Date, Boolean, Array, Object")}),e}},{key:"_checkPropertiesKey",value:function(e){var t=!0;return y.each(e,function(e,o){D.test(o)||(I.warn("Invalid KEY: "+o),t=!1)}),t}},{key:"event",value:function(e){return!(!y.isString(e)||!D.test(e))||(I.warn("Check the parameter format. The eventName must start with an English letter and contain no more than 50 characters including letters, digits, and underscores: "+e),!1)}},{key:"propertyName",value:function(e){return!(!y.isString(e)||!D.test(e))||(I.warn("Check the parameter format. PropertyName must start with a letter and contain letters, digits, and underscores (_). The value is a string of no more than 50 characters: "+e),!1)}},{key:"properties",value:function(e){return this.stripProperties(e),!(e&&(y.isObject(e)?!this._checkPropertiesKey(e)&&(I.warn("Check the parameter format. The properties key must start with a letter, contain digits, letters, and underscores (_), and contain a maximum of 50 characters"),1):(I.warn("properties can be none, but it must be an object"),1)))}},{key:"propertiesMust",value:function(e){return this.stripProperties(e),void 0===e||!y.isObject(e)||y.isEmptyObject(e)?(I.warn("properties must be an object with a value"),!1):!!this._checkPropertiesKey(e)||(I.warn("Check the parameter format. The properties key must start with a letter, contain digits, letters, and underscores (_), and contain a maximum of 50 characters"),!1)}},{key:"userId",value:function(e){return!(!y.isString(e)||!/^.{1,64}$/.test(e))||(I.warn("The user ID must be a string of less than 64 characters and cannot be null"),!1)}},{key:"userAddProperties",value:function(e){if(!this.propertiesMust(e))return!1;for(var t in e)if(!y.isNumber(e[t]))return I.warn("The attributes of userAdd need to be Number"),!1;return!0}},{key:"userAppendProperties",value:function(e){if(!this.propertiesMust(e))return!1;for(var t in e)if(!y.isArray(e[t]))return I.warn("The attribute of userAppend must be Array"),!1;return!0}}]),e}(),W=function(){function e(t,o,n,i,r,a){c(this,e),this.data=t,this.serverUrl=o,this.callback=a,this.debugMode=r,this.tryCount=y.isNumber(n)?n:1,this.permissionTryCount=6,this.timeout=y.isNumber(i)?i:3e3,this.taClassName="HttpTask"}return l(e,[{key:"run",value:function(){var e=this,t=y.createExtraHeaders(),o=(t["content-type"]="application/json","debug"===this.debugMode&&(t["Turbo-Debug-Mode"]=1),x.request({url:this.serverUrl,method:"POST",data:this.data,header:t,success:function(t){var o;0===(null==t||null==(o=t.data)?void 0:o.code)?e.onSuccess(t):e.onFailed(t)},fail:function(t){e.onFailed(t)}}));setTimeout(function(){(y.isObject(o)||y.isPromise(o))&&y.isFunction(o.abort)&&o.abort()},this.timeout)}},{key:"onSuccess",value:function(e){var t,o;200===e.statusCode?(o="Data Verified",null!=e&&null!=(t=e.data)&&null!=(t=t.extra)&&null!=(t=t.errors)&&t.length&&(o=e.data.extra.errors),this.callback({code:null==e||null==(t=e.data)?void 0:t.code,msg:o})):this.callback({code:-3,msg:e.statusCode})}},{key:"onFailed",value:function(e){var t,o=this;0<--this.tryCount?setTimeout(function(){o.run()},1e3):this.callback({code:-3,msg:"".concat(null==e||null==(t=e.data)?void 0:t.msg,"\uff1a").concat(null==e||null==(t=e.data)||null==(t=t.extra)?void 0:t.error)})}}]),e}(),U=new(function(){function e(){c(this,e),this.items=[],this.isRunning=!1,this.showDebug=!1}return l(e,[{key:"enqueue",value:function(e,t,o){var n=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],i="debug"===o.debugMode,r=this;e=new W(JSON.stringify(e),t,o.maxRetries,o.sendTimeout,o.debugMode,function(e){r.isRunning=!1,y.isFunction(o.callback)&&o.callback(e),r._runNext(i),i&&I.info("code ".concat(e.code," and msg is ").concat(e.msg))}),!0===n?(this.items.push(e),this._runNext(i)):e.run()}},{key:"_dequeue",value:function(){return this.items.shift()}},{key:"_runNext",value:function(e){if(0<this.items.length&&!this.isRunning)if(this.isRunning=!0,e)this._dequeue().run();else{for(var t=this.items.splice(0,this.items.length),o=(e=t[0],JSON.parse(e.data)),n=1;n<t.length;n++){var i=t[n];i=JSON.parse(i.data),o.event_list=o.event_list.concat(i.event_list)}var r=(new Date).getTime();o.$flush_time=r,new W(JSON.stringify(o),e.serverUrl,e.tryCount,e.timeout,null==e?void 0:e.debugMode,e.callback).run()}}}]),e}()),j={name:"GravityEngine",is_plugin:!1,maxRetries:3,sendTimeout:5e3,enablePersistence:!0,asyncPersistence:!1,strict:!1,debugMode:"none"},G={properties:{$lib_version:d,$lib:"cocoscreator",$scene:"",$today_first_scene:""},getSystemInfo:function(e){var t=this;x.onNetworkStatusChange(function(e){t.properties.$network_type=e.networkType}),x.getNetworkType({success:function(e){t.properties.$network_type=e.networkType},complete:function(){x.getSystemInfo({success:function(e){I.info(JSON.stringify(e,null,4));var o={$manufacturer:e.brand,$brand:e.brand,$model:e.model,$screen_width:Number(e.screenWidth),$screen_height:Number(e.screenHeight),$system_language:e.language,$os:e.platform,$os_version:e.system};y.extend(t.properties,o),y.setMpPlatform(e.mp_platform)},complete:function(){e()}})}})}},H=function(){function e(t,o){var n=this;c(this,e),this.enabled=t.enablePersistence,this.enabled?(t.isChildInstance?(this.name=t.persistenceName+"_"+t.name,this.nameOld=t.persistenceNameOld+"_"+t.name):(this.name=t.persistenceName,this.nameOld=t.persistenceNameOld),t.asyncPersistence?(this._state={},x.getStorage(this.name,!0,function(e){y.isEmptyObject(e)?x.getStorage(n.nameOld,!0,function(e){n._state=y.extend2Layers({},e,n._state),n._init(t,o),n._save()}):(n._state=y.extend2Layers({},e,n._state),n._init(t,o),n._save())})):(this._state=x.getStorage(this.name)||{},y.isEmptyObject(this._state)&&(this._state=x.getStorage(this.nameOld)||{}),this._init(t,o))):(this._state={},this._init(t,o))}return l(e,[{key:"_init",value:function(e,t){this.getDistinctId()||this.setDistinctId(y.UUID()),e.isChildInstance||this.getDeviceId()||this._setDeviceId(y.UUID()),this.initComplete=!0,"function"==typeof t&&t(),t=null==(e=x.getStorage(this.name))?void 0:e.current_first_scene_date;var o=null==e?void 0:e.current_first_scene,n=(new Date).toLocaleDateString();o&&t&&t===n?G.properties.$today_first_scene=String(null==e?void 0:e.current_first_scene):(e=String((null==(o=x.getAppOptions())?void 0:o.scene)||(null==(t=x.getAppOptions())?void 0:t.from)),G.properties.$today_first_scene=e,this._state.current_first_scene=e,this._state.current_first_scene_date=n),this._save()}},{key:"_save",value:function(){this.enabled&&this.initComplete&&x.setStorage(this.name,JSON.stringify(this._state))}},{key:"_set",value:function(e,t){var o,n=this;"string"==typeof e?(o={})[e]=t:"object"===i(e)&&(o=e),y.each(o,function(e,t){n._state[t]=e}),this._save()}},{key:"_get",value:function(e){return this._state[e]}},{key:"setEventTimer",value:function(e,t){var o=this._state.event_timers||{};o[e]=t,this._set("event_timers",o)}},{key:"removeEventTimer",value:function(e){var t=(this._state.event_timers||{})[e];return y.isUndefined(t)||(delete this._state.event_timers[e],this._save()),t}},{key:"getDeviceId",value:function(){return this._state.device_id}},{key:"_setDeviceId",value:function(e){this.getDeviceId()?I.warn("cannot modify the device id."):this._set("device_id",e)}},{key:"getDistinctId",value:function(){return this._state.distinct_id}},{key:"setDistinctId",value:function(e){this._set("distinct_id",e)}},{key:"getAccountId",value:function(){return this._state.account_id}},{key:"setAccountId",value:function(e){this._set("account_id",e)}},{key:"getSuperProperties",value:function(){return this._state.props||{}}},{key:"setSuperProperties",value:function(e,t){t=t?e:y.extend(this.getSuperProperties(),e),this._set("props",t)}}]),e}();function z(){return x.getConfig().persistenceNameOld}m=function(){function e(t){c(this,e),t.appId=y.checkAppId((null==t?void 0:t.clientId)||""),t.accessToken=t.accessToken,t.accessToken||console.warn("GravityAnalytics: accessToken must be required"),t.serverUrl="".concat(h,"/event/collect/?access_token=").concat(t.accessToken);var o=y.extend({},j,x.getConfig());y.isObject(t)?this.config=y.extend(o,t):this.config=o,this._init(this.config)}var t,n,i;return l(e,[{key:"_init",value:function(e){var t=this,o=(this.name=e.name,this.appId=e.clientId,this.accessToken=e.accessToken,e.serverUrl||e.server_url);("GravityEngine_wechat_game"===(this.serverUrl=o,this.serverDebugUrl=o,this.configUrl=o+"/config",this.autoTrackProperties={},this._queue=[],this.config.syncBatchSize=100,this.config.syncInterval=60,e.isChildInstance?this._state={}:(I.enabled="debug"===e.debugMode,this.instances=[],this._state={getSystemInfo:!1,initComplete:!1},G.getSystemInfo(function(){t._updateState({getSystemInfo:!0})}),x.setGlobal(this,this.name)),G.properties.$scene=String((null==(o=x.getAppOptions())?void 0:o.scene)||(null==(o=x.getAppOptions())?void 0:o.from)),this.store=new H(e,function(){t.config.asyncPersistence&&y.isFunction(t.config.persistenceComplete)&&t.config.persistenceComplete(t),t._updateState()}),this.enabled=!y.isBoolean(this.store._get("ge_enabled"))||this.store._get("ge_enabled"),this.isOptOut=!!y.isBoolean(this.store._get("ge_isOptOut"))&&this.store._get("ge_isOptOut"),o=z())||"GravityEngine_tt_game"===o||"GravityEngine_ali_game"===o||o.includes("gravityengine_qg"))&&e.autoTrack.appLaunch&&this.track("$MPLaunch",{$url_query:this.setQuery(this.getQuery())}),!e.isChildInstance&&e.autoTrack&&(this.autoTrack=x.initAutoTrackInstance(this,e))}},{key:"updateConfig",value:function(){}},{key:"initInstance",value:function(t,o){if(!this.config.isChildInstance)return y.isString(t)&&t!==this.name&&y.isUndefined(this[t])?(o=new e(y.extend({},this.config,{enablePersistence:!1,isChildInstance:!0,name:t},o)),this[t]=o,this.instances.push(t),this[t]._state=this._state,o):void I.warn("initInstance() failed due to the name is invalid: "+t);I.warn("initInstance() cannot be called on child instance")}},{key:"lightInstance",value:function(e){return this[e]}},{key:"_setAutoTrackProperties",value:function(e){y.extend(this.autoTrackProperties,e)}},{key:"setupAndStart",value:function(e){if(null!=e&&e.clientId&&(this.config.appId=e.clientId,this.appId=e.clientId),this._state.initComplete)return!1;this._updateState({initComplete:!0})}},{key:"_isReady",value:function(){return this._state.getSystemInfo&&this._state.initComplete&&this.store.initComplete&&this.config.appId&&this.config.accessToken}},{key:"_updateState",value:function(e){var t=this;y.isObject(e)&&y.extend(this._state,e),this._onStateChange(),y.each(this.instances,function(e){t[e]._onStateChange()})}},{key:"_onStateChange",value:function(){var e=this;this._isReady()&&this._queue&&0<this._queue.length&&(y.each(this._queue,function(t){e[t[0]].apply(e,v.call(t[1]))}),this._queue=[])}},{key:"_hasDisabled",value:function(){var e=!this.enabled||this.isOptOut;return e&&I.info("GravityEngine is Pause or Stop!"),e}},{key:"_sendRequest",value:function(e,t,o){var n,i;this._hasDisabled()||(!y.isUndefined(this.config.disableEventList)&&this.config.disableEventList.includes(e.eventName)?I.info("disabled Event : "+e.eventName):(t=y.isDate(t)?t:new Date,(t={event_list:[{type:e.type,time:new Date(t).getTime()}]}).event_list[0].event=e.eventName,"track"===e.type?(t.event_list[0].properties=this.getSendProperties(),n=this.store.removeEventTimer(e.eventName),y.isUndefined(n)||(n=(new Date).getTime()-n,86400<(n=parseFloat((n/1e3).toFixed(3)))?n=86400:n<0&&(n=0),t.event_list[0].properties.$event_duration=n)):t.event_list[0].properties={},y.isObject(e.properties)&&!y.isEmptyObject(e.properties)&&y.extend(t.event_list[0].properties,e.properties),y.searchObjDate(t.event_list[0]),t.client_id=this.appId,I.info(JSON.stringify(t,null,4)),n=this.serverUrl,y.isBoolean(this.config.enableEncrypt)&&1==this.config.enableEncrypt&&(t.event_list[0]=y.generateEncryptyData(t.event_list[0],void 0)),o?(o=new FormData,"debug"===this.config.debugMode?(o.append("source","client"),o.append("appid",this.appId),o.append("deviceId",this.getDeviceId()),o.append("data",JSON.stringify(t.event_list[0]))):(i=y.base64Encode(JSON.stringify(t)),o.append("data",i)),navigator.sendBeacon(n,o),y.isFunction(e.onComplete)&&e.onComplete({statusCode:200})):U.enqueue(t,n,{maxRetries:this.config.maxRetries,sendTimeout:this.config.sendTimeout,callback:e.onComplete,debugMode:this.config.debugMode})))}},{key:"_isObjectParams",value:function(e){return y.isObject(e)&&y.isFunction(e.onComplete)}},{key:"track",value:function(e,t,o,n){var i;this._hasDisabled()||(this._isObjectParams(e)&&(e=(i=e).eventName,t=i.properties,o=i.time,n=i.onComplete),B.event(e)&&B.properties(t)||!this.config.strict?this._internalTrack(e,t,o,n):y.isFunction(n)&&n({code:-1,msg:"invalid parameters"}))}},{key:"_internalTrack",value:function(e,t,o,n,i){this._hasDisabled()||(o=y.isDate(o)?o:new Date,this._isReady()?this._sendRequest({type:"track",eventName:e,properties:t,onComplete:n},o,i):this._queue.push(["_internalTrack",[e,t,o,n]]))}},{key:"userSet",value:function(e,t,o){var n;this._hasDisabled()||(this._isObjectParams(e)&&(e=(n=e).properties,t=n.time,o=n.onComplete),B.propertiesMust(e)||!this.config.strict?(t=y.isDate(t)?t:new Date,this._isReady()?this._sendRequest({type:"profile",eventName:"profile_set",properties:e,onComplete:o},t):this._queue.push(["userSet",[e,t,o]])):(I.warn("calling userSet failed due to invalid arguments"),y.isFunction(o)&&o({code:-1,msg:"invalid parameters"})))}},{key:"userSetOnce",value:function(e,t,o){var n;this._hasDisabled()||(this._isObjectParams(e)&&(e=(n=e).properties,t=n.time,o=n.onComplete),B.propertiesMust(e)||!this.config.strict?(t=y.isDate(t)?t:new Date,this._isReady()?this._sendRequest({type:"profile",eventName:"profile_set_once",properties:e,onComplete:o},t):this._queue.push(["userSetOnce",[e,t,o]])):(I.warn("calling userSetOnce failed due to invalid arguments"),y.isFunction(o)&&o({code:-1,msg:"invalid parameters"})))}},{key:"userAdd",value:function(e,t,o){var n;this._hasDisabled()||(this._isObjectParams(e)&&(e=(n=e).properties,t=n.time,o=n.onComplete),B.propertiesMust(e)||!this.config.strict?(t=y.isDate(t)?t:new Date,this._isReady()?this._sendRequest({type:"profile",eventName:"profile_increment",properties:e,onComplete:o},t):this._queue.push(["userAdd",[e,t,o]])):(I.warn("calling userAdd failed due to invalid arguments"),y.isFunction(o)&&o({code:-1,msg:"invalid parameters"})))}},{key:"userNumberMax",value:function(e,t,o){if(!this._hasDisabled()){var n,i,r;for(i in this._isObjectParams(e)&&(e=(n=e).properties,t=n.time,o=n.onComplete),e)if("number"!=typeof e[i])return r="The key ".concat(i," must be type of number"),console.warn(r),void(y.isFunction(o)&&o({code:-1,msg:r}));B.propertiesMust(e)||!this.config.strict?(t=y.isDate(t)?t:new Date,this._isReady()?this._sendRequest({type:"profile",eventName:"profile_number_max",properties:e,onComplete:o},t):this._queue.push(["userNumberMax",[e,t,o]])):(I.warn("calling userNumberMax failed due to invalid arguments"),y.isFunction(o)&&o({code:-1,msg:"invalid parameters"}))}}},{key:"userNumberMin",value:function(e,t,o){if(!this._hasDisabled()){var n,i,r;for(i in this._isObjectParams(e)&&(e=(n=e).properties,t=n.time,o=n.onComplete),e)if("number"!=typeof e[i])return r="The key ".concat(i," must be type of number"),console.warn(r),void(y.isFunction(o)&&o({code:-1,msg:r}));B.propertiesMust(e)||!this.config.strict?(t=y.isDate(t)?t:new Date,this._isReady()?this._sendRequest({type:"profile",eventName:"profile_number_min",properties:e,onComplete:o},t):this._queue.push(["userNumberMin",[e,t,o]])):(I.warn("calling userNumberMin failed due to invalid arguments"),y.isFunction(o)&&o({code:-1,msg:"invalid parameters"}))}}},{key:"userDel",value:function(e,t){var o,n={};this._hasDisabled()||(this._isObjectParams(n)&&(n=(o=n).properties,e=o.time,t=o.onComplete),B.propertiesMust(n)||!this.config.strict?(e=y.isDate(e)?e:new Date,this._isReady()?this._sendRequest({type:"profile",eventName:"profile_delete",properties:n,onComplete:t},e):this._queue.push(["userDel",[n,e,t]])):(I.warn("calling userDel failed due to invalid arguments"),y.isFunction(t)&&t({code:-1,msg:"invalid parameters"})))}},{key:"userAppend",value:function(e,t,o){var n;this._hasDisabled()||(this._isObjectParams(e)&&(e=(n=e).properties,t=n.time,o=n.onComplete),B.propertiesMust(e)||!this.config.strict?(t=y.isDate(t)?t:new Date,this._isReady()?this._sendRequest({type:"profile",eventName:"profile_append",properties:e,onComplete:o},t):this._queue.push(["userAppend",[e,t,o]])):(I.warn("calling userAppend failed due to invalid arguments"),y.isFunction(o)&&o({code:-1,msg:"invalid parameters"})))}},{key:"userUniqAppend",value:function(e,t,o){var n;this._hasDisabled()||(this._isObjectParams(e)&&(e=(n=e).properties,t=n.time,o=n.onComplete),B.userAppendProperties(e)||!this.config.strict?(t=y.isDate(t)?t:new Date,this._isReady()?this._sendRequest({type:"profile",eventName:"profile_uniq_append",properties:e,onComplete:o},t):this._queue.push(["userUniqAppend",[e,t,o]])):(I.warn("calling userAppend failed due to invalid arguments"),y.isFunction(o)&&o({code:-1,msg:"invalid parameters"})))}},{key:"userUnset",value:function(e,t,o){var n;e=u({},e,null),this._hasDisabled()||(this._isObjectParams(e)&&(e=(n=e).properties,t=n.time,o=n.onComplete),B.propertiesMust(e)||!this.config.strict?(t=y.isDate(t)?t:new Date,this._isReady()?this._sendRequest({type:"profile",eventName:"profile_unset",properties:e,onComplete:o},t):this._queue.push(["userUnset",[e,t,o]])):(I.warn("calling userUnset failed due to invalid arguments"),y.isFunction(o)&&o({code:-1,msg:"invalid parameters"})))}},{key:"uploadQuickAppDeviceInfo",value:function(){var e=this;return new Promise(function(t,n){var i;x.getQuickDevice({success:(i=a(o().mark(function i(r){var a,c;return o().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return a={os_name:"android",android_id:r.user,imei:r.device,oaid:r.device,mac:r.mac,android_version:r.system,api_version:r.osVersionCode,rom:r.vendorOsName,rom_version:r.vendorOsVersion,phone_brand:r.manufacturer,phone_model:r.model},c="".concat(h,"/user/device_info/?access_token=").concat(e.accessToken,"&client_id=").concat(e.appId),o.next=4,e.sendNetWork(c,{data:a});case 4:return c=o.sent,o.abrupt("return",(0===c.code?t:n)(c));case 6:case"end":return o.stop()}},i)})),function(e){return i.apply(this,arguments)})})})}},{key:"uploadQuickGameDeviceInfo",value:function(){var e=this;return new Promise(function(t,n){var i,r=z();x.getQuickDevice({platform:r,success:(i=a(o().mark(function i(r){var a,c;return o().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return a=r,c="".concat(h,"/user/device_info/?access_token=").concat(e.accessToken,"&client_id=").concat(e.appId),o.next=4,e.sendNetWork(c,{data:a});case 4:return c=o.sent,o.abrupt("return",(0===c.code?t:n)(c));case 6:case"end":return o.stop()}},i)})),function(e){return i.apply(this,arguments)})})})}},{key:"logoutEvent",value:function(){this.track("$MPLogout",{})}},{key:"loginEvent",value:function(){this.track("$MPLogin",{})}},{key:"registerEvent",value:function(){"GravityEngine_quick_mp"===z()?this.track("$AppRegister",{}):this.track("$MPRegister",{})}},{key:"payEvent",value:function(e,t,o,n,i){if("number"!=typeof e)throw new Error("pay_amount must be a number");if("string"!=typeof t)throw new Error("pay_type must be a string");if("string"!=typeof o)throw new Error("order_id must be a string");if("string"!=typeof n)throw new Error("pay_reason must be a string");if("string"!=typeof i)throw new Error("pay_method must be a string");this.track("$PayEvent",{$pay_amount:e,$pay_type:t,$order_id:o,$pay_reason:n,$pay_method:i})}},{key:"bindTAThirdPlatform",value:function(e,t){if(!e&&!t)throw new Error("taAccountId or taDistinctId must be required");if(e&&"string"!=typeof e)throw new Error("taAccountId must be a string");if(t&&"string"!=typeof t)throw new Error("taDistinctId must be a string");this.track("$BindThirdPlatform",{$third_platform_type:"ta",$ta_account_id:e,$ta_distinct_id:t})}},{key:"adShowEvent",value:function(e,t,o){var n=z();if("GravityEngine_wechat"===n||"GravityEngine_wechat_game"===n){if("string"!=typeof e)throw new Error("ad_type must be a string");if("string"!=typeof t)throw new Error("ad_unit_id must be a string");n={$ad_type:e,$ad_unit_id:t,$adn_type:"wechat"},"[object Object]"===Object.prototype.toString.call(o)&&Object.assign(n,o),this.track("$AdShow",n)}}},{key:"getQuery",value:function(){try{var e;return null!=x&&x.getAppOptions&&null!=(e=x.getAppOptions())&&e.query?x.getAppOptions().query:{}}catch(e){return{}}}},{key:"setQuery",value:function(e){var t,o=[];for(t in e)e.hasOwnProperty(t)&&o.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return o.join("&")}},{key:"sendNetWork",value:function(e,t){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"POST";return new Promise(function(n,i){x.request({url:e,method:o,data:"string"==typeof t?t:JSON.stringify(t),header:{"content-type":"application/json"},success:function(e){200===e.statusCode||200===e.status?n(e.data):i(e)},fail:function(e){i(e)}})})}},{key:"_errorPromise",value:function(e){return Promise.reject(new Error(e))}},{key:"initializeWithHistoryUserInfo",value:(i=a(o().mark(function e(){var t,n,i=arguments;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=0<i.length&&void 0!==i[0]?i[0]:{},n=1<i.length?i[1]:void 0,e.abrupt("return",this.initialize(t,n));case 3:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},{key:"initialize",value:(n=a(o().mark(function e(){var t,n,i=this,r=arguments;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=0<r.length&&void 0!==r[0]?r[0]:{},n=1<r.length?r[1]:void 0,e.abrupt("return",new Promise(function(){var e=a(o().mark(function e(r,c){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{x.getStorage("is_ge_registered",!0,function(){var e=a(o().mark(function e(a){var s,l,u,p,d,f,m,g,v,_,S;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s="",i._state.initComplete?null!=t&&t.name?null!=t&&t.version||0===(null==t?void 0:t.version)?y.isNumber(null==t?void 0:t.version)&&"number"==typeof(null==t?void 0:t.version)?void 0!==n&&("[object Object]"!==Object.prototype.toString.call(n)?s="history_info must be type: Object":null!=n&&n.company?"string"!=typeof n.company?s="history_info.company must be type: String":null!=n&&n.create_time||0===n.create_time?y.isNumber(n.create_time)&&"number"==typeof n.create_time||(s="history_info.create_time must be type: Number"):s="history_info.create_time must be required":s="history_info.company must be required"):s="version must be type: Number":s="version must be required":s="name must be required":s="initialize must be called after setupAndStart",s)return e.abrupt("return",i._errorPromise(s));e.next=4;break;case 4:return s=i.getQuery(),l=(null==t?void 0:t.channel)||"base_channel",d={client_id:i.appId,name:t.name,channel:l,version:t.version,wx_openid:(null==t?void 0:t.openid)||(null==t?void 0:t.wx_openid)||"",wx_unionid:(null==t?void 0:t.wx_unionid)||"",promoted_object_id:(null==t?void 0:t.promoted_object_id)||"",need_return_attribution:(null==t?void 0:t.enable_sync_attribution)||!1,ad_data:s},n&&(d.history_info=n),p="".concat(h,"/user/initialize/?access_token=").concat(i.accessToken),e.next=11,i.sendNetWork(p,d);case 11:if(0!==(u=e.sent).code)return e.abrupt("return",c(u));e.next=14;break;case 14:return"GravityEngine_quick_mp"===(p=z())?i.uploadQuickAppDeviceInfo():p.includes("gravityengine_qg")&&i.uploadQuickGameDeviceInfo(),d=G.properties,g=new Date,v=g.getFullYear(),_=("0"+(g.getMonth()+1)).slice(-2),S=("0"+g.getDate()).slice(-2),f=("0"+g.getHours()).slice(-2),m=("0"+g.getMinutes()).slice(-2),g=("0"+g.getSeconds()).slice(-2),v="".concat(v,"-").concat(_,"-").concat(S," ").concat(f,":").concat(m,":").concat(g),"Y"!==a&&(i.userSetOnce({$channel:l,$manufacturer:d.$manufacturer,$model:d.$model,$brand:d.$brand,$os:d.$os,$first_visit_time:v,$first_scene:String(null==(_=x.getAppOptions())?void 0:_.scene)}),S=i.setQuery(i.getQuery()),i.track("$MPLaunch",{$url_query:S}),i.track("$MPShow",{$url_query:S})),x.setStorage("is_ge_registered",JSON.stringify("Y")),e.abrupt("return",r(u));case 28:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}catch(e){c(e)}case 1:case"end":return e.stop()}},e)}));return function(t,o){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}},e)})),function(){return n.apply(this,arguments)})},{key:"queryUserInfo",value:(t=a(o().mark(function e(){var t=this;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._state.initComplete){e.next=2;break}return e.abrupt("return",this._errorPromise("queryUserInfo must be called after setupAndStart"));case 2:return e.abrupt("return",new Promise(function(){var e=a(o().mark(function e(n,i){var r;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(h,"/user/get/?access_token=").concat(t.accessToken,"&client_id=").concat(t.appId),e.next=3,t.sendNetWork(r,{},"GET");case 3:return r=e.sent,e.abrupt("return",(0===r.code?n:i)(r));case 5:case"end":return e.stop()}},e)}));return function(t,o){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"authorizeOpenID",value:function(e){this.identify(e)}},{key:"identify",value:function(e){if(!this._hasDisabled()){if("number"==typeof e)e=String(e);else if("string"!=typeof e)return!1;this.store.setDistinctId(e)}}},{key:"getDistinctId",value:function(){return this.store.getDistinctId()}},{key:"login",value:function(e){if(!this._hasDisabled()){if("number"==typeof e)e=String(e);else if("string"!=typeof e)return!1;this.store.setAccountId(e)}}},{key:"getAccountId",value:function(){return this.store.getAccountId()}},{key:"logout",value:function(){this._hasDisabled()||this.store.setAccountId(null)}},{key:"setSuperProperties",value:function(e){this._hasDisabled()||(B.propertiesMust(e)||!this.config.strict?this.store.setSuperProperties(e):I.warn("setSuperProperties parameter must be a valid property value"))}},{key:"registerApp",value:function(e){this.setSuperProperties(e)}},{key:"clearSuperProperties",value:function(){this._hasDisabled()||this.store.setSuperProperties({},!0)}},{key:"unsetSuperProperty",value:function(e){var t;this._hasDisabled()||y.isString(e)&&(delete(t=this.getSuperProperties())[e],this.store.setSuperProperties(t,!0))}},{key:"getSuperProperties",value:function(){return this.store.getSuperProperties()}},{key:"getSendProperties",value:function(){try{var e,t=y.extend({},G.properties,this.autoTrackProperties,this.store.getSuperProperties(),this.dynamicProperties?this.dynamicProperties():{});for(e in t)"string"==typeof t[e]&&(t[e]=t[e].substring(0,8192));return t}catch(e){return{}}}},{key:"getPresetProperties",value:function(){var e=G.properties,t={},o=e.$system_language;return t.system_language=y.isUndefined(o)?"":o,o=e.$os,t.os=y.isUndefined(o)?"":o,o=e.$screen_width,t.screenWidth=y.isUndefined(o)?0:o,o=e.$screen_height,t.screenHeight=y.isUndefined(o)?0:o,o=e.$network_type,t.networkType=y.isUndefined(o)?"":o,o=e.$model,t.deviceModel=y.isUndefined(o)?"":o,o=e.$os_version,t.osVersion=y.isUndefined(o)?"":o,t.deviceId=this.getDeviceId(),o=0-(new Date).getTimezoneOffset()/60,t.zoneOffset=o,o=e.$manufacturer,t.manufacturer=y.isUndefined(o)?"":o,o=e.$manufacturer,t.brand=y.isUndefined(o)?"":o,t.toEventPresetProperties=function(){var e;return{$app_id:this.appId,$model:t.deviceModel,$screen_width:t.screenWidth,$screen_height:t.screenHeight,$system_language:t.system_language,$os:t.os,$os_version:t.osVersion,$network_type:t.networkType,$manufacturer:t.manufacturer,$brand:t.manufacturer,$scene:String((null==(e=x.getAppOptions())?void 0:e.scene)||(null==(e=x.getAppOptions())?void 0:e.from))}},t}},{key:"setDynamicSuperProperties",value:function(e){this._hasDisabled()||("function"==typeof e?B.properties(e())||!this.config.strict?this.dynamicProperties=e:I.warn("A dynamic public property must return a valid property value"):I.warn("setDynamicSuperProperties parameter must be a function type"))}},{key:"timeEvent",value:function(e,t){this._hasDisabled()||(t=y.isDate(t)?t:new Date,this._isReady()?B.event(e)||!this.config.strict?this.store.setEventTimer(e,t.getTime()):I.warn("calling timeEvent failed due to invalid eventName: "+e):this._queue.push(["timeEvent",[e,t]]))}},{key:"getDeviceId",value:function(){return G.properties.$device_id}},{key:"enableTracking",value:function(e){this.enabled=e,this.store._set("ta_enabled",e)}},{key:"optOutTracking",value:function(){this.store.setSuperProperties({},!0),this.store.setDistinctId(y.UUID()),this.store.setAccountId(null),this._queue.splice(0,this._queue.length),this.isOptOut=!0,this.store._set("ge_isOptOut",!0)}},{key:"optOutTrackingAndDeleteUser",value:function(){var e=new Date;this._sendRequest({type:"user_del"},e),this.optOutTracking()}},{key:"optInTracking",value:function(){this.isOptOut=!1,this.store._set("ge_isOptOut",!1)}},{key:"setTrackStatus",value:function(e){switch(e){case"PAUSE":this.eventSaveOnly=!1,this.optInTracking(),this.enableTracking(!1);break;case"STOP":this.eventSaveOnly=!1,this.optOutTracking(!0);break;default:this.eventSaveOnly=!1,this.optInTracking(),this.enableTracking(!0)}}}]),e}();var V={name:"GravityEngine",enableLog:!0,enableNative:!1};return g=function(){function e(t){c(this,e),t.appId=y.checkAppId(t.clientId),t.accessToken=t.accessToken,t.appId?t.accessToken||console.warn("GravityAnalytics: accessToken must be required"):console.warn("GravityAnalytics: clientId must be required"),t.serverUrl="".concat(h,"/event/collect/?access_token=").concat(t.accessToken);var o=y.extend({},V,x.getConfig());y.isObject(t)?this.config=y.extend(o,t):this.config=o,this._init(this.config)}var t;return l(e,[{key:"_isNativePlatform",value:function(){return!(!this._isIOS()&&!this._isAndroid()||!this.config.enableNative)}},{key:"_isIOS",value:function(){return!(!cc.sys.isNative||"iOS"!==cc.sys.os)}},{key:"_isAndroid",value:function(){return!(!cc.sys.isNative||"Android"!==cc.sys.os)}},{key:"_init",value:function(e){this.name=e.name,this.appId=e.clientId,this.accessToken=e.accessToken;var t=e.serverUrl||e.server_url;this.serverUrl=t,this.serverDebugUrl=t+"/data_debug",this.configUrl=t+"/config",this._isNativePlatform()?(this.initInstanceForNative(this.name,e,this.appId),this._readStorage(e)):this.geJs=new GravityAnalyticsAPIForJS(e)}},{key:"_readStorage",value:function(e){var t=this,o=e.persistenceName,n=e.persistenceNameOld;e.isChildInstance&&(o=e.persistenceName+"_"+e.name,n=e.persistenceNameOld+"_"+e.name),this._state=x.getStorage(o)||{},y.isEmptyObject(this._state)&&(this._state=x.getStorage(n)||{}),y.isEmptyObject(this._state)?x.getStorage(o,!0,function(e){y.isEmptyObject(e)?x.getStorage(n,!0,function(e){t._state=y.extend2Layers({},e,t._state)}):t._state=y.extend2Layers({},e,t._state),t._state.distinct_id&&t.identifyForNative(t._state.distinct_id),t._state.account_id&&t.loginForNative(t._state.account_id)}):(this._state.distinct_id&&this.identifyForNative(this._state.distinct_id),this._state.account_id&&this.loginForNative(this._state.account_id))}},{key:"initInstance",value:function(e,t){return this._isNativePlatform()?y.isUndefined(t)?this[e]=new GravityAnalyticsAPI(this.config):this[e]=new GravityAnalyticsAPI(t):this[e]=this.geJs.initInstance(e,t),this[e]}},{key:"lightInstance",value:function(e){return this[e]}},{key:"setupAndStart",value:function(){var e,t;this._isNativePlatform()?(e=window,t=this,e.__autoTrackCallback=function(e){return y.isFunction(t.config.autoTrack.callback)?(e=t.config.autoTrack.callback(e),JSON.stringify(e)):"{}"},this.startGravityAnalyticsForNative()):this.geJs.setupAndStart()}},{key:"track",value:function(e,t,o,n){this._isNativePlatform()?this.trackForNative(e,t,o,this.appId):this.geJs.track(e,t,o,n)}},{key:"initializeWithHistoryUserInfo",value:(t=a(o().mark(function e(){var t,n,i=arguments;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=0<i.length&&void 0!==i[0]?i[0]:{},n=1<i.length?i[1]:void 0,e.abrupt("return",this.geJs.initializeWithHistoryUserInfo(t,n));case 3:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"initialize",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length?arguments[1]:void 0;if(!this._isNativePlatform())return this.geJs.initialize(e,t)}},{key:"queryUserInfo",value:function(){if(!this._isNativePlatform())return this.geJs.queryUserInfo()}},{key:"registerApp",value:function(e){if(!this._isNativePlatform())return this.geJs.registerApp(e)}},{key:"registerEvent",value:function(){if(!this._isNativePlatform())return this.geJs.registerEvent()}},{key:"loginEvent",value:function(){if(!this._isNativePlatform())return this.geJs.loginEvent()}},{key:"logoutEvent",value:function(){if(!this._isNativePlatform())return this.geJs.logoutEvent()}},{key:"payEvent",value:function(e,t,o,n,i){if(!this._isNativePlatform())return this.geJs.payEvent(e,t,o,n,i)}},{key:"bindTAThirdPlatform",value:function(e,t){if(!this._isNativePlatform())return this.geJs.bindTAThirdPlatform(e,t)}},{key:"adShowEvent",value:function(e,t,o){if(!this._isNativePlatform())return this.geJs.adShowEvent(e,t,o)}},{key:"userSet",value:function(e,t,o){this._isNativePlatform()?this.userSetForNative(e,this.appId):this.geJs.userSet(e,t,o)}},{key:"userSetOnce",value:function(e,t,o){this._isNativePlatform()?this.userSetOnceForNative(e,this.appId):this.geJs.userSetOnce(e,t,o)}},{key:"userUnset",value:function(e,t,o){this._isNativePlatform()?this.userUnsetForNative(e,this.appId):this.geJs.userUnset(e,t,o)}},{key:"userDel",value:function(e,t){this._isNativePlatform()?this.userDelForNative(this.appId):this.geJs.userDel(e,t)}},{key:"userAdd",value:function(e,t,o){this._isNativePlatform()?this.userAddForNative(e,this.appId):this.geJs.userAdd(e,t,o)}},{key:"userNumberMax",value:function(e,t,o){this._isNativePlatform()||this.geJs.userNumberMax(e,t,o)}},{key:"userNumberMin",value:function(e,t,o){this._isNativePlatform()||this.geJs.userNumberMin(e,t,o)}},{key:"userAppend",value:function(e,t,o){this._isNativePlatform()?this.userAppendForNative(e,this.appId):this.geJs.userAppend(e,t,o)}},{key:"userUniqAppend",value:function(e,t,o){this._isNativePlatform()?this.userUniqAppendForNative(e,this.appId):this.geJs.userUniqAppend(e,t,o)}},{key:"authorizeOpenID",value:function(e){this.identify(e)}},{key:"identify",value:function(e){this._isNativePlatform()?this.identifyForNative(e,this.appId):this.geJs.identify(e)}},{key:"getDistinctId",value:function(){return this._isNativePlatform()?this.getDistinctIdForNative(this.appId):this.geJs.getDistinctId()}},{key:"login",value:function(e){this._isNativePlatform()?this.loginForNative(e,this.appId):this.geJs.login(e)}},{key:"getAccountId",value:function(){return this._isNativePlatform()?this.getAccountIdForNative(this.appId):this.geJs.getAccountId()}},{key:"logout",value:function(){this._isNativePlatform()?this.logoutForNative(this.appId):this.geJs.logout()}},{key:"setSuperProperties",value:function(e){this._isNativePlatform()?this.setSuperPropertiesForNative(e,this.appId):this.geJs.setSuperProperties(e)}},{key:"clearSuperProperties",value:function(){this._isNativePlatform()?this.clearSuperPropertiesForNative(this.appId):this.geJs.clearSuperProperties()}},{key:"unsetSuperProperty",value:function(e){this._isNativePlatform()?this.unsetSuperPropertyForNative(e,this.appId):this.geJs.unsetSuperProperty(e)}},{key:"getSuperProperties",value:function(){return this._isNativePlatform()?this.getSuperPropertiesForNative(this.appId):this.geJs.getSuperProperties()}},{key:"getPresetProperties",value:function(){var e,t,o,n;return this._isNativePlatform()?(e=this.getPresetPropertiesForNative(this.appId),t={},n=e.$system_language,t.system_language=y.isUndefined(n)?"":n,n=e.$os,t.os=y.isUndefined(n)?"":n,n=e.$screen_width,t.screenWidth=y.isUndefined(n)?0:n,n=e.$screen_height,t.screenHeight=y.isUndefined(n)?0:n,n=e.$network_type,t.networkType=y.isUndefined(n)?"":n,n=e.$device_model,t.deviceModel=y.isUndefined(n)?"":n,n=e.$os_version,t.osVersion=y.isUndefined(n)?"":n,t.deviceId=this.getDeviceId(),o=0-(new Date).getTimezoneOffset()/60,t.zoneOffset=o,n=e.$manufacturer,t.manufacturer=y.isUndefined(n)?"":n,n=e.$manufacturer,t.brand=y.isUndefined(n)?"":n,t.toEventPresetProperties=function(){return{$device_model:t.deviceModel,$device_id:t.deviceId,$screen_width:t.screenWidth,$screen_height:t.screenHeight,$system_language:t.system_language,$os:t.os,$os_version:t.osVersion,$network_type:t.networkType,$zone_offset:o,$manufacturer:t.manufacturer,$brand:t.manufacturer}},t):this.geJs.getPresetProperties()}},{key:"setDynamicSuperProperties",value:function(e){this._isNativePlatform()?"function"==typeof e?(this.dynamicProperties=e,window.__dynamicPropertiesForNative=function(t){return console.log("__dynamicPropertiesForNative: native msg: ",t),t=e(),t=y.encodeDates(t),JSON.stringify(t)},this.setDynamicSuperPropertiesForNative("__dynamicPropertiesForNative")):logger.warn("setDynamicSuperProperties parameter must be a function type"):this.geJs.setDynamicSuperProperties(e)}},{key:"timeEvent",value:function(e,t){return this._isNativePlatform()?this.timeEventForNative(e,this.appId):this.geJs.timeEvent(e,t)}},{key:"getDeviceId",value:function(){return this._isNativePlatform()?this.getDeviceIdForNative(this.appId):this.geJs.getDeviceId()}},{key:"enableTracking",value:function(e){this._isNativePlatform()?this.enableTrackingForNative(e,this.appId):this.geJs.enableTracking(e)}},{key:"optOutTracking",value:function(){this._isNativePlatform()?this.optOutTrackingForNative(this.appId):this.geJs.optOutTracking()}},{key:"optOutTrackingAndDeleteUser",value:function(){this._isNativePlatform()?this.optOutTrackingAndDeleteUserForNative(this.appId):this.geJs.optOutTrackingAndDeleteUser()}},{key:"optInTracking",value:function(){this._isNativePlatform()?this.optInTrackingForNative(this.appId):this.geJs.optInTracking()}},{key:"setTrackStatus",value:function(e){this._isNativePlatform()?this.setTrackStatusForNative(e,this.appId):this.geJs.setTrackStatus(e)}},{key:"trackForNative",value:function(e,t,o,n){o=y.isDate(o)?y.formatDate(o):"",y.isUndefined(t)&&(t={}),t=y.extend(t,this.dynamicProperties?this.dynamicProperties():{}),t=y.encodeDates(t),this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","track","(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V",e,JSON.stringify(t),o,n):this._isIOS()&&jsb.reflection.callStaticMethod("CocosCreatorProxyApi","track:properties:time:appId:",e,JSON.stringify(t),o,n)}},{key:"timeEventForNative",value:function(e,t){this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","timeEvent","(Ljava/lang/String;Ljava/lang/String;)V",e,t):this._isIOS()&&jsb.reflection.callStaticMethod("CocosCreatorProxyApi","timeEvent:appId:",e,t)}},{key:"loginForNative",value:function(e,t){this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","login","(Ljava/lang/String;Ljava/lang/String;)V",e,t):this._isIOS()&&jsb.reflection.callStaticMethod("CocosCreatorProxyApi","login:appId:",e,t)}},{key:"logoutForNative",value:function(e){this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","logout","(Ljava/lang/String;)V",e):this._isIOS()&&jsb.reflection.callStaticMethod("CocosCreatorProxyApi","logout:",e)}},{key:"setSuperPropertiesForNative",value:function(e,t){e=y.encodeDates(e),this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","setSuperProperties","(Ljava/lang/String;Ljava/lang/String;)V",JSON.stringify(e),t):this._isIOS()&&jsb.reflection.callStaticMethod("CocosCreatorProxyApi","setSuperProperties:appId:",JSON.stringify(e),t)}},{key:"getSuperPropertiesForNative",value:function(e){var t="{}";return this._isAndroid()?t=jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","getSuperProperties","(Ljava/lang/String;)V",e):this._isIOS()&&(t=jsb.reflection.callStaticMethod("CocosCreatorProxyApi","getSuperProperties:",e)),JSON.parse(t)}},{key:"unsetSuperPropertyForNative",value:function(e,t){this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","unsetSuperProperty","(Ljava/lang/String;Ljava/lang/String;)V",e,t):this._isIOS()&&jsb.reflection.callStaticMethod("CocosCreatorProxyApi","unsetSuperProperty:appId:",e,t)}},{key:"clearSuperPropertiesForNative",value:function(e){this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","clearSuperProperties","(Ljava/lang/String;)V",e):this._isIOS()&&jsb.reflection.callStaticMethod("CocosCreatorProxyApi","clearSuperProperties:",e)}},{key:"userSetForNative",value:function(e,t){e=y.encodeDates(e),this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","userSet","(Ljava/lang/String;Ljava/lang/String;)V",JSON.stringify(e),t):this._isIOS()&&jsb.reflection.callStaticMethod("CocosCreatorProxyApi","userSet:appId:",JSON.stringify(e),t)}},{key:"userSetOnceForNative",value:function(e,t){e=y.encodeDates(e),this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","userSetOnce","(Ljava/lang/String;Ljava/lang/String;)V",JSON.stringify(e),t):this._isIOS()&&jsb.reflection.callStaticMethod("CocosCreatorProxyApi","userSetOnce:appId:",JSON.stringify(e),t)}},{key:"userAppendForNative",value:function(e,t){e=y.encodeDates(e),this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","userAppend","(Ljava/lang/String;Ljava/lang/String;)V",JSON.stringify(e),t):this._isIOS()&&jsb.reflection.callStaticMethod("CocosCreatorProxyApi","userAppend:appId:",JSON.stringify(e),t)}},{key:"userUniqAppendForNative",value:function(e,t){e=y.encodeDates(e),this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","userUniqAppend","(Ljava/lang/String;Ljava/lang/String;)V",JSON.stringify(e),t):this._isIOS()&&jsb.reflection.callStaticMethod("CocosCreatorProxyApi","userUniqAppend:appId:",JSON.stringify(e),t)}},{key:"userAddForNative",value:function(e,t){e=y.encodeDates(e),this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","userAdd","(Ljava/lang/String;Ljava/lang/String;)V",JSON.stringify(e),t):this._isIOS()&&jsb.reflection.callStaticMethod("CocosCreatorProxyApi","userAdd:appId:",JSON.stringify(e),t)}},{key:"userUnsetForNative",value:function(e,t){this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","userUnset","(Ljava/lang/String;Ljava/lang/String;)V",e,t):this._isIOS()&&jsb.reflection.callStaticMethod("CocosCreatorProxyApi","userUnset:appId:",e,t)}},{key:"userDelForNative",value:function(e){this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","userDel","(Ljava/lang/String;)V",e):this._isIOS()&&jsb.reflection.callStaticMethod("CocosCreatorProxyApi","userDel:",e)}},{key:"authorizeOpenIDForNative",value:function(e,t){this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","authorizeOpenID","(Ljava/lang/String;Ljava/lang/String;)V",e,t):this._isIOS()&&jsb.reflection.callStaticMethod("CocosCreatorProxyApi","authorizeOpenID:appId:",e,t)}},{key:"identifyForNative",value:function(e,t){this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","identify","(Ljava/lang/String;Ljava/lang/String;)V",e,t):this._isIOS()&&jsb.reflection.callStaticMethod("CocosCreatorProxyApi","identify:appId:",e,t)}},{key:"initInstanceForNative",value:function(e,t,o){this._isAndroid()?(jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","setCustomerLibInfo","(Ljava/lang/String;Ljava/lang/String;)V",f,d),y.isUndefined(t)?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","initInstanceAppId","(Ljava/lang/String;Ljava/lang/String;)V",e,o):jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","initInstanceConfig","(Ljava/lang/String;Ljava/lang/String;)V",e,JSON.stringify(t))):this._isIOS()&&(jsb.reflection.callStaticMethod("CocosCreatorProxyApi","setCustomerLibInfoWithLibName:libVersion:",f,d),y.isUndefined(t)?jsb.reflection.callStaticMethod("CocosCreatorProxyApi","initInstance:appId:",e,o):jsb.reflection.callStaticMethod("CocosCreatorProxyApi","initInstance:config:",e,JSON.stringify(t)))}},{key:"lightInstanceForNative",value:function(e,t){return this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","lightInstance","(Ljava/lang/String;Ljava/lang/String;)V",e,t):this._isIOS()?jsb.reflection.callStaticMethod("CocosCreatorProxyApi","lightInstance:appId:",e,t):void 0}},{key:"startGravityAnalyticsForNative",value:function(e){this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","startGravityAnalytics","(Ljava/lang/String;)V",e):this._isIOS()&&jsb.reflection.callStaticMethod("CocosCreatorProxyApi","startGravityAnalytics:",e)}},{key:"setDynamicSuperPropertiesForNative",value:function(e,t){this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","setDynamicSuperProperties","(Ljava/lang/String;Ljava/lang/String;)V",e,t):this._isIOS()&&jsb.reflection.callStaticMethod("CocosCreatorProxyApi","setDynamicSuperProperties:appId:",e,t)}},{key:"getDeviceIdForNative",value:function(e){return this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","getDeviceId","(Ljava/lang/String;)Ljava/lang/String;",e):this._isIOS()?jsb.reflection.callStaticMethod("CocosCreatorProxyApi","getDeviceId:",e):void 0}},{key:"getDistinctIdForNative",value:function(e){return this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","getDistinctId","(Ljava/lang/String;)Ljava/lang/String;",e):this._isIOS()?jsb.reflection.callStaticMethod("CocosCreatorProxyApi","getDistinctId:",e):void 0}},{key:"getAccountIdForNative",value:function(e){return this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","getAccountId","(Ljava/lang/String;)Ljava/lang/String;",e):this._isIOS()?jsb.reflection.callStaticMethod("CocosCreatorProxyApi","getAccountId:",e):void 0}},{key:"getPresetPropertiesForNative",value:function(e){var t="{}";return this._isAndroid()?t=jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","getPresetProperties","(Ljava/lang/String;)Ljava/lang/String;",e):this._isIOS()&&(t=jsb.reflection.callStaticMethod("CocosCreatorProxyApi","getPresetProperties:",e)),JSON.parse(t)}},{key:"enableTrackingForNative",value:function(e,t){this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","enableTracking","(Ljava/lang/String;Ljava/lang/String;)V",e.toString(),t):this._isIOS()&&jsb.reflection.callStaticMethod("CocosCreatorProxyApi","enableTracking:appId:",e.toString(),t)}},{key:"optOutTrackingForNative",value:function(e){this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","optOutTracking","(Ljava/lang/String;)V",e):this._isIOS()&&jsb.reflection.callStaticMethod("CocosCreatorProxyApi","optOutTracking:",e)}},{key:"optOutTrackingAndDeleteUserForNative",value:function(e){this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","optOutTrackingAndDeleteUser","(Ljava/lang/String;)V",e):this._isIOS()&&jsb.reflection.callStaticMethod("CocosCreatorProxyApi","optOutTrackingAndDeleteUser:",e)}},{key:"optInTrackingForNative",value:function(e){this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","optInTracking","(Ljava/lang/String;)V",e):this._isIOS()&&jsb.reflection.callStaticMethod("CocosCreatorProxyApi","optInTracking:",e)}},{key:"setTrackStatusForNative",value:function(e,t){this._isAndroid()?jsb.reflection.callStaticMethod("com/cocos/game/CocosCreatorProxyApi","setTrackStatus","(Ljava/lang/String;Ljava/lang/String;)V",e,t):this._isIOS()&&jsb.reflection.callStaticMethod("CocosCreatorProxyApi","setTrackStatus:appId:",e,t)}}]),e}(),window.GravityAnalyticsAPI=g,window.GravityAnalyticsAPIForJS=m,g}),cc._RF.pop()},{"./helpers/Arrayincludes":"Arrayincludes","./helpers/typeof":"typeof"}],guideCtrl_SS:[function(e,t,o){"use strict";cc._RF.push(t,"953371J2lNOUrPsWHn4OZri","guideCtrl_SS");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"953371J2lNOUrPsWHn4OZri","guideCtrl_SS");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("ScrewSortGame_SS"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.light=null,t.finger=null,t}return s(t,e),t.prototype.start=function(){var e=cc.v2(u.default.instance.steelLayer.children[0].getPosition().x,0),t=(cc.v2(u.default.instance.steelLayer.children[1].getPosition().x,0),cc.v2(u.default.instance.steelLayer.children[2].getPosition().x,0));this.playGuideAnim(e,t)},t.prototype.playGuideAnim=function(e,t){var o=this;this._resetState(e),cc.tween(this.finger).to(.5,{scale:1.2,opacity:255}).delay(.25).call(function(){o._playClickAnim(o.light,o.finger,function(){cc.tween(o.node).to(.5,{x:t.x}).call(function(){o._playClickAnim(o.light,o.finger,function(){cc.tween(o.finger).to(.5,{opacity:0}).call(function(){o.playGuideAnim(e,t)}).start()})}).start()})}).start()},t.prototype._resetState=function(e){this.node.setPosition(e),this.node.opacity=255,this.node.scale=1,this.light.opacity=0,this.light.scale=0,this.finger.opacity=0,this.finger.scale=1.2},t.prototype._playClickAnim=function(e,t,o){cc.tween(t).to(.5,{scale:.9}).start(),cc.tween(e).delay(.25).to(.25,{scale:1,opacity:255}).delay(.5).call(function(){cc.tween(t).to(.5,{scale:1.2}).start(),cc.tween(e).to(.5,{scale:0,opacity:0}).call(function(){o&&o()}).start()}).start()},l([f(cc.Node)],t.prototype,"light",void 0),l([f(cc.Node)],t.prototype,"finger",void 0),l([d],t)}(cc.Component);r.default=h,cc._RF.pop(),cc._RF.pop()},{}],index:[function(t,o,n){"use strict";cc._RF.push(o,"117e2vZCChL2p8iLfx+VMTp","index");var r=t,a=o,c=n;function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e){return"function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?o.exports=l=function(e){return s(e)}:o.exports=l=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)},l(e)}function u(e,t,o){return(t=P(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function p(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return f(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&function(e,t){(Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}(e,t)}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=v(e);if(t){var i=v(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return m(this,o)}}function m(e,t){if(t&&("object"===_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return g(e)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(t){return(_="function"==typeof Symbol&&"symbol"==l(Symbol.iterator)?function(e){return l(e)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":e(t)})(t)}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P(n.key),n)}}function C(e,t,o){return t&&b(e.prototype,t),o&&b(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function P(e){var t=function(e){if("object"!==_(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,"string");if("object"!==_(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===_(t)?t:String(t)}cc._RF.push(a,"117e2vZCChL2p8iLfx+VMTp","index"),c.__esModule=!0,c.SDK=void 0;var k,w,I="LOCAL_ID",T="CLICK_ID",A="QUEUE_LOST_MAP",O="REMOTE_CONFIG",R="REMOTE_COMMON_CONFIG",N="OPENID",M={init:"init",reporting:"reporting",fail:"fail"},L={maxSdkInstance:4,maxQueueLength:500,actionParamMaxLength:1e4,autoTrack:!0,reportThreshold:5,reportDelay:1,inspectDelay:30,cgiBatchSize:50,requestConcurrency:4,requestTimeout:1e4,signVersion:"1.0",realTimeActionList:["START_APP","REGISTER","PURCHASE"]},E="JS_RUN_ERROR",F="REQUEST_ERROR",x="REQUEST_CONFIG_ERROR",D="PROXY_ERROR",B="UNKNOWN",W="TRUE",U="FALSE",j="TICKET_INTERVAL_CHANGE",G=(w=function(e){return"".concat("@dn-sdk/minigame","_").concat("production","_").concat(e)},{getSync:function(e){var t;try{t=wx.getStorageSync(w(e))}catch(e){return console.error("storage get error",e),t}return t},setSync:function(e,t){try{wx.setStorageSync(w(e),t)}catch(e){return console.error("storage set error",e),!1}return!0}}),H=function(){var e;return function(){if(!e){var t=function(){if(k)return k;try{return k=wx.getSystemInfoSync()}catch(e){return{}}}(),o=t.system,n=void 0===o?"":o,i=(null==n?void 0:n.split(" "))||[],r=function(e){if(!e)return B;var t=(null==e?void 0:e.toUpperCase())||"";return t.indexOf("ANDROID")>-1?"ANDROID":t.indexOf("IOS")>-1?"IOS":t.indexOf("MAC")>-1?"OSX":t.indexOf("WINDOWS")>-1?"WINDOWS":B}(i[0]),a=function(e){return!e||e.length<=0?"":2===e.length?e[1]:3===e.length&&"Windows"===e[0]?"".concat(e[1]," ").concat(e[2]):e[e.length-1]}(i);e={benchmark_level:t.benchmarkLevel,device_brand:t.brand,screen_height:Math.floor(t.screenHeight),screen_width:Math.floor(t.screenWidth),wx_lib_version:t.SDKVersion,wx_version:t.version,wx_platform:t.platform,device_model:t.model,os:r,os_version:a}}return e}}(),z=function(){var e;return function(){try{if(e)return e;e||(e=G.getSync(I)||""),e||(e=ae(),G.setSync(I,e))}catch(e){}return e}}(),V=function(){var e="unknown",t=!1;return function(){if(!t)try{wx.getNetworkType({success:function(t){e=t.networkType},fail:function(){e="unknown"}}),wx.onNetworkStatusChange(function(t){e=t.networkType}),t=!0}catch(e){}return e}}();V();var q=function(){var e="";return function(){return e||(e=G.getSync(N)||""),e}}(),X=function(){var e;return function(){if(e)return e;try{var t=wx.getAccountInfoSync();return oe(t.miniProgram)?e=t.miniProgram:{}}catch(t){return{}}}}();function J(e){var t=null==e?void 0:e.query;if(!oe(t))return"";var o="";return t.gdt_vid||[1045,1046,1084].indexOf(null==e?void 0:e.scene)>-1?o="TENCENT":t.clue_token||t.clickid&&t.item_id?o="BYTEDANCE":t.callback&&"kuaishou"===t.ksChannel?o="KUAISHOU":t.bd_vid||t.ai&&t.d&&t.q&&t.c?o="BAIDU":t.uctrackid?o="ALIBABA":(t.trackid||t.imp||[1065,1069,1194].indexOf(null==e?void 0:e.scene)>-1&&(t.callback||t.u))&&(o="OTHERS"),o}function K(e,t){try{var o=H(),n=X(),i={sdk_version:"1.5.6",sdk_name:"@dn-sdk/minigame",device_brand:null==o?void 0:o.device_brand,device_model:null==o?void 0:o.device_model,wx_version:null==o?void 0:o.wx_version,wx_lib_version:null==o?void 0:o.wx_lib_version,wx_platform:null==o?void 0:o.wx_platform,os:null==o?void 0:o.os,os_version:null==o?void 0:o.os_version,local_id:z(),env_version:null==n?void 0:n.envVersion,appid:null==n?void 0:n.appId},r=Object.assign(i,e);wx.request({url:"https://api.datanexus.qq.com/data-nexus-trace/log",data:r,method:"POST",timeout:L.requestTimeout,success:function(e){"function"==typeof t&&200===(null==e?void 0:e.statusCode)&&t()}})}catch(o){me.error(o)}}var Y=function(){function e(){S(this,e)}return C(e,null,[{key:"revise",value:function(e){e>0&&!this.isRevised&&(this.offsetTime=e-Date.now(),this.isRevised=!0)}},{key:"getRevisedcurrentTimeMillis",value:function(){return this.isRevised?Date.now()+this.offsetTime:-1}}]),e}();function Q(e){return new Promise(function(t,o){wx.request({method:"POST",url:"https://api.datanexus.qq.com/data-nexus-config/v1/sdk/config/get",data:e,timeout:L.requestTimeout,success:function(e){Z(e,t,"config/get",o),ee(e)},fail:function(e){$(e,"config/get",o)}})})}function Z(e,t,o,n){var i,r,a,c,s=null==e?void 0:e.statusCode,l=null==(i=null==e?void 0:e.data)?void 0:i.code;if(200!==s||0!==l){var u=l;200!==s&&(u="number"==typeof s?-1*s:-888),K({log_type:x,message:"cgiName: ".concat(o,", statusCode: ").concat(s,", code: ").concat(l,", traceid: ").concat(null==(a=null==e?void 0:e.data)?void 0:a.trace_id),code:u}),null==n||n(null==(c=null==e?void 0:e.data)?void 0:c.data)}else t(null==(r=e.data)?void 0:r.data)}function $(e,t,o){K({log_type:x,message:"cgiName: ".concat(t," , message: ").concat(null==e?void 0:e.errMsg," "),code:"number"==typeof(null==e?void 0:e.errno)?-1*e.errno:-999}),null==o||o(e)}function ee(e){var t,o=1*(null==(t=null==e?void 0:e.header)?void 0:t["Server-Time"]);o>17266752e5&&Y.revise(o)}Y.offsetTime=0,Y.isRevised=!1;var te=Object.prototype.toString,oe=function(e){return"[object Object]"===te.call(e)},ne=function(e){return"[object Array]"===te.call(e)},ie=function(e){return"[object Function]"===te.call(e)},re=(new Date).getTime();function ae(){var e=(new Date).getTime(),t=Math.abs(1e3*(e-re));return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(o){var n=16*Math.random();return e>0?(n=(e+n)%16|0,e=Math.floor(e/16)):(n=(t+n)%16|0,t=Math.floor(t/16)),("x"===o?n:3&n|8).toString(16).replace(/-/g,"")})}var ce=/^v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+))?(?:-[\da-z\-]+(?:\.[\da-z\-]+)*)?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,se=function(e){if("string"!=typeof e)throw new TypeError("Invalid argument expected string");if(!ce.test(e))throw new Error("Invalid argument not valid semver ('".concat(e,"' received)"))},le=function(e){return isNaN(Number(e))?e:Number(e)},ue=function(e){var t=e.replace(/^v/,"").replace(/\+.*$/,""),o=function(e){return-1===e.indexOf("-")?e.length:e.indexOf("-")}(t),n=t.substring(0,o).split(".");return n.push(t.substring(o+1)),n},pe=function(e,t){[e,t].forEach(se);for(var o=ue(e),n=ue(t),i=0;i<Math.max(o.length-1,n.length-1);i++){var r=parseInt(o[i]||"0",10),a=parseInt(n[i]||"0",10);if(r>a)return 1;if(a>r)return-1}var c=o[o.length-1],s=n[n.length-1];if(c&&s)for(var l=c.split(".").map(le),u=s.split(".").map(le),p=0;p<Math.max(l.length,u.length);p++){if(void 0===l[p]||"string"==typeof u[p]&&"number"==typeof l[p])return-1;if(void 0===u[p]||"string"==typeof l[p]&&"number"==typeof u[p]||l[p]>u[p])return 1;if(u[p]>l[p])return-1}else if(c||s)return c?-1:1;return 0};function de(e){return fe()[e]}function fe(){return L}function he(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var ye=function(e){try{return e&&"string"==typeof e?-1===(e=e.replace(/\s/g,"")).indexOf(".")?e:e.split(".").slice(0,2).join("."):""}catch(r){return e}},me=function(){function e(){S(this,e)}return C(e,null,[{key:"error",value:function(e){for(var t,o=arguments.length,n=new Array(o>1?o-1:0),i=1;i<o;i++)n[i-1]=arguments[i];(t=console).error.apply(t,["".concat("[@dn-sdk/minigame v1.5.6]",": ").concat(e)].concat(n))}},{key:"info",value:function(t){for(var o,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];e.debug&&(o=console).info.apply(o,["".concat("[@dn-sdk/minigame v1.5.6]",": ").concat(t)].concat(i))}},{key:"log",value:function(t){for(var o,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];e.debug&&(o=console).log.apply(o,["".concat("[@dn-sdk/minigame v1.5.6]",": ").concat(t)].concat(i))}},{key:"warn",value:function(e){for(var t,o=arguments.length,n=new Array(o>1?o-1:0),i=1;i<o;i++)n[i-1]=arguments[i];(t=console).warn.apply(t,["".concat("[@dn-sdk/minigame v1.5.6]",": ").concat(e)].concat(n))}},{key:"devLog",value:function(t){for(var o,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];e.isDev&&(o=console).log.apply(o,["".concat("[@dn-sdk/minigame v1.5.6]",": ").concat(t)].concat(i))}}]),e}();me.debug=!1,me.isDev=!1;var ge=function(){var e;return function(){if(!e)try{var t=wx.getLaunchOptionsSync(),o=t.query.gdt_vid||"";o?G.setSync(T,o):o=G.getSync(T)||"";var n=JSON.stringify(t);n.length>1e4&&(n=JSON.stringify({cut:1,scene:t.scene})),e={source_scene:t.scene,pkg_channel_id:t.query.wxgamepro||"",ad_trace_id:o,launch_options:n,channel:J(t)}}catch(t){e={},me.log("\u83b7\u53d6\u573a\u666f\u503c\u548c\u6e20\u9053\u53f7\u5931\u8d25",t)}return e}}();function ve(e,t,o){var n=o.value;return o.value=function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];try{return n.apply(this,i)}catch(o){try{me.error.apply(me,["calling ".concat(e.constructor.name,".").concat(t," error with arguments")].concat(i)),me.error(o);var a={log_type:E,message:"[safeExcutable] ".concat(e.constructor.name,".").concat(t,": ").concat(null==o?void 0:o.message),err_stack:null==o?void 0:o.stack};ie(this.reportLog)?this.reportLog(a):K(a)}catch(a){}}},o}var _e=Object.defineProperty,Se=Object.getOwnPropertyDescriptor,be=function(e,t,o,n){for(var i,r=n>1?void 0:n?Se(t,o):t,a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n?i(t,o,r):i(r))||r);return n&&r&&_e(t,o,r),r},Ce=function(){function e(t){var o=t.userActionSetId,n=t.maxLength,i=void 0===n?500:n;S(this,e),this.lostActionMaps={},this.stack=[],this.localStorageKey="",this.localStorageKey="".concat("QUEUE_ACTIONS","_").concat(null==o?void 0:o.toString()),this.maxLength=i,this.userActionSetId=o,this.setTimeStamp(),this.init()}return C(e,[{key:"getItems",value:function(){return this.stack}},{key:"getStorage",value:function(){var e,t=(null==(e=G)?void 0:e.getSync(this.localStorageKey))||"[]";return JSON.parse(t)}},{key:"reportLostNum",value:function(){var e=this,t=Object.assign({},this.lostActionMaps),o=[];for(var n in t){var i=null==n?void 0:n.split("_");o.push({queue_lost_session_id:i[0],queue_lost_timestamp:i[1],queue_lost_num:t[n]})}o.length&&(this.setTimeStamp(),o.forEach(function(t){var o=Object.assign({},{user_action_set_id:e.userActionSetId,log_type:"QUEUE_LOST_NUM"},t),n=null==t?void 0:t.queue_lost_session_id,i=null==t?void 0:t.queue_lost_timestamp,r="".concat(n,"_").concat(i);K(o,function(){he(e.lostActionMaps,r)&&(delete e.lostActionMaps[r],G.setSync(A,JSON.stringify(e.lostActionMaps)))})}))}},{key:"getLostMaps",value:function(){return this.lostActionMaps}},{key:"init",value:function(){var e=this,t=this.getStorage(),o=null==t?void 0:t.map(function(e){var t,o;return e.inner_status===(null==(t=M)?void 0:t.reporting)?Object.assign({},e,{inner_status:null==(o=M)?void 0:o.fail,is_retry:!0,retry_count:e.retry_count+1}):e});this.stack=o,this.lostActionMaps=JSON.parse(G.getSync(A)||"{}"),setTimeout(function(){e.reportLostNum()},1e3)}},{key:"addItem",value:function(e){var t;null==(t=null==this?void 0:this.stack)||t.push(e)}},{key:"removeItems",value:function(e){var t,o=null==(t=null==this?void 0:this.stack)?void 0:t.filter(function(t){return!(null!=e&&e.includes(null==t?void 0:t.action_id))});this.stack=o}},{key:"updateForReportFail",value:function(e){var t;this.stack=null==(t=this.stack)?void 0:t.map(function(t){var o;return null!=e&&e.includes(null==t?void 0:t.action_id)?Object.assign({},t,{inner_status:null==(o=M)?void 0:o.fail,retry_count:t.retry_count+1,is_retry:!0}):t})}},{key:"updateForReporting",value:function(e){var t;this.stack=null==(t=this.stack)?void 0:t.map(function(t){var o;return null!=e&&e.includes(null==t?void 0:t.action_id)?Object.assign({},t,{inner_status:null==(o=M)?void 0:o.reporting}):t})}},{key:"updateAllStack",value:function(e){this.stack=e}},{key:"updateToStorage",value:function(){G.setSync(this.localStorageKey,JSON.stringify(this.stack))}},{key:"updateLostAction",value:function(e){if(e){var t="".concat(e,"_").concat(this.timeStamp),o=this.lostActionMaps[t]||0;this.lostActionMaps[t]=o+1,G.setSync(A,JSON.stringify(this.lostActionMaps))}}},{key:"setTimeStamp",value:function(){this.timeStamp=Date.now().toString()}}]),e}();be([ve],Ce.prototype,"getItems",1),be([ve],Ce.prototype,"getStorage",1),be([ve],Ce.prototype,"reportLostNum",1),be([ve],Ce.prototype,"getLostMaps",1),be([ve],Ce.prototype,"init",1),be([ve],Ce.prototype,"addItem",1),be([ve],Ce.prototype,"removeItems",1),be([ve],Ce.prototype,"updateForReportFail",1),be([ve],Ce.prototype,"updateForReporting",1),be([ve],Ce.prototype,"updateAllStack",1),be([ve],Ce.prototype,"updateToStorage",1),be([ve],Ce.prototype,"updateLostAction",1);var Pe=C(function e(){S(this,e)});Pe.hasDirectGameMask=!1,Pe.activeDuration=0;var ke=Object.defineProperty,we=Object.getOwnPropertyDescriptor,Ie=function(e,t,o,n){for(var i,r=n>1?void 0:n?we(t,o):t,a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n?i(t,o,r):i(r))||r);return n&&r&&ke(t,o,r),r},Te=function(){h(t,Ce);var e=y(t);function t(o){var n,i=o.userActionSetId,r=o.maxLength,a=void 0===r?500:r,c=o.ogEvents,s=void 0===c?[]:c;return S(this,t),(n=e.call(this,{userActionSetId:i,maxLength:a})).ogEvents=s,n}return C(t,[{key:"getReportableActions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=this.getItems(),o=[];return null==t||t.forEach(function(t){var n;(null==o?void 0:o.length)<e&&(null==t?void 0:t.inner_status)!==(null==(n=M)?void 0:n.reporting)&&(null==o||o.push(t))}),o}},{key:"addAction",value:function(e){var t={code:0,message:"\u6210\u529f",actionId:e.action_id},o=this.getItems();if((null==o?void 0:o.length)>=this.maxLength){var n="\u961f\u5217\u957f\u5ea6\u8d85\u8fc7\u6700\u5927\u9650\u5236".concat(this.maxLength,"\u6761\uff0cSDK\u5c06\u6309\u7167\u884c\u4e3a\u4f18\u5148\u7ea7\u6392\u5e8f\uff0c\u4e22\u5f03\u4f18\u5148\u7ea7\u6700\u4f4e\u7684\u884c\u4e3a\u4e8b\u4ef6");me.warn(n),K({user_action_set_id:this.userActionSetId,log_type:"JS_QUEUE_LOG",message:"\u961f\u5217\u957f\u5ea6\u8d85\u8fc7\u9650\u5236"});var i=this.sortQueue(e,o);me.debug&&me.info("\u8d85\u8fc7".concat(this.maxLength,"\u6761\u6309\u4f18\u5148\u7ea7\u6392\u5e8f\u7684\u961f\u5217\uff1a"),i.concat([]));var r=i.pop();this.updateAllStack(i),this.updateLostAction((null==r?void 0:r.session_id)||""),(null==r?void 0:r.action_id)===e.action_id&&(t={code:103,message:"\u7f13\u5b58\u961f\u5217\u5df2\u6ee1\uff0c\u4e3b\u52a8\u4e22\u5f03\u884c\u4e3a"})}else this.addItem(e);return Pe.hasDirectGameMask||this.updateToStorage(),t}},{key:"removeActions",value:function(e){this.removeItems(e),this.updateToStorage()}},{key:"updateActionsForReportFail",value:function(e){this.updateForReportFail(e),this.updateToStorage()}},{key:"updateActionsForReporting",value:function(e){this.updateForReporting(e),this.updateToStorage()}},{key:"getReportableActionsLength",value:function(){var e=this.getItems().filter(function(e){var t;return(null==e?void 0:e.inner_status)!==(null==(t=M)?void 0:t.reporting)});return null==e?void 0:e.length}},{key:"sortQueue",value:function(e,t){var o=this,n={},i=null==e?void 0:e.action_time,r=t.concat([e]),a=function(e){return n[e.action_id]||(n[e.action_id]=o.caculateWeight(i,e)),n[e.action_id]};return r.sort(function(e,t){return a(t)-a(e)})}},{key:"caculateWeight",value:function(e,t){var o,n=0,i=this.formatWeight(e,null==t?void 0:t.action_time),r=i.ogWeight,a=i.sdkWeight,c=i.userWeight;null!=(o=this.ogEvents)&&o.includes(null==t?void 0:t.action_type)&&(n+=r),null!=t&&t.is_sdk_auto_track?n+=a:n+=c;var s=e-(null==t?void 0:t.action_time)+1;return s>0?n+1/s:n}},{key:"formatWeight",value:function(e,t){var o=1e3,n=10,i=100;return e-t>2592e6&&(o/=100,n/=100,i/=100),{ogWeight:o,sdkWeight:n,userWeight:i}}}]),t}();Ie([ve],Te.prototype,"getReportableActions",1),Ie([ve],Te.prototype,"addAction",1),Ie([ve],Te.prototype,"removeActions",1),Ie([ve],Te.prototype,"updateActionsForReportFail",1),Ie([ve],Te.prototype,"updateActionsForReporting",1),Ie([ve],Te.prototype,"getReportableActionsLength",1),Ie([ve],Te.prototype,"sortQueue",1),Ie([ve],Te.prototype,"caculateWeight",1),Ie([ve],Te.prototype,"formatWeight",1);var Ae=function(){function e(){S(this,e),this.events={}}return C(e,[{key:"subscribe",value:function(t,o){e.checkCallback(o),ne(this.events[t])?this.events[t].push(o):this.events[t]=[o]}},{key:"once",value:function(t,o){e.checkCallback(o),this.subscribe(this.onceEventName(t),o)}},{key:"unsubscribe",value:function(t,o){e.checkCallback(o),ne(this.events[t])&&(this.events[t]=this.events[t].filter(function(e){return e!==o})),ne(this.events[this.onceEventName(t)])&&(this.events[this.onceEventName(t)]=this.events[this.onceEventName(t)].filter(function(e){return e!==o}))}},{key:"publish",value:function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),n=1;n<t;n++)o[n-1]=arguments[n];var i=Date.now();ne(this.events[e])&&this.events[e].forEach(function(e){return e.apply(void 0,[i].concat(o))}),ne(this.events[this.onceEventName(e)])&&(this.events[this.onceEventName(e)].forEach(function(e){return e.apply(void 0,[i].concat(o))}),this.events[this.onceEventName(e)]=[])}},{key:"onceEventName",value:function(e){return"once_event_prefix_".concat(e)}}],[{key:"checkCallback",value:function(t){ie(t)||me.error(e.ERROR_CALLBACK_IS_NOT_A_FUNCTION)}}]),e}();Ae.ERROR_CALLBACK_IS_NOT_A_FUNCTION="callback \u4e0d\u662f\u51fd\u6570";var Oe=new Ae,Re=["REGISTER","VIEW_CONTENT","ADD_TO_CART","PURCHASE","COMPLETE_ORDER","ADD_TO_WISHLIST","START_APP","CREATE_ROLE","AUTHORIZE","TUTORIAL_FINISH","START_PAY","FINISH_PAY"],Ne=["REGISTER","START_APP","RE_ACTIVE"],Me=["TICKET","ENTER_FOREGROUND","ENTER_BACKGROUND"],Le=new(function(){function e(){S(this,e),this.channelClaimActionList=Ne,this.noClaimActionList=Me,this.realTimeActionList=L.realTimeActionList,this.ticketInterval=60,this.requestTimeout=L.requestTimeout,this.loadConfig()}return C(e,[{key:"getChannelClaimActionList",value:function(){return this.channelClaimActionList}},{key:"getNoClaimActionList",value:function(){return this.noClaimActionList}},{key:"getRealTimeActionList",value:function(){return this.realTimeActionList}},{key:"getTicketInterval",value:function(){return this.ticketInterval}},{key:"getRequestTimeout",value:function(){return this.requestTimeout}},{key:"loadConfig",value:function(){var e=this;try{if("undefined"==typeof wx)return;var t=G.getSync(R);t&&this.updateConfig(t),Q({conf_name:"mini_game_sdk_common",conf_key:"config"}).then(function(t){t&&oe(t)&&(e.updateConfig(t),G.setSync(R,t))})}catch(t){console.error(t)}}},{key:"updateConfig",value:function(e){e.channelClaimActionList&&ne(e.channelClaimActionList)&&(this.channelClaimActionList=e.channelClaimActionList),e.noClaimActionList&&ne(e.noClaimActionList)&&(this.noClaimActionList=e.noClaimActionList),e.realTimeActionList&&ne(e.realTimeActionList)&&(this.realTimeActionList=e.realTimeActionList),e.ticketInterval&&"number"==typeof e.ticketInterval&&e.ticketInterval>1&&e.ticketInterval!==this.ticketInterval&&(this.ticketInterval=e.ticketInterval,Oe.publish(j)),e.requestTimeout&&"number"==typeof e.requestTimeout&&e.requestTimeout>5e3&&(this.requestTimeout=e.requestTimeout)}}]),e}()),Ee=function(){var e=!0,t=!0,o=!0,n=!0,i=!0,r=!1;return function(){if(!r){r=!0;var a=G.getSync(O);if((null==a?void 0:a.bg)===W?e=!0:(null==a?void 0:a.bg)===U&&(e=!1),(null==a?void 0:a.fg)===W?t=!0:(null==a?void 0:a.fg)===U&&(t=!1),(null==a?void 0:a.st)===W?o=!0:(null==a?void 0:a.st)===U&&(o=!1),(null==a?void 0:a.ti)===W?n=!0:(null==a?void 0:a.ti)===U&&(n=!1),me.devLog("\u5f53\u524d\u7f13\u5b58\u5f00\u5173 bgOn\uff0cfgOn\uff0cstOn\uff0ctiOn\uff1a",e,t,o,n),o&&Oe.publish("START_APP"),n){var c=function(){i&&Oe.publish("TICKET")},s=setInterval(c,1e3*Le.getTicketInterval());Oe.subscribe(j,function(){s&&clearInterval(s),s=setInterval(c,1e3*Le.getTicketInterval())})}wx.onShow(function(e){if(i=!0,t){var o="";try{(o=JSON.stringify(e)).length>1e4&&(o=JSON.stringify({cut:1,scene:e.scene}))}catch(e){}Oe.publish("ENTER_FOREGROUND",{enter_options:o})}}),wx.onHide(function(){if(i=!1,e){var t=0;0!==Pe.activeDuration&&(t=Date.now()-Pe.activeDuration,Pe.activeDuration=0),Oe.publish("ENTER_BACKGROUND",{duration:t>0?t:0})}})}}}(),Fe="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:{};function xe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var De,Be=xe(function(){var e,t=null;function o(e){return!!e&&("object"==_(e)||"function"==typeof e)}function n(e){if(null!==e&&!o(e))throw new TypeError("Object prototype may only be an Object or null: "+e)}var i=Object,r=!(!i.create&&{__proto__:null}instanceof i),a=i.create||(r?function(e){return n(e),{__proto__:e}}:function(e){if(n(e),null===e)throw new SyntaxError("Native Object.create is required to create objects with null prototype");var t=function(){};return t.prototype=e,new t}),c=function(){return null},s=i.getPrototypeOf||([].__proto__===Array.prototype?function(e){var t=e.__proto__;return o(t)?t:null}:c);return(e=function(e){function t(t,o){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(l,u){if(void 0===(this&&this instanceof e?this.constructor:void 0))throw new TypeError("Constructor Proxy requires 'new'");if(!o(l)||!o(u))throw new TypeError("Cannot create proxy with a non-object as target or handler");var p=function(){};t=function(){l=null,p=function(e){throw new TypeError("Cannot perform '".concat(e,"' on a proxy that has been revoked"))}},setTimeout(function(){t=null},0);var d=u;for(var f in u={get:null,set:null,apply:null,construct:null},d){if(!(f in u))throw new TypeError("Proxy polyfill does not support trap '".concat(f,"'"));u[f]=d[f]}"function"==typeof d&&(u.apply=d.apply.bind(d));var h,y=s(l),m=!1,g=!1;"function"==typeof l?(h=function(){var e=this&&this.constructor===h,t=Array.prototype.slice.call(arguments);return p(e?"construct":"apply"),e&&u.construct?u.construct.call(this,l,t):!e&&u.apply?u.apply(l,this,t):e?(t.unshift(l),new(l.bind.apply(l,t))):l.apply(this,t)},m=!0):l instanceof Array?(h=[],g=!0):h=r||null!==y?a(y):{};var v=u.get?function(e){return p("get"),u.get(this,e,h)}:function(e){return p("get"),this[e]},_=u.set?function(e,t){p("set"),u.set(this,e,t,h)}:function(e,t){p("set"),this[e]=t},S=i.getOwnPropertyNames(l),b={};S.forEach(function(e){if(!m&&!g||!(e in h)){var t={enumerable:!!i.getOwnPropertyDescriptor(l,e).enumerable,get:v.bind(l,e),set:_.bind(l,e)};i.defineProperty(h,e,t),b[e]=!0}});var C=!0;if(m||g){var P=i.setPrototypeOf||([].__proto__===Array.prototype?function(e,t){return n(t),e.__proto__=t,e}:c);y&&P(h,y)||(C=!1)}if(u.get||!C)for(var k in l)b[k]||i.defineProperty(h,k,{get:v.bind(l,k)});return i.seal(l),i.seal(h),h})).revocable=function(o,n){return{proxy:new e(o,n),revoke:t}},e}),We={};try{De||(De=Be())}catch(k){ze(k=VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(k))}function Ue(e,t,o,n){try{if(!De||null==e||!e[t])return;e[t]=new De(e[t],{apply:function(e,t,i){var r,a;n&&He(function(){return n.apply(void 0,p(i))});var c=!!(null!=(r=i[0])&&r.success||null!=(a=i[0])&&a.fail);c&&["success","fail"].forEach(function(e){if(i[0][e])try{i[0][e]=new De(i[0][e],{apply:function(t,n,r){return He(function(){return o.apply(void 0,[e,i[0]].concat(p(r)))}),t.apply(n,r)}})}catch(e){ze(e)}});var s=e.apply(t,i);return!c&&s&&"[object Promise]"===Object.prototype.toString.call(s)?s.then(function(e){return He(function(){return o("success",i[0],e)}),e}).catch(function(e){throw He(function(){return o("fail",i[0],e)}),e}):s}})}catch(e){ze(e)}}function je(e,t,o){try{if(!De||null==e||!e[t])return;e[t]=new De(e[t],{apply:function(e,t,n){var i="function"==typeof n[0];if(i)try{n[0]=new De(n[0],{apply:function(e,t,n){var i=e.call.apply(e,[t].concat(p(n)));return He(function(){return o(i)}),i}})}catch(e){ze(e)}var r=e.call.apply(e,[t].concat(p(n)));return i||He(function(){return o(r)}),r}})}catch(e){ze(e)}}function Ge(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=arguments.length>2?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4?arguments[4]:void 0;try{if(!De||null==e||!e[t])return;e[t]=new De(e[t],{apply:function(e,r,a){var c=e.call.apply(e,[r].concat(p(a)));return(!o||!We[t])&&(He(function(){return null==i?void 0:i(c)}),n.forEach(function(e){var t=e.eventName,o=e.isAsync,n=e.proxyEvent;o?Ue(c,t,n):je(c,t,n)})),o&&(We[t]=!0),c}})}catch(e){ze(e)}}function He(e){try{e()}catch(e){ze(e)}}function ze(e){K({log_type:D,message:null==e?void 0:e.message,err_stack:null==e?void 0:e.stack})}var Ve="SHARE",qe="START_PAY",Xe="FINISH_PAY",Je=function(){var e=!1;return function(){e||(e=!0,Ue(wx,"login",function(e){"success"===e&&Oe.publish("LOGIN")}),je(wx,"onAddToFavorites",function(){Oe.publish("ADD_TO_WISHLIST")}),je(wx,"onShareTimeline",function(){Oe.publish(Ve,{target:"TIME_LINE",trigger:"MENU"})}),je(wx,"onShareAppMessage",function(){Oe.publish(Ve,{target:"APP_MESSAGE",trigger:"MENU"})}),je(wx,"shareAppMessage",function(){Oe.publish(Ve,{target:"APP_MESSAGE",trigger:"BUTTON"})}),Ge(wx,"createGameClubButton",!1,[{isAsync:!1,eventName:"onTap",proxyEvent:function(){Oe.publish("TAP_GAME_CLUB")}}],function(){Oe.publish("CREATE_GAME_CLUB")}),Ge(wx,"getGameServerManager",!0,[{isAsync:!0,eventName:"createRoom",proxyEvent:function(e){"success"===e&&Oe.publish("CREATE_GAME_ROOM")}},{isAsync:!0,eventName:"joinRoom",proxyEvent:function(e){"success"===e&&Oe.publish("JOIN_GAME_ROOM")}}]),Ue(wx,"requestMidasPayment",function(e,t){Oe.publish(Xe,{status:"success"===e?"SUCCESS":"FAIL",quantity:(null==t?void 0:t.buyQuantity)||0,mode:(null==t?void 0:t.mode)||"",platform:(null==t?void 0:t.platform)||"",no:(null==t?void 0:t.outTradeNo)||"",payType:"Midas"})},function(e){Oe.publish(qe,{quantity:(null==e?void 0:e.buyQuantity)||0,mode:(null==e?void 0:e.mode)||"",platform:(null==e?void 0:e.platform)||"",no:(null==e?void 0:e.outTradeNo)||"",payType:"Midas"})}),Ue(wx,"requestMidasPaymentGameItem",function(e,t){var o=(t||{}).signData;Oe.publish(Xe,{status:"success"===e?"SUCCESS":"FAIL",quantity:(null==o?void 0:o.buyQuantity)||0,mode:(null==o?void 0:o.mode)||"",platform:(null==o?void 0:o.platform)||"",no:(null==o?void 0:o.outTradeNo)||"",p:(null==o?void 0:o.goodsPrice)||0,productId:(null==o?void 0:o.productId)||"",payType:"MidasGameItem"})},function(e){var t=(e||{}).signData;Oe.publish(qe,{quantity:(null==t?void 0:t.buyQuantity)||0,mode:(null==t?void 0:t.mode)||"",platform:(null==t?void 0:t.platform)||"",no:(null==t?void 0:t.outTradeNo)||"",p:(null==t?void 0:t.goodsPrice)||0,productId:(null==t?void 0:t.productId)||"",payType:"MidasGameItem"})}))}}(),Ke=function(){function e(){S(this,e)}return C(e,null,[{key:"isEmpty",value:function(e){return null==e||"string"==typeof e&&""===e.trim()}},{key:"format",value:function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),n=1;n<t;n++)o[n-1]=arguments[n];return e.replace(/\${(\d+)}/g,function(e,t){return o[t]})}},{key:"customStringify",value:function(e){var t=[];try{return JSON.stringify(e,function(e,o){if(void 0===o)return"undefined";if("object"==_(o)&&null!==o){if(-1!==t.indexOf(o))return"[Circular]";t.push(o)}return"bigint"==typeof o?o.toString():o})}catch(e){return"[Param Error]"}}}]),e}(),Ye=/^([a-zA-Z][a-zA-Z\d_]{0,63})$/i,Qe=/^ams_reserved_(.*)/i,Ze=function(){function e(){S(this,e)}return C(e,null,[{key:"validateActionType",value:function(t){return Ke.isEmpty(t)?(me.error(e.ERROR_ACTION_TYPE_NULL),!1):!!Ye.test(t)||(me.error(e.ERROR_ACTION_TYPE_INVALID),!1)}},{key:"validateActionParam",value:function(t){if(!t)return!0;if(!oe(t))return me.error(e.ERROR_ACTION_PARAM_IS_NOT_OBJECT),!1;for(var o in t){if(Ke.isEmpty(o))return me.error(e.ERROR_ACTION_PARAM_KEY_NULL),!1;if(!Ye.test(o))return me.error(e.ERROR_ACTION_PARAM_KEY_INVALID),!1;Qe.test(o)&&me.warn(e.WARN_ACTION_PARAM_KEY_RESERVED);var n=t[o];if(!e.isValidValue(n))return me.error(Ke.format(e.ERROR_ACTION_PARAM_VALUE_INVALID,o,n)),!1;if(ne(n)){if(!e.isValidArrayValue(n)){for(var i=0;i<n.length;i++)me.error(Ke.format(e.ERROR_ACTION_PARAM_VALUE_ARRAY_INVALID,o,Ke.customStringify(n),i,n[i]));return!1}if(!e.checkArrayElementTypes(n))return me.error(e.ERROR_ACTION_PARAM_VALUE_ARRAY_TYPE_UNUNIQUE),!1}}return!0}},{key:"isValidValue",value:function(e){return null==e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e||ne(e)}},{key:"isValidArrayValue",value:function(e){for(var t=0;t<e.length;t++){var o=e[t];if("string"!=typeof o&&"number"!=typeof o&&"boolean"!=typeof o)return!1}return!0}},{key:"checkArrayElementTypes",value:function(e){if(!e||e.length<=1)return!0;for(var t=_(e[0]),o=1;o<e.length;o++)if(_(e[o])!==t)return!1;return!0}}]),e}();Ze.ERROR_ACTION_TYPE_NULL="\u5728track\u65b9\u6cd5\u4e2d\uff0caction_type\u53c2\u6570\u4e0d\u80fd\u4e3a\u7a7a\uff01",Ze.ERROR_ACTION_TYPE_INVALID="\u5728track\u65b9\u6cd5\u4e2d\uff0caction_type\u53c2\u6570\u53ea\u80fd\u5305\u542b\u5b57\u6bcd\u3001\u6570\u5b57\u548c\u4e0b\u5212\u7ebf\uff0c\u4e14\u53ea\u80fd\u4ee5\u5b57\u6bcd\u5f00\u5934\uff0c\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc764\u4e2a\u5b57\u7b26\uff01",Ze.ERROR_ACTION_PARAM_KEY_NULL="\u5728track\u65b9\u6cd5\u4e2d\uff0caction_param\u53c2\u6570\u7684key\u4e0d\u80fd\u4e3a\u7a7a\uff01",Ze.ERROR_ACTION_PARAM_KEY_INVALID="\u5728track\u65b9\u6cd5\u4e2d\uff0caction_param\u53c2\u6570\u7684key\u53ea\u80fd\u5305\u542b\u5b57\u6bcd\u3001\u6570\u5b57\u548c\u4e0b\u5212\u7ebf\uff0c\u4e14\u4e0d\u80fd\u4ee5\u6570\u5b57\u5f00\u5934\uff0c\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc764\u4e2a\u5b57\u7b26\uff01",Ze.WARN_ACTION_PARAM_KEY_RESERVED="SDK\u5185\u90e8\u9884\u7559\u53c2\u6570\u7684key\u5747\u4ee5'ams_reserved_'\u5f00\u5934\uff0c\u8be5\u53c2\u6570\u7684\u503c\u4f1a\u88abSDK\u5185\u90e8\u8986\u76d6\uff0c\u8bf7\u4e0d\u8981\u4f7f\u7528\uff01",Ze.ERROR_ACTION_PARAM_VALUE_INVALID="\u5728track\u65b9\u6cd5\u4e2d\uff0caction_param\u53c2\u6570\u7684value\u5fc5\u987b\u662fString/Number/Boolean/Array\u4e2d\u7684\u4e00\u79cd\uff01[key=${0}, value=${1}]",Ze.ERROR_ACTION_PARAM_VALUE_ARRAY_INVALID="\u5728track\u65b9\u6cd5\u4e2d\uff0c\u5982\u679caction_param\u53c2\u6570\u4e2d\u7684\u67d0\u4e2a\u5143\u7d20\u7684value\u662fArray\uff0c\u90a3\u4e48\u8fd9\u4e2aArray\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u5fc5\u987b\u662fString/Number/Boolean\u4e2d\u7684\u4e00\u79cd\uff01[key=${0}, value=${1}, \u6570\u7ec4\u7684\u7b2c${2}\u4e2a\u5143\u7d20\u4e3a${3}]",Ze.ERROR_ACTION_PARAM_VALUE_ARRAY_TYPE_UNUNIQUE="\u5728track\u65b9\u6cd5\u4e2d\uff0c\u5982\u679caction_param\u53c2\u6570\u4e2d\u7684\u67d0\u4e2a\u5143\u7d20\u7684value\u662fArray\uff0c\u90a3\u4e48\u8fd9\u4e2aArray\u4e2d\u6240\u6709\u5143\u7d20\u7684\u7c7b\u578b\u5fc5\u987b\u662f\u540c\u4e00\u79cd\uff01",Ze.ERROR_ACTION_PARAM_IS_NOT_OBJECT="action_param \u53c2\u6570\u4e0d\u662fObject";var $e={exports:{}};!function(e){!function(t){function o(e,t){var o=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(o>>16)<<16|65535&o}function n(e,t,n,i,r,a){return o(function(e){return e<<r|e>>>32-r}(o(o(t,e),o(i,a))),n)}function i(e,t,o,i,r,a,c){return n(t&o|~t&i,e,t,r,a,c)}function r(e,t,o,i,r,a,c){return n(t&i|o&~i,e,t,r,a,c)}function a(e,t,o,i,r,a,c){return n(t^o^i,e,t,r,a,c)}function c(e,t,o,i,r,a,c){return n(o^(t|~i),e,t,r,a,c)}function s(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var n,s,l,u,p,d=1732584193,f=-271733879,h=-1732584194,y=271733878;for(n=0;n<e.length;n+=16)s=d,l=f,u=h,p=y,d=i(d,f,h,y,e[n],7,-680876936),y=i(y,d,f,h,e[n+1],12,-389564586),h=i(h,y,d,f,e[n+2],17,606105819),f=i(f,h,y,d,e[n+3],22,-1044525330),d=i(d,f,h,y,e[n+4],7,-176418897),y=i(y,d,f,h,e[n+5],12,1200080426),h=i(h,y,d,f,e[n+6],17,-1473231341),f=i(f,h,y,d,e[n+7],22,-45705983),d=i(d,f,h,y,e[n+8],7,1770035416),y=i(y,d,f,h,e[n+9],12,-1958414417),h=i(h,y,d,f,e[n+10],17,-42063),f=i(f,h,y,d,e[n+11],22,-1990404162),d=i(d,f,h,y,e[n+12],7,1804603682),y=i(y,d,f,h,e[n+13],12,-40341101),h=i(h,y,d,f,e[n+14],17,-1502002290),d=r(d,f=i(f,h,y,d,e[n+15],22,1236535329),h,y,e[n+1],5,-165796510),y=r(y,d,f,h,e[n+6],9,-1069501632),h=r(h,y,d,f,e[n+11],14,643717713),f=r(f,h,y,d,e[n],20,-373897302),d=r(d,f,h,y,e[n+5],5,-701558691),y=r(y,d,f,h,e[n+10],9,38016083),h=r(h,y,d,f,e[n+15],14,-660478335),f=r(f,h,y,d,e[n+4],20,-405537848),d=r(d,f,h,y,e[n+9],5,568446438),y=r(y,d,f,h,e[n+14],9,-1019803690),h=r(h,y,d,f,e[n+3],14,-187363961),f=r(f,h,y,d,e[n+8],20,1163531501),d=r(d,f,h,y,e[n+13],5,-1444681467),y=r(y,d,f,h,e[n+2],9,-51403784),h=r(h,y,d,f,e[n+7],14,1735328473),d=a(d,f=r(f,h,y,d,e[n+12],20,-1926607734),h,y,e[n+5],4,-378558),y=a(y,d,f,h,e[n+8],11,-2022574463),h=a(h,y,d,f,e[n+11],16,1839030562),f=a(f,h,y,d,e[n+14],23,-35309556),d=a(d,f,h,y,e[n+1],4,-1530992060),y=a(y,d,f,h,e[n+4],11,1272893353),h=a(h,y,d,f,e[n+7],16,-155497632),f=a(f,h,y,d,e[n+10],23,-1094730640),d=a(d,f,h,y,e[n+13],4,681279174),y=a(y,d,f,h,e[n],11,-358537222),h=a(h,y,d,f,e[n+3],16,-722521979),f=a(f,h,y,d,e[n+6],23,76029189),d=a(d,f,h,y,e[n+9],4,-640364487),y=a(y,d,f,h,e[n+12],11,-421815835),h=a(h,y,d,f,e[n+15],16,530742520),d=c(d,f=a(f,h,y,d,e[n+2],23,-995338651),h,y,e[n],6,-198630844),y=c(y,d,f,h,e[n+7],10,1126891415),h=c(h,y,d,f,e[n+14],15,-1416354905),f=c(f,h,y,d,e[n+5],21,-57434055),d=c(d,f,h,y,e[n+12],6,1700485571),y=c(y,d,f,h,e[n+3],10,-1894986606),h=c(h,y,d,f,e[n+10],15,-1051523),f=c(f,h,y,d,e[n+1],21,-2054922799),d=c(d,f,h,y,e[n+8],6,1873313359),y=c(y,d,f,h,e[n+15],10,-30611744),h=c(h,y,d,f,e[n+6],15,-1560198380),f=c(f,h,y,d,e[n+13],21,1309151649),d=c(d,f,h,y,e[n+4],6,-145523070),y=c(y,d,f,h,e[n+11],10,-1120210379),h=c(h,y,d,f,e[n+2],15,718787259),f=c(f,h,y,d,e[n+9],21,-343485551),d=o(d,s),f=o(f,l),h=o(h,u),y=o(y,p);return[d,f,h,y]}function l(e){var t,o="",n=32*e.length;for(t=0;t<n;t+=8)o+=String.fromCharCode(e[t>>5]>>>t%32&255);return o}function u(e){var t,o=[];for(o[(e.length>>2)-1]=void 0,t=0;t<o.length;t+=1)o[t]=0;var n=8*e.length;for(t=0;t<n;t+=8)o[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return o}function p(e){var t,o,n="0123456789abcdef",i="";for(o=0;o<e.length;o+=1)t=e.charCodeAt(o),i+=n.charAt(t>>>4&15)+n.charAt(15&t);return i}function d(e){return unescape(encodeURIComponent(e))}function f(e){return function(e){return l(s(u(e),8*e.length))}(d(e))}function h(e,t){return function(e,t){var o,n,i=u(e),r=[],a=[];for(r[15]=a[15]=void 0,i.length>16&&(i=s(i,8*e.length)),o=0;o<16;o+=1)r[o]=909522486^i[o],a[o]=1549556828^i[o];return n=s(r.concat(u(t)),512+8*t.length),l(s(a.concat(n),640))}(d(e),d(t))}function y(e,t,o){return t?o?h(t,e):function(e,t){return p(h(e,t))}(t,e):o?f(e):function(e){return p(f(e))}(e)}e.exports?e.exports=y:t.md5=y}(Fe)}($e);var et=xe($e.exports),tt="function"==typeof btoa,ot="function"==typeof i;"function"==typeof TextDecoder&&new TextDecoder;var nt,it="function"==typeof TextEncoder?new TextEncoder:void 0,rt=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=");nt={},rt.forEach(function(e,t){return nt[e]=t});var at=String.fromCharCode.bind(String);"function"==typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array);var ct=tt?function(e){return btoa(e)}:ot?function(e){return i.from(e,"binary").toString("base64")}:function(e){for(var t,o,n,i,r="",a=e.length%3,c=0;c<e.length;){if((o=e.charCodeAt(c++))>255||(n=e.charCodeAt(c++))>255||(i=e.charCodeAt(c++))>255)throw new TypeError("invalid character found");r+=rt[(t=o<<16|n<<8|i)>>18&63]+rt[t>>12&63]+rt[t>>6&63]+rt[63&t]}return a?r.slice(0,a-3)+"===".substring(a):r},st=ot?function(e){return i.from(e).toString("base64")}:function(e){for(var t=[],o=0,n=e.length;o<n;o+=4096)t.push(at.apply(null,e.subarray(o,o+4096)));return ct(t.join(""))},lt=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?at(192|t>>>6)+at(128|63&t):at(224|t>>>12&15)+at(128|t>>>6&63)+at(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return at(240|t>>>18&7)+at(128|t>>>12&63)+at(128|t>>>6&63)+at(128|63&t)},ut=/[\ufffd-\ufffd][\ufffd-\ufffdF]|[^\x00-\x7F]/g,pt=ot?function(e){return i.from(e,"utf8").toString("base64")}:it?function(e){return st(it.encode(e))}:function(e){return ct(function(e){return e.replace(ut,lt)}(e))},dt=Object.defineProperty,ft=Object.getOwnPropertyDescriptor,ht=function(e,t,o,n){for(var i,r=n>1?void 0:n?ft(t,o):t,a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n?i(t,o,r):i(r))||r);return n&&r&&dt(t,o,r),r},yt=function(){function e(t){var o=this;S(this,e),this.cgiBatchSize=L.cgiBatchSize,this.reportThreshold=L.reportThreshold,this.reportDelay=L.reportDelay,this.triggerExecuteSend=function(e){var t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=[];return function(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return clearTimeout(t),t=setTimeout(function(){var t=e.apply(void 0,r);n.forEach(function(e){return e(t)}),n=[]},o),new Promise(function(e){return n.push(e)})}}(function(){o.executeSend()},1e3*this.reportDelay),this.inspectDelay=L.inspectDelay,this.inspectTimer=void 0,this.isNeedContinueSend=!1,this.getBaseInfo=t.getBaseInfo,this.reportLog=t.reportLog,this.queueManager=t.queueManager,this.configManager=t.configManager,this.onReportComplete=t.onReportComplete,this.onReportFail=t.onReportFail,this.flushSend(),this.startInspectTimer()}return C(e,[{key:"batchSend",value:function(){var e,t=this.queueManager.getReportableActions(this.reportThreshold);if(t.length>=this.reportThreshold)this.executeSend();else{var o=(null==(e=this.configManager)?void 0:e.getRealTimeActionList())||L.realTimeActionList;t.some(function(e){return o.indexOf(e.action_type)>-1&&!e.is_retry})?this.executeSend():this.triggerExecuteSend()}this.startInspectTimer()}},{key:"flushSend",value:function(){this.executeSend()}},{key:"executeSend",value:function(){var t=this;if(!Pe.hasDirectGameMask)if(e.currentRequestCount>=e.requestConcurrency)this.isNeedContinueSend=!0;else{this.isNeedContinueSend=!1;var o=(e.requestConcurrency-e.currentRequestCount)*this.cgiBatchSize,n=this.queueManager.getReportableActions(o),i=this.getBaseInfo();if(!i.openid&&!i.unionid&&(me.warn("\u8bf7\u5c3d\u5feb\u8c03\u7528 setOpenId \u6216 setUnionId \u65b9\u6cd5\u8bbe\u7f6e\u7528\u6237ID\uff01"),n=n.filter(function(e){return null==e?void 0:e.ad_trace_id})),!(n.length<=0)){o<this.queueManager.getReportableActionsLength()&&(this.isNeedContinueSend=!0),e.currentRequestCount+=Math.ceil(n.length/this.cgiBatchSize);for(var r=[],a=0;a<n.length;a+=this.cgiBatchSize){var c=this.generateActionReportParams(n.slice(a,a+this.cgiBatchSize));r.push(this.report(c))}Promise.all(r).then(function(e){var o=e.some(function(e){return e>=0});t.isNeedContinueSend&&o&&t.executeSend()}).catch(function(e){me.error(e),t.reportLog({message:"executeSend catch: ".concat(e.message),log_type:E,err_stack:e.stack})})}}}},{key:"generateActionReportParams",value:function(e){var t=[],o=[],n=this.getBaseInfo();return e.forEach(function(e){o.push(e.action_id);var n=Object.assign({},e);delete n.inner_status,t.push(n)}),{data:{info:n,actions:t},actionIdList:o}}},{key:"dealSuccessData",value:function(e,t,o){[51001,51003].indexOf(null==e?void 0:e.code)>-1?this.queueManager.updateActionsForReportFail(t):this.queueManager.removeActions(t),0!==(null==e?void 0:e.code)&&(this.reportLog({log_type:F,code:null==e?void 0:e.code,message:"trace_id: ".concat(null==e?void 0:e.trace_id,"\uff0cmsg: ").concat(null==e?void 0:e.message)}),me.error("\u4e0a\u62a5\u5931\u8d25\uff1a",e)),this.doTrackCallbackFn(this.onReportComplete,e,o),-1===[0,51001,51003].indexOf(null==e?void 0:e.code)&&this.doTrackCallbackFn(this.onReportFail,e,o)}},{key:"dealFailData",value:function(e,t,o){this.queueManager.updateActionsForReportFail(t),this.reportLog({log_type:F,code:e.code,message:e.message}),me.error("\u4e0a\u62a5\u5931\u8d25\uff1a",e),this.doTrackCallbackFn(this.onReportComplete,e,o)}},{key:"report",value:function(t){var o=this,n=t.data,i=t.actionIdList;return this.queueManager.updateActionsForReporting(i),me.debug&&(me.info("\u4e0a\u62a5\u884c\u4e3a\u7c7b\u578b: ","\u3010".concat(n.actions.map(function(e){return e.action_type}).join("\u3001"),"\u3011")),me.info("\u4e0a\u62a5\u8bf7\u6c42\u53c2\u6570: ",n)),new Promise(function(t){var r,a,c,s,l,u,p,d,f=Date.now();try{var h=function(e){var t="",o=null==e?void 0:e.appid,n=null==e?void 0:e.secret_key,i=null==e?void 0:e.sdk_version,r=null==e?void 0:e.timestamp;if(!(o&&n&&i&&r&&32===n.length))return t;for(var a=et(i+o+r),c=0;c<32;c++)t+=c%2==0?n[c]:a[c];return t}({appid:null==(r=null==n?void 0:n.info)?void 0:r.appid,secret_key:null==(a=null==n?void 0:n.info)?void 0:a.secret_key,sdk_version:null==(c=null==n?void 0:n.info)?void 0:c.sdk_version,timestamp:f}),y=function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?function(e){return e.replace(/=/g,"").replace(/[+\/]/g,function(e){return"+"==e?"-":"_"})}(pt(e)):pt(e)}(JSON.stringify(n));p={"Client-Time":f,"Sign-Value":et(y+(null==(s=null==n?void 0:n.info)?void 0:s.user_action_set_id)+(null==(l=null==n?void 0:n.info)?void 0:l.secret_key)+h),"Sign-Version":L.signVersion,"content-type":"text/plain;charset=UTF-8"},d=y}catch(h){p={"Client-Time":f},d=n,o.reportLog({log_type:"SIGN_ERROR",message:"sign error msg: ".concat(null==h?void 0:h.message),err_stack:null==h?void 0:h.stack}),me.error(h)}wx.request({url:"https://api.datanexus.qq.com/data-nexus-cgi/miniprogram",method:"POST",timeout:(null==(u=o.configManager)?void 0:u.getRequestTimeout())||L.requestTimeout,header:p,data:d,success:function(r){var a,c;me.devLog("\u4e0a\u62a5\u63a5\u53e3\u8fd4\u56de\u7801:",null==(a=null==r?void 0:r.data)?void 0:a.code);var s=(null==(c=null==r?void 0:r.header)?void 0:c["Server-Time"])||-1;if(Y.revise(s),e.currentRequestCount-=1,200===(null==r?void 0:r.statusCode))return o.dealSuccessData(null==r?void 0:r.data,i,n),void t((null==r?void 0:r.data).code);var l="";try{l="object"==_(null==r?void 0:r.data)?JSON.stringify(null==r?void 0:r.data):null==r?void 0:r.data}catch(e){me.error(e)}var u={code:"number"==typeof(null==r?void 0:r.statusCode)?-1*r.statusCode:-888,message:"statusCode: ".concat(null==r?void 0:r.statusCode,", data: ").concat(l)};o.dealFailData(u,i,n),t(u.code)},fail:function(r){me.devLog("\u4e0a\u62a5\u5931\u8d25:",r),e.currentRequestCount-=1;var a={code:"number"==typeof(null==r?void 0:r.errno)?-1*r.errno:-999,message:null==r?void 0:r.errMsg};o.dealFailData(a,i,n),t(a.code)}})})}},{key:"startInspectTimer",value:function(){var t=this;clearTimeout(this.inspectTimer),this.inspectTimer=setTimeout(function(){e.currentRequestCount>=e.requestConcurrency&&(e.currentRequestCount=e.requestConcurrency-1),t.executeSend(),t.startInspectTimer()},1e3*this.inspectDelay)}},{key:"doTrackCallbackFn",value:function(e,t,o){if("function"==typeof e)try{for(var n=[],i=0;i<o.actions.length;i++)if(!o.actions[i].is_sdk_auto_track){var r=o.actions[i],a=r.action_type,c=r.action_param,s=r.action_id,l=r.action_time;n.push({action_type:a,action_param:c,action_id:s,action_time:l})}if(n.length){var u=o.info,p=u.user_action_set_id,d=u.appid,f=u.openid,h=u.unionid,y=u.user_unique_id;e({code:null==t?void 0:t.code,message:null==t?void 0:t.message,data:{actions:n,info:{user_action_set_id:p,appid:d,openid:f,unionid:h,user_unique_id:y}}})}}catch(n){me.error("\u8fd4\u56de\u4e0a\u62a5\u56de\u8c03\u6570\u636e\u5f02\u5e38\uff1a",n)}}}],[{key:"setRequestConcurrency",value:function(t){"number"==typeof t?t<1?me.error("\u7f51\u7edc\u8bf7\u6c42\u6700\u5927\u5e76\u53d1\u91cf\u4e0d\u80fd\u5c0f\u4e8e1"):t>10?me.error("\u7f51\u7edc\u8bf7\u6c42\u6700\u5927\u5e76\u53d1\u91cf\u4e0d\u80fd\u5927\u4e8e10"):e.requestConcurrency=t:me.error("\u7f51\u7edc\u8bf7\u6c42\u6700\u5927\u5e76\u53d1\u91cf\u9700\u8bbe\u7f6e\u4e3a\u6570\u5b57")}}]),e}();yt.currentRequestCount=0,yt.requestConcurrency=L.requestConcurrency,ht([ve],yt.prototype,"batchSend",1),ht([ve],yt.prototype,"flushSend",1),ht([ve],yt.prototype,"executeSend",1);var mt=function(){function e(){S(this,e)}return C(e,[{key:"install",value:function(e,t){var o=function(t){Oe.subscribe(t,function(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Pe.hasDirectGameMask||("ENTER_FOREGROUND"===t&&(Pe.activeDuration=Date.now()),e.track(t,Object.assign(o||{},i,u(u({},At,!0),Ot,n))))}}(t))};o("TICKET"),o("START_APP"),o("ENTER_FOREGROUND"),o("ENTER_BACKGROUND"),"all"===t&&(o("LOGIN"),o("ADD_TO_WISHLIST"),o("SHARE"),o("CREATE_GAME_CLUB"),o("TAP_GAME_CLUB"),o("CREATE_GAME_ROOM"),o("JOIN_GAME_ROOM"),o("START_PAY"),o("FINISH_PAY"))}}]),e}(),gt=function(){function e(){S(this,e),this.special_method_symbol=Symbol("special_method_symbol")}return C(e,[{key:"onPurchase",value:function(e){return"number"!=typeof e&&me.warn("\u4ed8\u8d39\u91d1\u989d\u9700\u8981\u4e3a\u6570\u5b57"),e<=0&&me.warn("\u4ed8\u8d39\u91d1\u989d\u9700\u8981\u5927\u4e8e0"),this.wrapTrack("PURCHASE",{value:e})}},{key:"onEnterForeground",value:function(){return this.wrapTrack("ENTER_FOREGROUND")}},{key:"onEnterBackground",value:function(){return this.wrapTrack("ENTER_BACKGROUND")}},{key:"onAppStart",value:function(){return this.wrapTrack("START_APP")}},{key:"onAppQuit",value:function(){return this.wrapTrack("APP_QUIT")}},{key:"onAddToWishlist",value:function(){return this.wrapTrack("ADD_TO_WISHLIST")}},{key:"wrapTrack",value:function(e,t){return this.track(e,Object.assign(t||{},u({},this.special_method_symbol,1)))}}]),e}(),vt=function(){h(t,gt);var e=y(t);function t(){return S(this,t),e.apply(this,arguments)}return C(t,[{key:"onRegister",value:function(){return this.wrapTrack("REGISTER")}},{key:"onCreateRole",value:function(e){return e&&"string"!=typeof e&&me.warn("\u89d2\u8272\u540d\u79f0\u9700\u8981\u4e3a\u5b57\u7b26\u4e32"),this.wrapTrack("CREATE_ROLE",e?{name:e}:{})}},{key:"onTutorialFinish",value:function(){return this.wrapTrack("TUTORIAL_FINISH")}}]),t}(),_t="\uff08\u5982\u679c\u786e\u8ba4\u65e0\u8bef\uff0c\u8bf7\u5ffd\u7565\u8be5\u63d0\u793a\uff09",St=function(){var e=[];return{requestActionList:function(){try{Q({conf_name:"data_nexus_common",conf_key:"action_types"}).then(function(t){ne(t)&&(e=t)})}catch(e){me.error(e)}},getActionList:function(){return e}}}();function bt(e,t){try{e.is_sdk_auto_track||(function(e){try{var t=St.getActionList();if(!t.includes(e)){var o,n=function(e){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=d(e))){t&&(e=t);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){throw e}),f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,a=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return r=e.done,e},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){a=!0,i=e}),f:function(){try{r||null==t.return||t.return()}finally{if(a)throw i}}}}(t);try{for(n.s();!(o=n.n()).done;){var i=o.value;if(Ct(i,e)<=parseInt((.3*i.length).toString())){me.warn("\u901a\u8fc7SDK\u4e0a\u62a5\u7684".concat(e,"\u884c\u4e3a\u540d\u79f0\u53ef\u80fd\u6709\u8bef\uff0c\u8bf7\u68c0\u67e5\u8be5\u884c\u4e3a\u7c7b\u578b\u662f\u5426\u4e3a\u817e\u8baf\u5e7f\u544a\u63d0\u4f9b\u7684\u6807\u51c6\u884c\u4e3a\uff01").concat(_t));break}}}catch(e){n.e(e)}finally{n.f()}}}catch(t){me.error(t)}}(e.action_type),"minigame"===t?function(e,t){var o,n,i;try{["PURCHASE","ADD_TO_CART"].includes(e.action_type)&&e.action_param&&he(e.action_param,"value")&&("number"!=typeof(null==(o=e.action_param)?void 0:o.value)?me.warn("\u901a\u8fc7SDK\u4e0a\u62a5\u7684".concat(e.action_type,"\u884c\u4e3a\u643a\u5e26\u7684\u91d1\u989d\u53c2\u6570\u9700\u8981\u4e3a\u6570\u5b57\uff01")):(null==(n=e.action_param)?void 0:n.value)<=0?me.warn("\u901a\u8fc7SDK\u4e0a\u62a5\u7684".concat(e.action_type,"\u884c\u4e3a\u643a\u5e26\u7684\u91d1\u989d\u53c2\u6570\u9700\u8981\u5927\u4e8e0\uff01")):"minigame"===t&&(null==(i=e.action_param)?void 0:i.value)<100&&me.warn("\u901a\u8fc7SDK\u4e0a\u62a5\u7684".concat(e.action_type,"\u884c\u4e3a\u643a\u5e26\u7684\u91d1\u989d\u53c2\u6570\u53ef\u80fd\u6709\u8bef\uff0c\u91d1\u989d\u7684\u5355\u4f4d\u4e3a\u2018\u5206\u2019\uff0c\u8bf7\u68c0\u67e5\u91d1\u989d\u662f\u5426\u6b63\u786e\uff01").concat(_t)))}catch(e){me.error(e)}}(e,t):"miniprogram"===t&&function(e){try{var t=null==e?void 0:e.action_type,o=(null==e?void 0:e.action_param)||{};"PURCHASE"===t&&he(o,"value")&&("number"!=typeof(null==o?void 0:o.value)?me.warn("\u901a\u8fc7SDK\u4e0a\u62a5\u7684".concat(t,"\u884c\u4e3a\u643a\u5e26\u7684\u91d1\u989d\u53c2\u6570\u9700\u8981\u4e3a\u6570\u5b57\uff01")):(null==o?void 0:o.value)<=0&&me.warn("\u901a\u8fc7SDK\u4e0a\u62a5\u7684".concat(t,"\u884c\u4e3a\u643a\u5e26\u7684\u91d1\u989d\u53c2\u6570\u9700\u8981\u5927\u4e8e0\uff01")))}catch(t){me.error(t)}}(e))}catch(e){me.error(e)}}function Ct(e,t){try{if(0===e.length)return t.length;if(0===t.length)return e.length;for(var o=[],n=0;n<=t.length;n++)o[n]=[n];for(var i=0;i<=e.length;i++)o[0][i]=i;for(var r=1;r<=t.length;r++)for(var a=1;a<=e.length;a++)t.charAt(r-1)===e.charAt(a-1)?o[r][a]=o[r-1][a-1]:o[r][a]=Math.min(o[r-1][a-1]+1,o[r][a-1]+1,o[r-1][a]+1);return o[t.length][e.length]}catch(o){me.error(o)}}function Pt(e){try{e&&!/^[a-zA-Z0-9_\-]+$/.test(e)&&me.warn("\u901a\u8fc7SDK\u4e0a\u62a5\u7684openid\uff1a".concat(e,"\u53ef\u80fd\u6709\u8bef\uff0c\u8bf7\u68c0\u67e5openid\u662f\u5426\u6b63\u786e\uff01").concat(_t))}catch(e){me.error(e)}}var kt=Object.defineProperty,wt=Object.getOwnPropertyDescriptor,It=function(e,t,o,n){for(var i,r=n>1?void 0:n?wt(t,o):t,a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n?i(t,o,r):i(r))||r);return n&&r&&kt(t,o,r),r},Tt=Symbol("initializedInstance"),At=Symbol("autoTrack"),Ot=Symbol("actionTime"),Rt=function(){h(t,vt);var e=y(t);function t(o){var n;if(S(this,t),(n=e.call(this)).env="production",n.sdk_version="1.5.6",n.sdk_name="@dn-sdk/minigame",n.deviceInfo={},n.gameInfo={},n.session_id="",n.log_id=0,n.inited=!1,n.initErrMsg="",null==wx||!wx.createCanvas)return n.initErrMsg="\u4e0d\u652f\u6301\u975e\u5fae\u4fe1\u5c0f\u6e38\u620f\u4e2d\u4f7f\u7528",me.error(n.initErrMsg),m(n);var i=fe();if(t[Tt].length>=i.maxSdkInstance)return n.initErrMsg="\u521d\u59cb\u5316\u8d85\u8fc7\u4e0a\u9650",me.error(n.initErrMsg),m(n);var r=function(e){return oe(e)?(function(e){var t=["user_action_set_id","secret_key","appid","openid","unionid","user_unique_id","auto_track","auto_attr","on_report_fail","on_report_complete"];for(var o in e)t.includes(o)||me.warn("Invalid property '".concat(o,"' found in config"))}(e),"number"!=typeof e.user_action_set_id?"user_action_set_id \u53c2\u6570\u9700\u4e3a number \u7c7b\u578b":e.user_action_set_id<=0?"user_action_set_id \u53c2\u6570\u9700\u5927\u4e8e 0":"string"!=typeof e.secret_key?"secret_key \u53c2\u6570\u9700\u4e3a string \u7c7b\u578b":""===e.secret_key.trim()?"\u7f3a\u5c11 secret_key \u53c2\u6570":32!==e.secret_key.length?"secret_key \u53c2\u6570\u9700\u4e3a 32 \u4f4d\u5b57\u7b26\u4e32":"string"!=typeof e.appid?"appid \u53c2\u6570\u9700\u4e3a string \u7c7b\u578b":""!==e.appid.trim()||"\u7f3a\u5c11 appid"):"\u521d\u59cb\u5316\u53c2\u6570\u9700\u4e3a object \u7c7b\u578b"}(o),a=X();if(!0!==r)return n.initErrMsg=r,me.error(r),m(n);var c=null==a?void 0:a.appId;if(c&&c!==o.appid)return n.initErrMsg="\u521d\u59cb\u5316\u4f20\u5165\u7684appid\u4e0e\u5f53\u524d\u5c0f\u6e38\u620fappid\u4e0d\u4e00\u81f4",me.error(n.initErrMsg),m(n);n.config=o,he(o,"auto_track")||(n.config.auto_track=de("autoTrack")),n.openid=o.openid,n.unionid=o.unionid,n.user_unique_id=o.user_unique_id,n.onReportComplete=o.on_report_complete,n.onReportFail=o.on_report_fail,n.saveValidOpenidToStorage();var s=o.user_action_set_id;return t[Tt].includes(s)?(n.initErrMsg="\u540c\u4e2a\u6570\u636e\u6e90[".concat(s,"]\u53ea\u80fd\u521d\u59cb\u5316\u4e00\u6b21"),me.error(n.initErrMsg),n.reportLog({log_type:E,message:n.initErrMsg}),m(n)):(n.reportLog=n.reportLog.bind(g(n)),n.getTrackBaseInfo=n.getTrackBaseInfo.bind(g(n)),Pe.activeDuration=Date.now(),n.deviceInfo=H(),n.gameInfo=ge(),n.session_id=ae(),n.queueManage=new Te({userActionSetId:s,maxLength:i.maxQueueLength,ogEvents:Re}),n.actionReporter=new yt({getBaseInfo:n.getTrackBaseInfo,reportLog:n.reportLog,queueManager:n.queueManage,configManager:Le,onReportComplete:n.onReportComplete,onReportFail:n.onReportFail}),n.inited=!0,t[Tt].push(s),n.useAutoTrack(),n.doReportOnEnterBackground(),"release"===(null==a?void 0:a.envVersion)?(me.info("\u521d\u59cb\u5316\u6210\u529f"),m(n)):(function(e){var t=e.sdk_version,o=e.default_download_url,n=e.fail_handler;Q({conf_name:e.conf_name,conf_key:e.conf_key}).then(function(e){if(oe(e)){var i=null==e?void 0:e.blackVersions,r=null==e?void 0:e.minVersion,a=null==e?void 0:e.bestVersion,c=null==e?void 0:e.downloadUrl,s=o;return c&&/^https/.test(c)&&(s=c),ne(i)&&(null==i?void 0:i.indexOf(t))>-1?(null==n||n(),void me.error("\u521d\u59cb\u5316\u5931\u8d25\uff01\u5f53\u524dSDK\u7248\u672c\u5b58\u5728\u517c\u5bb9\u95ee\u9898\uff0c\u8bf7\u5c3d\u5feb\u5347\u7ea7\u81f3\u6700\u65b0\u7248\uff01\u4e0b\u8f7d\u5730\u5740\uff1a".concat(s))):r&&pe(t,r)<0?(null==n||n(),void me.error("\u521d\u59cb\u5316\u5931\u8d25\uff01\u5f53\u524dSDK\u7248\u672c\u8fc7\u4f4e\uff0c\u8bf7\u5c3d\u5feb\u5347\u7ea7\u81f3\u6700\u65b0\u7248\uff01\u4e0b\u8f7d\u5730\u5740\uff1a".concat(s))):(a&&pe(t,a)<0&&me.warn("\u65b0\u7248\u672cSDK\u5df2\u4e0a\u7ebf\uff0c\u5f3a\u70c8\u5efa\u8bae\u60a8\u5347\u7ea7\u81f3\u6700\u65b0\u7248\uff0c\u5c3d\u65e9\u4eab\u53d7\u65b0\u7279\u6027\uff01\u4e0b\u8f7d\u5730\u5740\uff1a".concat(s)),void me.info("\u521d\u59cb\u5316\u6210\u529f"))}me.info("\u521d\u59cb\u5316\u6210\u529f")}).catch(function(){me.info("\u521d\u59cb\u5316\u6210\u529f")})}({conf_name:"mini_game_sdk_common",conf_key:"version",sdk_version:n.sdk_version,default_download_url:"https://sr-home-1257214331.cos.ap-guangzhou.myqcloud.com/sdk/dn-sdk-minigame/dn-sdk-minigame.zip",fail_handler:function(){n.inited=!1}}),St.requestActionList(),Pt(o.openid),m(n)))}return C(t,[{key:"getInitResult",value:function(){return{inited:this.inited,initErrMsg:this.initErrMsg}}},{key:"track",value:function(e,t){var o,n;if(!this.inited||!this.queueManage)return me.error("\u4e0a\u62a5\u5931\u8d25\uff0c\u8bf7\u5148\u5b8c\u6210\u521d\u59cb\u5316"),{code:100,message:"\u672a\u5b8c\u6210\u521d\u59cb\u5316\u6216\u91cd\u590d\u521d\u59cb\u5316\u5bfc\u81f4\u521d\u59cb\u5316\u5931\u8d25\uff0c\u8bf7\u5148\u5b8c\u6210\u521d\u59cb\u5316"};var i=Ze.validateActionType(e),r=Ze.validateActionParam(t);if(i&&r){!this.openid&&!this.unionid&&me.warn("\u7f3a\u5c11 openid \u6216 unionid");var a=de("actionParamMaxLength");if(JSON.stringify(t||{}).length>a)return me.error("\u76d1\u6d4b\u5230\u8d85\u8fc7".concat(a,"\u7684\u4e0a\u62a5\u65e5\u5fd7\uff1a").concat(e," ").concat(t)),{code:102,message:"action_param \u53c2\u6570\u8fc7\u5927\uff0c\u4e0d\u80fd\u8d85\u8fc7 ".concat(a," \u5b57\u7b26")};var c=!(null==t||!t[At]),s=this.createAction(e,t||{},c);"release"!==(null==(o=X())?void 0:o.envVersion)&&bt(s,"minigame");var l=this.queueManage.addAction(s);return null==(n=this.actionReporter)||n.batchSend(),l}return{code:101,message:"action_type \u6216 action_param \u53c2\u6570\u9519\u8bef"}}},{key:"flush",value:function(){var e;null==(e=this.actionReporter)||e.flushSend()}},{key:"setOpenId",value:function(e){var t;if(e&&"string"==typeof e)return this.openid=e,this.gameInfo.ad_trace_id&&!G.getSync(N)&&Oe.publish("START_APP"),this.flush(),this.saveValidOpenidToStorage(),"release"!==(null==(t=X())?void 0:t.envVersion)&&Pt(e),{code:0,message:"\u6210\u529f"};var o="openid \u683c\u5f0f\u9519\u8bef";return me.error(o),{code:101,message:o}}},{key:"setUnionId",value:function(e){if(e&&"string"==typeof e)return this.unionid=e,this.flush(),{code:0,message:"\u6210\u529f"};var t="unionid \u683c\u5f0f\u9519\u8bef";return me.error(t),{code:101,message:t}}},{key:"setUserUniqueId",value:function(e){if(e&&"string"==typeof e)return this.user_unique_id=e,{code:0,message:"\u6210\u529f"};var t="user_unique_id \u683c\u5f0f\u9519\u8bef";return me.error(t),{code:101,message:t}}},{key:"doReportOnEnterBackground",value:function(){var e=this;wx.onHide(function(){var t,o;null==(t=e.actionReporter)||t.flushSend(),null==(o=e.queueManage)||o.reportLostNum()})}},{key:"getTrackBaseInfo",value:function(){var e=X();return Object.assign({},this.deviceInfo,function(e){var t={};return["user_action_set_id","appid","openid","secret_key","user_unique_id","unionid"].forEach(function(o){he(e,o)&&(t[o]=e[o])}),t}(this.config),{local_id:z(),sdk_name:this.sdk_name,sdk_version:this.sdk_version,openid:this.openid||q(),unionid:this.unionid,user_unique_id:this.user_unique_id,inner_param:{app_env_version:e.envVersion,app_version:e.version}})}},{key:"createAction",value:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];null!=t&&t[At]&&delete t[At];var n=Date.now();null!=t&&t[Ot]&&(n=null==t?void 0:t[Ot],delete t[Ot]);var i={action_id:ae(),action_param:t,action_time:n,action_type:e,is_retry:!1,is_sdk_auto_track:o,retry_count:0,revised_action_time:Y.getRevisedcurrentTimeMillis(),log_id:++this.log_id,session_id:this.session_id,pkg_channel_id:this.gameInfo.pkg_channel_id,source_scene:this.gameInfo.source_scene,network_type:V(),ad_trace_id:this.gameInfo.ad_trace_id,channel:this.getChannelByActionType(e)};return null!=t&&t[this.special_method_symbol]&&(this.addActionInnerParam(i,"is_special_method",!0),delete t[this.special_method_symbol]),Le.getChannelClaimActionList().indexOf(e)>-1&&this.gameInfo.launch_options&&this.addActionInnerParam(i,"launch_options",this.gameInfo.launch_options),i}},{key:"addActionInnerParam",value:function(e,t,o){e.inner_param&&oe(e.inner_param)?e.inner_param[t]=o:e.inner_param=u({},t,o)}},{key:"getChannelByActionType",value:function(e){var t="";return Le.getChannelClaimActionList().indexOf(e)>-1?t=this.gameInfo.channel||"":Le.getNoClaimActionList().indexOf(e)>-1&&(t="UNKNOWN"),t}},{key:"reportLog",value:function(e){var t,o,n={user_action_set_id:null==(t=this.config)?void 0:t.user_action_set_id,appid:null==(o=this.config)?void 0:o.appid,session_id:this.session_id};K(Object.assign(n,e))}},{key:"useAutoTrack",value:function(){var e;if(null!=(e=this.config)&&e.auto_track){var t=!0,o=G.getSync(O);(null==o?void 0:o.ap)===W?t=!0:(null==o?void 0:o.ap)===U&&(t=!1),"devtools"===H().wx_platform&&(t=!0),(new mt).install(this,t?"all":"lifecycle"),Ee(),t&&Je(),this.getAutoProxyRemoteConfig()}}},{key:"getAutoProxyRemoteConfig",value:function(){var e,t,o=H();o.os&&o.os_version&&null!=(e=this.config)&&e.user_action_set_id&&function(e){return new Promise(function(t){wx.request({method:"POST",url:"https://api.datanexus.qq.com/data-nexus-config/v1/sdk/minigame/get",data:e,timeout:L.requestTimeout,success:function(e){Z(e,t,"minigame/get"),ee(e)},fail:function(e){$(e,"minigame/get")}})})}({conf_name:"MG",conf_param:{user_action_set_id:null==(t=this.config)?void 0:t.user_action_set_id,sdk_version:this.sdk_version,os_type:(null==o?void 0:o.os)||"",os_version:ye(o.os_version),device_brand:(null==o?void 0:o.device_brand)||"",weixin_lib_version:(null==o?void 0:o.wx_lib_version)||"",weixin_version:(null==o?void 0:o.wx_version)||""}}).then(function(e){oe(e)&&G.setSync(O,e)})}},{key:"saveValidOpenidToStorage",value:function(){this.openid&&function(e){return/^[a-zA-Z0-9_-]{28,30}$/.test(e)}(this.openid)&&G.setSync(N,this.openid)}}],[{key:"setRequestConcurrency",value:function(e){yt.setRequestConcurrency(e)}},{key:"setDebug",value:function(e){me.debug=e}}]),t}();c.SDK=Rt,Rt[Tt]=[],It([ve],Rt.prototype,"track",1),It([ve,function(e,t,o){var n=o.value;return o.value=function(){if(this.inited){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return n.apply(this,t)}me.error("\u4e0a\u62a5\u5931\u8d25\uff0c\u8bf7\u5148\u5b8c\u6210\u521d\u59cb\u5316")},o}],Rt.prototype,"flush",1),It([ve],Rt.prototype,"setOpenId",1),It([ve],Rt.prototype,"setUnionId",1),It([ve],Rt.prototype,"setUserUniqueId",1),It([ve],Rt.prototype,"doReportOnEnterBackground",1),It([ve],Rt.prototype,"getTrackBaseInfo",1),It([ve],Rt.prototype,"useAutoTrack",1),cc._RF.pop(),cc._RF.pop()},{}],ios:[function(e,t){"use strict";cc._RF.push(t,"e0932EBuoZJsoIqMatM+zaZ","ios");var o=t;cc._RF.push(o,"e0932EBuoZJsoIqMatM+zaZ","ios"),cc._RF.pop(),cc._RF.pop()},{}],ks:[function(e,t){"use strict";cc._RF.push(t,"0a0ccYWngRC9ppNtW3GkLJN","ks");var o=t;cc._RF.push(o,"0a0ccYWngRC9ppNtW3GkLJN","ks"),cc._RF.pop(),cc._RF.pop()},{}],meizu:[function(e,t){"use strict";cc._RF.push(t,"322c1uiw19Fe692qw18ti2F","meizu");var o=t;cc._RF.push(o,"322c1uiw19Fe692qw18ti2F","meizu"),cc._RF.pop(),cc._RF.pop()},{}],oppo:[function(e,t){"use strict";cc._RF.push(t,"f5ece2cqctGgpuEAPpXwpQB","oppo");var o=t;cc._RF.push(o,"f5ece2cqctGgpuEAPpXwpQB","oppo"),cc._RF.pop(),cc._RF.pop()},{}],putTopPnl_SS:[function(e,t,o){"use strict";cc._RF.push(t,"69dde+kakBARbjdC9xNX6jW","putTopPnl_SS");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"69dde+kakBARbjdC9xNX6jW","putTopPnl_SS");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData_SS"),p=n("GameManager_SS"),d=n("PanelBase_SS"),f=cc._decorator,h=f.ccclass,y=(f.property,f.menu),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.start=function(){},t.prototype.clickClose=function(){p.default.playVibrateShort(),this.hide()},t.prototype.clickPutTop=function(){var e=this;p.default.playVibrateShort(),p.default.platform.showRewardAD(function(){e.hide(function(){u.default.ScrewSortCtrl.putTop()})})},l([h,y("ScrewSortGameUI/PutTop")],t)}(d.default);r.default=m,cc._RF.pop(),cc._RF.pop()},{}],qq:[function(e,t){"use strict";cc._RF.push(t,"46a3dt9PTdMW4AS9zHFT7xZ","qq");var o=t;cc._RF.push(o,"46a3dt9PTdMW4AS9zHFT7xZ","qq"),cc._RF.pop(),cc._RF.pop()},{}],regeneratorRuntime:[function(e,t){"use strict";cc._RF.push(t,"7b21egjZKpBmbiSqbSktMiB","regeneratorRuntime");var o=e("./typeof");function n(){t.exports=n=function(){return e},t.exports.__esModule=!0,t.exports.default=t.exports;var e={},i=Object.prototype,r=i.hasOwnProperty,a=Object.defineProperty||function(e,t,o){e[t]=o.value},c="function"==typeof Symbol?Symbol:{},s=c.iterator||"@@iterator",l=c.asyncIterator||"@@asyncIterator",u=c.toStringTag||"@@toStringTag";function p(e,t,o){return Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{p({},"")}catch(o){p=function(e,t,o){return e[t]=o}}function d(e,t,o,n){var i=t&&t.prototype instanceof y?t:y,r=Object.create(i.prototype),c=new A(n||[]);return a(r,"_invoke",{value:k(e,o,c)}),r}function f(e,t,o){try{return{type:"normal",arg:e.call(t,o)}}catch(e){return{type:"throw",arg:e}}}e.wrap=d;var h={};function y(){}function m(){}function g(){}var v={};p(v,s,function(){return this});var _=Object.getPrototypeOf,S=_&&_(_(O([])));S&&S!==i&&r.call(S,s)&&(v=S);var b=g.prototype=y.prototype=Object.create(v);function C(e){["next","throw","return"].forEach(function(t){p(e,t,function(e){return this._invoke(t,e)})})}function P(e,t){function n(i,a,c,s){var l=f(e[i],e,a);if("throw"!==l.type){var u=l.arg,p=u.value;return p&&"object"==o(p)&&r.call(p,"__await")?t.resolve(p.__await).then(function(e){n("next",e,c,s)},function(e){n("throw",e,c,s)}):t.resolve(p).then(function(e){u.value=e,c(u)},function(e){return n("throw",e,c,s)})}s(l.arg)}var i;a(this,"_invoke",{value:function(e,o){function r(){return new t(function(t,i){n(e,o,t,i)})}return i=i?i.then(r,r):r()}})}function k(e,t,o){var n="suspendedStart";return function(i,r){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw r;return{value:void 0,done:!0}}for(o.method=i,o.arg=r;;){var a=o.delegate;if(a){var c=w(a,o);if(c){if(c===h)continue;return c}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===n)throw n="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);n="executing";var s=f(e,t,o);if("normal"===s.type){if(n=o.done?"completed":"suspendedYield",s.arg===h)continue;return{value:s.arg,done:o.done}}"throw"===s.type&&(n="completed",o.method="throw",o.arg=s.arg)}}}function w(e,t){var o=t.method,n=e.iterator[o];if(void 0===n)return t.delegate=null,"throw"===o&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==o&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+o+"' method")),h;var i=f(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,h;var r=i.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function O(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,n=function t(){for(;++o<e.length;)if(r.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:R}}function R(){return{value:void 0,done:!0}}return m.prototype=g,a(b,"constructor",{value:g,configurable:!0}),a(g,"constructor",{value:m,configurable:!0}),m.displayName=p(g,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,p(e,u,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},C(P.prototype),p(P.prototype,l,function(){return this}),e.AsyncIterator=P,e.async=function(t,o,n,i,r){void 0===r&&(r=Promise);var a=new P(d(t,o,n,i),r);return e.isGeneratorFunction(o)?a:a.next().then(function(e){return e.done?e.value:a.next()})},C(b),p(b,u,"Generator"),p(b,s,function(){return this}),p(b,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),o=[];for(var n in t)o.push(n);return o.reverse(),function e(){for(;o.length;){var n=o.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=O,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(o,n){return a.type="throw",a.arg=e,t.next=o,n&&(t.method="next",t.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],a=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var n=this.tryEntries[o];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.finallyLoc===e)return this.complete(o.completion,o.afterLoc),T(o),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc===e){var n=o.completion;if("throw"===n.type){var i=n.arg;T(o)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,o){return this.delegate={iterator:O(e),resultName:t,nextLoc:o},"next"===this.method&&(this.arg=void 0),h}},e}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports,cc._RF.pop()},{"./typeof":"typeof"}],revivePnl_SS:[function(e,t,o){"use strict";cc._RF.push(t,"b751f3/zrRLwoki4gWo/8el","revivePnl_SS");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"b751f3/zrRLwoki4gWo/8el","revivePnl_SS");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData_SS"),p=n("GameManager_SS"),d=n("PanelBase_SS"),f=cc._decorator,h=f.ccclass,y=(f.property,f.menu),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.start=function(){},t.prototype.clickClose=function(){p.default.playVibrateShort(),this.hide()},t.prototype.clickRevive=function(){var e=this;p.default.playVibrateShort(),p.default.platform.showRewardAD(function(){u.default.lastTimeWatchingAd=(new Date).getTime(),u.default.ScrewSortCtrl.reviveTimes--,e.hide(function(){u.default.ScrewSortCtrl.revive()})})},l([h,y("ScrewSortGameUI/Revive")],t)}(d.default);r.default=m,cc._RF.pop(),cc._RF.pop()},{}],setPnl_SS:[function(e,t,o){"use strict";cc._RF.push(t,"adf4fov0oxMLpuCQmaa2yKn","setPnl_SS");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"adf4fov0oxMLpuCQmaa2yKn","setPnl_SS");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData_SS"),p=n("DataManager_SS"),d=n("GameManager_SS"),f=n("MusicManager_SS"),h=n("UIManager_SS"),y=n("PanelBase_SS"),m=cc._decorator,g=m.ccclass,v=m.property,_=m.menu,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onPosX=0,t.switchBgImg=[],t.Music=null,t.Sound=null,t.Vibrate=null,t.closeBtn=null,t.btns=null,t.title=null,t.title_set=null,t.title_pause=null,t.pageName="",t}return s(t,e),t.prototype.init=function(){u.default.curScene,this.bg.setPosition(0,h.default.instance.gamePnl.active?200:100),this.title.spriteFrame=h.default.instance.gamePnl.active?this.title_pause:this.title_set,this.btns.active=h.default.instance.gamePnl.active,this.updateSet(),this.pageName=h.default.instance.gamePnl.active?"PausePage":"SetPage"},t.prototype.updateSet=function(){var e=this.Music.getChildByName("switchBg");e.getComponent(cc.Sprite).spriteFrame=this.switchBgImg[1==p.default.musicOn?1:0],e.getChildByName("switch").x=1==p.default.musicOn?this.onPosX:-this.onPosX;var t=this.Sound.getChildByName("switchBg");t.getComponent(cc.Sprite).spriteFrame=this.switchBgImg[1==p.default.soundOn?1:0],t.getChildByName("switch").x=1==p.default.soundOn?this.onPosX:-this.onPosX;var o=this.Vibrate.getChildByName("switchBg");o.getComponent(cc.Sprite).spriteFrame=this.switchBgImg[1==p.default.vibrateOn?1:0],o.getChildByName("switch").x=1==p.default.vibrateOn?this.onPosX:-this.onPosX},t.prototype.clickSwitch=function(e,t){d.default.playVibrateShort(),"music"===t?(p.default.musicOn=!p.default.musicOn,p.default.musicOn?f.default.instance.BGMPlay():f.default.instance.BGMStop()):"sound"===t?p.default.soundOn=!p.default.soundOn:"vibrate"===t&&(p.default.vibrateOn=!p.default.vibrateOn),this.updateSet()},t.prototype.clickClose=function(){d.default.playVibrateShort(),this.hide(function(){})},t.prototype.clickGiveup=function(){d.default.playVibrateShort(),this.hide(function(){h.default.instance.gamePnlCtrl.gameClose()})},t.prototype.clickRestart=function(){d.default.playVibrateShort(),console.log("\u91cd\u73a9\u5173\u5361\uff0c\u6d88\u8017\u4f53\u529b"),this.hide(function(){h.default.instance.gamePnlCtrl.gameStart()})},t.prototype.clickContinue=function(){d.default.playVibrateShort(),this.hide(function(){})},l([v({tooltip:"\u5904\u4e8e\u6253\u5f00\u72b6\u6001\u7684x\u5750\u6807"})],t.prototype,"onPosX",void 0),l([v(cc.SpriteFrame)],t.prototype,"switchBgImg",void 0),l([v(cc.Node)],t.prototype,"Music",void 0),l([v(cc.Node)],t.prototype,"Sound",void 0),l([v(cc.Node)],t.prototype,"Vibrate",void 0),l([v(cc.Node)],t.prototype,"closeBtn",void 0),l([v(cc.Node)],t.prototype,"btns",void 0),l([v(cc.Sprite)],t.prototype,"title",void 0),l([v(cc.SpriteFrame)],t.prototype,"title_set",void 0),l([v(cc.SpriteFrame)],t.prototype,"title_pause",void 0),l([g,_("ScrewSortGameUI/Set")],t)}(y.default);r.default=S,cc._RF.pop(),cc._RF.pop()},{}],testPanel_BP:[function(e,t,o){"use strict";cc._RF.push(t,"7cdce1JrVZAxJjiQ4hlFliK","testPanel_BP");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"7cdce1JrVZAxJjiQ4hlFliK","testPanel_BP");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("GameManager_BP"),p=n("LevelDataMgr_BP"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.levelInput=null,t.btn_Jump=null,t.btn_Close=null,t.tips_Label=null,t.btn_LevelComplete=null,t}return s(t,e),t.prototype.onLoad=function(){this.btn_Jump&&this.btn_Jump.on(cc.Node.EventType.TOUCH_END,this.onJumpClick,this),this.btn_Close&&this.btn_Close.on(cc.Node.EventType.TOUCH_END,this.onCloseClick,this),this.levelInput&&this.levelInput.node.on("editing-return",this.onJumpClick,this)},t.prototype.onEnable=function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},t.prototype.onDisable=function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},t.prototype.onKeyDown=function(e){e.keyCode===cc.macro.KEY.enter&&this.onJumpClick()},t.prototype.show=function(){this.levelInput.node.active=!0,this.btn_Jump.active=!0,this.btn_Close.opacity=255,this.tips_Label.node.active=!0,this.btn_LevelComplete.active=!0,this.levelInput&&(this.levelInput.string=""),this.updateTips("")},t.prototype.hide=function(){this.levelInput.node.active=!1,this.btn_Jump.active=!1,this.btn_Close.opacity=0,this.tips_Label.node.active=!1,this.btn_LevelComplete.active=!1},t.prototype.onJumpClick=function(){if(this.levelInput){var e=this.levelInput.string.trim();if(e){var t=parseInt(e,10);if(isNaN(t)||t<=0)this.updateTips("\u8bf7\u8f93\u5165\u6709\u6548\u7684\u5173\u5361\u53f7");else if(p.LevelDataMgr_BP.getLevelData(t)){var o=u.default.instance;o?(o.jumpToLevel(t),this.updateTips("\u5df2\u8df3\u8f6c\u5230\u7b2c "+t+" \u5173")):this.updateTips("GameManager \u672a\u521d\u59cb\u5316")}else this.updateTips("\u5173\u5361 "+t+" \u4e0d\u5b58\u5728")}else this.updateTips("\u8bf7\u8f93\u5165\u5173\u5361\u53f7")}else this.updateTips("\u8f93\u5165\u6846\u672a\u7ed1\u5b9a")},t.prototype.onCloseClick=function(){255===this.btn_Close.opacity?this.hide():this.show()},t.prototype.updateTips=function(e){this.tips_Label&&(this.tips_Label.string=e)},t.prototype.onLevelCompleteClick=function(){var e=u.default.instance;e?(e.notifyLevelComplete(),this.updateTips("\u5df2\u89e6\u53d1\u5173\u5361\u5b8c\u6210\uff08\u6d4b\u8bd5\u7528\uff09")):this.updateTips("GameManager \u672a\u521d\u59cb\u5316")},l([h(cc.EditBox)],t.prototype,"levelInput",void 0),l([h(cc.Node)],t.prototype,"btn_Jump",void 0),l([h(cc.Node)],t.prototype,"btn_Close",void 0),l([h(cc.Label)],t.prototype,"tips_Label",void 0),l([h(cc.Node)],t.prototype,"btn_LevelComplete",void 0),l([f],t)}(cc.Component);r.default=y,cc._RF.pop(),cc._RF.pop()},{}],test:[function(e,t,o){"use strict";cc._RF.push(t,"7dd42TlFEFIn69ZSfkCxHDI","test");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"7dd42TlFEFIn69ZSfkCxHDI","test");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData"),p=cc._decorator,d=p.ccclass,f=(p.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.onBtn_jump=function(){wx.navigateToMiniProgram({appId:"wx81542a40deb82337",path:"?wxgamecid=CCBgAAoXkpQY8rW4zhMYvn",extraData:{userId:u.default.openId},success:function(){}})},l([d],t)}(cc.Component));r.default=f,cc._RF.pop(),cc._RF.pop()},{}],toPrimitive:[function(e,t){"use strict";cc._RF.push(t,"81899TNsO5N4KcEQ4Xm8YQQ","toPrimitive");var o=e("./typeof");t.exports=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},cc._RF.pop()},{"./typeof":"typeof"}],toPropertyKey:[function(e,t){"use strict";cc._RF.push(t,"1ec78/jXddLOY2J7sQJtmJB","toPropertyKey");var o=e("./typeof"),n=e("./toPrimitive");t.exports=function(e){var t=n(e,"string");return"symbol"===o(t)?t:String(t)},cc._RF.pop()},{"./toPrimitive":"toPrimitive","./typeof":"typeof"}],toutiao:[function(e,t,o){"use strict";cc._RF.push(t,"07763cEYQZEaonbb81gNa6O","toutiao");var n=e,i=t,r=o;cc._RF.push(i,"07763cEYQZEaonbb81gNa6O","toutiao"),Object.defineProperty(r,"__esModule",{value:!0}),r.getUserData=r.navigateToScene=r.checkSidebarState=r.checkShortcut=r.getLaunchOptions=r.reportScene=r.reportAdPointEvent=r.reportShareEvent=r.reportLevelTimeEvent=r.reportVideoEvent=r.reportVideoError=r.reportPageEvent=r.reportButtonEvent=r.getRankList=r.setRankData=r.removeDownloadFile=r.downImageFile=r.loadSubpackage=r.addshortCut=r.onShow=r.onHide=r.toMiniGame=r.getSystemInfo=r.getSystemInfoSync=r.vibrateShort=r.vibrateLong=r.showModal=r.shareLp=r.stopLp=r.resumeLp=r.pauseLp=r.startLp=r.inviteShowShare=r.showShare=r.setMoreGamesInfo=r.showTips=r.openShare=r.showRewardAD=r.showInterstitialAd=r.preloadInterstitialAd=r.createInterstitialAd=r.showBannerAD=r.createRewardedVideoAd=r.createBannerAd=r.login=r.checkauthorize=r.initAds=r.init=r.getRandomLabelUrl=r.getRandomImageUrl=void 0,r.joinGroup=r.inviter=r.invited=r.getGameTitle=r.onFeedStatusChange=r.checkFeedSubscribeStatus=r.requestFeedSubscribe=r.forceGC=r.copyToClipboard=r.getTTOpenId=r.setWhiteList=r.getImg=r.getUserInfo=r.authorize=void 0;var a,c,s=n("AppConfig"),l=n("CommonData"),u=n("CupMgr"),p=n("const"),d=n("DataManager"),f=n("Rankdata"),h=cc._decorator,y=(h.ccclass,h.property,"https://api.flysheeep.com/api/expro/getttopenid"),m=s.appId,g=s.version,v=s.gameTitle,_=s.interAD_ID,S=s.rewardAD_ID,b=null,C=null,P=!1,k=0,w=[],I=[];function T(){var e=Math.floor(Math.random()*I.length);return I[e]}function A(){var e=Math.floor(Math.random()*w.length);return w[e]}r.getRandomImageUrl=T,r.getRandomLabelUrl=A;var O=null;function R(e,t){void 0===e&&(e=null),void 0===t&&(t=null),tt.login({force:!1,success:function(o){console.error("login \u8c03\u7528\u6210\u529f"+o.code+" "+o.anonymousCode),o.isLogin?e&&e(o):t&&t()},fail:function(e){console.error("login \u8c03\u7528\u5931\u8d25",e),t&&t()}})}function N(){tt.createRewardedVideoAd&&((C=tt.createRewardedVideoAd({adUnitId:S})).onLoad(function(){console.log("\u52a0\u8f7d\u6210\u529f")}),C.onClose(function(e){cc.director.emit(p.EventNames.OnVideoAdEnd),e&&e.isEnded||void 0===e?(console.log("\u64ad\u653e\u5b8c\u6210\u5173\u95ed"),tq_sdk.tt_ogzt.watchVideoAdCompletedReport(),null!=u.default.getInstance()&&u.default.getInstance().currentLevelAdWatchedCount++,a&&(a(),a=null)):(E("\u5b8c\u6574\u89c2\u770b\u89c6\u9891\u624d\u80fd\u83b7\u5f97\u5956\u52b1\u54e6"),c&&(c(),c=null))}),C.onError(function(e){D("load_fail",JSON.stringify(e),e.errCode),console.log("Rewarded \u52a0\u8f7d\u5931\u8d25"+e,e.errCode)}),C.load())}r.init=function(){l.default.appId=m,l.default.version=g;var e=tt.getLaunchOptionsSync();O=e.query,console.log("query",O),l.default.sceneId=e.scene,console.log("sceneId",l.default.sceneId),"3041"===l.default.sceneId.toString().slice(-4)&&(l.default.feedType=parseInt(O.feed_game_channel),console.log("feedType",l.default.feedType),tt.onFeedStatusChange(function(e){var t=e.type;"feedEnter"===t&&(2===l.default.feedType?l.default.sceneId="FeedNew":1===l.default.feedType&&(l.default.sceneId="FeedReturn"),x("StarlLevel","normal",l.default.CurrentLevel,l.default.sceneId)),"feedExit"===t&&console.log("\u89e6\u53d1\u4ece\u5c0f\u6e38\u620f\u9000\u56de\u5230Feed\u6d41\u4e8b\u4ef6\u56de\u8c03")})),"1001"===l.default.sceneId.toString().slice(-4)&&(l.default.ifOpenBySidebar=!0),this.checkauthorize(),this.getTTOpenId().then(function(){console.warn("openId",l.default.openId),console.log("appId",l.default.appId),tq_sdk.tt_ogzt.init(l.default.appId,l.default.openId),U(),O&&O.openId&&!l.default.IsFirstInvited&&j(O.openId),G(),l.default.IsFirstInvited=!0,d.default.tryUpdateUserData(!0),d.default.tryUpdateGoldCoin(!0),f.default.getRankData()})},r.initAds=function(){L(),N()},r.checkauthorize=function(){tt.getSetting({success:function(e){e.authSetting["scope.userInfo"]?(P=e.authSetting["scope.userInfo"],console.log("\u5df2\u6388\u6743!"),W(function(){})):console.log("\u672a\u6388\u6743!",e)},fail:function(){console.log("\u672a\u6388\u6743!")}})},r.login=R,r.createBannerAd=function(){},r.createRewardedVideoAd=N,r.showBannerAD=function(){};var M=!1;function L(){_&&""!==_&&tt.createInterstitialAd&&(console.error("createInterstitialAd"),(b=tt.createInterstitialAd({adUnitId:_})).onLoad(function(){M=!0}),b.onClose(function(){M=!1,b&&b.destroy&&(b.destroy(),b=null)}),b.onError(function(){L()}))}function E(e){tt.showToast({title:e,icon:"none",duration:2500})}function F(e){tt.shareAppMessage({success:function(){console.log("\u5206\u4eab\u6210\u529f\uff01"),e&&e()},fail:function(){console.log("\u5206\u4eab\u5931\u8d25\uff01"),E("\u5206\u4eab\u5931\u8d25\uff01")},complete:function(){console.log("complete")}})}function x(e,t,o,n){console.log("reportPageEvent",e,t,o,n),tt.reportAnalytics("Page",{name:e,mode:t,level:l.default.CurrentLevel,scene:l.default.sceneId})}function D(e,t,o,n,i){console.log("reportVideoError",e,t,o,n,i),tt.reportAnalytics("Video",{name:e,mode:t,level:l.default.CurrentLevel,type:o,scene:l.default.sceneId})}function B(e,t){void 0===e&&(e=null),void 0===t&&(t=null),tt.authorize({scope:"scope.userInfo",success:function(){P=!0,console.log("\u6388\u6743\u6210\u529f"),e&&e()},fail:function(e){console.error("\u6388\u6743\u5931\u8d25",e),t&&t()}})}function W(e,t){void 0===e&&(e=null),void 0===t&&(t=null),tt.getUserInfo({success:function(t){console.log("\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u6210\u529f",t.userInfo),e&&e(t.userInfo)},fail:function(e){console.error("\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u5931\u8d25",e),t&&t()}})}function U(){tt.request({url:"https://api.flysheeep.com/api/user/get_user_type",header:{"Content-Type":"application/json;charset=utf-8","x-appid":l.default.appId},data:{open_id:l.default.openId},method:"POST",success:function(e){var t=e.data.data;if(t.user_type){var o=t.user_type;console.warn("\u7528\u6237\u7c7b\u578b",o),1==o?(l.default.ifTest=!0,l.default.ifSkipAd=!0):(l.default.ifTest=!1,l.default.ifSkipAd=!1)}},fail:function(e){console.error("------------get usertype_fail---------fail-------",e)}})}function j(e){tt.request({url:"https://api.flysheeep.com/api/sparrow/set_sparrow_invite",data:{app_id:l.default.appId,open_id:e,open_id_invitee:l.default.openId},header:{"content-type":"application/json","x-appid":l.default.appId},method:"POST",dataType:"JSON",responseType:"text",success:function(){l.default.IsFirstInvited=!0},fail:function(e){console.error("\u4e0a\u4f20\u88ab\u9080\u8bf7\u5931\u8d25",e)}})}function G(e){void 0===e&&(e=function(){}),tt.request({url:"https://api.flysheeep.com/api/sparrow/get_sparrow_invite",data:{app_id:l.default.appId,open_id:l.default.openId},header:{"content-type":"application/json","x-appid":l.default.appId},method:"POST",dataType:"JSON",responseType:"text",success:function(t){t&&t.data&&(t=JSON.parse(t.data)),t.data.count?(l.default.InviteCount=t.data.count,e&&e()):console.log("\u83b7\u53d6\u9080\u8bf7\u4eba\u6570\u5931\u8d25",t)},fail:function(e){console.log("\u83b7\u53d6\u9080\u8bf7\u4eba\u6570\u5931\u8d25",e,l.default.openId,{appid:l.default.appId,code:e.code})}})}r.createInterstitialAd=L,r.preloadInterstitialAd=function(){b?b.load():L()},r.showInterstitialAd=function(){console.error("showInterstitialAd"),"Douyin"!==tt.getSystemInfoSync().appName&&"douyin_lite"!==tt.getSystemInfoSync().appName||_&&""!==_&&(Date.now()-k<=3e4?console.error("showInterstitialAd fail err: \u95f4\u9694\u5c0f\u4e8e30s"):null==b||M?null!=b&&M?(console.error("showInterstitialAd success"),k=Date.now(),b.show()):(console.error("show interAD is null, recreate"),L()):b.load().then(function(){k=Date.now(),b.show()}).catch(function(e){console.error("showInterstitialAd fail err:",e)}))},r.showRewardAD=function(e){return void 0===e&&(e=function(){}),new Promise(function(t,o){if(null==C)return N(),E("\u6682\u65f6\u6ca1\u6709\u53ef\u64ad\u653e\u7684\u5e7f\u544a\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5!"),void o("\u6682\u65f6\u6ca1\u6709\u53ef\u64ad\u653e\u7684\u5e7f\u544a\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5!");C.show().then(function(){cc.director.emit(p.EventNames.OnVideoAdStart),a=function(){e(),t("\u64ad\u653e\u5b8c\u6210\u5173\u95ed")},c=function(){o("\u5b8c\u6574\u89c2\u770b\u89c6\u9891\u624d\u80fd\u83b7\u5f97\u5956\u52b1\u54e6")}}).catch(function(n){D("show_fail1",JSON.stringify(n),n.errCode),C.load().then(function(){C.show().then(function(){cc.director.emit(p.EventNames.OnVideoAdStart),a=function(){e(),t("\u64ad\u653e\u5b8c\u6210\u5173\u95ed")},c=function(){o("\u5b8c\u6574\u89c2\u770b\u89c6\u9891\u624d\u80fd\u83b7\u5f97\u5956\u52b1\u54e6")}}).catch(function(n){D("show_fail2",JSON.stringify(n),n.errCode);var i=Date.now();(!l.default.lastRewardAdFailShareTime||i-l.default.lastRewardAdFailShareTime>=36e5)&&(l.default.lastRewardAdFailShareTime=i,l.default.lastRewardAdFailCallShareTimes=0),l.default.lastRewardAdFailCallShareTimes<=5?(l.default.lastRewardAdFailCallShareTimes+=1,F(e),t("\u901a\u8fc7\u5206\u4eab\u83b7\u5f97\u5956\u52b1")):(E("\u6682\u65f6\u62c9\u53d6\u4e0d\u5230\u5e7f\u544a\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5"),o("\u5206\u4eab\u6b21\u6570\u5df2\u8fbe\u4e0a\u9650"))})})})})},r.openShare=function(){wx.showShareMenu&&(wx.showShareMenu({withShareTicket:!0}),wx.onShareAppMessage(function(){return{title:T(),imageUrl:T()}}))},r.showTips=E,r.setMoreGamesInfo=function(){tt.setMoreGamesInfo&&tt.setMoreGamesInfo({appLaunchOptions:[]})},r.showShare=F,r.inviteShowShare=function(){var e=tt.getSystemInfoSync();"Douyin"==e.appName||"douyin_lite"==e.appName?tt.shareAppMessage({title:A(),imageUrl:T(),query:"openId="+l.default.openId,channel:"invite",success:function(){console.log("\u5206\u4eab\u6210\u529f\uff01")},fail:function(){console.log("\u5206\u4eab\u5931\u8d25\uff01"),E("\u5206\u4eab\u5931\u8d25\uff01")},complete:function(){console.log("complete")}}):tt.shareAppMessage({title:A(),imageUrl:T(),query:"openId="+l.default.openId,success:function(){console.log("\u5206\u4eab\u6210\u529f\uff01")},fail:function(){console.log("\u5206\u4eab\u5931\u8d25\uff01"),E("\u5206\u4eab\u5931\u8d25\uff01")},complete:function(){console.log("complete")}})},r.startLp=function(){console.log("startLp")},r.pauseLp=function(){},r.resumeLp=function(){},r.stopLp=function(){console.log("stopLp")},r.shareLp=function(){tt.showToast({title:"\u5f55\u5236\u89c6\u9891\u4e0d\u8db33s",icon:"none",duration:2e3})},r.showModal=function(e,t,o,n){tt.showModal({title:e,content:t,success:function(e){e.confirm?o&&o():e.cancel&&n&&n()},fail:function(){console.log("showModal\u8c03\u7528\u5931\u8d25")}})},r.vibrateLong=function(){tt.vibrateLong({success:function(e){console.log(""+e)},fail:function(){console.log("vibrateLong\u8c03\u7528\u5931\u8d25")}})},r.vibrateShort=function(){tt.vibrateShort({success:function(e){console.log(""+e)},fail:function(){console.log("vibrateShort\u8c03\u7528\u5931\u8d25")}})},r.getSystemInfoSync=function(){try{return tt.getSystemInfoSync()}catch(n){console.log("getSystemInfoSync fail")}},r.getSystemInfo=function(e){tt.getSystemInfo({success:function(){e.success()},fail:function(){e.fail&&e.fail()},complete:function(){e.complete&&e.complete()}})},r.toMiniGame=function(){tt.showMoreGamesModal({appLaunchOptions:[],success:function(e){console.log("success",e.errMsg)},fail:function(e){console.log("fail",e.errMsg)}})},r.onHide=function(e){tt.onHide(function(){e()})},r.onShow=function(e){tt.onShow(function(){e()})},r.addshortCut=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null),tt.addShortcut({success:function(){console.log("\u6dfb\u52a0\u684c\u9762\u6210\u529f"),tt.showToast({title:"\u6dfb\u52a0\u684c\u9762\u6210\u529f",icon:"none",duration:2500}),e&&e()},fail:function(e){console.log("\u6dfb\u52a0\u684c\u9762\u5931\u8d25",e.errMsg),t&&t(),tt.showToast({title:"\u6dfb\u52a0\u684c\u9762\u5931\u8d25",icon:"none",duration:2500})}})},r.loadSubpackage=function(e){return new Promise(function(t,o){tt.loadSubpackage({name:e,success:function(){console.log("\u5934\u6761\u52a0\u8f7d\u5206\u5305====> \u6210\u529f","\u5206\u5305\u540d:"+e),t(0)},fail:function(t){console.log("\u5934\u6761\u52a0\u8f7d\u5206\u5305====> \u5931\u8d25","\u5206\u5305\u540d:"+e,"err = "+t),o()}})})},r.downImageFile=function(e){for(var t=""+tt.env.USER_DATA_PATH,o=e.split("resource/")[1];-1!=o.indexOf("/");){var n=o.indexOf("/"),i=o.substring(0,n),r=o.substring(n+1,o.length);o=i+"-"+r}var a=t+"/"+o,c=tt.getFileSystemManager();return new Promise(function(t,o){c.stat({path:a,success:function(e){e.stats.isDirectory(),e.stats.isFile()&&t(a)},fail:function(){tt.downloadFile({url:e,success:function(e){tt.saveFile({tempFilePath:e.tempFilePath,filePath:a,success:function(){console.log("\u4fdd\u5b58\u5230\u672c\u5730!!!"),t(a)},fail:function(){o("\u6587\u4ef6\u4fdd\u5b58\u5931\u8d25!")}})},fail:function(){o("\u6587\u4ef6\u4e0b\u8f7d\u5931\u8d25!")}})}})})},r.removeDownloadFile=function(e){for(var t=""+tt.env.USER_DATA_PATH,o=e.split("resource/")[1];-1!=o.indexOf("/");){var n=o.indexOf("/"),i=o.substring(0,n),r=o.substring(n+1,o.length);o=i+"-"+r}var a=t+"/"+o,c=tt.getFileSystemManager();return new Promise(function(t,o){c.stat({path:a,success:function(n){n.stats.isFile()&&(c.unlink({filePath:a,success:function(){console.log("\u5220\u9664\u672c\u5730\u56fe\u7247\u6210\u529f!!!!!",e),t(0)},fail:function(){o()}}),t(a))},fail:function(){console.log("\u672c\u5730\u56fe\u7247\u4e0d\u5b58\u5728",e),t(0)}})})},r.setRankData=function(e,t,o,n){"Douyin"==tt.getSystemInfoSync().appName&&tt.setImRankData({dataType:e,value:t,priority:o||0,extra:n||"",zoneId:"waterSort",success:function(e){console.log("setImRankData success res: "+e)},fail:function(e){console.log("setImRankData fail res: "+e.errMsg)}})},r.getRankList=function(){console.log("getRankList"),"Douyin"==tt.getSystemInfoSync().appName?tt.getImRankList({relationType:"default",dataType:0,rankType:"week",suffix:"\u5173",rankTitle:v,zoneId:"waterSort",success:function(e){console.log("getImRankData success res: "+e)},fail:function(e){console.error("getImRankData fail res: "+e.errMsg)}}):tt.showToast({title:"\u8be5\u5e73\u53f0\u6682\u65e0\u6392\u884c\u699c",icon:"none",duration:1500})},r.reportButtonEvent=function(e,t,o,n,i){console.log("reportButtonEvent",e,t,o,n,i),tt.reportAnalytics("Button",{name:e,mode:o,level:l.default.CurrentLevel,type:t,scene:l.default.sceneId})},r.reportPageEvent=x,r.reportVideoError=D,r.reportVideoEvent=function(e,t,o,n,i){console.log("reportVideoEvent",e,t,o,n,i),tt.reportAnalytics("Video",{name:e,mode:t,level:l.default.CurrentLevel,type:o,scene:l.default.sceneId})},r.reportLevelTimeEvent=function(e,t,o,n,i){console.log("reportLevelTimeEvent",e,t,o,n,i),tt.reportAnalytics("LevelTime",{name:e,mode:o,time:t,level:l.default.CurrentLevel,scene:l.default.sceneId})},r.reportShareEvent=function(e,t,o,n){console.log("reportShareEvent",e,t,o,n),tt.reportAnalytics("Share",{name:e,title:" ",imageUrl:" ",scene:l.default.sceneId})},r.reportAdPointEvent=function(e,t,o,n,i){console.log("reportAdPointEvent",e,t,o,n,i),tt.reportAnalytics("AdPoint",{name:e,mode:o,level:l.default.CurrentLevel,progress:t,scene:l.default.sceneId})},r.reportScene=function(e,t){tt.reportScene({sceneId:e,costTime:t,success:function(e){console.log(e)},fail:function(e){console.log(e)}})},r.getLaunchOptions=function(e){if(tt.getLaunchOptionsSync){var t=tt.getLaunchOptionsSync()[e].toString();if(!t)return console.error("getLaunchOptions no info"),null;if("scene"===e)return console.log("\u767b\u5f55\u573a\u666f ",t),t}},r.checkShortcut=function(){return new Promise(function(e){tt.checkShortcut({success:function(t){console.log("\u68c0\u67e5\u5feb\u6377\u65b9\u5f0f",t.status),t.status.exist?(l.default.ifAddDesktop=!0,console.log("\u5df2\u6dfb\u52a0\u684c\u9762\u5feb\u6377\u65b9\u5f0f"),e(!0)):(l.default.ifAddDesktop=!1,console.log("\u672a\u6dfb\u52a0\u684c\u9762\u5feb\u6377\u65b9\u5f0f"),e(!1))},fail:function(e){console.log("\u68c0\u67e5\u5feb\u6377\u65b9\u5f0f\u5931\u8d25",e.errMsg)}})})},r.checkSidebarState=function(){return new Promise(function(e,t){tt.getSystemInfo({success:function(o){console.log(o.appName),"Douyin"==o.appName||"douyin_lite"==o.appName?tt.checkScene?tt.checkScene({scene:"sidebar",success:function(){e(!0)},fail:function(e){console.error("check scene fail:",e),t()}}):(console.log("\u6b64\u7248\u672c\u4e0d\u652f\u6301\u4fa7\u8fb9\u680f"),t()):(console.log("\u6b64\u5e94\u7528\u4e0d\u652f\u6301\u4fa7\u8fb9\u680f"),t())},fail:function(){console.error("getSystemInfo \u8c03\u7528\u5931\u8d25"),t()}})})},r.navigateToScene=function(e){tt.navigateToScene&&tt.navigateToScene({scene:e,success:function(){},fail:function(){}})},r.getUserData=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null),P||R(B.bind(this,W.bind(this,e,t),t),t)},r.authorize=B,r.getUserInfo=W,r.getImg=function(e){return new Promise(function(t){if(e){var o=tt.createImage();o.src=e,o.onload=function(){var e=new cc.Texture2D;e.initWithElement(o),e.handleLoadedTexture(),t(new cc.SpriteFrame(e))}}else t(null)})},r.setWhiteList=U,r.getTTOpenId=function(){return new Promise(function(e){var t=cc.sys.localStorage.getItem("openId");t?(l.default.openId=t,e(t)):tt.login({success:function(t){var o;o=t.isLogin?t.code:t.anonymousCode,tt.request({url:y,header:{"Content-Type":"application/json;charset=utf-8","x-appid":l.default.appId},data:{appid:m,code:o},method:"POST",success:function(t){var o=t.data.data;o.openid?l.default.openId=o.openid:o.anonymous_openid&&(l.default.openId=o.anonymous_openid),cc.sys.localStorage.setItem("openId",l.default.openId),e(l.default.openId)},fail:function(e){console.error("------------get openid---------fail-------",e)}})},fail:function(e){console.error("------------login---------fail-------",e)}})})},r.copyToClipboard=function(e){tt.setClipboardData({data:e,success:function(){tt.showToast({title:"\u590d\u5236\u6210\u529f",icon:"none",duration:1500})},fail:function(){tt.showToast({title:"\u590d\u5236\u5931\u8d25",icon:"none",duration:1500})}})},r.forceGC=function(){tt.triggerGC?(tt.triggerGC(),console.log("\u5f3a\u5236\u89e6\u53d1\u5783\u573e\u56de\u6536")):console.warn("\u5f53\u524d\u5b57\u8282\u7248\u672c\u4e0d\u652f\u6301\u5f3a\u5236\u89e6\u53d1\u5783\u573e\u56de\u6536")},r.requestFeedSubscribe=function(e,t){if(void 0===e&&(e=null),void 0===t&&(t=null),"Douyin"===tt.getSystemInfoSync().appName){var o=["CONTENT12491558146"];"tt1a6c6cd18564383c02"==m&&(o=["CONTENT13183815170"]),tt.requestFeedSubscribe({type:"play",scene:3,contentIDs:o,success:function(o){console.log(o.success),o.success?e&&e():(t&&t(),console.log("\u8ba2\u9605\u5931\u8d25",o))},fail:function(e){t&&t(),console.log(e.errMsg)}})}},r.checkFeedSubscribeStatus=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null),"Douyin"===tt.getSystemInfoSync().appName&&(function(e,t){e=e.split("."),t=t.split(".");for(var o=Math.max(e.length,t.length);e.length<o;)e.push("0");for(;t.length<o;)t.push("0");for(var n=0;n<o;n++){var i=parseInt(e[n]),r=parseInt(t[n]);if(i>r)return 1;if(i<r)return-1}return 0}(tt.getSystemInfoSync().SDKVersion,"3.34.0")<0||tt.checkFeedSubscribeStatus({type:"play",scene:3,success:function(t){e&&e(t),console.log(t.status)},fail:function(e){t&&t(),console.log(e.errMsg)}}))},r.onFeedStatusChange=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null),"Douyin"===tt.getSystemInfoSync().appName&&tt.onFeedStatusChange(function(o){var n=o.type;"feedEnter"===n&&(e&&e(),console.log("\u89e6\u53d1\u4eceFeed\u6d41\u8fdb\u5165\u5c0f\u6e38\u620f\u4e8b\u4ef6\u56de\u8c03")),"feedExit"===n&&(t&&t(),console.log("\u89e6\u53d1\u4ece\u5c0f\u6e38\u620f\u9000\u56de\u5230Feed\u6d41\u4e8b\u4ef6\u56de\u8c03"))})},r.getGameTitle=function(){return v},r.invited=j,r.inviter=G,r.joinGroup=function(){tt.joinGroup({groupid:"@4F9QhaHBD5xpOnOiMoBlQqL41WeGOv2LM5V2oA6jJ1IVbvD10HbmcmIujgn96zUFS6bsK0eyA/RC/p1qAxxfsg==",sessionFrom:"sessionFrom",extraInfo:"extraInfo",success:function(e){console.error(e)},fail:function(e){console.error(e)}})},cc._RF.pop(),cc._RF.pop()},{}],tq_sdk:[function(e,t){"use strict";cc._RF.push(t,"661e712m/lItb4jViTdH2QD","tq_sdk");var o,n,i,r,a=e("./helpers/regeneratorRuntime"),c=e("./helpers/asyncToGenerator"),s=e("./helpers/classCallCheck"),l=e("./helpers/createClass"),u="jsjiami.com.v7",p=d;function d(e,t){var o=f();return(d=function(t,n){var i=o[t-=416];if(void 0===d.iFQJzP){var r=function(e){for(var t,o,n="",i="",r=0,a=0;o=e.charAt(a++);~o&&(t=r%4?64*t+o:o,r++%4)?n+=String.fromCharCode(255&t>>(-2*r&6)):0)o="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(o);for(var c=0,s=n.length;c<s;c++)i+="%"+("00"+n.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(i)},a=function(e,t){var o,n,i=[],a=0,c="";for(e=r(e),n=0;n<256;n++)i[n]=n;for(n=0;n<256;n++)a=(a+i[n]+t.charCodeAt(n%t.length))%256,o=i[n],i[n]=i[a],i[a]=o;n=0,a=0;for(var s=0;s<e.length;s++)a=(a+i[n=(n+1)%256])%256,o=i[n],i[n]=i[a],i[a]=o,c+=String.fromCharCode(e.charCodeAt(s)^i[(i[n]+i[a])%256]);return c};d.KAmHyQ=a,e=arguments,d.iFQJzP=!0}var c=o[0],s=t+c,l=e[s];return l?i=l:(void 0===d.wDiWYy&&(d.wDiWYy=!0),i=d.KAmHyQ(i,n),e[s]=i),i})(e,t)}function f(){var e=[u,"tCbBjsFjCiOyaWLmhti.YFcMAowmCe.Vv7MkOJlt==","wCkBWQbloCoN","WP/dGeTjlq","W5WfWPzbW55IWPhcLMLVWRq","BGuVgLFcTmowW7OFWQ7dRG","paryjZW","xJqjdfVcUSoLWPpdR8oSDSoNhSk0","mqjEod1xWPpdO8kvqMrCW44+WRCKW5VcSZrKrL3dStSCxxfnirJdSmosgCk1D08bWRpdLgdcKqXadaLnW7SpW4tcKYhcOfTiW7dcRCkN","W487W4yyW6b3W4y6","W6HYDIFcPCow","rCotneqa","tNL4A8k1","BSkfpq7cRq","xfldNc/dGmkfW5JdMCkZWQy","WQ46W6/dJq","W4LrEcVcMG","WOhdM2BcTx4","pmkNAd5mzCobj8oeardcSCkbWQiZWPbPWQhcQ2pdSCoYwM/cTH/cO8ohW6ldOSkqW7D6WPjQAmoYsmkdWPPxD8koWRChW6ZdHmoFcrzA","bmk3EI8","WQv5pmko","hqpdSXi9","tIaXh3y","o8oECCkGnq","W5LoFbNcG8oBsdBcQ3xcNIS5pmkVo1DnWOtdL1hcUXOdW5OreIlcVWiDW4/cOg1IW4H/wmo+W7NdPCoAzW5NxCoxWQFdNhhcMa","a8oCwCkPfmo0","W7emWRxcQYiw","W5W+WPzHW5ZcR3BdU8kzWRb6","gNxdKmoTWOy","rSkrWRK2WPi","WR0bjx/dJq","WO9LW4qZWOm","cXldSru","bmk0DYNdUSk3WQu","WPmsm0O","rwWPjSoj","dHFdPH0S","W7ivW4FdICoBWOyzueq","W6qkW4SwW4y","y8oOaGuVdxFcLCoPWRu","ctf0ySkaWOlcTSkxW4zRW6TqW6KyW4BcSCkwjIZcHSkKW61rW7qsv8kpW6FdHYRcSCoAW68","WPddUb3cKW","W4a1W40","WRmjuqiAWQ/dHCoibmoTWRDoWPBdMITdW5qdwCo1mh7dNSkXW50xzCo7WP7dNf4VnH7cVxJcSeFcPmovW71Xu0hcK0JcLG","bNZdPaJdRXBOSyhNL6pLP57OT4tcKqldHHxcRSo2oW","W4OAuCoJW5K","cbS+oq","WQK1aLRdTa","BSofFbS1WRxcISofpSk8dSk2xa","6zwS6k+s55UNA8o5hCk9FEAkLSkuW5rxm10x","WOxdRxpcOL0nogldTSkW","BSofFbS1WRxcISofpSkGdSkIxmoUW5ldOW","lCk6nM8yjSomiSozgW","W6GEv8oyW6ldO27cLrZcOHC","W7K6WQzWW7i","WP/dPfD0","DmoPmheHjmovkSoquG","s8k7WOmZWOW5eW","W4aZW4FdLmoN","W4OuW47dMSoF","W5W0kuxdSmkWrG","WPn8fSksW5m","r8opWOdcLSk/","W6aXWPq8oG","dsqDCmk7WQTRwCko","tu8lWOa","WPCixKtcGG","W4uGW4xdSa","WOFdV2tcVG","W4KyW5ZdLCov","jxtdJmo4WPeiW4VcGCkc","vSkYW6NdQLa","WOtdJ2BcV2G","W5jfbrxdN8oRAwCmWOPGtr4","i2CSECoV","xmkemdhcHq","WRf3kSkf","W4WoWOa","W4eAy0e","W40Hz8ouxW","c1FdTsxdHW","gCoFwCk1lCoXWQKqW77cKG","B8oODCkwWP4","WPldKLvyha","WQzbh8kuWRVcPZxdNw7dPHtdRtpcNConW5FdImoGW4HCWPzgW7NdKCo9W6imB8kAyHabW58","zCoGl10w","W5KjqKhdHq","WRa5A3BcGG","WO4kW5NdQhpNMBtLVRhLP6dOTR7dKq","Emo/yde/","xNDjBmkTWOD4C8kHW4O","W4mQW48AW51/W4e","u3TnASk2W4NOSi/NLitLP7NOTOSTBINdG3Gipq","WOaqxLhcJmkWpgqaWQPv","W7vgEb7cHG","uCo2g1W5W6LUWQ3dSq","k2VdPrFdGG","vgiHWPzO","W74Fv8olW4BdQ2RcKs7cUa","W7ucW5RdJ8oHWPKesLq","oSo4bHOpdwZcK8oQWPL3W47cSq","zSoDWQxcUmk9","sMDpCCkiWOH+tCkLW50","W54/W5SbW6DLW5e","W5/dP8k0W5ZdJW","W49iWPpcRdaIW4q","s8kOW6VdSuC","W4KjWQWOkG","uCkraCo6qmkWWR0DW6RdGqO+BCoYrWJdQJBdJ8oRs8o1WPldL1xcG8kcDCoSWPtdPxv8cSkFW7RcGCkFCHZdI8kOWR9CihiMW70TW6FdRg7dRW","WO3dP8krbmkWfSkOW5xdNG","W6TTCcJcOmoHEqW+WO3cM24","ymoQjwOv","WQDrv250","W6qoW6hdUCoB","tg1z","uSkHWQuEWQ0","rxi2iCouW4ldTmopWPGfW6nrW7G","xuRdGbVdPW","W44QWOSZcSojWQ0uWQ3dQmkFhSoYsN8p","WPldTbRcMCktFCkDp3VcMq","k3VdOcBdLG","cLnFW4tcUmopdq","eXuRpSkd55Ic5B2i5AEg6lEzWP0","WQn7sLDvqSoOux3cJa","d1DCW58","mSkwlKHXW7JcG8oCnmoFeSk6xmoLW4VcP8oXpCkQW7TuW4RdRLnoWRekWPRdSZxcVZJcLmkyW4JcOCoBWQbCWOqpW7ldVbXIsmk6obZcPCkmtgldPCov","fCktW7RdP8ojWPX3WOGDlCkxCLtcT8ohW5vxW5pcHJjbW7xdILpcJmoaf8kvymozWOauW5jTWQ3dQ8kvWQtcOCkgW4FdIColW4TIAHuLmCo/W5FcUYa","dSkjfSoS","W7uEW5/dImoHWPWj","dg5rud8","nrLjksi+W4JcO8kgu2Ox","W4ldP1ZcS3q/bq","W6fWsW3cRq","C8ksbJ7cNG","wSolWRBcR8krW49LWO0a","W6WwW6FdUCoW","uSosdvqE","W4a0WOeZgSoa6i215y635AEV6lAsW5e","tfpdIXddO8kd","5lU+5PQ45AYU6iM05BQv5y+JW4G","W6KDWQlcQW","uw88pCo9W47dQCoBWOy1","W4OiASolW6y","oKXLW6NcQW","xSolWRxcQCkDW5n/","W7uOqx3dMq","W5uuDuO","W6rJFYxcRSotBGG","WO4kW5NdQhmV6loN55E55AAQ6lARW6b2WO4EW53dJmoP","BwDiuCk6","W6ivW6ldGSkNySoM","s3XpBq","WPxdTgFcS3G","6zAz6k6F55IYW53dJSkfbf3MIlBdVvXPaCk7WQi","Dcmdgu4","gSo6WRhcPrqoW5LHWRPQkSkCWOJcRHPmW7VcSJhcMSkmfIpdH8kyWOPwW47cVmo1zbxcNmoUBIvwkmoNW6hcK0BcOsBdIgrLWRxcOMe+W6ZdUrZcQSkF","lavpoH4mW47cRCkzqq","c8ojsmklhmoLWRusW7VcSrGKACo6ra","erldGHWX","uCo3eL02W6r1WR/dQdy","W6ddTmkIW5NdOgxdLq","WRXvW6WIWP8","oSoermkXmq","WPeuqLtcImkQl2m7","hmkzW7xdRCoeW4HbWR4btmkP","W47cQKtdI8oBm8kpdgVdNxzLfaJcRXS0pGVdPSkxW4GLWRfuAZOqW7NdMCkuW6XgW6vVo8k/WQbCWPFcJCkHhmkSCvT4W7VcJCoMW4q","tcCigLVcT8oOWOtdSG","5lU+5PM95B6L5OMw5BUO5y2Ufq","fmkbamoZW7G","c8kqAsFdOq","r8oRe0O","da01imkS","oGrpktOeW4RcQCkRw2K","WPddTHxcMSkeCSkkcW","W6SpWRxcTXStW5FdOJLa","FmotsWWc","eSkmfmotW44","mxBdKmoNWQChW4pcHSkFcCkhWQDfWRzlWPtcTXBcMCoQW6axWPrFW6ijkLPLW70","k8kOlmomW7tdJ3q","offSzq/cHCojW605WOVdKCkCeKVcHNLEiK1J","WPxdHGZcHSkq","W7WQExRdPa","5lQI5PMR5A6Z6iUF5BIa5y2uW6m","lCobx8kbna"].concat(["WReiW4FdO3O","W5RdGSkrW5NdJa","WPq3oLtdR8o7wq","6i6o5y6d5zgl5yUb5y+g5PAR5B6b5As8","hSojtCkYgmoJWQ8","W5mhWRfhW4e","W6vRqH/cLG","W5atWQRcJYy","s2W8iCoeW4S","xCkKWO8IWRCXbs1jW6m","d8onumkRh8oXWRGA","cHqLi8kYehK","ACodWQtcNmk9","WRDRW7GHWOW","W5KPW48gW5j3W5CWzX0","dejXW57cUSogdq","WP/dUb4","qSoqkIqX","puxdLWVdIW","WPqll2VdRa","q8oInreC","xCoDWQlcQmkKW51JWOujFG","WRm+yhu","WQaFW7xdMwS","h8ovtW","aLWrza","m1T/","WR53kCkjW40","v8klWOT7na","WQ8HW6/dKCk5smo8WRpdLSkk","WPpdV3VcOgWflw3dHmkQoG","W65LWRJcLmozxCoEWOJdNSk4W60","WOxdNYRcLmkl","pCklsX/dKa","WO3dG8kfeSkG","WOT/imk1W6S","Au5Ytmk+","eHGzoSkx","WPNdULTUbSkq","thfEsSkSWOXH","W5eTW57dVCo/W63dUG","WOa/o0ldMG","CCkTW4pdLxK","c1fDW5lcJq","sConWRpcS8kcW5K","vmktoc/cPq","W54/W5OBW7bIW6qYFGCtW5y","venaW5JcQCoJemofW6S","lhKGrSoB","WOBdUrdcGSk5ESkn","wJqibwBcUSoIWPW","j2FdKSoL","khb2tay","gWKHb8kR","vCkgW6NdU1W","DM0GWOn4","CCkoW6pdNgi","eSkREZJdGCk/WRpcMSkuW6K","r8oEWQlcTmkDW5G","W4TrFa/cLa","W7jXDJVcNmotFWiHWP8","WPqLqgxcNG","k8k1imokW7VdH2lcQConzq","W4a0WOeZlmonWQy","WPldQ0PH","W7OfEmoQta","W7GzCmoftq","pCkNkmoiW4RdJ3FcPSo/F8kR","WP/dRNpcVLiflG","wmkzWPPkdCoTW5/cRwVdPa","h2ddPHpdKvCWWQRcGSks","cGKPjCk9gg/cLSkrWRe","W4SNqSoSDa","z8ozpKKC","WPRdTmkfh8kHoSkOW4xdIG8","WQ4oqaa5W7tcMmkgcmoU","WO5Xx2Lt","wJqjgwxcSSoMWPNdMCoMzG","tCkomZxcLh7dPdlcIW","WQ88W6pdL8k2qmoQ","WRK9W67dHG","WQKlxe3cUG","WPfvbCk4W6u","lWRdLduT","hshdTWOR","cre4d8kc","WPblseHP","W6qjW6GbW4S","ymkzWQCwWQ0","WRG6DJWJ","frVdJWOd","txfBDSk9WPP4","yCktWQShWOS","W7S7W7S/W7u","mer9rWFcLa","W7a/WQtcGb4","ebtcIgVcQCowW57dVCkAWRVdT2m","DgnMvSkn","kKD9wZ7cKCovW688WRC","WQKrc17dSq","W5KxFepdUG","W54UW5ddT8o6","W6egrSo9Fq","W6CdvCoqW7G","W5O3WOeVi8ofWRaaWRpdHa","WPhdVrZcL8ka","WPyuW6hdSNLK","WQaMfgNdLW","BSoiCbO5WRBcKCoVjmkB","d8oEwCkMcCo5WQ0uW4ZcIb0","W54/W5SbW6DLW5e4BG","s8o0eKepW6e","dh/dLHxdJa","oLyYqCoR","W7mvW4ldTCokWPaa","x8kzkWNcU3FdOYJcMW","eLGxrCo5cmk6CmoK","y1NdQH7dOW","W50XW5ldSmo9W6a","gK0gzmoGcq","WOibq0JcIq","W6nNWRVcLCoqg8o6WPFdV8kxW6hcHa","cmkVlmowW74","c8k3FsVdVCknWRxcLmklW7VdTmon","W405W4KBW7D4W5eoyWO","ovXkW53cJW","WQrNqvn8","rmobWQdcS8kAWPZOSjlNL4ZLPzxOTkJdItCCW7/cMSoygW","WOefjeRdISkKwIpcOJa","W6CrW5VdMCoHWPqjxuNdRu1JhmkW","zmo+fGiAh3e","ax3dKstdIa","W4VcTWm9uSouW5xdJSk3c8oPFJ08W5K6xMZcSmkGl8oksee6tYTwW4KgWOhcKCkOW5pdOCoUWRFcL8klvmoVamozWQFcVCkoWPeYW4ldMSoNW53cNM4s","C8oPfrGn","W6SoWRZcTHqEW4ZdSca","5lI15PUt5AYi6iUe5BQ45y+IWQW","WPldP17cMhu","W6xdKSkhW4hdVa","WOKKavpdKq","W4mOW7KAW7u","qvxdJs3dO8oEWOxcL8k/WQxdNYOvWRK6hmoZW5eSF8klWO0CD303i8orW6m3W5bKdqazbSomvCkcWRtdTCoDtNNdKZxdMmoAWQVdL3i/yCk8","6i6F5y+VE8ksWPZcHtat5B6t5Aw6","umkMW77dTG","WO7dT8kfa8kS","W6ldUSkEW57dOq","W6C4W6xdUmo3","WQtdTIJcVCkr","DSocqtmF","jSoUsCksea","WPuHW4BdSLy","bmk5CIBdS8k/WQlcKa","5lIQ5PUO5A+B6iIA5BMA5y+EWP4","rqStWOZdOmkCh8onWQHIyJGkjmkEWR7cJhyEWQfJCxHyiqtcHmoxddr4WO3cICkfhCoPW7zpCwhcHeyVWRLXWO3cVSo3WOK9W5maWPuOW5C","tcybg1tcUSoZWPBdQ8o8","x8olaY8q","f2DAxcC","gqxdPHuTl8oOWRldOG0","BSk9WOC1WQ4","BquPh17dHCksW4G3WPpdHCkjna","kCkNmCoBW4pdShNcRmofECkoumk1WP/cK8orm27dPSoqoSkjWPxcImoVWOGu","r8kNWO8+WO40","DSo7j20","WObXWOpdHmo3W7xdTmkfbq","zSo/iu8qmmojkmovCqlcQ8kfWQOW","sfhdIttdTa","W7nQDIC","WOtdTGVcMa","WOyHk2/dI8o/rSkvWRm4","o8k2sLPsqsu","A3Cibmop","WOqZoN7dS8oixCkqWRSKAG8pE3JdHCksWOVdGalcNCo1qmk/WQ/dJNi","W440WPq0fW","WPFdPffUfSkzW5ZdL8k9Dmo1zJ03W4b+","WPDUoCkIW6S","l8kQv0rhxN/cUCoCWQHDW40","hHKVomkyf2NcQmkvWQy","o3ldSq/dTa","guzlEXK","vmktoc/cPtlOSO7NLANMI6/LIzC","i8oiyraTWQZcJmogkmkGcmk2aW","jxxdHCo5WP4fW5dcK8kBfq","eWpdPHuWfa","W5S7W5GA","wSklWO1w"].concat(["WPZdO8kmhCk3bmk/W5C","lx58W4hcJa","WQeqlNFdLW","ae4gEmozdmkMEmoTWPq","hfmkFSkKqmo5nmo0WPpcNbLHwrpdMM/dVmki","s8oLpMmE","W40sWOjvW494WPpcMLi","W4tdMmk8W6JdJG","WQyIl2ldRW","WOVdTmkxmSk/","W5mjW6hdSSok","WPycvLpcVCk4kwSYWRa","WOyPW4tdP3K","W7qoW7WvW7a","FNbYCCkO","W7pdOCkJW4xdOq","W7CrW4tdKG","ehTOtdy","w8kDmJBcQNVdQI/cOmkHsW","WPhdVwlcUxSj","WOCfeKldNW","W4LEBaNcK8owa3FdV3JcIIyOfSkVFLHuWONdMKhcQWOtW4OlvhZcSK5tWPBdTW","E8kXnWhcJW","o8kWimowW5/dUwtcSCoqCW","fba/gSkm","WRXzf8kAW6e","WOFdPqZcKW","tSklWPnup8oTW47cPW","wmkBWQWLWQK","W7bJysC","xJClowK","WPCwW5VdS01UWPBcSmo2W70","u30Riq","W6ixW4GmW6m","W5mCz0ldIW","BGCUh17dHmkwW70uWPhdL8krpG","WPTEW4WJWR8","a8oEB8kPcG","wmoslgyF","lCkJmCoXW5/dG30","qSoiWPhcI8kH","c11iW7ZcKq","W7qgW4hdV8ou","WOH9W5m9WPC","W77dVSkWW43dQuxdLxOHW4aeW6i","WPeajfBdRSkAxdVcVYy","W6xdSmkHW4i","gJ3dUJmF","W7udW5pdJSoUWPqFwe3dVq","seSiWPT0WRWko3C","hmksWQCzWO0MgG","WQSBW6NdJSkn","B1T5vW","yGKLffpdKmobW6iOW6tdKSkahKhcMcPSk0OGqgKJW7r+WOBcHgP0W4VdICktlcCfiSonW7DXWOpdIXtdHSkmWQWzW5BcRmotnSoLhmol","W68lE8o5AMmYW6z4WRBcJbVcJhK","W68aW5pdKSoxWPhOJ5RLJ6/LPjhOTQSy","bCobyNVdTJldQY3cHSoOxe7cVSodW4xcUCostrLLuCosWRVdVmoVsmodW4WcW5bxW4NdJCkSWOCzDSktWRrwW6mwFmkgtCkpW4notX4fW7Wn","lCkYfSomW4i","WQnGW5SyWOG","vCksWRv0dG","WQhdS2pcO0K","FKi7WQDG","u8oLbue","F8kOWOLjma","WPywmfhdM8kiwJpcTG","W73dOCk2W4ldRhi","WOaRpq","kGhdQX8p","WPCdrKq","gviaA8oLpSkGDSoYWOBdLLe","qvD9WPBdLmogDfRdUmoctSk/d8k6AWVcKCkxWOy","W7hdVSk3W4K","tCkpoJtcM3pdVYdcKSk7","WPhdSSkTomkM","tJqwbW","xKddIZm","sSoeWQlcU8ks","wMjpBCkSWRz4vCk4W4S","WO5UW40+WOFcIMtdPa","k8k0kColW7tdINNcU8ou","qmo+dxeb","W5SSWOeZ","eSkQCJNdJSkYWQJcImkn","t8kZW7JdQfOuWPaIWQi6mmoAWOVcPXmFW7lcPZ3dN8obbx3cLCoiWO1CW43dTCkSAaNcICoZiwTbzmkUWOpdIXJdRhxcQsvYWQtcQgeVW7BdPvldI8opWR0jgva","hbuOmG","WOhdQ0XU","uSk0W6NdQNLpW41SWQ45","WPDQaCkKW5i","FCoyWRlcJCkm","hxldSq8","6i+p5y+G5zcb5yIz5yYF5PEm5B255AwQW7XVCcaFkmkkWQq","WPeDkfddOCkssG","WRiQW63dLq","xSoko0Ck","WPddSSkfh8k8aq","W6KjySo1q2C","W7O/WOLsW7i","y8oTpK0D","WRCztbq7","xNPfBCkHWOrJwCk7W61Vj2e","WRqnqbWaW7e","sCoaWQJcTmknW5f+WPextSklFLq","WQxdPNT2hW","W5ObWPzoW55uWPpcIKzJ","WPNdK8kvaCkJ","W68LC8oDWP7cHCkghmk7q8oUWOj6W4SQWRGkWPnoW5vblc7dImoZmcVcH8kKW7TIWQ/cH8kEWR9QW6f+WPhdV8k5cCkUdCkFdwhdHvZdOSo6W7Or","WPyFwLxcSSkWpW","WQ/dL8kueSke","cxldRHhdOf8LWQxcSmkiW5G","W78mWQdcQsirW4tdTZ1Ctmk9qCorW6ieWQFcGCkDgwu7WPfeW4xcQmo9W6P5WQG","WQGtW6/dGmkC","BCoOztC5","W7utW6hdV8o8","nX5JbYS","WPClW5FdTujMWOa","w8oxWRq","s34kWRTE","WP/dI01fnW","WPO7n1tdVq","W6ONWOSogG","WPS8gvRdUa","qa8NmxC","WP/dRNpcVMqi","WRnhxGdcPSoeya","WQzPeCktW4FdJG","beCTumoi","BCk3fq7cUG","W58ixuddLCktWOy","y8oPcWqGagZcH8oW","WQWCvXW","xCoumKa+","A8o6WQdcNCky","Bmk5hd/cRq","WOisue7cMmk3l1u2WQC","W50ZW6tdSmoJ","WOiKW4pdR8kL","pGxdHZO1","WORdSCkfa8kfbmkUW53dLXK","WRjbWOFcISkoW4byF0BdMv1Rpa","W78lzmoY","WRCQuXC8","WOi/hhxdTG","WRv5i8kfW7ZdHmkefmkRamoPWOnWW4a","WRCJguBdVW","W4i/W5iaW51YW4qOvqevW5yG","WPNdKbdcMCkk","nrLnisbn6lk/55EK5OUK5yQT","W4qPWQmloG","o1vSsa","WO98WORcO8kPWQtdUmkTkSkiW7PpWR5/WRSSFexdIKTBWQedbIhdT8ogWO7cVuJcS8k2W4JdTMxcHu5pW7OptCoPDq3cNHG6W6GtFSoUWPVdObjpCW","qe5WWPhcLG","oKzQzb3cLW","W4hcP07cHCkfuCkofvq","W7iFWOPyW7O","W7Opz8oPuheIW6T1","gCoKW5XMW5DKrJ9HW4ukb8oU","WR/cVmo+WOhcQdVcJdH+WOWeW6iatSkQdmkEF8otW6ZcQ8kzz8o6FG8OrcXRxmkPyW","bmkoWQJcQSkrW5j4WObE","dmkBDWtdTa","W4eRbh7dOSonEW","xeFdLsxdQa","eetdOqBdQW","sCoQdxCH","tSkPW6xdRa","CSk+kHpcPG","WRuRoe7dKG","WQzFoCkVW4K","WP0tf2FdMq","WQaIy3pcHG","s8koWPbnmq","W68LC8oDWP7cHCkghmk7q8oUWOj6W4SQWRGkWPnoW5vblc7dImoZmdtcGmkKW7TIWQ/cH8kEWR9QW6f+WPhdV8k5cCkUdCkFdxtdKvBdRCk/WRDCiSolxW","zSo/iuWbimojiSoz","WOpdMq7cMmkj","jwpdIdBdUq","WOaDwKlcHSkWpW","cCoEtSkkdSo3","W5SYW7BdVCoGW63dQmkK","EbiGjvW","q8kdW4BdQ0q","lxv9sHS","WQfPxuS","b2SAs8oG","WPpdSxlcTq"]));return(f=function(){return e})()}o=198,i="hs",r="hs",function(e,t,a,c,s){var l=d;r+=s="up",i=a(i=(c="tfi")+i),r=a(r),a=0;for(var u=e();245385+--o;)try{c=-parseInt(l(584,"rbgm"))/1+parseInt(l(557,"40bq"))/2*(-parseInt(l(553,"zfy3"))/3)+parseInt(l(448,"zfy3"))/4*(-parseInt(l(536,"Eozz"))/5)+-parseInt(l(652,"&qfL"))/6+-parseInt(l(884,"3#Hs"))/7*(parseInt(l(639,"gdqj"))/8)+-parseInt(l(643,"DT3T"))/9*(-parseInt(l(794,"3#Hs"))/10)+parseInt(l(937,"oGNo"))/11*(parseInt(l(925,"T6[J"))/12)}catch(o){o=VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(o),c=a}finally{if(s=u[i](),196<=o)a?n?c=s:n=s:a=s;else if(a==n.replace(/[eVFytwOkCLJMYbhBAlW=]/g,"")){if(245385===c){u["un"+i](s);break}u[r](s)}}}(f,0,function(e,t,o,n){return(e=(e=(e=arguments[0])[t="split"](""))[o="reverse"]("v"))[n="join"]("")}),f&&(u=2256),function(e){var t=d,o={AhcGW:"===== fly sheep api =====(ks active)=====>>  success >>",AdXrp:"application/json;charset=utf-8",rAecu:function(e,t){return e!==t},EPPnr:"HPabD",EcoSi:t(424,"cxKG"),LSoFX:function(e,t){return e+t},JGEKS:t(431,"fRO^"),SHXWo:t(732,"Eozz"),lfQEN:t(911,"*4Tk"),orSnw:"\u4f20\u5165\u4e86openid",VIoDK:function(e,t){return e===t},AjdlR:t(728,"DT3T"),HSBuI:t(453,"Eozz"),LCYmi:function(e,t){return e!=t},Abwhm:t(574,"T6[J"),dDJsm:t(761,"hNRi"),StZtL:t(755,"rX@a"),qYxKq:t(651,"3PF2"),ronvy:t(667,"PBv3"),kmGVI:t(731,"3PF2"),flUtM:"LZHxc",CSPRk:function(e,t){return e!==t},QZMpz:t(763,"PBv3"),tkyFw:t(839,"s8p2"),IxSyu:function(e,t){return e===t},NsbbI:t(422,"WEAy"),NozJm:function(e,t){return e+t},wTsDs:"\u4e0d\u662f\u5feb\u624b\u5e73\u53f0!",XvILL:function(e,t){return e===t},wNwIy:t(418,"gdqj"),yiRFS:t(748,"4)4Q"),OkQKb:function(e,t){return e(t)},KnYxU:function(e,t){return e!==t},KZsfl:"udqhX",dsmPF:t(836,"EFiX"),EqFhc:t(523,"dyv4"),VybHf:function(e,t){return e(t)},uflxx:t(563,"gdqj"),IDAWl:function(e){return e()},hnWGc:t(915,"(9@u"),zvONJ:"===== fly sheep api =====(tt active)=====>> fail >>",nAYzB:function(e,t){return e===t},TECyf:t(791,"wQsK"),vQmqZ:t(534,"r3FJ"),MvgpJ:t(706,"rX@a"),UyRfc:t(568,"3Ni%"),dLzfd:function(e,t){return e(t)},bjeaf:"isKSActive",yQayg:"RwGmF",IPdXo:t(939,"@WBq"),npMIs:t(775,"9]MJ"),hwdso:"EYjLF",byHHx:t(488,"(9@u"),fdoul:function(e,t){return e==t},fQupv:t(705,"9]MJ"),iAsEX:function(e,t){return e!==t},uGUjj:t(615,"r3FJ"),wDneh:t(734,"$6Pb"),BQnFQ:t(860,"DT3T"),XTVar:function(e,t){return e===t},qEpes:t(571,"@WBq"),yZCXs:"WsfZG",ucWCB:t(465,"r3FJ"),ZSUUA:t(419,"gdqj"),JspfH:t(556,"4)4Q"),qIcmd:"\u9519\u8bef\u7684appid\u6216secret!",stSti:function(e,t){return e===t},rDkWJ:t(641,"9]MJ"),AMFBi:t(603,"gdqj"),rTYiu:t(661,"rX@a"),YgnUH:t(622,"h$61"),YHyen:"https://api.flysheeep.com/api/expro/set_ecpm_active_newer",nLXxy:"https://api.flysheeep.com/api/expro/get_ks_openid",JQhUV:t(903,"dsJb"),gYavw:t(587,"!0ui")};tq_sdk[t(723,"9]MJ")]=o.rTYiu;var n=function(e,n,i,r){function u(){s(this,u)}var p;return l(u,null,[{key:e,value:(p=c(a().mark(function e(n,i){var r,s,l=this;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t,s={bWXvQ:o.AhcGW,UvuWx:o.AdXrp,SyWNt:function(e,t){return o[d(508,"3#Hs")](e,t)},TdJjp:o.EPPnr,NSkbV:o.EcoSi,skfML:function(e,t){return o[d(822,"ptRX")](e,t)},gboPm:o[r(747,"rX@a")],JxSCs:"\u9519\u8bef\u7684appid\u6216secret!",Eixgc:o[r(715,"EFiX")],dEaIc:o[r(714,"Eozz")],pLFuN:r(895,"AS22"),tvwCj:function(e,t){return e(t)},EKqHj:o[r(665,"48Pn")],faGmR:function(e,t){return o[r(819,"$6Pb")](e,t)},bwkNl:o[r(888,"(9@u")],KJVSI:r(904,"]4z^"),ZCECj:o[r(764,"cE86")],HNMFJ:function(e,t){return o[r(818,"h*NO")](e,t)},ErODq:o.Abwhm},e.abrupt("return",new Promise(function(){var e=c(a().mark(function e(t,o){var c,p;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(p={nCtEU:function(e,t){return e(t)},ISeOB:function(e,t){return s[d(439,"(9@u")](e,t)},zFExs:"login\u767b\u5f55\u5931\u8d25_",jGiol:function(e,t){return s[d(846,"r3FJ")](e,t)},dxowN:s[(c=r)(428,"#Qee")],WVTjJ:s[c(880,"dsJb")],FjmeI:function(e,t){return e(t)},tymeo:s.Eixgc,JzolW:s.dEaIc,sxXyN:s[c(426,"zfy3")]},window.tt){e.next=3;break}return e.abrupt("return",(console[c(647,"3PF2")](c(718,"cxKG")),void s[c(440,"Eozz")](o,c(914,"$6Pb"))));case 3:return console[c(644,"h*NO")](c(766,"#Qee")),u[c(834,"WEAy")][c(934,"hNRi")]=n,e.next=7,l[c(926,"EFiX")]()[c(479,"hNRi")](function(e){var t=c;p[t(543,"cxKG")](p[t(654,"bVP]")],"vbQUY")?(u[t(446,"Eozz")].clickid=e.clickId,u[t(950,"dyv4")][t(688,"AEL&")]=e[t(953,"WK6S")]):(_0x3976e3[t(483,"AS22")](t(727,"PBv3")),p[t(858,"MKv^")](_0x1cb1ab,{errorCode:1e3,errorMsg:p.ISeOB(p.zFExs,_0x572e51[t(573,"*4Tk")])}))});case 7:if(!i){e.next=11;break}console.warn(s[c(658,"AgQ$")]),u[c(930,"40bq")][c(801,"AS22")]=i,e.next=20;break;case 11:if(!s.faGmR(s[c(495,"EFiX")],s.bwkNl)){e.next=19;break}return console[c(487,"@WBq")](s.KJVSI),e.next=15,l[c(878,"bVP]")](n)[c(730,"DT3T")](function(e){var t=c;if(p[t(844,"&qfL")]!==t(562,"bVP]"))return _0x5a0743[t(585,"!0ui")](p[t(781,"@WBq")]),void p[t(920,"zfy3")](_0x2d4a2f,p[t(645,"&qfL")]);u[t(429,"PBv3")][t(771,"GIiv")]=e});case 15:if(""!=u[c(446,"Eozz")].openid){e.next=17;break}return e.abrupt("return",(console[c(430,"GIiv")](s.ZCECj),void o(s[c(862,"40bq")])));case 17:e.next=20;break;case 19:_0x421414&&_0x4e16cd(),_0x5b0775.warn(p[c(754,"DOog")]);case 20:console.warn(c(951,"dyv4")+u.userParams[c(690,"EFiX")]+", openid:"+u[c(681,"DT3T")][c(923,"zfy3")]+c(631,"EFiX")+u.userParams[c(803,"T6[J")]+",requestid:"+u[c(867,"hNRi")][c(462,"gdqj")]),s[c(851,"zfy3")](cc[c(787,"*4Tk")][c(689,"ptRX")].getItem(s[c(485,"3Ni%")]),s[c(595,"ptRX")])&&l.reportActive(function(){var e=c,t={IFaNW:function(e){return e()},vkPQn:s.bWXvQ,fNyHF:s[e(486,"9]MJ")],WrMgH:e(490,"PBv3")};s[e(957,"Eozz")](e(617,"fRO^"),s.TdJjp)?_0x74022f[e(739,"cE86")]({url:_0x45def7[e(841,"bVP]")][1],data:{app_id:_0x133eea.userParams.appid,open_id:_0x55e885[e(677,"Kdvf")].openid,callback:_0x325d33[e(772,"zfy3")][e(726,"ptRX")],event_type:_0x42ce53[e(891,"gdqj")][e(417,"3PF2")],account_id:_0x2e0409[e(681,"DT3T")].account_id,campaign_id:_0x4534d5[e(861,"rbgm")][e(840,"#Qee")],unit_id:_0x484c71.userParams[e(504,"&qfL")],creative_id:_0x3a237b[e(823,"ptRX")].creative_id},header:{"Content-Type":t[e(445,"r3FJ")]},method:t[e(602,"*4Tk")],success:function(){_0xf96f79&&t.IFaNW(_0x5e0aa1),_0x30dca4.warn(t.vkPQn)},fail:function(){var t=e;_0x2fd086[t(644,"h*NO")](t(597,"EFiX"))}}):cc.sys[e(467,"dyv4")][e(802,"DT3T")]("isActive",s[e(609,"40bq")])}),s[c(956,"AEL&")](t,u[c(834,"WEAy")].openid);case 21:case"end":return e.stop()}},e)}));return function(t,o){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}},e)})),function(e,t){return p.apply(this,arguments)})},{key:n,value:function(){var e=t,n={AvcZO:function(e,t){return e+t},QadTo:o[e(889,"s8p2")]};if(!o[e(954,"cE86")](o[e(545,"hNRi")],o[e(875,"@WBq")]))return new Promise(function(t){var n=e,i={iJuIB:o.dDJsm};if(o.VIoDK(o[n(870,"40bq")],o[n(691,"s8p2")]))_0x1a864c[n(430,"GIiv")](i[n(582,"AS22")]);else{var r=tt[n(758,"rbgm")]().query,a=r[n(612,"4)4Q")];a||(a="");var c=r[n(616,"Eozz")];c||(c=""),t({clickId:a,requestid:c})}});var i=function(e,t){return e(t)};_0x2da69d[e(808,"bVP]")]({success:function(t){var o=e;_0x1e2d07.warn(o(941,"bVP]")+t[o(598,"4)4Q")]);var n=t[o(598,"4)4Q")];i(_0x8ea1a4,n)},fail:function(t){var o=e;_0xc7918[o(814,"&0w[")]("login \u8c03\u7528\u5931\u8d25-------"),_0x1f6203({errorCode:1e3,errorMsg:n[o(624,"Kdvf")](n.QadTo,t[o(717,"dsJb")])})}})}},{key:"login",value:function(){var e=t,n={nFSfu:function(e,t){return e(t)},FMUPX:function(e,t){return o.IxSyu(e,t)},wuUvr:o[e(680,"9]MJ")],DlBIq:function(t,n){return o[e(770,"MKv^")](t,n)}};return new Promise(function(t,i){var r=e,a={Ihjik:r(716,"hNRi")};if(!o[r(566,"&qfL")](o[r(740,"4GQT")],o[r(696,"dsJb")]))return _0x4077d1[r(657,"48Pn")](a[r(648,"Eozz")]),void _0x47658e(a.Ihjik);tt.login({success:function(e){var o=r;console[o(537,"AgQ$")](o(544,"!0ui")+e[o(469,"cE86")]+o(931,"oGNo")+e[o(695,"GIiv")]);var i=e.isLogin?e[o(843,"3#Hs")]:e[o(627,"DOog")];n.nFSfu(t,i)},fail:function(e){var t=r;n[t(633,"WK6S")](t(511,"!0ui"),n[t(601,"#Qee")])?_0x6a2c22=_0xd8d34c[t(697,"hNRi")]:(console.warn(t(890,"9]MJ")),n[t(608,"zfy3")](i,{errorCode:1e3,errorMsg:n[t(459,"h*NO")](t(701,"WEAy"),e.errMsg)}))}})})}},{key:i,value:function(e){var n=this,i=t,r={OOpeX:o.AdXrp,ilPaH:i(785,"&qfL"),TKMSN:function(e,t){return o[i(592,"bVP]")](e,t)}};return o[i(954,"cE86")]("QXyjl",o[i(558,"dsJb")])?new Promise(function(t,a){var c=i,s={BzKXv:c(628,"dyv4"),aDvDF:o[c(824,"&qfL")],VZOsf:c(547,"T6[J"),biQVZ:function(e,t){return o[c(533,"3#Hs")](e,t)},mnzXG:o.wNwIy,dXkXs:c(554,"cE86"),wCTmy:o[c(910,"DOog")],FsKdd:function(e,t){return o.OkQKb(e,t)},vHSbm:function(e,t){return o[c(712,"bVP]")](e,t)},PUtcQ:o.KZsfl,sgscP:function(e,t){return e!==t},Jdxfa:o[c(816,"WEAy")],VZXOf:o.EqFhc,CVFPo:"----------getOpenid------3------\x3e"};n[c(790,"3Ni%")]().then(function(o){var n=c;console[n(779,"cxKG")](n(619,"GIiv"),o),tt.request({url:u[n(477,"rX@a")][0],header:{"Content-Type":r[n(964,"rbgm")]},data:{appid:e,code:o},method:r[n(865,"AgQ$")],success:function(e){var o=n,i={ZdYsi:"\u9519\u8bef\u7684appid\u6216secret!",UBAgN:s[o(786,"PBv3")],pybYf:s[o(659,"@WBq")],DZEfe:s[o(653,"dyv4")]};if(s.biQVZ("gUsCR",s[o(560,"Y]b]")]))return _0x35d533.error(i[o(776,"4GQT")]),void _0xb544cc(i.UBAgN);if(console[o(789,"rbgm")](s[o(662,"AS22")]),200!=e.data[o(620,"cxKG")])return s[o(769,"ptRX")](s[o(900,"cE86")],o(438,"9]MJ"))?void _0x283acb.warn(i.pybYf):(console[o(441,"4GQT")]("\u9519\u8bef\u7684appid\u6216secret!"),void s.FsKdd(a,s[o(722,"(9@u")]));var r=e[o(827,"AS22")].data,c="";if(r.openid)s[o(795,"cxKG")](o(811,"dyv4"),s[o(505,"AEL&")])?c=r[o(604,"*4Tk")]:_0x2ab573.warn(i.DZEfe);else if(r[o(630,"DOog")])if(s[o(806,"(9@u")](s[o(638,"Eozz")],s[o(799,"DT3T")]))c=r[o(935,"AS22")];else{var l={maAgh:"isKSActive"};this.reportActive(function(){var e=o;_0x4c0b03[e(513,"9]MJ")][e(886,"4)4Q")][e(877,"Eozz")](l[e(737,"r3FJ")],"true")})}console[o(621,"fRO^")](s.CVFPo,c),t(c)},fail:function(){}})})}):new _0x4d7cc7(function(e){var t=i,o=_0x4c6633.getLaunchOptionsSync()[t(650,"$6Pb")],n=o.clickid;n||(n="");var a=o[t(713,"9]MJ")];a||(a=""),r[t(780,"oGNo")](e,{clickId:n,requestid:a})})}},{key:"reportActive",value:function(e){var n=t,i={lWveU:function(e){return o[d(855,"zfy3")](e)},CMKXF:o[n(518,"40bq")],KIbIK:o.zvONJ};if(o[n(423,"3Ni%")](o[n(530,"bVP]")],o[n(434,"4GQT")])){var r={pNwno:function(e,t){return o[n(456,"4GQT")](e,t)},pkMrd:o.ronvy};return new _0x21feca(function(e,t){var o=n;_0x3ca8ab[o(866,"Kdvf")]({success:function(t){var n=o;_0x5120fa[n(537,"AgQ$")]("login \u8c03\u7528\u6210\u529f"+t[n(749,"Y]b]")]+n(684,"PBv3")+t[n(497,"DT3T")]);var i=t[n(525,"48Pn")]?t[n(482,"WEAy")]:t[n(499,"9]MJ")];e(i)},fail:function(e){var n=o;_0x106367[n(929,"cxKG")](n(671,"DT3T")),t({errorCode:1e3,errorMsg:r[n(570,"cxKG")](r[n(907,"cE86")],e.errMsg)})}})})}tt[n(854,"DT3T")]({url:u[n(649,"&0w[")][1],data:{openid:u[n(784,"9]MJ")][n(605,"MKv^")],clickid:u[n(784,"9]MJ")][n(572,"&qfL")],event_type:u[n(837,"AEL&")][n(493,"AgQ$")],adid:"",creativeid:"",creativetype:"",appid:u.userParams[n(962,"cE86")],requestid:u.userParams[n(873,"fRO^")]},header:{"Content-Type":o[n(640,"3Ni%")]},method:o[n(683,"cE86")],success:function(){var t=n;e&&i[t(538,"h$61")](e),console.warn(i[t(845,"3Ni%")])},fail:function(){console[n(963,"Eozz")](i.KIbIK)}})}},{key:r,value:function(){var e=t,n={frXDa:o[e(474,"9]MJ")],iPsjr:function(t,n){return o[e(565,"40bq")](t,n)},vktXo:o.yQayg};if(o[e(817,"$6Pb")](o[e(917,"oGNo")],"WnsUZ")){if(!window.tt){if(o[e(797,"AEL&")](e(800,"WEAy"),e(516,"40bq")))return void console[e(613,"gdqj")](o[e(576,"$6Pb")]);_0x53d1e0[e(693,"DT3T")].localStorage.setItem(n[e(711,"ptRX")],e(466,"&qfL"))}tt[e(700,"(9@u")]({url:u[e(526,"oGNo")][2],data:{openid:u[e(832,"wQsK")][e(589,"ptRX")],clickid:u[e(720,"GIiv")].clickid,event_type:u[e(421,"rX@a")][e(452,"AgQ$")],mp_id:u[e(738,"Y]b]")][e(934,"hNRi")]},header:{"Content-Type":o[e(478,"EFiX")]},method:"POST",success:function(){var t=e;console.warn(o[t(908,"T6[J")])},fail:function(){var t=e,o={jiJIl:t(454,"bVP]")};n.iPsjr(n[t(848,"WEAy")],t(420,"bVP]"))?_0x19a77a.warn(o.jiJIl):console[t(625,"WEAy")](t(451,"rbgm"))}})}else{_0x48f85c[e(613,"gdqj")]("login \u8c03\u7528\u6210\u529f"+_0x3b601e[e(580,"3PF2")]);var i=_0x516ba1[e(725,"48Pn")];o[e(804,"gdqj")](_0x5ccf4f,i)}}}]),u}(t(634,"AS22"),t(736,"*4Tk"),t(569,"EFiX"),t(922,"rX@a"));n[t(838,"h$61")]={appid:"",clickid:"",openid:"",requestid:""},n.urls_list=[o[t(798,"3Ni%")],o[t(436,"EFiX")],t(481,"$6Pb")],n[t(919,"r3FJ")]={active:"active",active_pay:"active_pay",game_addiction:t(892,"Eozz"),next_day_open:t(542,"fRO^")},e[t(778,"(9@u")]=n;var i=function(e,n,i,r,u){function p(){s(this,p)}var f;return l(p,null,[{key:e,value:(f=c(a().mark(function e(n,i){var r,s,l=this;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s={tBmMO:o[(r=t)(759,"cxKG")]},e.abrupt("return",new Promise(function(){var e=c(a().mark(function e(t,c){var u,d,f,h,y,m,g,v;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(d={lAHQj:o[(u=r)(694,"zfy3")],zWbgj:u(756,"&0w["),fMHuY:function(e,t){return o.IxSyu(e,t)},UHRpQ:o[u(471,"AEL&")],VhxvL:o[u(610,"4GQT")],zNLhl:o[u(517,"hNRi")]},!o[u(577,"rbgm")](o[u(548,"]4z^")],o.hwdso)){e.next=6;break}f=_0x4d0638.getLaunchOptionsSync().query,h=f[u(752,"cxKG")]?f.callback:"",y=f[u(698,"cxKG")]?f[u(938,"WEAy")]:"",m=f[u(793,"3PF2")]?f.campaign_id:"",g=f.unit_id?f[u(812,"cxKG")]:"",v=f[u(632,"Kdvf")]?f.creative_id:"",_0x45ec3f({callback:h,account_id:y,campaign_id:m,unit_id:g,creative_id:v}),e.next=28;break;case 6:if(window.ks){e.next=8;break}return e.abrupt("return",(console[u(625,"WEAy")](o.wTsDs),void o[u(932,"GIiv")](c,u(746,"40bq"))));case 8:return console[u(703,"(9@u")](o[u(899,"3PF2")],n),p.userParams.appid=n,e.next=12,l.getLaunchParams()[u(594,"3#Hs")](function(e){var t=u;p[t(943,"&0w[")][t(913,"4)4Q")]=e[t(588,"fRO^")],p.userParams[t(887,"fRO^")]=e.account_id,p.userParams.campaign_id=e[t(830,"rX@a")],p[t(861,"rbgm")][t(842,"3#Hs")]=e[t(512,"PBv3")],p[t(593,"dsJb")][t(872,"*4Tk")]=e.creative_id});case 12:if(!i){e.next=16;break}console[u(460,"Y]b]")](o[u(435,"*4Tk")]),p.userParams[u(463,"cE86")]=i,e.next=27;break;case 16:if(!o.rAecu(u(539,"40bq"),u(591,"DT3T"))){e.next=20;break}_0x32bd1e[u(719,"MKv^")](s.tBmMO),e.next=27;break;case 20:return console[u(719,"MKv^")]("\u83b7\u53d6openid\u5f00\u59cb"),e.next=23,l.getOpenid(n)[u(928,"ptRX")](function(e){var t=u;p.userParams[t(821,"9]MJ")]=e});case 23:if(!o[u(567,"wQsK")](p[u(833,"@WBq")][u(492,"AEL&")],"")){e.next=27;break}if(!o[u(724,"48Pn")](u(835,"AgQ$"),u(863,"48Pn"))){e.next=26;break}return e.abrupt("return",(console[u(578,"s8p2")](o[u(918,"rbgm")]),void o[u(959,"PBv3")](c,o[u(850,"fRO^")])));case 26:_0xe9c6a0=_0x5ac2dd[u(826,"hNRi")];case 27:console[u(646,"T6[J")](u(468,"]4z^")+p[u(735,"!0ui")][u(927,"dsJb")]+u(555,"9]MJ")+p[u(820,"4)4Q")][u(881,"T6[J")]+", callback:"+p[u(720,"GIiv")][u(425,"wQsK")]+",account_id:"+p[u(916,"#Qee")][u(531,"&qfL")]+u(679,"oGNo")+p[u(784,"9]MJ")].campaign_id+u(810,"(9@u")+p[u(443,"gdqj")][u(707,"Eozz")]+u(942,"DOog")+p.userParams[u(751,"!0ui")]),cc[u(464,"40bq")][u(442,"cE86")][u(765,"40bq")](o[u(868,"cxKG")])!=o[u(949,"gdqj")]&&l.reportActive(function(){var e=u,t={ZgLGo:function(e){return e()},tGwOj:e(704,"DOog"),egvmy:d.lAHQj,SZIyQ:d[e(559,"@WBq")]};if(d[e(686,"hNRi")](e(762,"*4Tk"),d[e(948,"(9@u")]))cc[e(656,"WK6S")][e(709,"!0ui")][e(437,"rX@a")](d[e(741,"*4Tk")],d[e(491,"Y]b]")]);else{var o={aRtqr:function(o){return t[e(626,"40bq")](o)},bCvBu:t[e(564,"3Ni%")],xxJLS:t[e(432,"48Pn")]};_0x4e7faf[e(767,"*4Tk")]({url:_0x463c72[e(745,"#Qee")][1],data:{openid:_0x4955e4.userParams[e(882,"dyv4")],clickid:_0x480860[e(753,"MKv^")].clickid,event_type:_0x2af36a[e(475,"DT3T")].active,adid:"",creativeid:"",creativetype:"",appid:_0x5379b8[e(618,"oGNo")].appid,requestid:_0x22bdbe[e(838,"h$61")][e(742,"&qfL")]},header:{"Content-Type":t[e(708,"rbgm")]},method:e(450,"DT3T"),success:function(){var t=e;_0x154d11&&o[t(847,"r3FJ")](_0x42459c),_0x513218[t(472,"#Qee")](o[t(509,"DOog")])},fail:function(){var t=e;_0x4f7f80[t(444,"cE86")](o[t(457,"wQsK")])}})}}),o[u(876,"dyv4")](t,p[u(629,"3PF2")][u(604,"*4Tk")]);case 28:case"end":return e.stop()}},e)}));return function(t,o){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}},e)})),function(e,t){return f.apply(this,arguments)})},{key:"getLaunchParams",value:function(){return new Promise(function(e){var t=d;if(o[t(515,"AS22")](o.uGUjj,"glUYy")){var n=ks.getLaunchOptionsSync()[t(906,"AEL&")],i=n[t(813,"#Qee")]?n[t(773,"*4Tk")]:"",r=n[t(871,"DOog")]?n.account_id:"",a=n[t(672,"&qfL")]?n[t(506,"@WBq")]:"",c=n[t(774,"WEAy")]?n[t(489,"gdqj")]:"",s=n[t(583,"WK6S")]?n.creative_id:"";o.VybHf(e,{callback:i,account_id:r,campaign_id:a,unit_id:c,creative_id:s})}else _0x2c7ccf[t(825,"rX@a")][t(857,"rbgm")]=_0x354c15})}},{key:n,value:function(){var e=t,n={qPsUO:o[e(668,"DOog")],AGDLX:o[e(733,"#Qee")],ihLqZ:function(e,t){return e(t)},VjOMP:o[e(828,"AgQ$")]};return new Promise(function(t,i){var r=e,a={OupaI:o[r(815,"rbgm")],rrpJs:r(687,"*4Tk"),UKJHq:o[r(532,"T6[J")],psfYx:o[r(955,"gdqj")]};if(o[r(960,"fRO^")](o[r(596,"3PF2")],o[r(519,"#Qee")])){if(!_0x36ad42.ks)return void _0x271607[r(599,"3Ni%")](n[r(514,"h*NO")]);_0x1bd151.request({url:_0x119399[r(480,"4)4Q")][2],data:{app_id:_0x5a1832[r(535,"AEL&")][r(600,"r3FJ")],open_id:_0x1d01e0[r(777,"fRO^")][r(520,"3PF2")],callback:_0x2b1ea3[r(792,"3#Hs")][r(947,"AEL&")],event_type:_0x374ac5.event_type.game_addiction},header:{"Content-Type":r(507,"MKv^")},method:n[r(575,"#Qee")],success:function(){var e=r;_0x5784f5[e(578,"s8p2")](a[e(642,"hNRi")])},fail:function(){var e=r;_0x5bfd3f[e(625,"WEAy")](a[e(637,"T6[J")])}})}else ks[r(864,"T6[J")]({success:function(e){var o=r;if(o(579,"dyv4")!==a[o(829,"AgQ$")]){console.warn("login \u8c03\u7528\u6210\u529f"+e[o(655,"3Ni%")]);var n=e.code;t(n)}else _0x4cdd5d[o(905,"$6Pb")](a[o(524,"bVP]")]),_0x1e75cd[o(825,"rX@a")][o(944,"r3FJ")]=_0x4fe315},fail:function(e){var t=r;console[t(527,"h$61")](t(623,"@WBq")),n[t(853,"r3FJ")](i,{errorCode:1e3,errorMsg:n[t(805,"$6Pb")]+e[t(549,"rbgm")]})}})})}},{key:i,value:function(e){var n=this,i=t,r={yPEoX:o[i(902,"fRO^")],oaILx:o[i(901,"40bq")],EvwBH:function(e,t){return o.iAsEX(e,t)},wDxsK:o[i(510,"Eozz")],QmusD:o[i(796,"4)4Q")],FrSRw:o[i(607,"&0w[")],RwZna:o[i(449,"3#Hs")],pBZOB:o[i(666,"&qfL")],cGSNJ:"application/json;charset=utf-8",GEqTD:o.MvgpJ,AxfvC:function(e,t){return o[i(455,"rX@a")](e,t)},RBvqm:o[i(673,"ptRX")]};return new Promise(function(t,o){var a=i;r[a(675,"@WBq")](a(885,"rX@a"),r[a(461,"wQsK")])?_0x23bf61[a(657,"48Pn")](a(744,"cxKG")):n.login()[a(928,"ptRX")](function(n){var i=a,c={knREI:r[i(528,"Y]b]")],ITqGP:r[i(952,"Y]b]")],WaQKw:function(e,t){return r[i(936,"3Ni%")](e,t)},wlvwF:r[i(912,"PBv3")],lpBgk:r[i(458,"3PF2")],EHzrX:i(500,"AS22"),swywA:function(e,t){return e!==t},MhyxP:r[i(940,"rbgm")],FCgml:r.RwZna,VOVgO:function(e,t){return e(t)},SPXbA:r.pBZOB};console[i(427,"ptRX")](i(663,"Kdvf"),e,n),ks.request({url:p.urls_list[0],header:{"Content-Type":r[i(852,"h$61")]},data:{app_id:e,js_code:n},method:r.GEqTD,success:function(e){var n=i;if(c[n(909,"cxKG")](n(496,"h$61"),c.wlvwF)){var r=e.data[n(546,"rbgm")];console[n(924,"EFiX")](c[n(768,"WK6S")],e);var a="";if(r[n(831,"3PF2")])c[n(856,"fRO^")](c[n(494,"WK6S")],"JoOyy")?a=r[n(670,"fRO^")]:(_0x529e4e[n(788,"dyv4")](c[n(894,"@WBq")]),_0x34b9cd[n(470,"bVP]")].openid=_0x4038ef);else{if(!c[n(750,"WEAy")](c[n(551,"WK6S")],c.MhyxP))return console[n(896,"oGNo")](c[n(849,"s8p2")]),void c[n(692,"T6[J")](o,c[n(541,"gdqj")]);_0x882e61[n(430,"GIiv")](c.ITqGP)}console[n(460,"Y]b]")]("----------getOpenid------3------\x3e",a),t(a)}else _0x46844c[n(833,"@WBq")].clickid=_0x2bd747.clickId,_0x2f3101[n(958,"&qfL")][n(552,"AgQ$")]=_0x502e9c[n(447,"h*NO")]},fail:function(){}})})})}},{key:r,value:function(e){var n=t,i={CTgGl:function(e){return e()},xXhAY:o[n(699,"@WBq")]};ks.request({url:p[n(674,"Y]b]")][1],data:{app_id:p.userParams.appid,open_id:p.userParams[n(881,"T6[J")],callback:p.userParams[n(476,"4GQT")],event_type:p.event_type[n(807,"9]MJ")],account_id:p[n(702,"s8p2")][n(669,"DT3T")],campaign_id:p[n(702,"s8p2")][n(416,"bVP]")],unit_id:p[n(677,"Kdvf")][n(757,"rX@a")],creative_id:p[n(784,"9]MJ")].creative_id},header:{"Content-Type":o[n(721,"Kdvf")]},method:o.MvgpJ,success:function(){var t=n;e&&i[t(529,"9]MJ")](e),console[t(473,"dsJb")](i.xXhAY)},fail:function(){console.warn(o.AMFBi)}})}},{key:u,value:function(){var e=t,n={hLGGT:o[e(783,"oGNo")],kUEAV:o[e(502,"AEL&")],YRbTW:o[e(664,"Y]b]")]};if(o.stSti("KtyyP",e(590,"EFiX"))){var i={ulGSV:n.kUEAV};if(!_0x5a360d.tt)return void _0x464e26[e(945,"fRO^")](e(898,"bVP]"));_0x1e8260[e(682,"fRO^")]({url:_0x127c52[e(897,"MKv^")][2],data:{openid:_0x35f211[e(484,"$6Pb")][e(498,"h$61")],clickid:_0x4d05f1[e(660,"*4Tk")][e(636,"zfy3")],event_type:_0x22b7fb[e(501,"WK6S")][e(586,"#Qee")],mp_id:_0x28f517[e(753,"MKv^")][e(614,"GIiv")]},header:{"Content-Type":n.YRbTW},method:"POST",success:function(){_0xb5665a[e(946,"wQsK")](n.hLGGT)},fail:function(){_0x5d06e6[e(487,"@WBq")](i.ulGSV)}})}else{if(!window.ks)return void console[e(611,"r3FJ")](o[e(824,"&qfL")]);ks[e(893,"oGNo")]({url:p.urls_list[2],data:{app_id:p[e(777,"fRO^")][e(883,"&qfL")],open_id:p[e(535,"AEL&")][e(874,"Y]b]")],callback:p[e(635,"EFiX")].callback,event_type:p[e(837,"AEL&")][e(540,"3Ni%")]},header:{"Content-Type":o[e(961,"DT3T")]},method:o.MvgpJ,success:function(){console.warn(o.wDneh)},fail:function(){var t=e;console.warn(t(503,"3Ni%"))}})}}}]),p}(t(561,"$6Pb"),t(685,"$6Pb"),t(879,"dyv4"),t(809,"fRO^"),t(933,"40bq"));i[t(943,"&0w[")]={appid:"",openid:"",callback:"",account_id:"",campaign_id:"",unit_id:"",creative_id:""},i[t(678,"Eozz")]=[o[t(676,"h*NO")],o[t(760,"48Pn")],o[t(782,"40bq")]],i.event_type={active:1,game_addiction:143},e.ks_clzt=i}(window[p(581,"wQsK")]=window[p(869,"PBv3")]||{}),window[p(522,"3Ni%")]=window.tq_sdk||{},cc._RF.pop()},{"./helpers/asyncToGenerator":"asyncToGenerator","./helpers/classCallCheck":"classCallCheck","./helpers/createClass":"createClass","./helpers/regeneratorRuntime":"regeneratorRuntime"}],typeof:[function(e,t){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e){return"function"==typeof Symbol&&"symbol"===o(Symbol.iterator)?t.exports=n=function(e){return o(e)}:t.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":o(e)},n(e)}cc._RF.push(t,"a55cbq5gulNFqvECAjVKyGe","typeof"),t.exports=n,cc._RF.pop()},{}],vivo:[function(e,t){"use strict";cc._RF.push(t,"bdaa3Fvz+pBX4FGW0amOIgU","vivo");var o=t;cc._RF.push(o,"bdaa3Fvz+pBX4FGW0amOIgU","vivo"),cc._RF.pop(),cc._RF.pop()},{}],waterFlow_ED:[function(e,t,o){"use strict";cc._RF.push(t,"f1a816j1MNHGK7DwsJxNK7T","waterFlow_ED");var n=t,i=o;cc._RF.push(n,"f1a816j1MNHGK7DwsJxNK7T","waterFlow_ED");var r,a=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(i,"__esModule",{value:!0}),i.WaterFlow_ED=void 0;var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._toPt=cc.v2(),t.from=cc.v2(),t}return a(t,e),t.prototype.onLoad=function(){this.lineWidth=6,this.lineCap=cc.Graphics.LineCap.ROUND},Object.defineProperty(t.prototype,"toPt",{get:function(){return this._toPt},set:function(e){this._toPt=e,this.clear(),this.moveTo(this.from.x,this.from.y),this.lineTo(this._toPt.x,this._toPt.y),this.stroke()},enumerable:!1,configurable:!0}),t.prototype.playFlowAni=function(e,t,o,n,i){this.clear(),this.from=n?t:e,this.moveTo(this.from.x,this.from.y),cc.tween(this).set({toPt:e}).to(o,{toPt:t}).call(i).start()},t.prototype.setLineScale=function(e){this.lineWidth=6*e},t}(cc.Graphics);i.WaterFlow_ED=c,cc._RF.pop(),cc._RF.pop()},{}],web:[function(e,t){"use strict";cc._RF.push(t,"68675OtUFJJQKSniUmovzDU","web");var o=t;cc._RF.push(o,"68675OtUFJJQKSniUmovzDU","web"),cc._RF.pop(),cc._RF.pop()},{}],wechat:[function(e,t,o){"use strict";cc._RF.push(t,"e529eyySYBNCZD3mjtkDywb","wechat");var n=e,i=t,r=o;cc._RF.push(i,"048d64s3StD66VFKw3wYQcn","wechat");var a=function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function c(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},c=function(e,t){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return s([e,t])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.copyToClipboard=r.getGameTitle=r.forceGC=r.showCustomGridAd=r.CreateCustomGridAd=r.showCustomBannerAd=r.CreateCustomBannerAd=r.setWhiteList=r.getWXOpenId=r.getLaunchOptions=r.getOpendataContext=r.reportCollectionEvent=r.reportAdPointEvent=r.reportLevelTimeEvent=r.reportVideoEvent=r.reportPageEvent=r.reportVideoError=r.reportButtonEvent=r.reportShareEvent=r.removeDownloadFile=r.downImageFile=r.loadSubpackage=r.login=r.onShow=r.onHide=r.toMiniGame=r.getSystemInfo=r.getSystemInfoSync=r.vibrateShortLight=r.vibrateShortMedium=r.vibrateShortHeavy=r.vibrateShort=r.vibrateLong=r.showModal=r.inviteShowShare=r.showShare=r.showTips=r.openShare=r.showRewardAD=r.showInterstitialAd=r.showGridAD=r.showBannerAD=r.createRewardedVideoAd=r.createInterstitialAd=r.createGridAd=r.createBannerAd=r.initAds=r.init=r.getRandomLabelUrl=r.getRandomImageUrl=void 0,r.showSubGameUpdate=r.showSubFriendRank=r.showUpdateSub=r.showRecommend=r.loadRecommendData=r.showGameCenter=r.loadGameCenterData=r.GetGameClubReward=r.getGameClubData=r.destroyGameClubButton=r.showGameClubButton=r.createGameClubButton=r.inviter=r.invited=void 0;var s,l,u,p,d,f,h=n("AppConfig"),y=n("AppConfig"),m=n("RingFightManager"),g=n("AudioManager"),v=n("CommonData"),_=n("CupMgr"),S=n("const"),b=n("DataManager"),C=n("GameManager"),P=n("gravityAnalys"),k=n("Rankdata"),w=n("IAAAnalys"),I=n("DataNexusEnum"),T=n("DataNexusSDK"),A=cc._decorator,O=(A.ccclass,A.property,"https://api.flysheeep.com/api/expro/getopenid"),R=h.appId,N=h.gameTitle,M=h.interAD_ID,L=y.rewardAD_ID,E=null,F=null,x=null,D=null,B=!1,W=["\u5728\u5417\uff1f\u9080\u4f60\u4e00\u8d77\u7ed9\u6c34\u6ef4\u6392\u5e8f\u2026\u2026","\u522b\u7b11\uff01\u4f60\u8fde\u7b2c\u4e8c\u5173\u7684\u676f\u5b50\u90fd\u7aef\u4e0d\u7a33"],U=["https://mmocgame.qpic.cn/wechatgame/qsyIGXciaicECLzOpsfOho4LvZcNGf2WibPOYV0KM4XyDmhsG47vQCpIsK05GpsHzp6/0","https://mmocgame.qpic.cn/wechatgame/hzbdicMYTic1QAcjp42CklY4Ng6VUCSQz90GUkf8UPGA0hRySmRX62gLv8GgdD4h1G/0","https://mmocgame.qpic.cn/wechatgame/Hr3RHI8aY1PeLH80R8Aaf7mHibzQJvZHD9zibye9Sj2SzMWxhc6sv8YJ8gQ5zcwWBH/0","https://mmocgame.qpic.cn/wechatgame/qz7B4aTwUSAhSiahSy4WfdrAMicy7wGpqUFxLJSztMFblK0ypv2pfTNS9MB0up9ic61/0","https://mmocgame.qpic.cn/wechatgame/WXK9tfqbuia8wjtIsUjDWBpaZ9nkws2crkgLYu1LTuH2PeBmj2p8Vj0APG7j4cC9W/0","https://mmocgame.qpic.cn/wechatgame/zxCexUiceFiaYFqibOyHMjKajiayBCcDib8ibluuaPgDYS9YIlib5Xn4t7VUolLZPH56Iich/0","https://mmocgame.qpic.cn/wechatgame/wquloibWFNjjuxK9ObGQY8AFS3c5SN0ckrRyCeMdcwZ3loqGXL7QXpZvtTOlagsCk/0","https://mmocgame.qpic.cn/wechatgame/YOKuftwqIk57bVvCfmZJMzLrdXwDm4QyPMbVfYSUZqaT5qEic9Zf565TnJQlNIpes/0"];function j(){var e=Math.floor(Math.random()*U.length);return U[e]}function G(){var e=Math.floor(Math.random()*W.length);return W[e]}r.getRandomImageUrl=j,r.getRandomLabelUrl=G;var H=["1176","1184","1191","1193","1195","1197","1198","1200","1201","1205","1206","1216","1219","1228","1239"],z=["1045","1046","1084"],V=["1095"];function q(){wx.createBannerAd}function X(){wx.createGridAd}function J(){v.default.ifTestingB&&wx.createInterstitialAd&&""!=M&&(F=wx.createInterstitialAd({adUnitId:M})).onError(function(e){$("inter_load_fail",JSON.stringify(e),e.errCode)})}function K(){console.log("====>> createRewardedVideoAd"),wx.createRewardedVideoAd&&""!=L&&((x=wx.createRewardedVideoAd({adUnitId:L})).onLoad(function(){console.log("Rewarded \u52a0\u8f7d\u6210\u529f")}),x.onError(function(e){Q("\u5e7f\u544a\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5!"),$("load_fail",JSON.stringify(e),e.errCode),console.log("Rewarded \u52a0\u8f7d\u5931\u8d25"+e)}),x.onClose(function(e){cc.director.emit(S.EventNames.OnVideoAdEnd),e&&e.isEnded||void 0===e?(console.log("\u64ad\u653e\u5b8c\u6210\u5173\u95ed"),s&&(v.default.PropCounter++,5!=v.default.PropCounter&&10!=v.default.PropCounter||(v.default.firstProp=!0,_.default.getInstance()&&(_.default.getInstance().updateLockedCups(),_.default.getInstance().currentLevelAdWatchedCount++)),s(),C.default.onRewardAdClose(),s=null)):(Q("\u5b8c\u6574\u89c2\u770b\u89c6\u9891\u624d\u80fd\u83b7\u5f97\u5956\u52b1\u54e6"),l&&(l(),l=null))}))}function Y(){wx.showShareMenu&&(wx.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]}),wx.onShareAppMessage(function(){return T.default.instance.trackShare(I.ShareTarget.APP_MESSAGE),{title:G(),imageUrl:j()}}),wx.onShareTimeline&&wx.onShareTimeline(function(){return T.default.instance.trackShare(I.ShareTarget.TIME_LINE),{title:G(),imageUrl:j()}}))}function Q(e){wx.showToast({title:e,icon:"none",duration:2500})}function Z(e,t){var o=G(),n=j(),i=W.indexOf(o),r=U.indexOf(n);T.default.instance.trackShare(I.ShareTarget.APP_MESSAGE),P.track("Share",{name:"ShowShare",title:i.toString(),imageUrl:r.toString(),scene:v.default.sceneId}),wx.shareAppMessage({title:o,imageUrl:n,query:"&title="+i+"&imageUrl="+r+"&sceneId="+v.default.sceneId}),p=e,d=t,B=!0,u=Date.now()}function $(e,t,o,n,i){v.default.ifTest||(console.log("reportVideoEvent",e,t,o,n,i),P.track("Video",{name:e,mode:t,level:v.default.CurrentLevel,type:o,scene:v.default.sceneId,undoNum:v.default.PropUndo,addCupNum:v.default.PropAddCup,pumpNum:v.default.PropPump}))}function ee(){return new Promise(function(e,t){var o=cc.sys.localStorage.getItem("waterSortOpenId");wx.login({success:function(n){var i=n.code;wx.request({url:O,header:{"Content-Type":"application/json;charset=utf-8","x-appid":v.default.appId},data:{appid:R,code:i},method:"POST",success:function(t){var o=t.data.data;console.error("\u83b7\u53d6 openId",t),o.openid?v.default.openId=o.openid:o.anonymous_openid&&(v.default.openId=o.anonymous_openid),cc.sys.localStorage.setItem("waterSortOpenId",v.default.openId),P.init(v.default.openId);var n=wx.getLaunchOptionsSync().query;w.init(n,v.default.openId,v.default.appId),f&&f.openId&&!v.default.IsFirstInvited&&(console.error("\u88ab\u9080\u8bf7\u4eba openId:",f.openId),re(f.openId)),ae(),v.default.IsFirstInvited=!0,te(),b.default.tryUpdateUserData(!0),b.default.tryUpdateGoldCoin(!0),T.default.instance.setOpenId(v.default.openId),1==v.default.Level&&1==v.default.isNewPlayer&&(T.default.instance.trackRegister(),v.default.isNewPlayer=!1),k.default.getRankData(),e(v.default.openId)},fail:function(e){t(e),v.default.openId=o,console.error("------------get openid---------fail-------",e)}})},fail:function(e){v.default.openId=o,console.error("------------login---------fail-------",e)}})})}function te(){wx.request({url:"https://api.flysheeep.com/api/user/get_user_type",header:{"Content-Type":"application/json;charset=utf-8","x-appid":v.default.appId},data:{open_id:v.default.openId},method:"POST",success:function(e){var t=e.data.data;if(t.user_type){var o=t.user_type;console.warn("\u7528\u6237\u7c7b\u578b",o),1==o?(v.default.playerType=1,v.default.ifTest=!0,v.default.ifSkipAd=!0):(v.default.ifTest=!1,v.default.ifSkipAd=!1)}},fail:function(e){console.error("------------get usertype_fail---------fail-------",e)}})}r.init=function(){var e=wx.getLaunchOptionsSync(),t=wx.getDeviceInfo();de(wx.getAppBaseInfo().SDKVersion,"3.10.1")>0&&m.default.instance.init(),console.error("user",v.default.userInfoAuthorized,v.default.nickName,v.default.avatarUrl),v.default.platform=t.platform,v.default.version="1.5.4",(f=e.query)&&f.title&&f.imageUrl&&P.track("Share",{name:"EnterGame",title:f.title,imageUrl:f.imageUrl,scene:f.sceneId}),1103!==e.scene&&1104!==e.scene&&1001!==e.scene&&1089!==e.scene&&1257!==e.scene&&1271!==e.scene||(v.default.ifOpenBySidebar=!0),v.default.sceneId=e.scene.toString(),""==v.default.FirstLogInDate&&(v.default.FirstLogInDate=v.default.getTodayDate()),v.default.isToday(v.default.LastLogInDate)||(v.default.PropCounter=0,H.includes(v.default.sceneId)||z.includes(v.default.sceneId)&&v.default.isToday(v.default.FirstLogInDate)||V.includes(v.default.sceneId)&&v.default.isToday(v.default.FirstLogInDate)?(v.default.PropCounter=999,v.default.firstProp=!1):v.default.firstProp=!0),wx.onAddToFavorites(function(){T.default.instance.trackAddToWishlist(I.WishListType.DEFAULT)}),v.default.appId=R,Y(),wx.onShow(function(){console.log("====>> WX onShow"),B&&(B=!1,Date.now()-u>=2500?d?p(d):p&&p():Math.random()>.5?Q("\u5206\u4eab\u5931\u8d25\uff0c\u8bf7\u5206\u4eab\u5230\u7fa4\u83b7\u5f97\u5956\u52b1"):Q("\u5206\u4eab\u5931\u8d25\uff0c\u8bf7\u5206\u4eab\u7ed9\u597d\u53cb\u83b7\u5f97\u5956\u52b1"),p=null)}),wx.onAudioInterruptionEnd(function(){cc.audioEngine.pauseMusic(),cc.audioEngine.resumeMusic(),g.default.instance.resumeBGM()}),ee().then(function(){le(),wx.getSetting({success:function(e){console.error("\u83b7\u53d6\u7528\u6237\u8bbe\u7f6e:",e);var t=e.subscriptionsSetting;if(t&&!0===t.mainSwitch){var o=t.itemSettings;o&&"accept"===o.SYS_MSG_TYPE_RANK&&(v.default.subFriendRank=!0),o&&"accept"===o.SYS_MSG_TYPE_WHATS_NEW&&(v.default.subUpdateNotice=!0)}!0===e.authSetting["scope.userInfo"]?wx.getUserInfo({success:function(e){v.default.userInfoAuthorized=!0,v.default.nickName=e.userInfo.nickName,v.default.avatarUrl=e.userInfo.avatarUrl,console.error("\u6388\u6743\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u6210\u529f:",e,v.default.nickName,v.default.avatarUrl,v.default.userInfoAuthorized)}}):(v.default.userInfoAuthorized=!1,console.error("\u6388\u6743\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u5931\u8d25:",e,v.default.nickName,v.default.avatarUrl,v.default.userInfoAuthorized))}})}),v.default.LastLogInDate=v.default.getTodayDate()},r.initAds=function(){console.log("====>> init Ads"),K(),J()},r.createBannerAd=q,r.createGridAd=X,r.createInterstitialAd=J,r.createRewardedVideoAd=K,r.showBannerAD=function(e){null!=E?e?E.show():E.hide():q()},r.showGridAD=function(e){null!=D?e?D.show():D.hide():X()},r.showInterstitialAd=function(){""!=M&&(null!=F?F.show().catch(function(e){$("interAD_show_fail1",JSON.stringify(e),e.errCode),F.load().then(function(){F.show().catch(function(e){$("interAD_show_fail2",JSON.stringify(e),e.errCode)}),console.log("interAD error",e)})}):J())},r.showRewardAD=function(e){return new Promise(function(t,o){if(null==x)return Q("\u6682\u65f6\u6ca1\u6709\u53ef\u64ad\u653e\u7684\u5e7f\u544a\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5!"),K(),void o("\u6682\u65f6\u6ca1\u6709\u53ef\u64ad\u653e\u7684\u5e7f\u544a\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5!");x.show().then(function(){cc.director.emit(S.EventNames.OnVideoAdStart),T.default.instance.trackAdImpression(1),s=function(){s=e(),t("\u64ad\u653e\u5b8c\u6210\u5173\u95ed")},l=function(){o("\u5b8c\u6574\u89c2\u770b\u89c6\u9891\u624d\u80fd\u83b7\u5f97\u5956\u52b1\u54e6")}}).catch(function(n){$("show_fail1",JSON.stringify(n),n.errCode),x.load().then(function(){x.show().then(function(){cc.director.emit(S.EventNames.OnVideoAdStart),T.default.instance.trackAdImpression(1),s=function(){s=e(),t("\u64ad\u653e\u5b8c\u6210\u5173\u95ed")},l=function(){o("\u5b8c\u6574\u89c2\u770b\u89c6\u9891\u624d\u80fd\u83b7\u5f97\u5956\u52b1\u54e6")}}).catch(function(n){$("show_fail2",JSON.stringify(n),n.errCode);var i=Date.now();(!v.default.lastRewardAdFailShareTime||i-v.default.lastRewardAdFailShareTime>=36e5)&&(v.default.lastRewardAdFailShareTime=i,v.default.lastRewardAdFailCallShareTimes=0),v.default.lastRewardAdFailCallShareTimes<=5?(v.default.lastRewardAdFailCallShareTimes+=1,Z(function(){e(),cc.director.emit(S.EventNames.OnVideoAdEnd)}),t("\u901a\u8fc7\u5206\u4eab\u83b7\u5f97\u5956\u52b1")):(Q("\u6682\u65f6\u62c9\u53d6\u4e0d\u5230\u5e7f\u544a\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5"),o("\u5206\u4eab\u6b21\u6570\u5df2\u8fbe\u4e0a\u9650"))})})})})},r.openShare=Y,r.showTips=Q,r.showShare=Z,r.inviteShowShare=function(){wx.shareAppMessage({title:G(),imageUrl:j(),query:"openId="+v.default.openId})},r.showModal=function(e,t,o,n){wx.showModal({title:e,content:t,success:function(e){e.confirm?o&&o():e.cancel&&n&&n()}})},r.vibrateLong=function(){wx.vibrateLong({success:function(e){console.log(""+e)},fail:function(){console.log("vibrateLong\u8c03\u7528\u5931\u8d25")}})},r.vibrateShort=function(){wx.vibrateShort({success:function(e){console.log(""+e)},fail:function(){console.log("vibrateLong\u8c03\u7528\u5931\u8d25")}})},r.vibrateShortHeavy=function(){wx.vibrateShort({type:"heavy",success:function(e){console.log(""+e)},fail:function(){console.log("vibrateShortHeavy\u8c03\u7528\u5931\u8d25")}})},r.vibrateShortMedium=function(){wx.vibrateShort({type:"medium",success:function(e){console.log(""+e)},fail:function(){console.log("vibrateShortMedium  \u8c03\u7528\u5931\u8d25")}})},r.vibrateShortLight=function(){wx.vibrateShort({type:"light",success:function(e){console.log(""+e)},fail:function(){console.log("vibrateShortLight  \u8c03\u7528\u5931\u8d25")}})},r.getSystemInfoSync=function(){try{return wx.getSystemInfoSync()}catch(n){console.log("getSystemInfoSync fail")}},r.getSystemInfo=function(e){wx.getSystemInfo({success:function(){e.success()},fail:function(){e.fail&&e.fail()},complete:function(){e.complete&&e.complete()}})},r.toMiniGame=function(e){wx.navigateToMiniProgram({appId:e,path:"",extraData:{time:(new Date).valueOf()},success:function(){}})},r.onHide=function(e){wx.onHide(function(){e()})},r.onShow=function(e){wx.onShow(function(){e()})},r.login=function(){return new Promise(function(e,t){wx.login({timeout:3e3,success:function(o){o.code?e(o.code):t("\u672a\u83b7\u53d6\u5230code")},fail:function(e){t(e)}})})},r.loadSubpackage=function(e){return new Promise(function(t,o){wx.loadSubpackage({name:e,success:function(){console.log("\u5fae\u4fe1\u52a0\u8f7d\u5206\u5305====> \u6210\u529f","\u5206\u5305\u540d:"+e),t(0)},fail:function(t){console.log("\u5fae\u4fe1\u52a0\u8f7d\u5206\u5305====> \u5931\u8d25","\u5206\u5305\u540d:"+e,"err = "+t),o()}})})},r.downImageFile=function(e){for(var t=""+wx.env.USER_DATA_PATH,o=e.split("resource/")[1];-1!=o.indexOf("/");){var n=o.indexOf("/"),i=o.substring(0,n),r=o.substring(n+1,o.length);o=i+"-"+r}var a=t+"/"+o,c=wx.getFileSystemManager();return new Promise(function(t,o){c.stat({path:a,success:function(e){e.stats.isDirectory(),e.stats.isFile()&&t(a)},fail:function(){wx.downloadFile({url:e,success:function(e){wx.saveFile({tempFilePath:e.tempFilePath,filePath:a,success:function(){console.log("\u4fdd\u5b58\u5230\u672c\u5730!!!"),t(a)},fail:function(){o("\u6587\u4ef6\u4fdd\u5b58\u5931\u8d25!")}})},fail:function(){o("\u6587\u4ef6\u4e0b\u8f7d\u5931\u8d25!")}})}})})},r.removeDownloadFile=function(e){for(var t=""+wx.env.USER_DATA_PATH,o=e.split("resource/")[1];-1!=o.indexOf("/");){var n=o.indexOf("/"),i=o.substring(0,n),r=o.substring(n+1,o.length);o=i+"-"+r}var a=t+"/"+o,c=wx.getFileSystemManager();return new Promise(function(t,o){c.stat({path:a,success:function(n){n.stats.isFile()&&(c.unlink({filePath:a,success:function(){console.log("\u5220\u9664\u672c\u5730\u56fe\u7247\u6210\u529f!!!!!",e),t(0)},fail:function(){o()}}),t(a))},fail:function(){console.log("\u672c\u5730\u56fe\u7247\u4e0d\u5b58\u5728",e),t(0)}})})},r.reportShareEvent=function(e,t,o,n){v.default.ifTest||(console.log("reportShareEvent",e,t,o,n),P.track("Share",{name:e,title:" ",imageUrl:" ",scene:v.default.sceneId,undoNum:v.default.PropUndo,addCupNum:v.default.PropAddCup,pumpNum:v.default.PropPump}))},r.reportButtonEvent=function(e,t,o,n,i){v.default.ifTest||(console.log("reportButtonEvent",e,t,o,n,i),P.track("Button",{name:e,mode:v.default.mode,level:v.default.CurrentLevel,type:t,scene:v.default.sceneId,undoNum:v.default.PropUndo,addCupNum:v.default.PropAddCup,pumpNum:v.default.PropPump}))},r.reportVideoError=$,r.reportPageEvent=function(e,t,o,n){v.default.ifTest||(console.log("reportPageEvent",e,t,o,n),P.track("Page",{name:e,mode:v.default.mode,level:v.default.CurrentLevel,scene:v.default.sceneId,undoNum:v.default.PropUndo,addCupNum:v.default.PropAddCup,pumpNum:v.default.PropPump}))},r.reportVideoEvent=function(e,t,o,n,i){v.default.ifTest||(console.log("reportVideoEvent",e,t,o,n,i),P.track("Video",{name:e,mode:v.default.mode,level:v.default.CurrentLevel,type:o,scene:v.default.sceneId,undoNum:v.default.PropUndo,addCupNum:v.default.PropAddCup,pumpNum:v.default.PropPump}),w.reportIAA(t,e))},r.reportLevelTimeEvent=function(e,t,o,n,i){v.default.ifTest||(console.log("reportLevelTimeEvent",e,t,o,n,i),P.track("LevelTime",{name:e,mode:v.default.mode,time:t,level:v.default.CurrentLevel,scene:v.default.sceneId,undoNum:v.default.PropUndo,addCupNum:v.default.PropAddCup,pumpNum:v.default.PropPump}))},r.reportAdPointEvent=function(e,t,o,n,i){v.default.ifTest||(console.log("reportAdPointEvent",e,t,o,n,i),P.track("AdPoint",{name:e,mode:v.default.mode,level:v.default.CurrentLevel,progress:t,scene:v.default.sceneId,undoNum:v.default.PropUndo,addCupNum:v.default.PropAddCup,pumpNum:v.default.PropPump}))},r.reportCollectionEvent=function(e,t,o,n){v.default.ifTest||(console.log("reportCollectionEvent",e,t,o,n),P.track("Collection",{name:e,level:v.default.CurrentLevel,scene:v.default.sceneId,progressCap:t,progressDrink:o,progressCharacter:n,undoNum:v.default.PropUndo,addCupNum:v.default.PropAddCup,pumpNum:v.default.PropPump}))},r.getOpendataContext=function(){return wx.getOpenDataContext()},r.getLaunchOptions=function(){var e=wx.getLaunchOptionsSync().scene.toString();return console.log("\u767b\u5f55\u573a\u666f ",e,oe[e]),e},r.getWXOpenId=ee,r.setWhiteList=te;var oe={1e3:"\u5176\u4ed6",1001:"\u53d1\u73b0\u9875\u5c0f\u7a0b\u5e8f\u300c\u6700\u8fd1\u4f7f\u7528\u300d\u5217\u8868",1005:"\u5fae\u4fe1\u9996\u9875\u9876\u90e8\u641c\u7d22\u6846\u7684\u641c\u7d22\u7ed3\u679c\u9875",1006:"\u53d1\u73b0\u680f\u5c0f\u7a0b\u5e8f\u4e3b\u5165\u53e3\u641c\u7d22\u6846\u7684\u641c\u7d22\u7ed3\u679c\u9875",1007:"\u5355\u4eba\u804a\u5929\u4f1a\u8bdd\u4e2d\u7684\u5c0f\u7a0b\u5e8f\u6d88\u606f\u5361\u7247",1008:"\u7fa4\u804a\u4f1a\u8bdd\u4e2d\u7684\u5c0f\u7a0b\u5e8f\u6d88\u606f\u5361\u7247",1010:"\u6536\u85cf\u5939",1011:"\u626b\u63cf\u4e8c\u7ef4\u7801",1012:"\u957f\u6309\u56fe\u7247\u8bc6\u522b\u4e8c\u7ef4\u7801",1013:"\u626b\u63cf\u624b\u673a\u76f8\u518c\u4e2d\u9009\u53d6\u7684\u4e8c\u7ef4\u7801",1014:"\u5c0f\u7a0b\u5e8f\u8ba2\u9605\u6d88\u606f\uff08\u4e0e1107\u76f8\u540c\uff09",1017:"\u524d\u5f80\u5c0f\u7a0b\u5e8f\u4f53\u9a8c\u7248\u7684\u5165\u53e3\u9875",1019:"\u5fae\u4fe1\u94b1\u5305\uff08\u5fae\u4fe1\u5ba2\u6237\u7aef7.0.0\u7248\u672c\u6539\u4e3a\u652f\u4ed8\u5165\u53e3\uff09",1020:"\u516c\u4f17\u53f7 profile \u9875\u76f8\u5173\u5c0f\u7a0b\u5e8f\u5217\u8868\uff08\u5df2\u5e9f\u5f03\uff09",1022:"\u804a\u5929\u9876\u90e8\u7f6e\u9876\u5c0f\u7a0b\u5e8f\u5165\u53e3",1023:"\u5b89\u5353\u7cfb\u7edf\u684c\u9762\u56fe\u6807",1024:"\u5c0f\u7a0b\u5e8f profile \u9875\t",1025:"\u626b\u63cf\u4e00\u7ef4\u7801",1026:"\u53d1\u73b0\u680f\u5c0f\u7a0b\u5e8f\u4e3b\u5165\u53e3\uff0c\u300c\u9644\u8fd1\u7684\u5c0f\u7a0b\u5e8f\u300d\u5217\u8868",1027:"\u5fae\u4fe1\u9996\u9875\u9876\u90e8\u641c\u7d22\u6846\u641c\u7d22\u7ed3\u679c\u9875\u300c\u4f7f\u7528\u8fc7\u7684\u5c0f\u7a0b\u5e8f\u300d\u5217\u8868",1028:"\u6211\u7684\u5361\u5305",1029:"\u5c0f\u7a0b\u5e8f\u4e2d\u7684\u5361\u5238\u8be6\u60c5\u9875",1030:"\u81ea\u52a8\u5316\u6d4b\u8bd5\u4e0b\u6253\u5f00\u5c0f\u7a0b\u5e8f",1031:"\u957f\u6309\u56fe\u7247\u8bc6\u522b\u4e00\u7ef4\u7801",1032:"\u626b\u63cf\u624b\u673a\u76f8\u518c\u4e2d\u9009\u53d6\u7684\u4e00\u7ef4\u7801",1034:"\u5fae\u4fe1\u652f\u4ed8\u5b8c\u6210\u9875",1035:"\u516c\u4f17\u53f7\u81ea\u5b9a\u4e49\u83dc\u5355",1036:"App \u5206\u4eab\u6d88\u606f\u5361\u7247",1037:"\u5c0f\u7a0b\u5e8f\u6253\u5f00\u5c0f\u7a0b\u5e8f",1038:"\u4ece\u53e6\u4e00\u4e2a\u5c0f\u7a0b\u5e8f\u8fd4\u56de",1039:"\u6447\u7535\u89c6",1042:"\u6dfb\u52a0\u597d\u53cb\u641c\u7d22\u6846\u7684\u641c\u7d22\u7ed3\u679c\u9875",1043:"\u516c\u4f17\u53f7\u6a21\u677f\u6d88\u606f",1044:"\u5e26 shareTicket \u7684\u5c0f\u7a0b\u5e8f\u6d88\u606f\u5361\u7247",1045:"\u670b\u53cb\u5708\u5e7f\u544a",1046:"\u670b\u53cb\u5708\u5e7f\u544a\u8be6\u60c5\u9875",1047:"\u626b\u63cf\u5c0f\u7a0b\u5e8f\u7801",1048:"\u957f\u6309\u56fe\u7247\u8bc6\u522b\u5c0f\u7a0b\u5e8f\u7801",1049:"\u626b\u63cf\u624b\u673a\u76f8\u518c\u4e2d\u9009\u53d6\u7684\u5c0f\u7a0b\u5e8f\u7801",1052:"\u5361\u5238\u7684\u9002\u7528\u95e8\u5e97\u5217\u8868",1053:"\u641c\u4e00\u641c\u7684\u7ed3\u679c\u9875",1054:"\u9876\u90e8\u641c\u7d22\u6846\u5c0f\u7a0b\u5e8f\u5feb\u6377\u5165\u53e3",1056:"\u804a\u5929\u9876\u90e8\u97f3\u4e50\u64ad\u653e\u5668\u53f3\u4e0a\u89d2\u83dc\u5355",1057:"\u94b1\u5305\u4e2d\u7684\u94f6\u884c\u5361\u8be6\u60c5\u9875",1058:"\u516c\u4f17\u53f7\u6587\u7ae0",1059:"\u4f53\u9a8c\u7248\u5c0f\u7a0b\u5e8f\u7ed1\u5b9a\u9080\u8bf7\u9875",1060:"\u5fae\u4fe1\u652f\u4ed8\u5b8c\u6210\u9875\uff08\u4e0e1034\u76f8\u540c\uff09",1064:"\u5fae\u4fe1\u9996\u9875\u8fdeWi-Fi\u72b6\u6001\u680f",1065:"URL scheme",1067:"\u516c\u4f17\u53f7\u6587\u7ae0\u5e7f\u544a",1068:"\u9644\u8fd1\u5c0f\u7a0b\u5e8f\u5217\u8868\u5e7f\u544a\uff08\u5df2\u5e9f\u5f03\uff09",1069:"\u79fb\u52a8\u5e94\u7528\u901a\u8fc7openSDK\u8fdb\u5165\u5fae\u4fe1\uff0c\u6253\u5f00\u5c0f\u7a0b\u5e8f",1071:"\u94b1\u5305\u4e2d\u7684\u94f6\u884c\u5361\u5217\u8868\u9875",1072:"\u4e8c\u7ef4\u7801\u6536\u6b3e\u9875\u9762",1073:"\u5ba2\u670d\u6d88\u606f\u5217\u8868\u4e0b\u53d1\u7684\u5c0f\u7a0b\u5e8f\u6d88\u606f\u5361\u7247",1074:"\u516c\u4f17\u53f7\u4f1a\u8bdd\u4e0b\u53d1\u7684\u5c0f\u7a0b\u5e8f\u6d88\u606f\u5361\u7247",1077:"\u6447\u5468\u8fb9",1078:"\u5fae\u4fe1\u8fdeWi-Fi\u6210\u529f\u63d0\u793a\u9875",1079:"\u5fae\u4fe1\u6e38\u620f\u4e2d\u5fc3",1081:"\u5ba2\u670d\u6d88\u606f\u4e0b\u53d1\u7684\u6587\u5b57\u94fe",1082:"\u516c\u4f17\u53f7\u4f1a\u8bdd\u4e0b\u53d1\u7684\u6587\u5b57\u94fe",1084:"\u670b\u53cb\u5708\u5e7f\u544a\u539f\u751f\u9875",1088:"\u4f1a\u8bdd\u4e2d,\u7cfb\u7edf\u6d88\u606f\uff0c\u6253\u5f00\u5c0f\u7a0b\u5e8f",1089:"\u5fae\u4fe1\u804a\u5929\u4e3b\u754c\u9762\u4e0b\u62c9\uff0c\u300c\u6700\u8fd1\u4f7f\u7528\u300d\u680f",1090:"\u957f\u6309\u5c0f\u7a0b\u5e8f\u53f3\u4e0a\u89d2\u83dc\u5355\u5524\u51fa\u6700\u8fd1\u4f7f\u7528\u5386\u53f2",1091:"\u516c\u4f17\u53f7\u6587\u7ae0\u5546\u54c1\u5361\u7247",1092:"\u57ce\u5e02\u670d\u52a1\u5165\u53e3",1095:"\u5c0f\u7a0b\u5e8f\u5e7f\u544a\u7ec4\u4ef6",1096:"\u804a\u5929\u8bb0\u5f55\uff0c\u6253\u5f00\u5c0f\u7a0b\u5e8f",1097:"\u5fae\u4fe1\u652f\u4ed8\u7b7e\u7ea6\u539f\u751f\u9875\uff0c\u6253\u5f00\u5c0f\u7a0b\u5e8f",1099:"\u9875\u9762\u5185\u5d4c\u63d2\u4ef6",1100:"\u7ea2\u5305\u5c01\u9762\u8be6\u60c5\u9875\u6253\u5f00\u5c0f\u7a0b\u5e8f",1101:"\u8fdc\u7a0b\u8c03\u8bd5\u70ed\u66f4\u65b0\uff08\u5f00\u53d1\u8005\u5de5\u5177\u4e2d\uff0c\u9884\u89c8 -> \u81ea\u52a8\u9884\u89c8 -> \u7f16\u8bd1\u5e76\u9884\u89c8\uff09",1102:"\u516c\u4f17\u53f7 profile \u9875\u670d\u52a1\u9884\u89c8",1103:"\u53d1\u73b0\u9875\u5c0f\u7a0b\u5e8f\u300c\u6211\u7684\u5c0f\u7a0b\u5e8f\u300d\u5217\u8868",1104:"\u5fae\u4fe1\u804a\u5929\u4e3b\u754c\u9762\u4e0b\u62c9\uff0c\u300c\u6211\u7684\u5c0f\u7a0b\u5e8f\u300d\u680f",1106:"\u804a\u5929\u4e3b\u754c\u9762\u4e0b\u62c9\uff0c\u4ece\u9876\u90e8\u641c\u7d22\u7ed3\u679c\u9875\uff0c\u6253\u5f00\u5c0f\u7a0b\u5e8f",1107:"\u8ba2\u9605\u6d88\u606f\uff0c\u6253\u5f00\u5c0f\u7a0b\u5e8f",1113:"\u5b89\u5353\u624b\u673a\u8d1f\u4e00\u5c4f\uff0c\u6253\u5f00\u5c0f\u7a0b\u5e8f\uff08\u4e09\u661f\uff09",1114:"\u5b89\u5353\u624b\u673a\u4fa7\u8fb9\u680f\uff0c\u6253\u5f00\u5c0f\u7a0b\u5e8f\uff08\u4e09\u661f\uff09",1119:"\u3010\u4f01\u4e1a\u5fae\u4fe1\u3011\u5de5\u4f5c\u53f0\u5185\u6253\u5f00\u5c0f\u7a0b\u5e8f",1120:"\u3010\u4f01\u4e1a\u5fae\u4fe1\u3011\u4e2a\u4eba\u8d44\u6599\u9875\u5185\u6253\u5f00\u5c0f\u7a0b\u5e8f",1121:"\u3010\u4f01\u4e1a\u5fae\u4fe1\u3011\u804a\u5929\u52a0\u53f7\u9644\u4ef6\u6846\u5185\u6253\u5f00\u5c0f\u7a0b\u5e8f",1124:"\u626b\u201c\u4e00\u7269\u4e00\u7801\u201d\u6253\u5f00\u5c0f\u7a0b\u5e8f",1125:"\u957f\u6309\u56fe\u7247\u8bc6\u522b\u201c\u4e00\u7269\u4e00\u7801\u201d",1126:"\u626b\u63cf\u624b\u673a\u76f8\u518c\u4e2d\u9009\u53d6\u7684\u201c\u4e00\u7269\u4e00\u7801\u201d",1129:"\u5fae\u4fe1\u722c\u866b\u8bbf\u95ee",1131:"\u6d6e\u7a97",1133:"\u786c\u4ef6\u8bbe\u5907\u6253\u5f00\u5c0f\u7a0b\u5e8f",1135:"\u5c0f\u7a0b\u5e8fprofile\u9875\u76f8\u5173\u5c0f\u7a0b\u5e8f\u5217\u8868\uff0c\u6253\u5f00\u5c0f\u7a0b\u5e8f",1144:"\u516c\u4f17\u53f7\u6587\u7ae0 - \u89c6\u9891\u8d34\u7247",1145:"\u53d1\u73b0\u680f - \u53d1\u73b0\u5c0f\u7a0b\u5e8f",1146:"\u5730\u7406\u4f4d\u7f6e\u4fe1\u606f\u6253\u5f00\u51fa\u884c\u7c7b\u5c0f\u7a0b\u5e8f",1148:"\u5361\u5305-\u4ea4\u901a\u5361\uff0c\u6253\u5f00\u5c0f\u7a0b\u5e8f",1150:"\u626b\u4e00\u626b\u5546\u54c1\u6761\u7801\u7ed3\u679c\u9875\u6253\u5f00\u5c0f\u7a0b\u5e8f",1151:"\u53d1\u73b0\u680f - \u6211\u7684\u8ba2\u5355",1152:"\u8ba2\u9605\u53f7\u89c6\u9891\u6253\u5f00\u5c0f\u7a0b\u5e8f",1153:"\u201c\u8bc6\u7269\u201d\u7ed3\u679c\u9875\u6253\u5f00\u5c0f\u7a0b\u5e8f",1154:"\u670b\u53cb\u5708\u5185\u6253\u5f00\u201c\u5355\u9875\u6a21\u5f0f\u201d",1155:"\u201c\u5355\u9875\u6a21\u5f0f\u201d\u6253\u5f00\u5c0f\u7a0b\u5e8f",1157:"\u670d\u52a1\u53f7\u4f1a\u8bdd\u9875\u6253\u5f00\u5c0f\u7a0b\u5e8f",1158:"\u7fa4\u5de5\u5177\u6253\u5f00\u5c0f\u7a0b\u5e8f",1160:"\u7fa4\u5f85\u529e",1167:"H5 \u901a\u8fc7\u5f00\u653e\u6807\u7b7e\u6253\u5f00\u5c0f\u7a0b\u5e8f",1168:"\u79fb\u52a8/\u7f51\u7ad9\u5e94\u7528\u76f4\u63a5\u8fd0\u884c\u5c0f\u7a0b\u5e8f",1169:"\u53d1\u73b0\u680f\u5c0f\u7a0b\u5e8f\u4e3b\u5165\u53e3\uff0c\u5404\u4e2a\u751f\u6d3b\u670d\u52a1\u5165\u53e3\uff08\u4f8b\u5982\u5feb\u9012\u670d\u52a1\u3001\u51fa\u884c\u670d\u52a1\u7b49\uff09",1171:"\u5fae\u4fe1\u8fd0\u52a8\u8bb0\u5f55\uff08\u4ec5\u5b89\u5353\uff09",1173:"\u804a\u5929\u7d20\u6750\u7528\u5c0f\u7a0b\u5e8f\u6253\u5f00 \u8be6\u60c5",1175:"\u89c6\u9891\u53f7\u4e3b\u9875\u5546\u5e97\u5165\u53e3",1176:"\u89c6\u9891\u53f7\u76f4\u64ad\u95f4\u4e3b\u64ad\u6253\u5f00\u5c0f\u7a0b\u5e8f",1177:"\u89c6\u9891\u53f7\u76f4\u64ad\u5546\u54c1",1178:"\u5728\u7535\u8111\u6253\u5f00\u624b\u673a\u4e0a\u6253\u5f00\u7684\u5c0f\u7a0b\u5e8f",1179:"#\u8bdd\u9898\u9875\u6253\u5f00\u5c0f\u7a0b\u5e8f",1181:"\u7f51\u7ad9\u5e94\u7528\u6253\u5f00PC\u5c0f\u7a0b\u5e8f",1183:"PC\u5fae\u4fe1 - \u5c0f\u7a0b\u5e8f\u9762\u677f - \u53d1\u73b0\u5c0f\u7a0b\u5e8f - \u641c\u7d22",1184:"\u89c6\u9891\u53f7\u94fe\u63a5\u6253\u5f00\u5c0f\u7a0b\u5e8f",1185:"\u7fa4\u516c\u544a",1186:"\u6536\u85cf - \u7b14\u8bb0",1187:"\u6d6e\u7a97",1189:"\u8868\u60c5\u96e8\u5e7f\u544a",1191:"\u89c6\u9891\u53f7\u6d3b\u52a8",1192:"\u4f01\u4e1a\u5fae\u4fe1\u8054\u7cfb\u4ebaprofile\u9875",1193:"\u89c6\u9891\u53f7\u4e3b\u9875\u670d\u52a1\u83dc\u5355\u6253\u5f00\u5c0f\u7a0b\u5e8f",1194:"URL Link \u8be6\u60c5",1195:"\u89c6\u9891\u53f7\u4e3b\u9875\u5546\u54c1tab",1196:"\u4e2a\u4eba\u72b6\u6001\u6253\u5f00\u5c0f\u7a0b\u5e8f",1197:"\u89c6\u9891\u53f7\u4e3b\u64ad\u4ece\u76f4\u64ad\u95f4\u8fd4\u56de\u5c0f\u6e38\u620f",1198:"\u89c6\u9891\u53f7\u5f00\u64ad\u754c\u9762\u6253\u5f00\u5c0f\u6e38\u620f",1200:"\u89c6\u9891\u53f7\u5e7f\u544a\u6253\u5f00\u5c0f\u7a0b\u5e8f",1201:"\u89c6\u9891\u53f7\u5e7f\u544a\u8be6\u60c5\u9875\u6253\u5f00\u5c0f\u7a0b\u5e8f",1202:"\u4f01\u5fae\u5ba2\u670d\u53f7\u4f1a\u8bdd\u6253\u5f00\u5c0f\u7a0b\u5e8f\u5361\u7247",1203:"\u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u538b\u6d4b\u5de5\u5177\u7684\u8bf7\u6c42",1206:"\u89c6\u9891\u53f7\u5c0f\u6e38\u620f\u76f4\u64ad\u95f4\u6253\u5f00\u5c0f\u6e38\u620f",1207:"\u4f01\u5fae\u5ba2\u670d\u53f7\u4f1a\u8bdd\u6253\u5f00\u5c0f\u7a0b\u5e8f\u6587\u5b57\u94fe",1208:"\u804a\u5929\u6253\u5f00\u5546\u54c1\u5361\u7247",1212:"\u9752\u5c11\u5e74\u6a21\u5f0f\u7533\u8bf7\u9875\u6253\u5f00\u5c0f\u7a0b\u5e8f",1215:"\u5e7f\u544a\u9884\u7ea6\u6253\u5f00\u5c0f\u7a0b\u5e8f",1216:"\u89c6\u9891\u53f7\u8ba2\u5355\u4e2d\u5fc3\u6253\u5f00\u5c0f\u7a0b\u5e8f",1223:"\u5b89\u5353\u684c\u9762Widget\u6253\u5f00\u5c0f\u7a0b\u5e8f",1228:"\u89c6\u9891\u53f7\u539f\u751f\u5e7f\u544a\u7ec4\u4ef6\u6253\u5f00\u5c0f\u7a0b\u5e8f",1230:"\u8ba2\u9605\u53f7H5\u5e7f\u544a\u8fdb\u5165\u5c0f\u7a0b\u5e8f",1231:"\u52a8\u6001\u6d88\u606f\u63d0\u9192\u5165\u53e3\u6253\u5f00\u5c0f\u7a0b\u5e8f",1242:"\u5c0f\u7a0b\u5e8f\u53d1\u73b0\u9875\u95e8\u5e97\u5feb\u9001\u6a21\u5757\u9891\u9053\u9875\u8fdb\u5165\u5c0f\u7a0b\u5e8f",1245:"\u5c0f\u7a0b\u5e8f\u53d1\u73b0\u9875\u95e8\u5e97\u5feb\u9001\u641c\u7d22\u7ed3\u679c\u9875\u8fdb\u5165\u5c0f\u7a0b\u5e8f",1252:"\u641c\u4e00\u641c\u5c0f\u7a0b\u5e8f\u641c\u7d22\u9875\u300c\u5c0f\u529f\u80fd\u300d\u6a21\u5757\u8fdb\u5165\u5c0f\u7a0b\u5e8f"};function ne(){wx.createCustomAd&&((E=wx.createCustomAd({adUnitId:"adunit-09d8fb38bcba085a",adIntervals:30,left:0,top:wx.getWindowInfo().windowHeight-135,width:wx.getWindowInfo().windowWidth})).onLoad(function(){console.error("bannerAd\u52a0\u8f7d\u6210\u529f")}),E.onError(function(e){console.error("bannerAd\u52a0\u8f7d\u5931\u8d25"+e)}))}function ie(){wx.createCustomAd&&((D=wx.createCustomAd({adUnitId:"adunit-6f38edad2985f6ec",adIntervals:30,left:wx.getSystemInfoSync().windowWidth-100,top:85,width:300})).onLoad(function(){console.error("GridAd\u52a0\u8f7d\u6210\u529f")}),D.onError(function(e){console.error("GridAd\u52a0\u8f7d\u5931\u8d25"+e)}))}function re(e){wx.request({url:"https://api.flysheeep.com/api/sparrow/set_sparrow_invite",data:{app_id:v.default.appId,open_id:e,open_id_invitee:v.default.openId},header:{"content-type":"application/json","x-appid":v.default.appId},method:"POST",dataType:"JSON",responseType:"text",success:function(e){console.error("\u4e0a\u4f20\u88ab\u9080\u8bf7\u6210\u529f",e),v.default.IsFirstInvited=!0},fail:function(e){console.error("\u4e0a\u4f20\u88ab\u9080\u8bf7\u5931\u8d25",e)}})}function ae(e){void 0===e&&(e=function(){}),wx.request({url:"https://api.flysheeep.com/api/sparrow/get_sparrow_invite",data:{app_id:v.default.appId,open_id:v.default.openId},header:{"content-type":"application/json","x-appid":v.default.appId},method:"POST",dataType:"JSON",responseType:"text",success:function(t){t&&t.data&&(console.error("\u83b7\u53d6\u9080\u8bf7\u4eba\u6570\u6210\u529f",t),t=JSON.parse(t.data)),t.data.count?(console.error("\u9080\u8bf7\u4eba\u6570",t.data.count),v.default.InviteCount=t.data.count,e&&e()):console.log("\u83b7\u53d6\u9080\u8bf7\u4eba\u6570\u5931\u8d25",t)},fail:function(e){console.log("\u83b7\u53d6\u9080\u8bf7\u4eba\u6570\u5931\u8d25",e,v.default.openId,{appid:v.default.appId,code:e.code})}})}r.CreateCustomBannerAd=ne,r.showCustomBannerAd=function(e){null!=E?e?(console.error("showCustomBannerAd"),E.show()):(console.error("hideCustomBannerAd"),E.hide()):(console.error("CreateCustomBannerAd"),ne())},r.CreateCustomGridAd=ie,r.showCustomGridAd=function(e){null!=D?e?(console.error("showCustomGridAd"),D.show()):(console.error("hideCustomGridAd"),D.hide()):(console.error("CreateCustomGridAd"),ie())},r.forceGC=function(){wx.triggerGC?(wx.triggerGC(),console.log("\u5f3a\u5236\u89e6\u53d1\u5783\u573e\u56de\u6536")):console.warn("\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u4e0d\u652f\u6301\u5f3a\u5236\u89e6\u53d1\u5783\u573e\u56de\u6536")},r.getGameTitle=function(){return N},r.copyToClipboard=function(e){wx.setClipboardData({data:e})},r.invited=re,r.inviter=ae;var ce,se=null;function le(){if("wxeb3a3f764474c346"==v.default.appId&&window.wx){var e=[];new Promise(function(t,o){window.wx.request({url:"https://api.flysheeep.com/api/tapaway/get_gift",header:{"Content-Type":"application/json;charset=utf-8","x-appid":v.default.appId},data:{openid:v.default.openId},method:"POST",success:function(o){var n=o.data.data;if(n.gifts)for(var i=0,r=n.gifts;i<r.length;i++){var a=r[i];e.push(a.OrderId);for(var c=0,s=a.GoodsList;c<s.length;c++){var l=s[c];C.default.claimRewardFromServer(l.Id,l.Num)}}t()},fail:function(e){console.error("------------get openid---------fail-------",e),o()}})}).then(function(){e.length>0&&C.default.DeleteGameClubRewardHistory(e)})}}function ue(){return a(this,void 0,void 0,function(){var e;return c(this,function(t){switch(t.label){case 0:if(de(wx.getAppBaseInfo().SDKVersion,"3.7.6")<0)throw"\u5f53\u524d\u57fa\u7840\u5e93\u7248\u672c\u6682\u4e0d\u652f\u6301\u3002";return e=wx.createPageManager(),console.error("loadGameCenterData",e),[4,e.load({openlink:"FM09ILkjlQxM0OIigsWiuGIdFe7FV0HoNKXS8V9PYRFYoPHccWLC0bzbE15jGTWzuEUkrmlj9ojA5W6aWoMyrJxPz66VctqUptWDLaEFI1htCl5XmInmYKyFqHDDv0cEO3RzV9i-hFTtErsDy2LiXHBA1wuR8TtRJGMzbig3bEWf4ZcmkAxspE-1HwhfJZk2hAT1hjKlGymzU_DD4szno0fpPHbw_IKrnIiisAhA9mebarIw0oBGDwmt3U5izLGqnyKIJMtQUp640DT9VcsKKX6D7FEXyKtY075pxSbj1AsMjAjA729L_ZZrS-jhA-tpm75vFG9BnzjgxXiwEOvsytkQTdk8lG0qU6tFjUSbFGtcHsiHTC0blHAdkpwnMagI7g5T4mh9ZA3twY8d0trKpA"})];case 1:return t.sent(),ce=e,[2]}})})}function pe(){return a(this,void 0,void 0,function(){var e;return c(this,function(t){switch(t.label){case 0:return e=wx.createPageManager(),console.error("loadGameCenterData",e),[4,e.load({openlink:"TWFRCqV5WeM2AkMXhKwJ03MhfPOieJfAsvXKUbWvQFQtLyyA5etMPabBehga950uzfZcH3Vi3QeEh41xRGEVFw"})];case 1:return t.sent(),ce=e,de(wx.getAppBaseInfo().SDKVersion,"3.8.6")<0||e.on("destroy",function(e){console.error("recommend component destroy\uff1a",e.isRecommended),v.default.IsRecommended=e.isRecommended}),[2]}})})}function de(e,t){e=e.split("."),t=t.split(".");for(var o=Math.max(e.length,t.length);e.length<o;)e.push("0");for(;t.length<o;)t.push("0");for(var n=0;n<o;n++){var i=parseInt(e[n]),r=parseInt(t[n]);if(i>r)return 1;if(i<r)return-1}return 0}r.createGameClubButton=function(e,t,o,n){"wxeb3a3f764474c346"==v.default.appId&&wx.createGameClubButton&&(null==se?((se=wx.createGameClubButton({type:"text",text:"",style:{left:e,top:t,width:o,height:n}})).onTap(function(){T.default.instance.trackGameclubEnter()}),se.show()):se.show())},r.showGameClubButton=function(e){"wxeb3a3f764474c346"==v.default.appId&&null!=se&&(e?se.show():se.hide())},r.destroyGameClubButton=function(){"wxeb3a3f764474c346"==v.default.appId&&null!=se&&(se.destroy(),se=null)},r.getGameClubData=function(e){void 0===e&&(e=function(){}),"wxeb3a3f764474c346"==v.default.appId&&wx.getGameClubData({dataTypeList:[{type:1}],success:function(t){e&&e(t)},fail:function(t){e&&e(t)},complete:function(t){e&&e(t)}})},r.GetGameClubReward=le,r.loadGameCenterData=ue,r.showGameCenter=function(){return a(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return ce?[3,2]:[4,ue()];case 1:e.sent(),console.error("showGameCenter--loadGameCenterData--"),e.label=2;case 2:return console.error("showGameCenter--show--"),[4,ce.show()];case 3:return[2,e.sent()]}})})},r.loadRecommendData=pe,r.showRecommend=function(){return a(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return v.default.IsRecommended?(console.error("\u5df2\u7ecf\u63a8\u8350\u8fc7\u4e86"),[2]):ce?[3,2]:[4,pe()];case 1:e.sent(),console.error("showRecommend--loadRecommendData--"),e.label=2;case 2:return console.error("showRecommend--show--"),[4,ce.show()];case 3:return[2,e.sent()]}})})},r.showUpdateSub=function(){},r.showSubFriendRank=function(){wx.requestSubscribeSystemMessage({msgTypeList:["SYS_MSG_TYPE_INTERACTIVE","SYS_MSG_TYPE_RANK"],success:function(e){console.log(e),"accept"===e.SYS_MSG_TYPE_RANK&&(v.default.subFriendRank=!0)}})},r.showSubGameUpdate=function(){console.error(wx.getAppBaseInfo().SDKVersion),de(wx.getAppBaseInfo().SDKVersion,"2.32.1")<0||wx.requestSubscribeSystemMessage({msgTypeList:["SYS_MSG_TYPE_WHATS_NEW"],success:function(e){console.error(e),"accept"===e.SYS_MSG_TYPE_WHATS_NEW&&(T.default.instance.trackSubscribe(),v.default.subUpdateNotice=!0)}})},cc._RF.pop(),cc._RF.pop()},{}],withdrawPnl_SS:[function(e,t,o){"use strict";cc._RF.push(t,"8178dHsqhJLML0QrJq/+Z8S","withdrawPnl_SS");var n=e,i=t,r=o,a=function(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)};cc._RF.push(i,"8178dHsqhJLML0QrJq/+Z8S","withdrawPnl_SS");var c,s=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),l=function(e,t,o,n){var i,r=arguments.length,c=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(r<3?i(c):r>3?i(t,o,c):i(t,o))||c);return r>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(r,"__esModule",{value:!0});var u=n("CommonData_SS"),p=n("GameManager_SS"),d=n("PanelBase_SS"),f=cc._decorator,h=f.ccclass,y=(f.property,f.menu),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.start=function(){},t.prototype.clickClose=function(){p.default.playVibrateShort(),this.hide()},t.prototype.clickWithdraw=function(){var e=this;p.default.playVibrateShort(),p.default.platform.showRewardAD(function(){e.hide(function(){u.default.ScrewSortCtrl.withdraw()})})},l([h,y("ScrewSortGameUI/Withdraw")],t)}(d.default);r.default=m,cc._RF.pop(),cc._RF.pop()},{}]},{},["ABTest_Game","AbsorbCup","AddCupPanel","AddDesktopPanel","AddPackageNode","AddStepPanel","AddTimePanel","AppConfig","AudioManager","AudioManager_BP","AudioManager_ED","AutoPlayUtil","AutoPlayer","AutoPlayerFillLong","AutoPlayerLong","AutoPlayerMulti","AutoPlayUtil_ED","AutoPlayer_ED","BasePanel","BasePanel_ED","BeginnerTaskGift","BombCup","BombWarning","Bottle_BP","BreathAnimation","BundleManager","BundleData","CandidateText","CapSkin","ChallengeBtn","ChallengeModeScene","ChangeColorCup","CircleProgreeDisplay","ClockAnimation","CollectionData","CollectionManager","FinishEffectDataManager","FinishParticle","CollectionItem_Animal","CollectionItem_Cap","CollectionItem_Drink","CollectionItem_Effect","CollectionItem_Rank","CollectionItem_Theme","CollectionPanel","CollectionScroll_Animal","CollectionScroll_Cap","CollectionScroll_Drink","CollectionScroll_Effect","CollectionScroll_Theme","Puzzle","ThemeDataManager","CollectionUnlockItem","CommonData_SS","DataManager_SS","GameManager_SS","MusicManager_SS","UIManager_SS","CommonData","CupMgr","LevelData","LevelManager","Cup","Key","CupDraggable","CupDraggable_ED","CupInfoUI","CupInfoUI_ED","CupMgr_ED","CupMgr_Multi","CupShowCaseData","CupShowCaseItem","CupShowCasePanel","CupTips","Cup_17","Cup_ED","Cup_Long","DailyRewardPanel","DataManager","DataManager_ED","DataMultipleMode","DragModelInfo","DrinkCollectionPanel","DrinkPanel","EndStreakPanel","EnergyPanel","SignInManager","Event2Bg","Event2MainButton","EventDescPanel","EventEffectPanel","EventItem","EventMainButton","EventManager","EventNotifyPanel","EventPanel","EventResignPanel","EventRewardAllPanel","EventRewardItem","EventRewardPanel","ExternalManager_BP","ExternalManager_ED","FadeIn","FeedTimer","FileManager","FileManager_ED","FinishEffectData","FragileCup","GameClubPanel","GameLosePanel","GameManager","GameManager_BP","GameManager_ED","GameManager_RF","GameOverChallengePanel","GameOverMainPanel","GameOverPanel","GameOverPanel_BP","GameOverRankData","GameOverRankItem","GameOverRankPanel","GameOverRankScroll","GameOver_Gold","GamePnl_SS","GameScene","GameScene_RF","GoldDataManager","GroupPanel","IAAAnalys","InGameLevelText","InGameUnlockItem","InputSimulator","InputSimulator_ED","InvitePanel","UnlockData","JourneyMainPanel","JourneyUnlockManager","Journey_OtherPlayer","LevelEditor","LevelEditor_ED","LevelGenRunner","LevelManager_ED","LevelPreGenerator_BP","LevelSelectPanel_BP","LevelSolver_BP","LoadScene","LockCup","LosePanel","LosePanel_RF","MainDialogue","MainLevelText","MainScene","MainUserInfoBtn","Main_ChallengeBtn","Main_CharacterAnimation","Main_Conveyor","Main_DialogueControl","Main_Energy","Main_Gold","Main_Order","MiniDialoguePopOut","CupMgr_17","GameManager_17","CupMgr_Long","GameManager_Long","GameScene_Long","LevelManager_Long","GameManager_Multi","PKManager","Package","PackageAD","PackageManger","BeginnerTaskPanel","PropPanel","PanelBase_SS","PenguinProgressNode","NativeBridge","DataNexusEnum","DataNexusSDK","config","RandomRiderDisplay","CollectionScroll_ChallengeRank","CollectionScroll_Rank","MyItem","RankPanel","ResourceManager_SS","RewardPanel","RingFightManager","Row_ED","ScrewSortGame_SS","ScrewSortGenerateConfigured_SS","ScrewSortGenerate_SS","ScrewSortSteel_SS","Scroll2Today","SettingPanel","SettingPanel_BP","ShareTitle","SideModePanel","SidebarPanel","SignInData","SignInEnum","SimpleLevelGen","SingleColorCup","Slide","SpinAnimation","StaminaManager","StartingRiderAnimation","SubItem_Animal","SubItem_Cap","SubItem_Effect","SubItem_Theme","SuperHardTips","TEST_SS","TestNode","TestNode_ED","ThemeData","ThemeManager","TopPnl_SS","TutorialPanel","JourneyPanel","Rankdata","UIManager","UIManager_BP","UIManager_ED","UITestNode","UI_SS","Warning_Multi","Water","WaterArrGenerate_ED","WaterFlow_BP","Water_17","Water_ED","Water_Long","WinPanel_RF","WxSidebarPanel","addListGuideCtrl_SS","addListPnl_SS","android","LevelConfig_BP","LevelDataMgr_BP","LevelGeneratorTool","LevelGenerator_BP","SpriteConfig_BP","const","BottleMgr_BP","gameOverPnl_SS","gravityAnalys","guideCtrl_SS","index","ios","ks","meizu","oppo","GameOverPnl_ED","PropPnl_ED","SettingPnl_ED","countdownCtrl_ED","putTopPnl_SS","qq","revivePnl_SS","AutoPlay_SS","Tool_SS","gravityengine.mg.cocoscreator.min","Arrayincludes","Objectentries","asyncToGenerator","classCallCheck","createClass","regeneratorRuntime","toPrimitive","toPropertyKey","typeof","tq_sdk","setPnl_SS","test","testPanel_BP","toutiao","wechat","vivo","waterFlow_ED","web","withdrawPnl_SS"]);